var VA=Object.defineProperty;var ax=n=>{throw TypeError(n)};var WA=(n,e,t)=>e in n?VA(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var K=(n,e,t)=>WA(n,typeof e!="symbol"?e+"":e,t),Lm=(n,e,t)=>e.has(n)||ax("Cannot "+t);var l=(n,e,t)=>(Lm(n,e,"read from private field"),t?t.call(n):e.get(n)),w=(n,e,t)=>e.has(n)?ax("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),y=(n,e,t,s)=>(Lm(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),_=(n,e,t)=>(Lm(n,e,"access private method"),t);var Ut=(n,e,t,s)=>({set _(i){y(n,e,i,t)},get _(){return l(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();var Zs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qA(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function GA(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var i=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:function(){return n[s]}})}),t}var sw={exports:{}},nm={},nw={exports:{}},le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jh=Symbol.for("react.element"),XA=Symbol.for("react.portal"),KA=Symbol.for("react.fragment"),YA=Symbol.for("react.strict_mode"),QA=Symbol.for("react.profiler"),JA=Symbol.for("react.provider"),ZA=Symbol.for("react.context"),eE=Symbol.for("react.forward_ref"),tE=Symbol.for("react.suspense"),sE=Symbol.for("react.memo"),nE=Symbol.for("react.lazy"),ox=Symbol.iterator;function iE(n){return n===null||typeof n!="object"?null:(n=ox&&n[ox]||n["@@iterator"],typeof n=="function"?n:null)}var iw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rw=Object.assign,aw={};function $c(n,e,t){this.props=n,this.context=e,this.refs=aw,this.updater=t||iw}$c.prototype.isReactComponent={};$c.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};$c.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function ow(){}ow.prototype=$c.prototype;function Hy(n,e,t){this.props=n,this.context=e,this.refs=aw,this.updater=t||iw}var Vy=Hy.prototype=new ow;Vy.constructor=Hy;rw(Vy,$c.prototype);Vy.isPureReactComponent=!0;var lx=Array.isArray,lw=Object.prototype.hasOwnProperty,Wy={current:null},cw={key:!0,ref:!0,__self:!0,__source:!0};function uw(n,e,t){var s,i={},r=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(r=""+e.key),e)lw.call(e,s)&&!cw.hasOwnProperty(s)&&(i[s]=e[s]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];i.children=c}if(n&&n.defaultProps)for(s in o=n.defaultProps,o)i[s]===void 0&&(i[s]=o[s]);return{$$typeof:jh,type:n,key:r,ref:a,props:i,_owner:Wy.current}}function rE(n,e){return{$$typeof:jh,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function qy(n){return typeof n=="object"&&n!==null&&n.$$typeof===jh}function aE(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var cx=/\/+/g;function Mm(n,e){return typeof n=="object"&&n!==null&&n.key!=null?aE(""+n.key):e.toString(36)}function mf(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case jh:case XA:a=!0}}if(a)return a=n,i=i(a),n=s===""?"."+Mm(a,0):s,lx(i)?(t="",n!=null&&(t=n.replace(cx,"$&/")+"/"),mf(i,e,t,"",function(d){return d})):i!=null&&(qy(i)&&(i=rE(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(cx,"$&/")+"/")+n)),e.push(i)),1;if(a=0,s=s===""?".":s+":",lx(n))for(var o=0;o<n.length;o++){r=n[o];var c=s+Mm(r,o);a+=mf(r,e,t,c,i)}else if(c=iE(n),typeof c=="function")for(n=c.call(n),o=0;!(r=n.next()).done;)r=r.value,c=s+Mm(r,o++),a+=mf(r,e,t,c,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Hh(n,e,t){if(n==null)return n;var s=[],i=0;return mf(n,s,"","",function(r){return e.call(t,r,i++)}),s}function oE(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Zt={current:null},gf={transition:null},lE={ReactCurrentDispatcher:Zt,ReactCurrentBatchConfig:gf,ReactCurrentOwner:Wy};function dw(){throw Error("act(...) is not supported in production builds of React.")}le.Children={map:Hh,forEach:function(n,e,t){Hh(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Hh(n,function(){e++}),e},toArray:function(n){return Hh(n,function(e){return e})||[]},only:function(n){if(!qy(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};le.Component=$c;le.Fragment=KA;le.Profiler=QA;le.PureComponent=Hy;le.StrictMode=YA;le.Suspense=tE;le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lE;le.act=dw;le.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=rw({},n.props),i=n.key,r=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,a=Wy.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(c in e)lw.call(e,c)&&!cw.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];s.children=o}return{$$typeof:jh,type:n.type,key:i,ref:r,props:s,_owner:a}};le.createContext=function(n){return n={$$typeof:ZA,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:JA,_context:n},n.Consumer=n};le.createElement=uw;le.createFactory=function(n){var e=uw.bind(null,n);return e.type=n,e};le.createRef=function(){return{current:null}};le.forwardRef=function(n){return{$$typeof:eE,render:n}};le.isValidElement=qy;le.lazy=function(n){return{$$typeof:nE,_payload:{_status:-1,_result:n},_init:oE}};le.memo=function(n,e){return{$$typeof:sE,type:n,compare:e===void 0?null:e}};le.startTransition=function(n){var e=gf.transition;gf.transition={};try{n()}finally{gf.transition=e}};le.unstable_act=dw;le.useCallback=function(n,e){return Zt.current.useCallback(n,e)};le.useContext=function(n){return Zt.current.useContext(n)};le.useDebugValue=function(){};le.useDeferredValue=function(n){return Zt.current.useDeferredValue(n)};le.useEffect=function(n,e){return Zt.current.useEffect(n,e)};le.useId=function(){return Zt.current.useId()};le.useImperativeHandle=function(n,e,t){return Zt.current.useImperativeHandle(n,e,t)};le.useInsertionEffect=function(n,e){return Zt.current.useInsertionEffect(n,e)};le.useLayoutEffect=function(n,e){return Zt.current.useLayoutEffect(n,e)};le.useMemo=function(n,e){return Zt.current.useMemo(n,e)};le.useReducer=function(n,e,t){return Zt.current.useReducer(n,e,t)};le.useRef=function(n){return Zt.current.useRef(n)};le.useState=function(n){return Zt.current.useState(n)};le.useSyncExternalStore=function(n,e,t){return Zt.current.useSyncExternalStore(n,e,t)};le.useTransition=function(){return Zt.current.useTransition()};le.version="18.3.1";nw.exports=le;var G=nw.exports;const Gy=qA(G);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE=G,uE=Symbol.for("react.element"),dE=Symbol.for("react.fragment"),hE=Object.prototype.hasOwnProperty,fE=cE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,pE={key:!0,ref:!0,__self:!0,__source:!0};function hw(n,e,t){var s,i={},r=null,a=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)hE.call(e,s)&&!pE.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:uE,type:n,key:r,ref:a,props:i,_owner:fE.current}}nm.Fragment=dE;nm.jsx=hw;nm.jsxs=hw;sw.exports=nm;var u=sw.exports,fw={exports:{}},Ds={},pw={exports:{}},mw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(D,q){var X=D.length;D.push(q);e:for(;0<X;){var se=X-1>>>1,ae=D[se];if(0<i(ae,q))D[se]=q,D[X]=ae,X=se;else break e}}function t(D){return D.length===0?null:D[0]}function s(D){if(D.length===0)return null;var q=D[0],X=D.pop();if(X!==q){D[0]=X;e:for(var se=0,ae=D.length,Se=ae>>>1;se<Se;){var Nt=2*(se+1)-1,sn=D[Nt],Pe=Nt+1,me=D[Pe];if(0>i(sn,X))Pe<ae&&0>i(me,sn)?(D[se]=me,D[Pe]=X,se=Pe):(D[se]=sn,D[Nt]=X,se=Nt);else if(Pe<ae&&0>i(me,X))D[se]=me,D[Pe]=X,se=Pe;else break e}}return q}function i(D,q){var X=D.sortIndex-q.sortIndex;return X!==0?X:D.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],d=[],h=1,f=null,p=3,m=!1,g=!1,b=!1,A=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(D){for(var q=t(d);q!==null;){if(q.callback===null)s(d);else if(q.startTime<=D)s(d),q.sortIndex=q.expirationTime,e(c,q);else break;q=t(d)}}function E(D){if(b=!1,S(D),!g)if(t(c)!==null)g=!0,L(C);else{var q=t(d);q!==null&&F(E,q.startTime-D)}}function C(D,q){g=!1,b&&(b=!1,x(T),T=-1),m=!0;var X=p;try{for(S(q),f=t(c);f!==null&&(!(f.expirationTime>q)||D&&!z());){var se=f.callback;if(typeof se=="function"){f.callback=null,p=f.priorityLevel;var ae=se(f.expirationTime<=q);q=n.unstable_now(),typeof ae=="function"?f.callback=ae:f===t(c)&&s(c),S(q)}else s(c);f=t(c)}if(f!==null)var Se=!0;else{var Nt=t(d);Nt!==null&&F(E,Nt.startTime-q),Se=!1}return Se}finally{f=null,p=X,m=!1}}var N=!1,k=null,T=-1,I=5,R=-1;function z(){return!(n.unstable_now()-R<I)}function ce(){if(k!==null){var D=n.unstable_now();R=D;var q=!0;try{q=k(!0,D)}finally{q?ye():(N=!1,k=null)}}else N=!1}var ye;if(typeof v=="function")ye=function(){v(ce)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,qe=ue.port2;ue.port1.onmessage=ce,ye=function(){qe.postMessage(null)}}else ye=function(){A(ce,0)};function L(D){k=D,N||(N=!0,ye())}function F(D,q){T=A(function(){D(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(D){D.callback=null},n.unstable_continueExecution=function(){g||m||(g=!0,L(C))},n.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<D?Math.floor(1e3/D):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(D){switch(p){case 1:case 2:case 3:var q=3;break;default:q=p}var X=p;p=q;try{return D()}finally{p=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(D,q){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var X=p;p=D;try{return q()}finally{p=X}},n.unstable_scheduleCallback=function(D,q,X){var se=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?se+X:se):X=se,D){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=X+ae,D={id:h++,callback:q,priorityLevel:D,startTime:X,expirationTime:ae,sortIndex:-1},X>se?(D.sortIndex=X,e(d,D),t(c)===null&&D===t(d)&&(b?(x(T),T=-1):b=!0,F(E,X-se))):(D.sortIndex=ae,e(c,D),g||m||(g=!0,L(C))),D},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(D){var q=p;return function(){var X=p;p=q;try{return D.apply(this,arguments)}finally{p=X}}}})(mw);pw.exports=mw;var mE=pw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gE=G,Ms=mE;function M(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gw=new Set,Fu={};function Fo(n,e){Pc(n,e),Pc(n+"Capture",e)}function Pc(n,e){for(Fu[n]=e,n=0;n<e.length;n++)gw.add(e[n])}var qi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sg=Object.prototype.hasOwnProperty,yE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ux={},dx={};function vE(n){return Sg.call(dx,n)?!0:Sg.call(ux,n)?!1:yE.test(n)?dx[n]=!0:(ux[n]=!0,!1)}function xE(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function bE(n,e,t,s){if(e===null||typeof e>"u"||xE(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function es(n,e,t,s,i,r,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=a}var kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){kt[n]=new es(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];kt[e]=new es(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){kt[n]=new es(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){kt[n]=new es(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){kt[n]=new es(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){kt[n]=new es(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){kt[n]=new es(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){kt[n]=new es(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){kt[n]=new es(n,5,!1,n.toLowerCase(),null,!1,!1)});var Xy=/[\-:]([a-z])/g;function Ky(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Xy,Ky);kt[e]=new es(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Xy,Ky);kt[e]=new es(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Xy,Ky);kt[e]=new es(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){kt[n]=new es(n,1,!1,n.toLowerCase(),null,!1,!1)});kt.xlinkHref=new es("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){kt[n]=new es(n,1,!1,n.toLowerCase(),null,!0,!0)});function Yy(n,e,t,s){var i=kt.hasOwnProperty(e)?kt[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bE(e,t,i,s)&&(t=null),s||i===null?vE(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var Ji=gE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vh=Symbol.for("react.element"),il=Symbol.for("react.portal"),rl=Symbol.for("react.fragment"),Qy=Symbol.for("react.strict_mode"),Ag=Symbol.for("react.profiler"),yw=Symbol.for("react.provider"),vw=Symbol.for("react.context"),Jy=Symbol.for("react.forward_ref"),Eg=Symbol.for("react.suspense"),kg=Symbol.for("react.suspense_list"),Zy=Symbol.for("react.memo"),nr=Symbol.for("react.lazy"),xw=Symbol.for("react.offscreen"),hx=Symbol.iterator;function Vc(n){return n===null||typeof n!="object"?null:(n=hx&&n[hx]||n["@@iterator"],typeof n=="function"?n:null)}var ze=Object.assign,Dm;function nu(n){if(Dm===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Dm=e&&e[1]||""}return`
`+Dm+n}var Om=!1;function Fm(n,e){if(!n||Om)return"";Om=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(n,[],e)}else{try{e.call()}catch(d){s=d}n.call(e.prototype)}else{try{throw Error()}catch(d){s=d}n()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),r=s.stack.split(`
`),a=i.length-1,o=r.length-1;1<=a&&0<=o&&i[a]!==r[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==r[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==r[o]){var c=`
`+i[a].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=a&&0<=o);break}}}finally{Om=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?nu(n):""}function wE(n){switch(n.tag){case 5:return nu(n.type);case 16:return nu("Lazy");case 13:return nu("Suspense");case 19:return nu("SuspenseList");case 0:case 2:case 15:return n=Fm(n.type,!1),n;case 11:return n=Fm(n.type.render,!1),n;case 1:return n=Fm(n.type,!0),n;default:return""}}function Ng(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case rl:return"Fragment";case il:return"Portal";case Ag:return"Profiler";case Qy:return"StrictMode";case Eg:return"Suspense";case kg:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case vw:return(n.displayName||"Context")+".Consumer";case yw:return(n._context.displayName||"Context")+".Provider";case Jy:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Zy:return e=n.displayName||null,e!==null?e:Ng(n.type)||"Memo";case nr:e=n._payload,n=n._init;try{return Ng(n(e))}catch{}}return null}function _E(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ng(e);case 8:return e===Qy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function bw(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function SE(n){var e=bw(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){s=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Wh(n){n._valueTracker||(n._valueTracker=SE(n))}function ww(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=bw(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function np(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Cg(n,e){var t=e.checked;return ze({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function fx(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=Qr(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _w(n,e){e=e.checked,e!=null&&Yy(n,"checked",e,!1)}function Tg(n,e){_w(n,e);var t=Qr(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?jg(n,e.type,t):e.hasOwnProperty("defaultValue")&&jg(n,e.type,Qr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function px(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function jg(n,e,t){(e!=="number"||np(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var iu=Array.isArray;function vl(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+Qr(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Pg(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(M(91));return ze({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function mx(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(M(92));if(iu(t)){if(1<t.length)throw Error(M(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Qr(t)}}function Sw(n,e){var t=Qr(e.value),s=Qr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function gx(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Aw(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rg(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Aw(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var qh,Ew=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(qh=qh||document.createElement("div"),qh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=qh.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function $u(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Au={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AE=["Webkit","ms","Moz","O"];Object.keys(Au).forEach(function(n){AE.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Au[e]=Au[n]})});function kw(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Au.hasOwnProperty(n)&&Au[n]?(""+e).trim():e+"px"}function Nw(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=kw(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var EE=ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ig(n,e){if(e){if(EE[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(M(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(M(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(M(61))}if(e.style!=null&&typeof e.style!="object")throw Error(M(62))}}function Lg(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mg=null;function ev(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Dg=null,xl=null,bl=null;function yx(n){if(n=Ih(n)){if(typeof Dg!="function")throw Error(M(280));var e=n.stateNode;e&&(e=lm(e),Dg(n.stateNode,n.type,e))}}function Cw(n){xl?bl?bl.push(n):bl=[n]:xl=n}function Tw(){if(xl){var n=xl,e=bl;if(bl=xl=null,yx(n),e)for(n=0;n<e.length;n++)yx(e[n])}}function jw(n,e){return n(e)}function Pw(){}var $m=!1;function Rw(n,e,t){if($m)return n(e,t);$m=!0;try{return jw(n,e,t)}finally{$m=!1,(xl!==null||bl!==null)&&(Pw(),Tw())}}function Bu(n,e){var t=n.stateNode;if(t===null)return null;var s=lm(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(M(231,e,typeof t));return t}var Og=!1;if(qi)try{var Wc={};Object.defineProperty(Wc,"passive",{get:function(){Og=!0}}),window.addEventListener("test",Wc,Wc),window.removeEventListener("test",Wc,Wc)}catch{Og=!1}function kE(n,e,t,s,i,r,a,o,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(h){this.onError(h)}}var Eu=!1,ip=null,rp=!1,Fg=null,NE={onError:function(n){Eu=!0,ip=n}};function CE(n,e,t,s,i,r,a,o,c){Eu=!1,ip=null,kE.apply(NE,arguments)}function TE(n,e,t,s,i,r,a,o,c){if(CE.apply(this,arguments),Eu){if(Eu){var d=ip;Eu=!1,ip=null}else throw Error(M(198));rp||(rp=!0,Fg=d)}}function $o(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Iw(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function vx(n){if($o(n)!==n)throw Error(M(188))}function jE(n){var e=n.alternate;if(!e){if(e=$o(n),e===null)throw Error(M(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return vx(i),n;if(r===s)return vx(i),e;r=r.sibling}throw Error(M(188))}if(t.return!==s.return)t=i,s=r;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,s=r;break}if(o===s){a=!0,s=i,t=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===t){a=!0,t=r,s=i;break}if(o===s){a=!0,s=r,t=i;break}o=o.sibling}if(!a)throw Error(M(189))}}if(t.alternate!==s)throw Error(M(190))}if(t.tag!==3)throw Error(M(188));return t.stateNode.current===t?n:e}function Lw(n){return n=jE(n),n!==null?Mw(n):null}function Mw(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Mw(n);if(e!==null)return e;n=n.sibling}return null}var Dw=Ms.unstable_scheduleCallback,xx=Ms.unstable_cancelCallback,PE=Ms.unstable_shouldYield,RE=Ms.unstable_requestPaint,Ke=Ms.unstable_now,IE=Ms.unstable_getCurrentPriorityLevel,tv=Ms.unstable_ImmediatePriority,Ow=Ms.unstable_UserBlockingPriority,ap=Ms.unstable_NormalPriority,LE=Ms.unstable_LowPriority,Fw=Ms.unstable_IdlePriority,im=null,si=null;function ME(n){if(si&&typeof si.onCommitFiberRoot=="function")try{si.onCommitFiberRoot(im,n,void 0,(n.current.flags&128)===128)}catch{}}var kn=Math.clz32?Math.clz32:FE,DE=Math.log,OE=Math.LN2;function FE(n){return n>>>=0,n===0?32:31-(DE(n)/OE|0)|0}var Gh=64,Xh=4194304;function ru(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function op(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?s=ru(o):(r&=a,r!==0&&(s=ru(r)))}else a=t&~i,a!==0?s=ru(a):r!==0&&(s=ru(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-kn(e),i=1<<t,s|=n[t],e&=~i;return s}function $E(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function BE(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var a=31-kn(r),o=1<<a,c=i[a];c===-1?(!(o&t)||o&s)&&(i[a]=$E(o,e)):c<=e&&(n.expiredLanes|=o),r&=~o}}function $g(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function $w(){var n=Gh;return Gh<<=1,!(Gh&4194240)&&(Gh=64),n}function Bm(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Ph(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-kn(e),n[e]=t}function UE(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-kn(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function sv(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-kn(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var be=0;function Bw(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Uw,nv,zw,Hw,Vw,Bg=!1,Kh=[],zr=null,Hr=null,Vr=null,Uu=new Map,zu=new Map,rr=[],zE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bx(n,e){switch(n){case"focusin":case"focusout":zr=null;break;case"dragenter":case"dragleave":Hr=null;break;case"mouseover":case"mouseout":Vr=null;break;case"pointerover":case"pointerout":Uu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zu.delete(e.pointerId)}}function qc(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=Ih(e),e!==null&&nv(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function HE(n,e,t,s,i){switch(e){case"focusin":return zr=qc(zr,n,e,t,s,i),!0;case"dragenter":return Hr=qc(Hr,n,e,t,s,i),!0;case"mouseover":return Vr=qc(Vr,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return Uu.set(r,qc(Uu.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,zu.set(r,qc(zu.get(r)||null,n,e,t,s,i)),!0}return!1}function Ww(n){var e=va(n.target);if(e!==null){var t=$o(e);if(t!==null){if(e=t.tag,e===13){if(e=Iw(t),e!==null){n.blockedOn=e,Vw(n.priority,function(){zw(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function yf(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Ug(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);Mg=s,t.target.dispatchEvent(s),Mg=null}else return e=Ih(t),e!==null&&nv(e),n.blockedOn=t,!1;e.shift()}return!0}function wx(n,e,t){yf(n)&&t.delete(e)}function VE(){Bg=!1,zr!==null&&yf(zr)&&(zr=null),Hr!==null&&yf(Hr)&&(Hr=null),Vr!==null&&yf(Vr)&&(Vr=null),Uu.forEach(wx),zu.forEach(wx)}function Gc(n,e){n.blockedOn===e&&(n.blockedOn=null,Bg||(Bg=!0,Ms.unstable_scheduleCallback(Ms.unstable_NormalPriority,VE)))}function Hu(n){function e(i){return Gc(i,n)}if(0<Kh.length){Gc(Kh[0],n);for(var t=1;t<Kh.length;t++){var s=Kh[t];s.blockedOn===n&&(s.blockedOn=null)}}for(zr!==null&&Gc(zr,n),Hr!==null&&Gc(Hr,n),Vr!==null&&Gc(Vr,n),Uu.forEach(e),zu.forEach(e),t=0;t<rr.length;t++)s=rr[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<rr.length&&(t=rr[0],t.blockedOn===null);)Ww(t),t.blockedOn===null&&rr.shift()}var wl=Ji.ReactCurrentBatchConfig,lp=!0;function WE(n,e,t,s){var i=be,r=wl.transition;wl.transition=null;try{be=1,iv(n,e,t,s)}finally{be=i,wl.transition=r}}function qE(n,e,t,s){var i=be,r=wl.transition;wl.transition=null;try{be=4,iv(n,e,t,s)}finally{be=i,wl.transition=r}}function iv(n,e,t,s){if(lp){var i=Ug(n,e,t,s);if(i===null)Ym(n,e,s,cp,t),bx(n,s);else if(HE(i,n,e,t,s))s.stopPropagation();else if(bx(n,s),e&4&&-1<zE.indexOf(n)){for(;i!==null;){var r=Ih(i);if(r!==null&&Uw(r),r=Ug(n,e,t,s),r===null&&Ym(n,e,s,cp,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else Ym(n,e,s,null,t)}}var cp=null;function Ug(n,e,t,s){if(cp=null,n=ev(s),n=va(n),n!==null)if(e=$o(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Iw(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return cp=n,null}function qw(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(IE()){case tv:return 1;case Ow:return 4;case ap:case LE:return 16;case Fw:return 536870912;default:return 16}default:return 16}}var $r=null,rv=null,vf=null;function Gw(){if(vf)return vf;var n,e=rv,t=e.length,s,i="value"in $r?$r.value:$r.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(s=1;s<=a&&e[t-s]===i[r-s];s++);return vf=i.slice(n,1<s?1-s:void 0)}function xf(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Yh(){return!0}function _x(){return!1}function Os(n){function e(t,s,i,r,a){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Yh:_x,this.isPropagationStopped=_x,this}return ze(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Yh)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Yh)},persist:function(){},isPersistent:Yh}),e}var Bc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},av=Os(Bc),Rh=ze({},Bc,{view:0,detail:0}),GE=Os(Rh),Um,zm,Xc,rm=ze({},Rh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ov,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Xc&&(Xc&&n.type==="mousemove"?(Um=n.screenX-Xc.screenX,zm=n.screenY-Xc.screenY):zm=Um=0,Xc=n),Um)},movementY:function(n){return"movementY"in n?n.movementY:zm}}),Sx=Os(rm),XE=ze({},rm,{dataTransfer:0}),KE=Os(XE),YE=ze({},Rh,{relatedTarget:0}),Hm=Os(YE),QE=ze({},Bc,{animationName:0,elapsedTime:0,pseudoElement:0}),JE=Os(QE),ZE=ze({},Bc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),ek=Os(ZE),tk=ze({},Bc,{data:0}),Ax=Os(tk),sk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ik={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rk(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=ik[n])?!!e[n]:!1}function ov(){return rk}var ak=ze({},Rh,{key:function(n){if(n.key){var e=sk[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=xf(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?nk[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ov,charCode:function(n){return n.type==="keypress"?xf(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?xf(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),ok=Os(ak),lk=ze({},rm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ex=Os(lk),ck=ze({},Rh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ov}),uk=Os(ck),dk=ze({},Bc,{propertyName:0,elapsedTime:0,pseudoElement:0}),hk=Os(dk),fk=ze({},rm,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),pk=Os(fk),mk=[9,13,27,32],lv=qi&&"CompositionEvent"in window,ku=null;qi&&"documentMode"in document&&(ku=document.documentMode);var gk=qi&&"TextEvent"in window&&!ku,Xw=qi&&(!lv||ku&&8<ku&&11>=ku),kx=" ",Nx=!1;function Kw(n,e){switch(n){case"keyup":return mk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yw(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var al=!1;function yk(n,e){switch(n){case"compositionend":return Yw(e);case"keypress":return e.which!==32?null:(Nx=!0,kx);case"textInput":return n=e.data,n===kx&&Nx?null:n;default:return null}}function vk(n,e){if(al)return n==="compositionend"||!lv&&Kw(n,e)?(n=Gw(),vf=rv=$r=null,al=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Xw&&e.locale!=="ko"?null:e.data;default:return null}}var xk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cx(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!xk[n.type]:e==="textarea"}function Qw(n,e,t,s){Cw(s),e=up(e,"onChange"),0<e.length&&(t=new av("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var Nu=null,Vu=null;function bk(n){l_(n,0)}function am(n){var e=cl(n);if(ww(e))return n}function wk(n,e){if(n==="change")return e}var Jw=!1;if(qi){var Vm;if(qi){var Wm="oninput"in document;if(!Wm){var Tx=document.createElement("div");Tx.setAttribute("oninput","return;"),Wm=typeof Tx.oninput=="function"}Vm=Wm}else Vm=!1;Jw=Vm&&(!document.documentMode||9<document.documentMode)}function jx(){Nu&&(Nu.detachEvent("onpropertychange",Zw),Vu=Nu=null)}function Zw(n){if(n.propertyName==="value"&&am(Vu)){var e=[];Qw(e,Vu,n,ev(n)),Rw(bk,e)}}function _k(n,e,t){n==="focusin"?(jx(),Nu=e,Vu=t,Nu.attachEvent("onpropertychange",Zw)):n==="focusout"&&jx()}function Sk(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return am(Vu)}function Ak(n,e){if(n==="click")return am(e)}function Ek(n,e){if(n==="input"||n==="change")return am(e)}function kk(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Cn=typeof Object.is=="function"?Object.is:kk;function Wu(n,e){if(Cn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!Sg.call(e,i)||!Cn(n[i],e[i]))return!1}return!0}function Px(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Rx(n,e){var t=Px(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Px(t)}}function e_(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?e_(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function t_(){for(var n=window,e=np();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=np(n.document)}return e}function cv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Nk(n){var e=t_(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&e_(t.ownerDocument.documentElement,t)){if(s!==null&&cv(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=Rx(t,r);var a=Rx(t,s);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Ck=qi&&"documentMode"in document&&11>=document.documentMode,ol=null,zg=null,Cu=null,Hg=!1;function Ix(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Hg||ol==null||ol!==np(s)||(s=ol,"selectionStart"in s&&cv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Cu&&Wu(Cu,s)||(Cu=s,s=up(zg,"onSelect"),0<s.length&&(e=new av("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=ol)))}function Qh(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var ll={animationend:Qh("Animation","AnimationEnd"),animationiteration:Qh("Animation","AnimationIteration"),animationstart:Qh("Animation","AnimationStart"),transitionend:Qh("Transition","TransitionEnd")},qm={},s_={};qi&&(s_=document.createElement("div").style,"AnimationEvent"in window||(delete ll.animationend.animation,delete ll.animationiteration.animation,delete ll.animationstart.animation),"TransitionEvent"in window||delete ll.transitionend.transition);function om(n){if(qm[n])return qm[n];if(!ll[n])return n;var e=ll[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in s_)return qm[n]=e[t];return n}var n_=om("animationend"),i_=om("animationiteration"),r_=om("animationstart"),a_=om("transitionend"),o_=new Map,Lx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function sa(n,e){o_.set(n,e),Fo(e,[n])}for(var Gm=0;Gm<Lx.length;Gm++){var Xm=Lx[Gm],Tk=Xm.toLowerCase(),jk=Xm[0].toUpperCase()+Xm.slice(1);sa(Tk,"on"+jk)}sa(n_,"onAnimationEnd");sa(i_,"onAnimationIteration");sa(r_,"onAnimationStart");sa("dblclick","onDoubleClick");sa("focusin","onFocus");sa("focusout","onBlur");sa(a_,"onTransitionEnd");Pc("onMouseEnter",["mouseout","mouseover"]);Pc("onMouseLeave",["mouseout","mouseover"]);Pc("onPointerEnter",["pointerout","pointerover"]);Pc("onPointerLeave",["pointerout","pointerover"]);Fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pk=new Set("cancel close invalid load scroll toggle".split(" ").concat(au));function Mx(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,TE(s,e,void 0,n),n.currentTarget=null}function l_(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==r&&i.isPropagationStopped())break e;Mx(i,o,d),r=c}else for(a=0;a<s.length;a++){if(o=s[a],c=o.instance,d=o.currentTarget,o=o.listener,c!==r&&i.isPropagationStopped())break e;Mx(i,o,d),r=c}}}if(rp)throw n=Fg,rp=!1,Fg=null,n}function Ce(n,e){var t=e[Xg];t===void 0&&(t=e[Xg]=new Set);var s=n+"__bubble";t.has(s)||(c_(e,n,2,!1),t.add(s))}function Km(n,e,t){var s=0;e&&(s|=4),c_(t,n,s,e)}var Jh="_reactListening"+Math.random().toString(36).slice(2);function qu(n){if(!n[Jh]){n[Jh]=!0,gw.forEach(function(t){t!=="selectionchange"&&(Pk.has(t)||Km(t,!1,n),Km(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Jh]||(e[Jh]=!0,Km("selectionchange",!1,e))}}function c_(n,e,t,s){switch(qw(e)){case 1:var i=WE;break;case 4:i=qE;break;default:i=iv}t=i.bind(null,e,t,n),i=void 0,!Og||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Ym(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;o!==null;){if(a=va(o),a===null)return;if(c=a.tag,c===5||c===6){s=r=a;continue e}o=o.parentNode}}s=s.return}Rw(function(){var d=r,h=ev(t),f=[];e:{var p=o_.get(n);if(p!==void 0){var m=av,g=n;switch(n){case"keypress":if(xf(t)===0)break e;case"keydown":case"keyup":m=ok;break;case"focusin":g="focus",m=Hm;break;case"focusout":g="blur",m=Hm;break;case"beforeblur":case"afterblur":m=Hm;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Sx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=KE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=uk;break;case n_:case i_:case r_:m=JE;break;case a_:m=hk;break;case"scroll":m=GE;break;case"wheel":m=pk;break;case"copy":case"cut":case"paste":m=ek;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Ex}var b=(e&4)!==0,A=!b&&n==="scroll",x=b?p!==null?p+"Capture":null:p;b=[];for(var v=d,S;v!==null;){S=v;var E=S.stateNode;if(S.tag===5&&E!==null&&(S=E,x!==null&&(E=Bu(v,x),E!=null&&b.push(Gu(v,E,S)))),A)break;v=v.return}0<b.length&&(p=new m(p,g,null,t,h),f.push({event:p,listeners:b}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==Mg&&(g=t.relatedTarget||t.fromElement)&&(va(g)||g[Gi]))break e;if((m||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,m?(g=t.relatedTarget||t.toElement,m=d,g=g?va(g):null,g!==null&&(A=$o(g),g!==A||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=d),m!==g)){if(b=Sx,E="onMouseLeave",x="onMouseEnter",v="mouse",(n==="pointerout"||n==="pointerover")&&(b=Ex,E="onPointerLeave",x="onPointerEnter",v="pointer"),A=m==null?p:cl(m),S=g==null?p:cl(g),p=new b(E,v+"leave",m,t,h),p.target=A,p.relatedTarget=S,E=null,va(h)===d&&(b=new b(x,v+"enter",g,t,h),b.target=S,b.relatedTarget=A,E=b),A=E,m&&g)t:{for(b=m,x=g,v=0,S=b;S;S=Ho(S))v++;for(S=0,E=x;E;E=Ho(E))S++;for(;0<v-S;)b=Ho(b),v--;for(;0<S-v;)x=Ho(x),S--;for(;v--;){if(b===x||x!==null&&b===x.alternate)break t;b=Ho(b),x=Ho(x)}b=null}else b=null;m!==null&&Dx(f,p,m,b,!1),g!==null&&A!==null&&Dx(f,A,g,b,!0)}}e:{if(p=d?cl(d):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var C=wk;else if(Cx(p))if(Jw)C=Ek;else{C=Sk;var N=_k}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=Ak);if(C&&(C=C(n,d))){Qw(f,C,t,h);break e}N&&N(n,p,d),n==="focusout"&&(N=p._wrapperState)&&N.controlled&&p.type==="number"&&jg(p,"number",p.value)}switch(N=d?cl(d):window,n){case"focusin":(Cx(N)||N.contentEditable==="true")&&(ol=N,zg=d,Cu=null);break;case"focusout":Cu=zg=ol=null;break;case"mousedown":Hg=!0;break;case"contextmenu":case"mouseup":case"dragend":Hg=!1,Ix(f,t,h);break;case"selectionchange":if(Ck)break;case"keydown":case"keyup":Ix(f,t,h)}var k;if(lv)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else al?Kw(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(Xw&&t.locale!=="ko"&&(al||T!=="onCompositionStart"?T==="onCompositionEnd"&&al&&(k=Gw()):($r=h,rv="value"in $r?$r.value:$r.textContent,al=!0)),N=up(d,T),0<N.length&&(T=new Ax(T,n,null,t,h),f.push({event:T,listeners:N}),k?T.data=k:(k=Yw(t),k!==null&&(T.data=k)))),(k=gk?yk(n,t):vk(n,t))&&(d=up(d,"onBeforeInput"),0<d.length&&(h=new Ax("onBeforeInput","beforeinput",null,t,h),f.push({event:h,listeners:d}),h.data=k))}l_(f,e)})}function Gu(n,e,t){return{instance:n,listener:e,currentTarget:t}}function up(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=Bu(n,t),r!=null&&s.unshift(Gu(n,r,i)),r=Bu(n,e),r!=null&&s.push(Gu(n,r,i))),n=n.return}return s}function Ho(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Dx(n,e,t,s,i){for(var r=e._reactName,a=[];t!==null&&t!==s;){var o=t,c=o.alternate,d=o.stateNode;if(c!==null&&c===s)break;o.tag===5&&d!==null&&(o=d,i?(c=Bu(t,r),c!=null&&a.unshift(Gu(t,c,o))):i||(c=Bu(t,r),c!=null&&a.push(Gu(t,c,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var Rk=/\r\n?/g,Ik=/\u0000|\uFFFD/g;function Ox(n){return(typeof n=="string"?n:""+n).replace(Rk,`
`).replace(Ik,"")}function Zh(n,e,t){if(e=Ox(e),Ox(n)!==e&&t)throw Error(M(425))}function dp(){}var Vg=null,Wg=null;function qg(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Gg=typeof setTimeout=="function"?setTimeout:void 0,Lk=typeof clearTimeout=="function"?clearTimeout:void 0,Fx=typeof Promise=="function"?Promise:void 0,Mk=typeof queueMicrotask=="function"?queueMicrotask:typeof Fx<"u"?function(n){return Fx.resolve(null).then(n).catch(Dk)}:Gg;function Dk(n){setTimeout(function(){throw n})}function Qm(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),Hu(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);Hu(e)}function Wr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function $x(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Uc=Math.random().toString(36).slice(2),ti="__reactFiber$"+Uc,Xu="__reactProps$"+Uc,Gi="__reactContainer$"+Uc,Xg="__reactEvents$"+Uc,Ok="__reactListeners$"+Uc,Fk="__reactHandles$"+Uc;function va(n){var e=n[ti];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Gi]||t[ti]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=$x(n);n!==null;){if(t=n[ti])return t;n=$x(n)}return e}n=t,t=n.parentNode}return null}function Ih(n){return n=n[ti]||n[Gi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function cl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(M(33))}function lm(n){return n[Xu]||null}var Kg=[],ul=-1;function na(n){return{current:n}}function je(n){0>ul||(n.current=Kg[ul],Kg[ul]=null,ul--)}function Ne(n,e){ul++,Kg[ul]=n.current,n.current=e}var Jr={},Bt=na(Jr),hs=na(!1),To=Jr;function Rc(n,e){var t=n.type.contextTypes;if(!t)return Jr;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function fs(n){return n=n.childContextTypes,n!=null}function hp(){je(hs),je(Bt)}function Bx(n,e,t){if(Bt.current!==Jr)throw Error(M(168));Ne(Bt,e),Ne(hs,t)}function u_(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(M(108,_E(n)||"Unknown",i));return ze({},t,s)}function fp(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Jr,To=Bt.current,Ne(Bt,n),Ne(hs,hs.current),!0}function Ux(n,e,t){var s=n.stateNode;if(!s)throw Error(M(169));t?(n=u_(n,e,To),s.__reactInternalMemoizedMergedChildContext=n,je(hs),je(Bt),Ne(Bt,n)):je(hs),Ne(hs,t)}var pi=null,cm=!1,Jm=!1;function d_(n){pi===null?pi=[n]:pi.push(n)}function $k(n){cm=!0,d_(n)}function ia(){if(!Jm&&pi!==null){Jm=!0;var n=0,e=be;try{var t=pi;for(be=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}pi=null,cm=!1}catch(i){throw pi!==null&&(pi=pi.slice(n+1)),Dw(tv,ia),i}finally{be=e,Jm=!1}}return null}var dl=[],hl=0,pp=null,mp=0,qs=[],Gs=0,jo=null,Ui=1,zi="";function ca(n,e){dl[hl++]=mp,dl[hl++]=pp,pp=n,mp=e}function h_(n,e,t){qs[Gs++]=Ui,qs[Gs++]=zi,qs[Gs++]=jo,jo=n;var s=Ui;n=zi;var i=32-kn(s)-1;s&=~(1<<i),t+=1;var r=32-kn(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Ui=1<<32-kn(e)+i|t<<i|s,zi=r+n}else Ui=1<<r|t<<i|s,zi=n}function uv(n){n.return!==null&&(ca(n,1),h_(n,1,0))}function dv(n){for(;n===pp;)pp=dl[--hl],dl[hl]=null,mp=dl[--hl],dl[hl]=null;for(;n===jo;)jo=qs[--Gs],qs[Gs]=null,zi=qs[--Gs],qs[Gs]=null,Ui=qs[--Gs],qs[Gs]=null}var Is=null,Rs=null,Me=!1,An=null;function f_(n,e){var t=Ys(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function zx(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Is=n,Rs=Wr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Is=n,Rs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=jo!==null?{id:Ui,overflow:zi}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ys(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Is=n,Rs=null,!0):!1;default:return!1}}function Yg(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Qg(n){if(Me){var e=Rs;if(e){var t=e;if(!zx(n,e)){if(Yg(n))throw Error(M(418));e=Wr(t.nextSibling);var s=Is;e&&zx(n,e)?f_(s,t):(n.flags=n.flags&-4097|2,Me=!1,Is=n)}}else{if(Yg(n))throw Error(M(418));n.flags=n.flags&-4097|2,Me=!1,Is=n}}}function Hx(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Is=n}function ef(n){if(n!==Is)return!1;if(!Me)return Hx(n),Me=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!qg(n.type,n.memoizedProps)),e&&(e=Rs)){if(Yg(n))throw p_(),Error(M(418));for(;e;)f_(n,e),e=Wr(e.nextSibling)}if(Hx(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(M(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Rs=Wr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Rs=null}}else Rs=Is?Wr(n.stateNode.nextSibling):null;return!0}function p_(){for(var n=Rs;n;)n=Wr(n.nextSibling)}function Ic(){Rs=Is=null,Me=!1}function hv(n){An===null?An=[n]:An.push(n)}var Bk=Ji.ReactCurrentBatchConfig;function Kc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(M(309));var s=t.stateNode}if(!s)throw Error(M(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(a){var o=i.refs;a===null?delete o[r]:o[r]=a},e._stringRef=r,e)}if(typeof n!="string")throw Error(M(284));if(!t._owner)throw Error(M(290,n))}return n}function tf(n,e){throw n=Object.prototype.toString.call(e),Error(M(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Vx(n){var e=n._init;return e(n._payload)}function m_(n){function e(x,v){if(n){var S=x.deletions;S===null?(x.deletions=[v],x.flags|=16):S.push(v)}}function t(x,v){if(!n)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function s(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function i(x,v){return x=Kr(x,v),x.index=0,x.sibling=null,x}function r(x,v,S){return x.index=S,n?(S=x.alternate,S!==null?(S=S.index,S<v?(x.flags|=2,v):S):(x.flags|=2,v)):(x.flags|=1048576,v)}function a(x){return n&&x.alternate===null&&(x.flags|=2),x}function o(x,v,S,E){return v===null||v.tag!==6?(v=rg(S,x.mode,E),v.return=x,v):(v=i(v,S),v.return=x,v)}function c(x,v,S,E){var C=S.type;return C===rl?h(x,v,S.props.children,E,S.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===nr&&Vx(C)===v.type)?(E=i(v,S.props),E.ref=Kc(x,v,S),E.return=x,E):(E=kf(S.type,S.key,S.props,null,x.mode,E),E.ref=Kc(x,v,S),E.return=x,E)}function d(x,v,S,E){return v===null||v.tag!==4||v.stateNode.containerInfo!==S.containerInfo||v.stateNode.implementation!==S.implementation?(v=ag(S,x.mode,E),v.return=x,v):(v=i(v,S.children||[]),v.return=x,v)}function h(x,v,S,E,C){return v===null||v.tag!==7?(v=Co(S,x.mode,E,C),v.return=x,v):(v=i(v,S),v.return=x,v)}function f(x,v,S){if(typeof v=="string"&&v!==""||typeof v=="number")return v=rg(""+v,x.mode,S),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Vh:return S=kf(v.type,v.key,v.props,null,x.mode,S),S.ref=Kc(x,null,v),S.return=x,S;case il:return v=ag(v,x.mode,S),v.return=x,v;case nr:var E=v._init;return f(x,E(v._payload),S)}if(iu(v)||Vc(v))return v=Co(v,x.mode,S,null),v.return=x,v;tf(x,v)}return null}function p(x,v,S,E){var C=v!==null?v.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return C!==null?null:o(x,v,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Vh:return S.key===C?c(x,v,S,E):null;case il:return S.key===C?d(x,v,S,E):null;case nr:return C=S._init,p(x,v,C(S._payload),E)}if(iu(S)||Vc(S))return C!==null?null:h(x,v,S,E,null);tf(x,S)}return null}function m(x,v,S,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return x=x.get(S)||null,o(v,x,""+E,C);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Vh:return x=x.get(E.key===null?S:E.key)||null,c(v,x,E,C);case il:return x=x.get(E.key===null?S:E.key)||null,d(v,x,E,C);case nr:var N=E._init;return m(x,v,S,N(E._payload),C)}if(iu(E)||Vc(E))return x=x.get(S)||null,h(v,x,E,C,null);tf(v,E)}return null}function g(x,v,S,E){for(var C=null,N=null,k=v,T=v=0,I=null;k!==null&&T<S.length;T++){k.index>T?(I=k,k=null):I=k.sibling;var R=p(x,k,S[T],E);if(R===null){k===null&&(k=I);break}n&&k&&R.alternate===null&&e(x,k),v=r(R,v,T),N===null?C=R:N.sibling=R,N=R,k=I}if(T===S.length)return t(x,k),Me&&ca(x,T),C;if(k===null){for(;T<S.length;T++)k=f(x,S[T],E),k!==null&&(v=r(k,v,T),N===null?C=k:N.sibling=k,N=k);return Me&&ca(x,T),C}for(k=s(x,k);T<S.length;T++)I=m(k,x,T,S[T],E),I!==null&&(n&&I.alternate!==null&&k.delete(I.key===null?T:I.key),v=r(I,v,T),N===null?C=I:N.sibling=I,N=I);return n&&k.forEach(function(z){return e(x,z)}),Me&&ca(x,T),C}function b(x,v,S,E){var C=Vc(S);if(typeof C!="function")throw Error(M(150));if(S=C.call(S),S==null)throw Error(M(151));for(var N=C=null,k=v,T=v=0,I=null,R=S.next();k!==null&&!R.done;T++,R=S.next()){k.index>T?(I=k,k=null):I=k.sibling;var z=p(x,k,R.value,E);if(z===null){k===null&&(k=I);break}n&&k&&z.alternate===null&&e(x,k),v=r(z,v,T),N===null?C=z:N.sibling=z,N=z,k=I}if(R.done)return t(x,k),Me&&ca(x,T),C;if(k===null){for(;!R.done;T++,R=S.next())R=f(x,R.value,E),R!==null&&(v=r(R,v,T),N===null?C=R:N.sibling=R,N=R);return Me&&ca(x,T),C}for(k=s(x,k);!R.done;T++,R=S.next())R=m(k,x,T,R.value,E),R!==null&&(n&&R.alternate!==null&&k.delete(R.key===null?T:R.key),v=r(R,v,T),N===null?C=R:N.sibling=R,N=R);return n&&k.forEach(function(ce){return e(x,ce)}),Me&&ca(x,T),C}function A(x,v,S,E){if(typeof S=="object"&&S!==null&&S.type===rl&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Vh:e:{for(var C=S.key,N=v;N!==null;){if(N.key===C){if(C=S.type,C===rl){if(N.tag===7){t(x,N.sibling),v=i(N,S.props.children),v.return=x,x=v;break e}}else if(N.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===nr&&Vx(C)===N.type){t(x,N.sibling),v=i(N,S.props),v.ref=Kc(x,N,S),v.return=x,x=v;break e}t(x,N);break}else e(x,N);N=N.sibling}S.type===rl?(v=Co(S.props.children,x.mode,E,S.key),v.return=x,x=v):(E=kf(S.type,S.key,S.props,null,x.mode,E),E.ref=Kc(x,v,S),E.return=x,x=E)}return a(x);case il:e:{for(N=S.key;v!==null;){if(v.key===N)if(v.tag===4&&v.stateNode.containerInfo===S.containerInfo&&v.stateNode.implementation===S.implementation){t(x,v.sibling),v=i(v,S.children||[]),v.return=x,x=v;break e}else{t(x,v);break}else e(x,v);v=v.sibling}v=ag(S,x.mode,E),v.return=x,x=v}return a(x);case nr:return N=S._init,A(x,v,N(S._payload),E)}if(iu(S))return g(x,v,S,E);if(Vc(S))return b(x,v,S,E);tf(x,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,v!==null&&v.tag===6?(t(x,v.sibling),v=i(v,S),v.return=x,x=v):(t(x,v),v=rg(S,x.mode,E),v.return=x,x=v),a(x)):t(x,v)}return A}var Lc=m_(!0),g_=m_(!1),gp=na(null),yp=null,fl=null,fv=null;function pv(){fv=fl=yp=null}function mv(n){var e=gp.current;je(gp),n._currentValue=e}function Jg(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function _l(n,e){yp=n,fv=fl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(ds=!0),n.firstContext=null)}function en(n){var e=n._currentValue;if(fv!==n)if(n={context:n,memoizedValue:e,next:null},fl===null){if(yp===null)throw Error(M(308));fl=n,yp.dependencies={lanes:0,firstContext:n}}else fl=fl.next=n;return e}var xa=null;function gv(n){xa===null?xa=[n]:xa.push(n)}function y_(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,gv(e)):(t.next=i.next,i.next=t),e.interleaved=t,Xi(n,s)}function Xi(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var ir=!1;function yv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function v_(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Hi(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function qr(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,he&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,Xi(n,t)}return i=s.interleaved,i===null?(e.next=e,gv(s)):(e.next=i.next,i.next=e),s.interleaved=e,Xi(n,t)}function bf(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,sv(n,t)}}function Wx(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function vp(n,e,t,s){var i=n.updateQueue;ir=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,d=c.next;c.next=null,a===null?r=d:a.next=d,a=c;var h=n.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=d:o.next=d,h.lastBaseUpdate=c))}if(r!==null){var f=i.baseState;a=0,h=d=c=null,o=r;do{var p=o.lane,m=o.eventTime;if((s&p)===p){h!==null&&(h=h.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=n,b=o;switch(p=e,m=t,b.tag){case 1:if(g=b.payload,typeof g=="function"){f=g.call(m,f,p);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=b.payload,p=typeof g=="function"?g.call(m,f,p):g,p==null)break e;f=ze({},f,p);break e;case 2:ir=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(d=h=m,c=f):h=h.next=m,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(h===null&&(c=f),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);Ro|=a,n.lanes=a,n.memoizedState=f}}function qx(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(M(191,i));i.call(s)}}}var Lh={},ni=na(Lh),Ku=na(Lh),Yu=na(Lh);function ba(n){if(n===Lh)throw Error(M(174));return n}function vv(n,e){switch(Ne(Yu,e),Ne(Ku,n),Ne(ni,Lh),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Rg(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Rg(e,n)}je(ni),Ne(ni,e)}function Mc(){je(ni),je(Ku),je(Yu)}function x_(n){ba(Yu.current);var e=ba(ni.current),t=Rg(e,n.type);e!==t&&(Ne(Ku,n),Ne(ni,t))}function xv(n){Ku.current===n&&(je(ni),je(Ku))}var $e=na(0);function xp(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Zm=[];function bv(){for(var n=0;n<Zm.length;n++)Zm[n]._workInProgressVersionPrimary=null;Zm.length=0}var wf=Ji.ReactCurrentDispatcher,eg=Ji.ReactCurrentBatchConfig,Po=0,Ue=null,ot=null,gt=null,bp=!1,Tu=!1,Qu=0,Uk=0;function Ct(){throw Error(M(321))}function wv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Cn(n[t],e[t]))return!1;return!0}function _v(n,e,t,s,i,r){if(Po=r,Ue=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,wf.current=n===null||n.memoizedState===null?Wk:qk,n=t(s,i),Tu){r=0;do{if(Tu=!1,Qu=0,25<=r)throw Error(M(301));r+=1,gt=ot=null,e.updateQueue=null,wf.current=Gk,n=t(s,i)}while(Tu)}if(wf.current=wp,e=ot!==null&&ot.next!==null,Po=0,gt=ot=Ue=null,bp=!1,e)throw Error(M(300));return n}function Sv(){var n=Qu!==0;return Qu=0,n}function Dn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?Ue.memoizedState=gt=n:gt=gt.next=n,gt}function tn(){if(ot===null){var n=Ue.alternate;n=n!==null?n.memoizedState:null}else n=ot.next;var e=gt===null?Ue.memoizedState:gt.next;if(e!==null)gt=e,ot=n;else{if(n===null)throw Error(M(310));ot=n,n={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},gt===null?Ue.memoizedState=gt=n:gt=gt.next=n}return gt}function Ju(n,e){return typeof e=="function"?e(n):e}function tg(n){var e=tn(),t=e.queue;if(t===null)throw Error(M(311));t.lastRenderedReducer=n;var s=ot,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var o=a=null,c=null,d=r;do{var h=d.lane;if((Po&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:n(s,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=f,a=s):c=c.next=f,Ue.lanes|=h,Ro|=h}d=d.next}while(d!==null&&d!==r);c===null?a=s:c.next=o,Cn(s,e.memoizedState)||(ds=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,Ue.lanes|=r,Ro|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function sg(n){var e=tn(),t=e.queue;if(t===null)throw Error(M(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do r=n(r,a.action),a=a.next;while(a!==i);Cn(r,e.memoizedState)||(ds=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function b_(){}function w_(n,e){var t=Ue,s=tn(),i=e(),r=!Cn(s.memoizedState,i);if(r&&(s.memoizedState=i,ds=!0),s=s.queue,Av(A_.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||gt!==null&&gt.memoizedState.tag&1){if(t.flags|=2048,Zu(9,S_.bind(null,t,s,i,e),void 0,null),yt===null)throw Error(M(349));Po&30||__(t,e,i)}return i}function __(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function S_(n,e,t,s){e.value=t,e.getSnapshot=s,E_(e)&&k_(n)}function A_(n,e,t){return t(function(){E_(e)&&k_(n)})}function E_(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Cn(n,t)}catch{return!0}}function k_(n){var e=Xi(n,1);e!==null&&Nn(e,n,1,-1)}function Gx(n){var e=Dn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ju,lastRenderedState:n},e.queue=n,n=n.dispatch=Vk.bind(null,Ue,n),[e.memoizedState,n]}function Zu(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function N_(){return tn().memoizedState}function _f(n,e,t,s){var i=Dn();Ue.flags|=n,i.memoizedState=Zu(1|e,t,void 0,s===void 0?null:s)}function um(n,e,t,s){var i=tn();s=s===void 0?null:s;var r=void 0;if(ot!==null){var a=ot.memoizedState;if(r=a.destroy,s!==null&&wv(s,a.deps)){i.memoizedState=Zu(e,t,r,s);return}}Ue.flags|=n,i.memoizedState=Zu(1|e,t,r,s)}function Xx(n,e){return _f(8390656,8,n,e)}function Av(n,e){return um(2048,8,n,e)}function C_(n,e){return um(4,2,n,e)}function T_(n,e){return um(4,4,n,e)}function j_(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function P_(n,e,t){return t=t!=null?t.concat([n]):null,um(4,4,j_.bind(null,e,n),t)}function Ev(){}function R_(n,e){var t=tn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&wv(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function I_(n,e){var t=tn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&wv(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function L_(n,e,t){return Po&21?(Cn(t,e)||(t=$w(),Ue.lanes|=t,Ro|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,ds=!0),n.memoizedState=t)}function zk(n,e){var t=be;be=t!==0&&4>t?t:4,n(!0);var s=eg.transition;eg.transition={};try{n(!1),e()}finally{be=t,eg.transition=s}}function M_(){return tn().memoizedState}function Hk(n,e,t){var s=Xr(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},D_(n))O_(e,t);else if(t=y_(n,e,t,s),t!==null){var i=Kt();Nn(t,n,s,i),F_(t,e,s)}}function Vk(n,e,t){var s=Xr(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(D_(n))O_(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,t);if(i.hasEagerState=!0,i.eagerState=o,Cn(o,a)){var c=e.interleaved;c===null?(i.next=i,gv(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=y_(n,e,i,s),t!==null&&(i=Kt(),Nn(t,n,s,i),F_(t,e,s))}}function D_(n){var e=n.alternate;return n===Ue||e!==null&&e===Ue}function O_(n,e){Tu=bp=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function F_(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,sv(n,t)}}var wp={readContext:en,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useInsertionEffect:Ct,useLayoutEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useMutableSource:Ct,useSyncExternalStore:Ct,useId:Ct,unstable_isNewReconciler:!1},Wk={readContext:en,useCallback:function(n,e){return Dn().memoizedState=[n,e===void 0?null:e],n},useContext:en,useEffect:Xx,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,_f(4194308,4,j_.bind(null,e,n),t)},useLayoutEffect:function(n,e){return _f(4194308,4,n,e)},useInsertionEffect:function(n,e){return _f(4,2,n,e)},useMemo:function(n,e){var t=Dn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=Dn();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=Hk.bind(null,Ue,n),[s.memoizedState,n]},useRef:function(n){var e=Dn();return n={current:n},e.memoizedState=n},useState:Gx,useDebugValue:Ev,useDeferredValue:function(n){return Dn().memoizedState=n},useTransition:function(){var n=Gx(!1),e=n[0];return n=zk.bind(null,n[1]),Dn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=Ue,i=Dn();if(Me){if(t===void 0)throw Error(M(407));t=t()}else{if(t=e(),yt===null)throw Error(M(349));Po&30||__(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,Xx(A_.bind(null,s,r,n),[n]),s.flags|=2048,Zu(9,S_.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=Dn(),e=yt.identifierPrefix;if(Me){var t=zi,s=Ui;t=(s&~(1<<32-kn(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=Qu++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Uk++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},qk={readContext:en,useCallback:R_,useContext:en,useEffect:Av,useImperativeHandle:P_,useInsertionEffect:C_,useLayoutEffect:T_,useMemo:I_,useReducer:tg,useRef:N_,useState:function(){return tg(Ju)},useDebugValue:Ev,useDeferredValue:function(n){var e=tn();return L_(e,ot.memoizedState,n)},useTransition:function(){var n=tg(Ju)[0],e=tn().memoizedState;return[n,e]},useMutableSource:b_,useSyncExternalStore:w_,useId:M_,unstable_isNewReconciler:!1},Gk={readContext:en,useCallback:R_,useContext:en,useEffect:Av,useImperativeHandle:P_,useInsertionEffect:C_,useLayoutEffect:T_,useMemo:I_,useReducer:sg,useRef:N_,useState:function(){return sg(Ju)},useDebugValue:Ev,useDeferredValue:function(n){var e=tn();return ot===null?e.memoizedState=n:L_(e,ot.memoizedState,n)},useTransition:function(){var n=sg(Ju)[0],e=tn().memoizedState;return[n,e]},useMutableSource:b_,useSyncExternalStore:w_,useId:M_,unstable_isNewReconciler:!1};function ln(n,e){if(n&&n.defaultProps){e=ze({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Zg(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:ze({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var dm={isMounted:function(n){return(n=n._reactInternals)?$o(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=Kt(),i=Xr(n),r=Hi(s,i);r.payload=e,t!=null&&(r.callback=t),e=qr(n,r,i),e!==null&&(Nn(e,n,i,s),bf(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=Kt(),i=Xr(n),r=Hi(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=qr(n,r,i),e!==null&&(Nn(e,n,i,s),bf(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Kt(),s=Xr(n),i=Hi(t,s);i.tag=2,e!=null&&(i.callback=e),e=qr(n,i,s),e!==null&&(Nn(e,n,s,t),bf(e,n,s))}};function Kx(n,e,t,s,i,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!Wu(t,s)||!Wu(i,r):!0}function $_(n,e,t){var s=!1,i=Jr,r=e.contextType;return typeof r=="object"&&r!==null?r=en(r):(i=fs(e)?To:Bt.current,s=e.contextTypes,r=(s=s!=null)?Rc(n,i):Jr),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=dm,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function Yx(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&dm.enqueueReplaceState(e,e.state,null)}function e0(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},yv(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=en(r):(r=fs(e)?To:Bt.current,i.context=Rc(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(Zg(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&dm.enqueueReplaceState(i,i.state,null),vp(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Dc(n,e){try{var t="",s=e;do t+=wE(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function ng(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function t0(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Xk=typeof WeakMap=="function"?WeakMap:Map;function B_(n,e,t){t=Hi(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){Sp||(Sp=!0,d0=s),t0(n,e)},t}function U_(n,e,t){t=Hi(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){t0(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){t0(n,e),typeof s!="function"&&(Gr===null?Gr=new Set([this]):Gr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function Qx(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new Xk;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=lN.bind(null,n,e,t),e.then(n,n))}function Jx(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Zx(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Hi(-1,1),e.tag=2,qr(t,e,1))),t.lanes|=1),n)}var Kk=Ji.ReactCurrentOwner,ds=!1;function Xt(n,e,t,s){e.child=n===null?g_(e,null,t,s):Lc(e,n.child,t,s)}function eb(n,e,t,s,i){t=t.render;var r=e.ref;return _l(e,i),s=_v(n,e,t,s,r,i),t=Sv(),n!==null&&!ds?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ki(n,e,i)):(Me&&t&&uv(e),e.flags|=1,Xt(n,e,s,i),e.child)}function tb(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!Iv(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,z_(n,e,r,s,i)):(n=kf(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:Wu,t(a,s)&&n.ref===e.ref)return Ki(n,e,i)}return e.flags|=1,n=Kr(r,s),n.ref=e.ref,n.return=e,e.child=n}function z_(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Wu(r,s)&&n.ref===e.ref)if(ds=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(ds=!0);else return e.lanes=n.lanes,Ki(n,e,i)}return s0(n,e,t,s,i)}function H_(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(ml,Ts),Ts|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ne(ml,Ts),Ts|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,Ne(ml,Ts),Ts|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,Ne(ml,Ts),Ts|=s;return Xt(n,e,i,t),e.child}function V_(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function s0(n,e,t,s,i){var r=fs(t)?To:Bt.current;return r=Rc(e,r),_l(e,i),t=_v(n,e,t,s,r,i),s=Sv(),n!==null&&!ds?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ki(n,e,i)):(Me&&s&&uv(e),e.flags|=1,Xt(n,e,t,i),e.child)}function sb(n,e,t,s,i){if(fs(t)){var r=!0;fp(e)}else r=!1;if(_l(e,i),e.stateNode===null)Sf(n,e),$_(e,t,s),e0(e,t,s,i),s=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var c=a.context,d=t.contextType;typeof d=="object"&&d!==null?d=en(d):(d=fs(t)?To:Bt.current,d=Rc(e,d));var h=t.getDerivedStateFromProps,f=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==s||c!==d)&&Yx(e,a,s,d),ir=!1;var p=e.memoizedState;a.state=p,vp(e,s,a,i),c=e.memoizedState,o!==s||p!==c||hs.current||ir?(typeof h=="function"&&(Zg(e,t,h,s),c=e.memoizedState),(o=ir||Kx(e,t,o,s,p,c,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),a.props=s,a.state=c,a.context=d,s=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,v_(n,e),o=e.memoizedProps,d=e.type===e.elementType?o:ln(e.type,o),a.props=d,f=e.pendingProps,p=a.context,c=t.contextType,typeof c=="object"&&c!==null?c=en(c):(c=fs(t)?To:Bt.current,c=Rc(e,c));var m=t.getDerivedStateFromProps;(h=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||p!==c)&&Yx(e,a,s,c),ir=!1,p=e.memoizedState,a.state=p,vp(e,s,a,i);var g=e.memoizedState;o!==f||p!==g||hs.current||ir?(typeof m=="function"&&(Zg(e,t,m,s),g=e.memoizedState),(d=ir||Kx(e,t,d,s,p,g,c)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,g,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=g),a.props=s,a.state=g,a.context=c,s=d):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),s=!1)}return n0(n,e,t,s,r,i)}function n0(n,e,t,s,i,r){V_(n,e);var a=(e.flags&128)!==0;if(!s&&!a)return i&&Ux(e,t,!1),Ki(n,e,r);s=e.stateNode,Kk.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&a?(e.child=Lc(e,n.child,null,r),e.child=Lc(e,null,o,r)):Xt(n,e,o,r),e.memoizedState=s.state,i&&Ux(e,t,!0),e.child}function W_(n){var e=n.stateNode;e.pendingContext?Bx(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Bx(n,e.context,!1),vv(n,e.containerInfo)}function nb(n,e,t,s,i){return Ic(),hv(i),e.flags|=256,Xt(n,e,t,s),e.child}var i0={dehydrated:null,treeContext:null,retryLane:0};function r0(n){return{baseLanes:n,cachePool:null,transitions:null}}function q_(n,e,t){var s=e.pendingProps,i=$e.current,r=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Ne($e,i&1),n===null)return Qg(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,n=s.fallback,r?(s=e.mode,r=e.child,a={mode:"hidden",children:a},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=a):r=pm(a,s,0,null),n=Co(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=r0(t),e.memoizedState=i0,n):kv(e,a));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return Yk(n,e,a,s,o,i,t);if(r){r=s.fallback,a=e.mode,i=n.child,o=i.sibling;var c={mode:"hidden",children:s.children};return!(a&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Kr(i,c),s.subtreeFlags=i.subtreeFlags&14680064),o!==null?r=Kr(o,r):(r=Co(r,a,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,a=n.child.memoizedState,a=a===null?r0(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},r.memoizedState=a,r.childLanes=n.childLanes&~t,e.memoizedState=i0,s}return r=n.child,n=r.sibling,s=Kr(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function kv(n,e){return e=pm({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function sf(n,e,t,s){return s!==null&&hv(s),Lc(e,n.child,null,t),n=kv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Yk(n,e,t,s,i,r,a){if(t)return e.flags&256?(e.flags&=-257,s=ng(Error(M(422))),sf(n,e,a,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=pm({mode:"visible",children:s.children},i,0,null),r=Co(r,i,a,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&Lc(e,n.child,null,a),e.child.memoizedState=r0(a),e.memoizedState=i0,r);if(!(e.mode&1))return sf(n,e,a,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var o=s.dgst;return s=o,r=Error(M(419)),s=ng(r,s,void 0),sf(n,e,a,s)}if(o=(a&n.childLanes)!==0,ds||o){if(s=yt,s!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|a)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,Xi(n,i),Nn(s,n,i,-1))}return Rv(),s=ng(Error(M(421))),sf(n,e,a,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=cN.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,Rs=Wr(i.nextSibling),Is=e,Me=!0,An=null,n!==null&&(qs[Gs++]=Ui,qs[Gs++]=zi,qs[Gs++]=jo,Ui=n.id,zi=n.overflow,jo=e),e=kv(e,s.children),e.flags|=4096,e)}function ib(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),Jg(n.return,e,t)}function ig(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function G_(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(Xt(n,e,s.children,t),s=$e.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&ib(n,t,e);else if(n.tag===19)ib(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Ne($e,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&xp(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),ig(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&xp(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}ig(e,!0,t,null,r);break;case"together":ig(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sf(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ki(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Ro|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(M(153));if(e.child!==null){for(n=e.child,t=Kr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Kr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Qk(n,e,t){switch(e.tag){case 3:W_(e),Ic();break;case 5:x_(e);break;case 1:fs(e.type)&&fp(e);break;case 4:vv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;Ne(gp,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Ne($e,$e.current&1),e.flags|=128,null):t&e.child.childLanes?q_(n,e,t):(Ne($e,$e.current&1),n=Ki(n,e,t),n!==null?n.sibling:null);Ne($e,$e.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return G_(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ne($e,$e.current),s)break;return null;case 22:case 23:return e.lanes=0,H_(n,e,t)}return Ki(n,e,t)}var X_,a0,K_,Y_;X_=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};a0=function(){};K_=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,ba(ni.current);var r=null;switch(t){case"input":i=Cg(n,i),s=Cg(n,s),r=[];break;case"select":i=ze({},i,{value:void 0}),s=ze({},s,{value:void 0}),r=[];break;case"textarea":i=Pg(n,i),s=Pg(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=dp)}Ig(t,s);var a;t=null;for(d in i)if(!s.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var o=i[d];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Fu.hasOwnProperty(d)?r||(r=[]):(r=r||[]).push(d,null));for(d in s){var c=s[d];if(o=i!=null?i[d]:void 0,s.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(t||(t={}),t[a]=c[a])}else t||(r||(r=[]),r.push(d,t)),t=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(r=r||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Fu.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ce("scroll",n),r||o===c||(r=[])):(r=r||[]).push(d,c))}t&&(r=r||[]).push("style",t);var d=r;(e.updateQueue=d)&&(e.flags|=4)}};Y_=function(n,e,t,s){t!==s&&(e.flags|=4)};function Yc(n,e){if(!Me)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Tt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function Jk(n,e,t){var s=e.pendingProps;switch(dv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(e),null;case 1:return fs(e.type)&&hp(),Tt(e),null;case 3:return s=e.stateNode,Mc(),je(hs),je(Bt),bv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(ef(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,An!==null&&(p0(An),An=null))),a0(n,e),Tt(e),null;case 5:xv(e);var i=ba(Yu.current);if(t=e.type,n!==null&&e.stateNode!=null)K_(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(M(166));return Tt(e),null}if(n=ba(ni.current),ef(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[ti]=e,s[Xu]=r,n=(e.mode&1)!==0,t){case"dialog":Ce("cancel",s),Ce("close",s);break;case"iframe":case"object":case"embed":Ce("load",s);break;case"video":case"audio":for(i=0;i<au.length;i++)Ce(au[i],s);break;case"source":Ce("error",s);break;case"img":case"image":case"link":Ce("error",s),Ce("load",s);break;case"details":Ce("toggle",s);break;case"input":fx(s,r),Ce("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},Ce("invalid",s);break;case"textarea":mx(s,r),Ce("invalid",s)}Ig(t,r),i=null;for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];a==="children"?typeof o=="string"?s.textContent!==o&&(r.suppressHydrationWarning!==!0&&Zh(s.textContent,o,n),i=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&Zh(s.textContent,o,n),i=["children",""+o]):Fu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ce("scroll",s)}switch(t){case"input":Wh(s),px(s,r,!0);break;case"textarea":Wh(s),gx(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=dp)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Aw(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=a.createElement(t,{is:s.is}):(n=a.createElement(t),t==="select"&&(a=n,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):n=a.createElementNS(n,t),n[ti]=e,n[Xu]=s,X_(n,e,!1,!1),e.stateNode=n;e:{switch(a=Lg(t,s),t){case"dialog":Ce("cancel",n),Ce("close",n),i=s;break;case"iframe":case"object":case"embed":Ce("load",n),i=s;break;case"video":case"audio":for(i=0;i<au.length;i++)Ce(au[i],n);i=s;break;case"source":Ce("error",n),i=s;break;case"img":case"image":case"link":Ce("error",n),Ce("load",n),i=s;break;case"details":Ce("toggle",n),i=s;break;case"input":fx(n,s),i=Cg(n,s),Ce("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=ze({},s,{value:void 0}),Ce("invalid",n);break;case"textarea":mx(n,s),i=Pg(n,s),Ce("invalid",n);break;default:i=s}Ig(t,i),o=i;for(r in o)if(o.hasOwnProperty(r)){var c=o[r];r==="style"?Nw(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ew(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&$u(n,c):typeof c=="number"&&$u(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Fu.hasOwnProperty(r)?c!=null&&r==="onScroll"&&Ce("scroll",n):c!=null&&Yy(n,r,c,a))}switch(t){case"input":Wh(n),px(n,s,!1);break;case"textarea":Wh(n),gx(n);break;case"option":s.value!=null&&n.setAttribute("value",""+Qr(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?vl(n,!!s.multiple,r,!1):s.defaultValue!=null&&vl(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=dp)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Tt(e),null;case 6:if(n&&e.stateNode!=null)Y_(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(M(166));if(t=ba(Yu.current),ba(ni.current),ef(e)){if(s=e.stateNode,t=e.memoizedProps,s[ti]=e,(r=s.nodeValue!==t)&&(n=Is,n!==null))switch(n.tag){case 3:Zh(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Zh(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[ti]=e,e.stateNode=s}return Tt(e),null;case 13:if(je($e),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Me&&Rs!==null&&e.mode&1&&!(e.flags&128))p_(),Ic(),e.flags|=98560,r=!1;else if(r=ef(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(M(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(M(317));r[ti]=e}else Ic(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Tt(e),r=!1}else An!==null&&(p0(An),An=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||$e.current&1?lt===0&&(lt=3):Rv())),e.updateQueue!==null&&(e.flags|=4),Tt(e),null);case 4:return Mc(),a0(n,e),n===null&&qu(e.stateNode.containerInfo),Tt(e),null;case 10:return mv(e.type._context),Tt(e),null;case 17:return fs(e.type)&&hp(),Tt(e),null;case 19:if(je($e),r=e.memoizedState,r===null)return Tt(e),null;if(s=(e.flags&128)!==0,a=r.rendering,a===null)if(s)Yc(r,!1);else{if(lt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=xp(n),a!==null){for(e.flags|=128,Yc(r,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,a=r.alternate,a===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=a.childLanes,r.lanes=a.lanes,r.child=a.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=a.memoizedProps,r.memoizedState=a.memoizedState,r.updateQueue=a.updateQueue,r.type=a.type,n=a.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ne($e,$e.current&1|2),e.child}n=n.sibling}r.tail!==null&&Ke()>Oc&&(e.flags|=128,s=!0,Yc(r,!1),e.lanes=4194304)}else{if(!s)if(n=xp(a),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Yc(r,!0),r.tail===null&&r.tailMode==="hidden"&&!a.alternate&&!Me)return Tt(e),null}else 2*Ke()-r.renderingStartTime>Oc&&t!==1073741824&&(e.flags|=128,s=!0,Yc(r,!1),e.lanes=4194304);r.isBackwards?(a.sibling=e.child,e.child=a):(t=r.last,t!==null?t.sibling=a:e.child=a,r.last=a)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Ke(),e.sibling=null,t=$e.current,Ne($e,s?t&1|2:t&1),e):(Tt(e),null);case 22:case 23:return Pv(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Ts&1073741824&&(Tt(e),e.subtreeFlags&6&&(e.flags|=8192)):Tt(e),null;case 24:return null;case 25:return null}throw Error(M(156,e.tag))}function Zk(n,e){switch(dv(e),e.tag){case 1:return fs(e.type)&&hp(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Mc(),je(hs),je(Bt),bv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return xv(e),null;case 13:if(je($e),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(M(340));Ic()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return je($e),null;case 4:return Mc(),null;case 10:return mv(e.type._context),null;case 22:case 23:return Pv(),null;case 24:return null;default:return null}}var nf=!1,Ft=!1,eN=typeof WeakSet=="function"?WeakSet:Set,U=null;function pl(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){We(n,e,s)}else t.current=null}function o0(n,e,t){try{t()}catch(s){We(n,e,s)}}var rb=!1;function tN(n,e){if(Vg=lp,n=t_(),cv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,o=-1,c=-1,d=0,h=0,f=n,p=null;t:for(;;){for(var m;f!==t||i!==0&&f.nodeType!==3||(o=a+i),f!==r||s!==0&&f.nodeType!==3||(c=a+s),f.nodeType===3&&(a+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===n)break t;if(p===t&&++d===i&&(o=a),p===r&&++h===s&&(c=a),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}t=o===-1||c===-1?null:{start:o,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(Wg={focusedElem:n,selectionRange:t},lp=!1,U=e;U!==null;)if(e=U,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,U=n;else for(;U!==null;){e=U;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var b=g.memoizedProps,A=g.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?b:ln(e.type,b),A);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(M(163))}}catch(E){We(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,U=n;break}U=e.return}return g=rb,rb=!1,g}function ju(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&o0(e,t,r)}i=i.next}while(i!==s)}}function hm(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function l0(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Q_(n){var e=n.alternate;e!==null&&(n.alternate=null,Q_(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[ti],delete e[Xu],delete e[Xg],delete e[Ok],delete e[Fk])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function J_(n){return n.tag===5||n.tag===3||n.tag===4}function ab(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||J_(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function c0(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=dp));else if(s!==4&&(n=n.child,n!==null))for(c0(n,e,t),n=n.sibling;n!==null;)c0(n,e,t),n=n.sibling}function u0(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(u0(n,e,t),n=n.sibling;n!==null;)u0(n,e,t),n=n.sibling}var St=null,_n=!1;function Zi(n,e,t){for(t=t.child;t!==null;)Z_(n,e,t),t=t.sibling}function Z_(n,e,t){if(si&&typeof si.onCommitFiberUnmount=="function")try{si.onCommitFiberUnmount(im,t)}catch{}switch(t.tag){case 5:Ft||pl(t,e);case 6:var s=St,i=_n;St=null,Zi(n,e,t),St=s,_n=i,St!==null&&(_n?(n=St,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):St.removeChild(t.stateNode));break;case 18:St!==null&&(_n?(n=St,t=t.stateNode,n.nodeType===8?Qm(n.parentNode,t):n.nodeType===1&&Qm(n,t),Hu(n)):Qm(St,t.stateNode));break;case 4:s=St,i=_n,St=t.stateNode.containerInfo,_n=!0,Zi(n,e,t),St=s,_n=i;break;case 0:case 11:case 14:case 15:if(!Ft&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,a=r.destroy;r=r.tag,a!==void 0&&(r&2||r&4)&&o0(t,e,a),i=i.next}while(i!==s)}Zi(n,e,t);break;case 1:if(!Ft&&(pl(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(o){We(t,e,o)}Zi(n,e,t);break;case 21:Zi(n,e,t);break;case 22:t.mode&1?(Ft=(s=Ft)||t.memoizedState!==null,Zi(n,e,t),Ft=s):Zi(n,e,t);break;default:Zi(n,e,t)}}function ob(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new eN),e.forEach(function(s){var i=uN.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function rn(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:St=o.stateNode,_n=!1;break e;case 3:St=o.stateNode.containerInfo,_n=!0;break e;case 4:St=o.stateNode.containerInfo,_n=!0;break e}o=o.return}if(St===null)throw Error(M(160));Z_(r,a,i),St=null,_n=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){We(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)e1(e,n),e=e.sibling}function e1(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(rn(e,n),Rn(n),s&4){try{ju(3,n,n.return),hm(3,n)}catch(b){We(n,n.return,b)}try{ju(5,n,n.return)}catch(b){We(n,n.return,b)}}break;case 1:rn(e,n),Rn(n),s&512&&t!==null&&pl(t,t.return);break;case 5:if(rn(e,n),Rn(n),s&512&&t!==null&&pl(t,t.return),n.flags&32){var i=n.stateNode;try{$u(i,"")}catch(b){We(n,n.return,b)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,a=t!==null?t.memoizedProps:r,o=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&_w(i,r),Lg(o,a);var d=Lg(o,r);for(a=0;a<c.length;a+=2){var h=c[a],f=c[a+1];h==="style"?Nw(i,f):h==="dangerouslySetInnerHTML"?Ew(i,f):h==="children"?$u(i,f):Yy(i,h,f,d)}switch(o){case"input":Tg(i,r);break;case"textarea":Sw(i,r);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var m=r.value;m!=null?vl(i,!!r.multiple,m,!1):p!==!!r.multiple&&(r.defaultValue!=null?vl(i,!!r.multiple,r.defaultValue,!0):vl(i,!!r.multiple,r.multiple?[]:"",!1))}i[Xu]=r}catch(b){We(n,n.return,b)}}break;case 6:if(rn(e,n),Rn(n),s&4){if(n.stateNode===null)throw Error(M(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(b){We(n,n.return,b)}}break;case 3:if(rn(e,n),Rn(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Hu(e.containerInfo)}catch(b){We(n,n.return,b)}break;case 4:rn(e,n),Rn(n);break;case 13:rn(e,n),Rn(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(Tv=Ke())),s&4&&ob(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Ft=(d=Ft)||h,rn(e,n),Ft=d):rn(e,n),Rn(n),s&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!h&&n.mode&1)for(U=n,h=n.child;h!==null;){for(f=U=h;U!==null;){switch(p=U,m=p.child,p.tag){case 0:case 11:case 14:case 15:ju(4,p,p.return);break;case 1:pl(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){s=p,t=p.return;try{e=s,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(b){We(s,t,b)}}break;case 5:pl(p,p.return);break;case 22:if(p.memoizedState!==null){cb(f);continue}}m!==null?(m.return=p,U=m):cb(f)}h=h.sibling}e:for(h=null,f=n;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,d?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=kw("display",a))}catch(b){We(n,n.return,b)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(b){We(n,n.return,b)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:rn(e,n),Rn(n),s&4&&ob(n);break;case 21:break;default:rn(e,n),Rn(n)}}function Rn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(J_(t)){var s=t;break e}t=t.return}throw Error(M(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&($u(i,""),s.flags&=-33);var r=ab(n);u0(n,r,i);break;case 3:case 4:var a=s.stateNode.containerInfo,o=ab(n);c0(n,o,a);break;default:throw Error(M(161))}}catch(c){We(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function sN(n,e,t){U=n,t1(n)}function t1(n,e,t){for(var s=(n.mode&1)!==0;U!==null;){var i=U,r=i.child;if(i.tag===22&&s){var a=i.memoizedState!==null||nf;if(!a){var o=i.alternate,c=o!==null&&o.memoizedState!==null||Ft;o=nf;var d=Ft;if(nf=a,(Ft=c)&&!d)for(U=i;U!==null;)a=U,c=a.child,a.tag===22&&a.memoizedState!==null?ub(i):c!==null?(c.return=a,U=c):ub(i);for(;r!==null;)U=r,t1(r),r=r.sibling;U=i,nf=o,Ft=d}lb(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,U=r):lb(n)}}function lb(n){for(;U!==null;){var e=U;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ft||hm(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Ft)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:ln(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&qx(e,r,s);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}qx(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Hu(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(M(163))}Ft||e.flags&512&&l0(e)}catch(p){We(e,e.return,p)}}if(e===n){U=null;break}if(t=e.sibling,t!==null){t.return=e.return,U=t;break}U=e.return}}function cb(n){for(;U!==null;){var e=U;if(e===n){U=null;break}var t=e.sibling;if(t!==null){t.return=e.return,U=t;break}U=e.return}}function ub(n){for(;U!==null;){var e=U;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{hm(4,e)}catch(c){We(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){We(e,i,c)}}var r=e.return;try{l0(e)}catch(c){We(e,r,c)}break;case 5:var a=e.return;try{l0(e)}catch(c){We(e,a,c)}}}catch(c){We(e,e.return,c)}if(e===n){U=null;break}var o=e.sibling;if(o!==null){o.return=e.return,U=o;break}U=e.return}}var nN=Math.ceil,_p=Ji.ReactCurrentDispatcher,Nv=Ji.ReactCurrentOwner,Qs=Ji.ReactCurrentBatchConfig,he=0,yt=null,Je=null,Et=0,Ts=0,ml=na(0),lt=0,ed=null,Ro=0,fm=0,Cv=0,Pu=null,ls=null,Tv=0,Oc=1/0,ui=null,Sp=!1,d0=null,Gr=null,rf=!1,Br=null,Ap=0,Ru=0,h0=null,Af=-1,Ef=0;function Kt(){return he&6?Ke():Af!==-1?Af:Af=Ke()}function Xr(n){return n.mode&1?he&2&&Et!==0?Et&-Et:Bk.transition!==null?(Ef===0&&(Ef=$w()),Ef):(n=be,n!==0||(n=window.event,n=n===void 0?16:qw(n.type)),n):1}function Nn(n,e,t,s){if(50<Ru)throw Ru=0,h0=null,Error(M(185));Ph(n,t,s),(!(he&2)||n!==yt)&&(n===yt&&(!(he&2)&&(fm|=t),lt===4&&ar(n,Et)),ps(n,s),t===1&&he===0&&!(e.mode&1)&&(Oc=Ke()+500,cm&&ia()))}function ps(n,e){var t=n.callbackNode;BE(n,e);var s=op(n,n===yt?Et:0);if(s===0)t!==null&&xx(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&xx(t),e===1)n.tag===0?$k(db.bind(null,n)):d_(db.bind(null,n)),Mk(function(){!(he&6)&&ia()}),t=null;else{switch(Bw(s)){case 1:t=tv;break;case 4:t=Ow;break;case 16:t=ap;break;case 536870912:t=Fw;break;default:t=ap}t=c1(t,s1.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function s1(n,e){if(Af=-1,Ef=0,he&6)throw Error(M(327));var t=n.callbackNode;if(Sl()&&n.callbackNode!==t)return null;var s=op(n,n===yt?Et:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=Ep(n,s);else{e=s;var i=he;he|=2;var r=i1();(yt!==n||Et!==e)&&(ui=null,Oc=Ke()+500,No(n,e));do try{aN();break}catch(o){n1(n,o)}while(!0);pv(),_p.current=r,he=i,Je!==null?e=0:(yt=null,Et=0,e=lt)}if(e!==0){if(e===2&&(i=$g(n),i!==0&&(s=i,e=f0(n,i))),e===1)throw t=ed,No(n,0),ar(n,s),ps(n,Ke()),t;if(e===6)ar(n,s);else{if(i=n.current.alternate,!(s&30)&&!iN(i)&&(e=Ep(n,s),e===2&&(r=$g(n),r!==0&&(s=r,e=f0(n,r))),e===1))throw t=ed,No(n,0),ar(n,s),ps(n,Ke()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(M(345));case 2:ua(n,ls,ui);break;case 3:if(ar(n,s),(s&130023424)===s&&(e=Tv+500-Ke(),10<e)){if(op(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){Kt(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Gg(ua.bind(null,n,ls,ui),e);break}ua(n,ls,ui);break;case 4:if(ar(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var a=31-kn(s);r=1<<a,a=e[a],a>i&&(i=a),s&=~r}if(s=i,s=Ke()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*nN(s/1960))-s,10<s){n.timeoutHandle=Gg(ua.bind(null,n,ls,ui),s);break}ua(n,ls,ui);break;case 5:ua(n,ls,ui);break;default:throw Error(M(329))}}}return ps(n,Ke()),n.callbackNode===t?s1.bind(null,n):null}function f0(n,e){var t=Pu;return n.current.memoizedState.isDehydrated&&(No(n,e).flags|=256),n=Ep(n,e),n!==2&&(e=ls,ls=t,e!==null&&p0(e)),n}function p0(n){ls===null?ls=n:ls.push.apply(ls,n)}function iN(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!Cn(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ar(n,e){for(e&=~Cv,e&=~fm,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-kn(e),s=1<<t;n[t]=-1,e&=~s}}function db(n){if(he&6)throw Error(M(327));Sl();var e=op(n,0);if(!(e&1))return ps(n,Ke()),null;var t=Ep(n,e);if(n.tag!==0&&t===2){var s=$g(n);s!==0&&(e=s,t=f0(n,s))}if(t===1)throw t=ed,No(n,0),ar(n,e),ps(n,Ke()),t;if(t===6)throw Error(M(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ua(n,ls,ui),ps(n,Ke()),null}function jv(n,e){var t=he;he|=1;try{return n(e)}finally{he=t,he===0&&(Oc=Ke()+500,cm&&ia())}}function Io(n){Br!==null&&Br.tag===0&&!(he&6)&&Sl();var e=he;he|=1;var t=Qs.transition,s=be;try{if(Qs.transition=null,be=1,n)return n()}finally{be=s,Qs.transition=t,he=e,!(he&6)&&ia()}}function Pv(){Ts=ml.current,je(ml)}function No(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Lk(t)),Je!==null)for(t=Je.return;t!==null;){var s=t;switch(dv(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&hp();break;case 3:Mc(),je(hs),je(Bt),bv();break;case 5:xv(s);break;case 4:Mc();break;case 13:je($e);break;case 19:je($e);break;case 10:mv(s.type._context);break;case 22:case 23:Pv()}t=t.return}if(yt=n,Je=n=Kr(n.current,null),Et=Ts=e,lt=0,ed=null,Cv=fm=Ro=0,ls=Pu=null,xa!==null){for(e=0;e<xa.length;e++)if(t=xa[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var a=r.next;r.next=i,s.next=a}t.pending=s}xa=null}return n}function n1(n,e){do{var t=Je;try{if(pv(),wf.current=wp,bp){for(var s=Ue.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}bp=!1}if(Po=0,gt=ot=Ue=null,Tu=!1,Qu=0,Nv.current=null,t===null||t.return===null){lt=1,ed=e,Je=null;break}e:{var r=n,a=t.return,o=t,c=e;if(e=Et,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=o,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=Jx(a);if(m!==null){m.flags&=-257,Zx(m,a,o,r,e),m.mode&1&&Qx(r,d,e),e=m,c=d;var g=e.updateQueue;if(g===null){var b=new Set;b.add(c),e.updateQueue=b}else g.add(c);break e}else{if(!(e&1)){Qx(r,d,e),Rv();break e}c=Error(M(426))}}else if(Me&&o.mode&1){var A=Jx(a);if(A!==null){!(A.flags&65536)&&(A.flags|=256),Zx(A,a,o,r,e),hv(Dc(c,o));break e}}r=c=Dc(c,o),lt!==4&&(lt=2),Pu===null?Pu=[r]:Pu.push(r),r=a;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var x=B_(r,c,e);Wx(r,x);break e;case 1:o=c;var v=r.type,S=r.stateNode;if(!(r.flags&128)&&(typeof v.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Gr===null||!Gr.has(S)))){r.flags|=65536,e&=-e,r.lanes|=e;var E=U_(r,o,e);Wx(r,E);break e}}r=r.return}while(r!==null)}a1(t)}catch(C){e=C,Je===t&&t!==null&&(Je=t=t.return);continue}break}while(!0)}function i1(){var n=_p.current;return _p.current=wp,n===null?wp:n}function Rv(){(lt===0||lt===3||lt===2)&&(lt=4),yt===null||!(Ro&268435455)&&!(fm&268435455)||ar(yt,Et)}function Ep(n,e){var t=he;he|=2;var s=i1();(yt!==n||Et!==e)&&(ui=null,No(n,e));do try{rN();break}catch(i){n1(n,i)}while(!0);if(pv(),he=t,_p.current=s,Je!==null)throw Error(M(261));return yt=null,Et=0,lt}function rN(){for(;Je!==null;)r1(Je)}function aN(){for(;Je!==null&&!PE();)r1(Je)}function r1(n){var e=l1(n.alternate,n,Ts);n.memoizedProps=n.pendingProps,e===null?a1(n):Je=e,Nv.current=null}function a1(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Zk(t,e),t!==null){t.flags&=32767,Je=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{lt=6,Je=null;return}}else if(t=Jk(t,e,Ts),t!==null){Je=t;return}if(e=e.sibling,e!==null){Je=e;return}Je=e=n}while(e!==null);lt===0&&(lt=5)}function ua(n,e,t){var s=be,i=Qs.transition;try{Qs.transition=null,be=1,oN(n,e,t,s)}finally{Qs.transition=i,be=s}return null}function oN(n,e,t,s){do Sl();while(Br!==null);if(he&6)throw Error(M(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(M(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(UE(n,r),n===yt&&(Je=yt=null,Et=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||rf||(rf=!0,c1(ap,function(){return Sl(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Qs.transition,Qs.transition=null;var a=be;be=1;var o=he;he|=4,Nv.current=null,tN(n,t),e1(t,n),Nk(Wg),lp=!!Vg,Wg=Vg=null,n.current=t,sN(t),RE(),he=o,be=a,Qs.transition=r}else n.current=t;if(rf&&(rf=!1,Br=n,Ap=i),r=n.pendingLanes,r===0&&(Gr=null),ME(t.stateNode),ps(n,Ke()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(Sp)throw Sp=!1,n=d0,d0=null,n;return Ap&1&&n.tag!==0&&Sl(),r=n.pendingLanes,r&1?n===h0?Ru++:(Ru=0,h0=n):Ru=0,ia(),null}function Sl(){if(Br!==null){var n=Bw(Ap),e=Qs.transition,t=be;try{if(Qs.transition=null,be=16>n?16:n,Br===null)var s=!1;else{if(n=Br,Br=null,Ap=0,he&6)throw Error(M(331));var i=he;for(he|=4,U=n.current;U!==null;){var r=U,a=r.child;if(U.flags&16){var o=r.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(U=d;U!==null;){var h=U;switch(h.tag){case 0:case 11:case 15:ju(8,h,r)}var f=h.child;if(f!==null)f.return=h,U=f;else for(;U!==null;){h=U;var p=h.sibling,m=h.return;if(Q_(h),h===d){U=null;break}if(p!==null){p.return=m,U=p;break}U=m}}}var g=r.alternate;if(g!==null){var b=g.child;if(b!==null){g.child=null;do{var A=b.sibling;b.sibling=null,b=A}while(b!==null)}}U=r}}if(r.subtreeFlags&2064&&a!==null)a.return=r,U=a;else e:for(;U!==null;){if(r=U,r.flags&2048)switch(r.tag){case 0:case 11:case 15:ju(9,r,r.return)}var x=r.sibling;if(x!==null){x.return=r.return,U=x;break e}U=r.return}}var v=n.current;for(U=v;U!==null;){a=U;var S=a.child;if(a.subtreeFlags&2064&&S!==null)S.return=a,U=S;else e:for(a=v;U!==null;){if(o=U,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:hm(9,o)}}catch(C){We(o,o.return,C)}if(o===a){U=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,U=E;break e}U=o.return}}if(he=i,ia(),si&&typeof si.onPostCommitFiberRoot=="function")try{si.onPostCommitFiberRoot(im,n)}catch{}s=!0}return s}finally{be=t,Qs.transition=e}}return!1}function hb(n,e,t){e=Dc(t,e),e=B_(n,e,1),n=qr(n,e,1),e=Kt(),n!==null&&(Ph(n,1,e),ps(n,e))}function We(n,e,t){if(n.tag===3)hb(n,n,t);else for(;e!==null;){if(e.tag===3){hb(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Gr===null||!Gr.has(s))){n=Dc(t,n),n=U_(e,n,1),e=qr(e,n,1),n=Kt(),e!==null&&(Ph(e,1,n),ps(e,n));break}}e=e.return}}function lN(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=Kt(),n.pingedLanes|=n.suspendedLanes&t,yt===n&&(Et&t)===t&&(lt===4||lt===3&&(Et&130023424)===Et&&500>Ke()-Tv?No(n,0):Cv|=t),ps(n,e)}function o1(n,e){e===0&&(n.mode&1?(e=Xh,Xh<<=1,!(Xh&130023424)&&(Xh=4194304)):e=1);var t=Kt();n=Xi(n,e),n!==null&&(Ph(n,e,t),ps(n,t))}function cN(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),o1(n,t)}function uN(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(M(314))}s!==null&&s.delete(e),o1(n,t)}var l1;l1=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||hs.current)ds=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return ds=!1,Qk(n,e,t);ds=!!(n.flags&131072)}else ds=!1,Me&&e.flags&1048576&&h_(e,mp,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Sf(n,e),n=e.pendingProps;var i=Rc(e,Bt.current);_l(e,t),i=_v(null,e,s,n,i,t);var r=Sv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fs(s)?(r=!0,fp(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,yv(e),i.updater=dm,e.stateNode=i,i._reactInternals=e,e0(e,s,n,t),e=n0(null,e,s,!0,r,t)):(e.tag=0,Me&&r&&uv(e),Xt(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(Sf(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=hN(s),n=ln(s,n),i){case 0:e=s0(null,e,s,n,t);break e;case 1:e=sb(null,e,s,n,t);break e;case 11:e=eb(null,e,s,n,t);break e;case 14:e=tb(null,e,s,ln(s.type,n),t);break e}throw Error(M(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ln(s,i),s0(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ln(s,i),sb(n,e,s,i,t);case 3:e:{if(W_(e),n===null)throw Error(M(387));s=e.pendingProps,r=e.memoizedState,i=r.element,v_(n,e),vp(e,s,null,t);var a=e.memoizedState;if(s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=Dc(Error(M(423)),e),e=nb(n,e,s,t,i);break e}else if(s!==i){i=Dc(Error(M(424)),e),e=nb(n,e,s,t,i);break e}else for(Rs=Wr(e.stateNode.containerInfo.firstChild),Is=e,Me=!0,An=null,t=g_(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Ic(),s===i){e=Ki(n,e,t);break e}Xt(n,e,s,t)}e=e.child}return e;case 5:return x_(e),n===null&&Qg(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,a=i.children,qg(s,i)?a=null:r!==null&&qg(s,r)&&(e.flags|=32),V_(n,e),Xt(n,e,a,t),e.child;case 6:return n===null&&Qg(e),null;case 13:return q_(n,e,t);case 4:return vv(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=Lc(e,null,s,t):Xt(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ln(s,i),eb(n,e,s,i,t);case 7:return Xt(n,e,e.pendingProps,t),e.child;case 8:return Xt(n,e,e.pendingProps.children,t),e.child;case 12:return Xt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,a=i.value,Ne(gp,s._currentValue),s._currentValue=a,r!==null)if(Cn(r.value,a)){if(r.children===i.children&&!hs.current){e=Ki(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var o=r.dependencies;if(o!==null){a=r.child;for(var c=o.firstContext;c!==null;){if(c.context===s){if(r.tag===1){c=Hi(-1,t&-t),c.tag=2;var d=r.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),Jg(r.return,t,e),o.lanes|=t;break}c=c.next}}else if(r.tag===10)a=r.type===e.type?null:r.child;else if(r.tag===18){if(a=r.return,a===null)throw Error(M(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),Jg(a,t,e),a=r.sibling}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===e){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}Xt(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,_l(e,t),i=en(i),s=s(i),e.flags|=1,Xt(n,e,s,t),e.child;case 14:return s=e.type,i=ln(s,e.pendingProps),i=ln(s.type,i),tb(n,e,s,i,t);case 15:return z_(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ln(s,i),Sf(n,e),e.tag=1,fs(s)?(n=!0,fp(e)):n=!1,_l(e,t),$_(e,s,i),e0(e,s,i,t),n0(null,e,s,!0,n,t);case 19:return G_(n,e,t);case 22:return H_(n,e,t)}throw Error(M(156,e.tag))};function c1(n,e){return Dw(n,e)}function dN(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ys(n,e,t,s){return new dN(n,e,t,s)}function Iv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function hN(n){if(typeof n=="function")return Iv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Jy)return 11;if(n===Zy)return 14}return 2}function Kr(n,e){var t=n.alternate;return t===null?(t=Ys(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function kf(n,e,t,s,i,r){var a=2;if(s=n,typeof n=="function")Iv(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case rl:return Co(t.children,i,r,e);case Qy:a=8,i|=8;break;case Ag:return n=Ys(12,t,e,i|2),n.elementType=Ag,n.lanes=r,n;case Eg:return n=Ys(13,t,e,i),n.elementType=Eg,n.lanes=r,n;case kg:return n=Ys(19,t,e,i),n.elementType=kg,n.lanes=r,n;case xw:return pm(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case yw:a=10;break e;case vw:a=9;break e;case Jy:a=11;break e;case Zy:a=14;break e;case nr:a=16,s=null;break e}throw Error(M(130,n==null?n:typeof n,""))}return e=Ys(a,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function Co(n,e,t,s){return n=Ys(7,n,s,e),n.lanes=t,n}function pm(n,e,t,s){return n=Ys(22,n,s,e),n.elementType=xw,n.lanes=t,n.stateNode={isHidden:!1},n}function rg(n,e,t){return n=Ys(6,n,null,e),n.lanes=t,n}function ag(n,e,t){return e=Ys(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function fN(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bm(0),this.expirationTimes=Bm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bm(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Lv(n,e,t,s,i,r,a,o,c){return n=new fN(n,e,t,o,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Ys(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},yv(r),n}function pN(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:il,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function u1(n){if(!n)return Jr;n=n._reactInternals;e:{if($o(n)!==n||n.tag!==1)throw Error(M(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(fs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(M(171))}if(n.tag===1){var t=n.type;if(fs(t))return u_(n,t,e)}return e}function d1(n,e,t,s,i,r,a,o,c){return n=Lv(t,s,!0,n,i,r,a,o,c),n.context=u1(null),t=n.current,s=Kt(),i=Xr(t),r=Hi(s,i),r.callback=e??null,qr(t,r,i),n.current.lanes=i,Ph(n,i,s),ps(n,s),n}function mm(n,e,t,s){var i=e.current,r=Kt(),a=Xr(i);return t=u1(t),e.context===null?e.context=t:e.pendingContext=t,e=Hi(r,a),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=qr(i,e,a),n!==null&&(Nn(n,i,a,r),bf(n,i,a)),a}function kp(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function fb(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Mv(n,e){fb(n,e),(n=n.alternate)&&fb(n,e)}function mN(){return null}var h1=typeof reportError=="function"?reportError:function(n){console.error(n)};function Dv(n){this._internalRoot=n}gm.prototype.render=Dv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(M(409));mm(n,e,null,null)};gm.prototype.unmount=Dv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Io(function(){mm(null,n,null,null)}),e[Gi]=null}};function gm(n){this._internalRoot=n}gm.prototype.unstable_scheduleHydration=function(n){if(n){var e=Hw();n={blockedOn:null,target:n,priority:e};for(var t=0;t<rr.length&&e!==0&&e<rr[t].priority;t++);rr.splice(t,0,n),t===0&&Ww(n)}};function Ov(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function ym(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function pb(){}function gN(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var d=kp(a);r.call(d)}}var a=d1(e,s,n,0,null,!1,!1,"",pb);return n._reactRootContainer=a,n[Gi]=a.current,qu(n.nodeType===8?n.parentNode:n),Io(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var o=s;s=function(){var d=kp(c);o.call(d)}}var c=Lv(n,0,!1,null,null,!1,!1,"",pb);return n._reactRootContainer=c,n[Gi]=c.current,qu(n.nodeType===8?n.parentNode:n),Io(function(){mm(e,c,t,s)}),c}function vm(n,e,t,s,i){var r=t._reactRootContainer;if(r){var a=r;if(typeof i=="function"){var o=i;i=function(){var c=kp(a);o.call(c)}}mm(e,a,n,i)}else a=gN(t,e,n,i,s);return kp(a)}Uw=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=ru(e.pendingLanes);t!==0&&(sv(e,t|1),ps(e,Ke()),!(he&6)&&(Oc=Ke()+500,ia()))}break;case 13:Io(function(){var s=Xi(n,1);if(s!==null){var i=Kt();Nn(s,n,1,i)}}),Mv(n,1)}};nv=function(n){if(n.tag===13){var e=Xi(n,134217728);if(e!==null){var t=Kt();Nn(e,n,134217728,t)}Mv(n,134217728)}};zw=function(n){if(n.tag===13){var e=Xr(n),t=Xi(n,e);if(t!==null){var s=Kt();Nn(t,n,e,s)}Mv(n,e)}};Hw=function(){return be};Vw=function(n,e){var t=be;try{return be=n,e()}finally{be=t}};Dg=function(n,e,t){switch(e){case"input":if(Tg(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=lm(s);if(!i)throw Error(M(90));ww(s),Tg(s,i)}}}break;case"textarea":Sw(n,t);break;case"select":e=t.value,e!=null&&vl(n,!!t.multiple,e,!1)}};jw=jv;Pw=Io;var yN={usingClientEntryPoint:!1,Events:[Ih,cl,lm,Cw,Tw,jv]},Qc={findFiberByHostInstance:va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vN={bundleType:Qc.bundleType,version:Qc.version,rendererPackageName:Qc.rendererPackageName,rendererConfig:Qc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ji.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Lw(n),n===null?null:n.stateNode},findFiberByHostInstance:Qc.findFiberByHostInstance||mN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var af=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!af.isDisabled&&af.supportsFiber)try{im=af.inject(vN),si=af}catch{}}Ds.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yN;Ds.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ov(e))throw Error(M(200));return pN(n,e,null,t)};Ds.createRoot=function(n,e){if(!Ov(n))throw Error(M(299));var t=!1,s="",i=h1;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Lv(n,1,!1,null,null,t,!1,s,i),n[Gi]=e.current,qu(n.nodeType===8?n.parentNode:n),new Dv(e)};Ds.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(M(188)):(n=Object.keys(n).join(","),Error(M(268,n)));return n=Lw(e),n=n===null?null:n.stateNode,n};Ds.flushSync=function(n){return Io(n)};Ds.hydrate=function(n,e,t){if(!ym(e))throw Error(M(200));return vm(null,n,e,!0,t)};Ds.hydrateRoot=function(n,e,t){if(!Ov(n))throw Error(M(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",a=h1;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=d1(e,null,n,1,t??null,i,!1,r,a),n[Gi]=e.current,qu(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new gm(e)};Ds.render=function(n,e,t){if(!ym(e))throw Error(M(200));return vm(null,n,e,!1,t)};Ds.unmountComponentAtNode=function(n){if(!ym(n))throw Error(M(40));return n._reactRootContainer?(Io(function(){vm(null,null,n,!1,function(){n._reactRootContainer=null,n[Gi]=null})}),!0):!1};Ds.unstable_batchedUpdates=jv;Ds.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!ym(t))throw Error(M(200));if(n==null||n._reactInternals===void 0)throw Error(M(38));return vm(n,e,t,!1,s)};Ds.version="18.3.1-next-f1338f8080-20240426";function f1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f1)}catch(n){console.error(n)}}f1(),fw.exports=Ds;var xN=fw.exports,p1,mb=xN;p1=mb.createRoot,mb.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),De=(n,e)=>{const t=G.forwardRef(({color:s="currentColor",size:i=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:o="",children:c,...d},h)=>G.createElement("svg",{ref:h,...bN,width:i,height:i,stroke:s,strokeWidth:a?Number(r)*24/Number(i):r,className:["lucide",`lucide-${wN(n)}`,o].join(" "),...d},[...e.map(([f,p])=>G.createElement(f,p)),...Array.isArray(c)?c:[c]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=De("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=De("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=De("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=De("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=De("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=De("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m1=De("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=De("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g1=De("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=De("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=De("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y1=De("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=De("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=De("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=De("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=De("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v1=De("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m0=De("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=De("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=De("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=De("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jN=De("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=De("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=De("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),RN="modulepreload",IN=function(n){return"/"+n},vb={},Mh=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(t.map(c=>{if(c=IN(c),c in vb)return;vb[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":RN,d||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),d)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return e().catch(r)})},LN=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Mh(async()=>{const{default:s}=await Promise.resolve().then(()=>zc);return{default:s}},[]).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Fv extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class MN extends Fv{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class xb extends Fv{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class bb extends Fv{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var y0;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(y0||(y0={}));var DN=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function c(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?r(h.value):i(h.value).then(o,c)}d((s=s.apply(n,e||[])).next())})};class ON{constructor(e,{headers:t={},customFetch:s,region:i=y0.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=LN(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return DN(this,void 0,void 0,function*(){try{const{headers:i,method:r,body:a}=t;let o={},{region:c}=t;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(o["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let h;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",h=a):typeof a=="string"?(o["Content-Type"]="text/plain",h=a):typeof FormData<"u"&&a instanceof FormData?h=a:(o["Content-Type"]="application/json",h=JSON.stringify(a)));const f=yield this.fetch(d.toString(),{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:h}).catch(b=>{throw new MN(b)}),p=f.headers.get("x-relay-error");if(p&&p==="true")throw new xb(f);if(!f.ok)throw new bb(f);let m=((s=f.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),g;return m==="application/json"?g=yield f.json():m==="application/octet-stream"?g=yield f.blob():m==="text/event-stream"?g=f:m==="multipart/form-data"?g=yield f.formData():g=yield f.text(),{data:g,error:null,response:f}}catch(i){return{data:null,error:i,response:i instanceof bb||i instanceof xb?i.context:void 0}}})}}var cs={},$v={},xm={},Dh={},bm={},wm={},FN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Fc=FN();const $N=Fc.fetch,x1=Fc.fetch.bind(Fc),b1=Fc.Headers,BN=Fc.Request,UN=Fc.Response,zc=Object.freeze(Object.defineProperty({__proto__:null,Headers:b1,Request:BN,Response:UN,default:x1,fetch:$N},Symbol.toStringTag,{value:"Module"})),zN=GA(zc);var _m={};Object.defineProperty(_m,"__esModule",{value:!0});let HN=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};_m.default=HN;var w1=Zs&&Zs.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(wm,"__esModule",{value:!0});const VN=w1(zN),WN=w1(_m);let qN=class{constructor(e){var t,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(s=e.isMaybeSingle)!==null&&s!==void 0?s:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=VN.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let i=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async r=>{var a,o,c,d;let h=null,f=null,p=null,m=r.status,g=r.statusText;if(r.ok){if(this.method!=="HEAD"){const v=await r.text();v===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?f=v:f=JSON.parse(v))}const A=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),x=(c=r.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");A&&x&&x.length>1&&(p=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(h={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,p=null,m=406,g="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const A=await r.text();try{h=JSON.parse(A),Array.isArray(h)&&r.status===404&&(f=[],h=null,m=200,g="OK")}catch{r.status===404&&A===""?(m=204,g="No Content"):h={message:A}}if(h&&this.isMaybeSingle&&(!((d=h==null?void 0:h.details)===null||d===void 0)&&d.includes("0 rows"))&&(h=null,m=200,g="OK"),h&&this.shouldThrowOnError)throw new WN.default(h)}return{error:h,data:f,count:p,status:m,statusText:g}});return this.shouldThrowOnError||(i=i.catch(r=>{var a,o,c;return{error:{message:`${(a=r==null?void 0:r.name)!==null&&a!==void 0?a:"FetchError"}: ${r==null?void 0:r.message}`,details:`${(o=r==null?void 0:r.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=r==null?void 0:r.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};wm.default=qN;var GN=Zs&&Zs.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(bm,"__esModule",{value:!0});const XN=GN(wm);let KN=class extends XN.default{select(e){let t=!1;const s=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:i,referencedTable:r=i}={}){const a=r?`${r}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:i=s}={}){const r=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:i=!1,wal:r=!1,format:a="text"}={}){var o;const c=[e?"analyze":null,t?"verbose":null,s?"settings":null,i?"buffers":null,r?"wal":null].filter(Boolean).join("|"),d=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${d}"; options=${c};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};bm.default=KN;var YN=Zs&&Zs.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Dh,"__esModule",{value:!0});const QN=YN(bm);let JN=class extends QN.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:i}={}){let r="";i==="plain"?r="pl":i==="phrase"?r="ph":i==="websearch"&&(r="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${r}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const i=s?`${s}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Dh.default=JN;var ZN=Zs&&Zs.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(xm,"__esModule",{value:!0});const Jc=ZN(Dh);let eC=class{constructor(e,{headers:t={},schema:s,fetch:i}){this.url=e,this.headers=new Headers(t),this.schema=s,this.fetch=i}select(e,{head:t=!1,count:s}={}){const i=t?"HEAD":"GET";let r=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!r?"":(o==='"'&&(r=!r),o)).join("");return this.url.searchParams.set("select",a),s&&this.headers.append("Prefer",`count=${s}`),new Jc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:s=!0}={}){var i;const r="POST";if(t&&this.headers.append("Prefer",`count=${t}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(a.length>0){const o=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Jc.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:i,defaultToNull:r=!0}={}){var a;const o="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),i&&this.headers.append("Prefer",`count=${i}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(c.length>0){const d=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new Jc.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var s;const i="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Jc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:e}={}){var t;const s="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Jc.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};xm.default=eC;var _1=Zs&&Zs.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty($v,"__esModule",{value:!0});const tC=_1(xm),sC=_1(Dh);let nC=class S1{constructor(e,{headers:t={},schema:s,fetch:i}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new tC.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new S1(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:i=!1,count:r}={}){var a;let o;const c=new URL(`${this.url}/rpc/${e}`);let d;s||i?(o=s?"HEAD":"GET",Object.entries(t).filter(([f,p])=>p!==void 0).map(([f,p])=>[f,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([f,p])=>{c.searchParams.append(f,p)})):(o="POST",d=t);const h=new Headers(this.headers);return r&&h.set("Prefer",`count=${r}`),new sC.default({method:o,url:c,headers:h,schema:this.schemaName,body:d,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};$v.default=nC;var Hc=Zs&&Zs.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cs,"__esModule",{value:!0});cs.PostgrestError=cs.PostgrestBuilder=cs.PostgrestTransformBuilder=cs.PostgrestFilterBuilder=cs.PostgrestQueryBuilder=cs.PostgrestClient=void 0;const A1=Hc($v);cs.PostgrestClient=A1.default;const E1=Hc(xm);cs.PostgrestQueryBuilder=E1.default;const k1=Hc(Dh);cs.PostgrestFilterBuilder=k1.default;const N1=Hc(bm);cs.PostgrestTransformBuilder=N1.default;const C1=Hc(wm);cs.PostgrestBuilder=C1.default;const T1=Hc(_m);cs.PostgrestError=T1.default;var iC=cs.default={PostgrestClient:A1.default,PostgrestQueryBuilder:E1.default,PostgrestFilterBuilder:k1.default,PostgrestTransformBuilder:N1.default,PostgrestBuilder:C1.default,PostgrestError:T1.default};const{PostgrestClient:rC,PostgrestQueryBuilder:xP,PostgrestFilterBuilder:bP,PostgrestTransformBuilder:wP,PostgrestBuilder:_P,PostgrestError:SP}=iC;class aC{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const oC="2.15.1",lC=`realtime-js/${oC}`,cC="1.0.0",v0=1e4,uC=1e3,dC=100;var Iu;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Iu||(Iu={}));var st;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(st||(st={}));var Sn;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Sn||(Sn={}));var x0;(function(n){n.websocket="websocket"})(x0||(x0={}));var ma;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(ma||(ma={}));class hC{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const i=t.getUint8(1),r=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+i));a=a+i;const c=s.decode(e.slice(a,a+r));a=a+r;const d=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:c,payload:d}}}class j1{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ee;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ee||(Ee={}));const wb=(n,e,t={})=>{var s;const i=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((r,a)=>(r[a]=fC(a,n,e,i),r),{})},fC=(n,e,t,s)=>{const i=e.find(o=>o.name===n),r=i==null?void 0:i.type,a=t[n];return r&&!s.includes(r)?P1(r,a):b0(a)},P1=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return yC(e,t)}switch(n){case Ee.bool:return pC(e);case Ee.float4:case Ee.float8:case Ee.int2:case Ee.int4:case Ee.int8:case Ee.numeric:case Ee.oid:return mC(e);case Ee.json:case Ee.jsonb:return gC(e);case Ee.timestamp:return vC(e);case Ee.abstime:case Ee.date:case Ee.daterange:case Ee.int4range:case Ee.int8range:case Ee.money:case Ee.reltime:case Ee.text:case Ee.time:case Ee.timestamptz:case Ee.timetz:case Ee.tsrange:case Ee.tstzrange:return b0(e);default:return b0(e)}},b0=n=>n,pC=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},mC=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},gC=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},yC=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let r;const a=n.slice(1,t);try{r=JSON.parse("["+a+"]")}catch{r=a?a.split(","):[]}return r.map(o=>P1(e,o))}return n},vC=n=>typeof n=="string"?n.replace(" ","T"):n,R1=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class cg{constructor(e,t,s={},i=v0){this.channel=e,this.event=t,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var _b;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(_b||(_b={}));class Lu{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:r,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Lu.syncState(this.state,i,r,a),this.pendingDiffs.forEach(c=>{this.state=Lu.syncDiff(this.state,c,r,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},i=>{const{onJoin:r,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Lu.syncDiff(this.state,i,r,a),o())}),this.onJoin((i,r,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:r,newPresences:a})}),this.onLeave((i,r,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:r,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,i){const r=this.cloneDeep(e),a=this.transformState(t),o={},c={};return this.map(r,(d,h)=>{a[d]||(c[d]=h)}),this.map(a,(d,h)=>{const f=r[d];if(f){const p=h.map(A=>A.presence_ref),m=f.map(A=>A.presence_ref),g=h.filter(A=>m.indexOf(A.presence_ref)<0),b=f.filter(A=>p.indexOf(A.presence_ref)<0);g.length>0&&(o[d]=g),b.length>0&&(c[d]=b)}else o[d]=h}),this.syncDiff(r,{joins:o,leaves:c},s,i)}static syncDiff(e,t,s,i){const{joins:r,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(r,(o,c)=>{var d;const h=(d=e[o])!==null&&d!==void 0?d:[];if(e[o]=this.cloneDeep(c),h.length>0){const f=e[o].map(m=>m.presence_ref),p=h.filter(m=>f.indexOf(m.presence_ref)<0);e[o].unshift(...p)}s(o,h,c)}),this.map(a,(o,c)=>{let d=e[o];if(!d)return;const h=c.map(f=>f.presence_ref);d=d.filter(f=>h.indexOf(f.presence_ref)<0),e[o]=d,i(o,d,c),d.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const i=e[s];return"metas"in i?t[s]=i.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):t[s]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Sb;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Sb||(Sb={}));var Mu;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Mu||(Mu={}));var di;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(di||(di={}));class Bv{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=st.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new cg(this,Sn.join,this.params,this.timeout),this.rejoinTimer=new j1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=st.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=st.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Sn.reply,{},(i,r)=>{this._trigger(this._replyEventName(r),i)}),this.presence=new Lu(this),this.broadcastEndpointURL=R1(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==st.closed){const{config:{broadcast:r,presence:a,private:o}}=this.params,c=(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[Mu.PRESENCE]&&this.bindings[Mu.PRESENCE].length>0,h={},f={broadcast:r,presence:Object.assign(Object.assign({},a),{enabled:d}),postgres_changes:c,private:o};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(di.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(di.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:p})=>{var m;if(this.socket.setAuth(),p===void 0){e==null||e(di.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,b=(m=g==null?void 0:g.length)!==null&&m!==void 0?m:0,A=[];for(let x=0;x<b;x++){const v=g[x],{filter:{event:S,schema:E,table:C,filter:N}}=v,k=p&&p[x];if(k&&k.event===S&&k.schema===E&&k.table===C&&k.filter===N)A.push(Object.assign(Object.assign({},v),{id:k.id}));else{this.unsubscribe(),this.state=st.errored,e==null||e(di.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,e&&e(di.SUBSCRIBED);return}}).receive("error",p=>{this.state=st.errored,e==null||e(di.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(di.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===st.joined&&e===Mu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,i;if(!this._canPush()&&e.type==="broadcast"){const{event:r,payload:a}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var a,o,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&r("ok"),d.receive("ok",()=>r("ok")),d.receive("error",()=>r("error")),d.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=st.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Sn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(i=>{s=new cg(this,Sn.leave,{},e),s.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=st.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const i=new AbortController,r=setTimeout(()=>i.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(r),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new cg(this,e,t,s);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>dC){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var i,r;const a=e.toLocaleLowerCase(),{close:o,error:c,leave:d,join:h}=Sn;if(s&&[o,c,d,h].indexOf(a)>=0&&s!==this._joinRef())return;let p=this._onMessage(a,t,s);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(m=>{var g,b,A;return((g=m.filter)===null||g===void 0?void 0:g.event)==="*"||((A=(b=m.filter)===null||b===void 0?void 0:b.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===a}).map(m=>m.callback(p,s)):(r=this.bindings[a])===null||r===void 0||r.filter(m=>{var g,b,A,x,v,S;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const E=m.id,C=(g=m.filter)===null||g===void 0?void 0:g.event;return E&&((b=t.ids)===null||b===void 0?void 0:b.includes(E))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((A=t.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))}else{const E=(v=(x=m==null?void 0:m.filter)===null||x===void 0?void 0:x.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return E==="*"||E===((S=t==null?void 0:t.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof p=="object"&&"ids"in p){const g=p.data,{schema:b,table:A,commit_timestamp:x,type:v,errors:S}=g;p=Object.assign(Object.assign({},{schema:b,table:A,commit_timestamp:x,eventType:v,new:{},old:{},errors:S}),this._getPayloadRecords(g))}m.callback(p,s)})}_isClosed(){return this.state===st.closed}_isJoined(){return this.state===st.joined}_isJoining(){return this.state===st.joining}_isLeaving(){return this.state===st.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const i=e.toLocaleLowerCase(),r={type:i,filter:t,callback:s};return this.bindings[i]?this.bindings[i].push(r):this.bindings[i]=[r],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(i=>{var r;return!(((r=i.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===s&&Bv.isEqual(i.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Sn.close,{},e)}_onError(e){this._on(Sn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=st.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=wb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=wb(e.columns,e.old_record)),t}}const Ab=()=>{},of={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},xC=[1e3,2e3,5e3,1e4],bC=1e4,wC=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _C{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=v0,this.transport=null,this.heartbeatIntervalMs=of.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ab,this.ref=0,this.reconnectTimer=null,this.logger=Ab,this.conn=null,this.sendBuffer=[],this.serializer=new hC,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let r;return i?r=i:typeof fetch>"u"?r=(...a)=>Mh(async()=>{const{default:o}=await Promise.resolve().then(()=>zc);return{default:o}},void 0).then(({default:o})=>o(...a)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):r=fetch,(...a)=>r(...a)},!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${x0.websocket}`,this.httpEndpoint=R1(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=aC.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:cC}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Iu.connecting:return ma.Connecting;case Iu.open:return ma.Open;case Iu.closing:return ma.Closing;default:return ma.Closed}}isConnected(){return this.connectionState()===ma.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,i=this.getChannels().find(r=>r.topic===s);if(i)return i;{const r=new Bv(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:s,payload:i,ref:r}=e,a=()=>{this.encode(e,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${t} ${s} (${r})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(uC,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},of.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:i,payload:r,ref:a}=t,o=a?`(${a})`:"",c=r.status||"";this.log("receive",`${c} ${s} ${i} ${o}`.trim(),r),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(i,r,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Sn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${s}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([wC],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const i={access_token:t,version:lC};t&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(Sn.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new j1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},of.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,i,r,a,o,c,d;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:v0,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:of.HEARTBEAT_INTERVAL,this.worker=(r=e==null?void 0:e.worker)!==null&&r!==void 0?r:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(o=e==null?void 0:e.reconnectAfterMs)!==null&&o!==void 0?o:h=>xC[h-1]||bC,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(h,f)=>f(JSON.stringify(h)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Uv extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function at(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class SC extends Uv{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class w0 extends Uv{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var AC=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function c(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?r(h.value):i(h.value).then(o,c)}d((s=s.apply(n,e||[])).next())})};const I1=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Mh(async()=>{const{default:s}=await Promise.resolve().then(()=>zc);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},EC=()=>AC(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Mh(()=>Promise.resolve().then(()=>zc),void 0)).Response:Response}),_0=n=>{if(Array.isArray(n))return n.map(t=>_0(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,s])=>{const i=t.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));e[i]=_0(s)}),e},kC=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Bo=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function c(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?r(h.value):i(h.value).then(o,c)}d((s=s.apply(n,e||[])).next())})};const ug=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),NC=(n,e,t)=>Bo(void 0,void 0,void 0,function*(){const s=yield EC();n instanceof s&&!(t!=null&&t.noResolveJson)?n.json().then(i=>{const r=n.status||500,a=(i==null?void 0:i.statusCode)||r+"";e(new SC(ug(i),r,a))}).catch(i=>{e(new w0(ug(i),i))}):e(new w0(ug(n),n))}),CC=(n,e,t,s)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!s?i:(kC(s)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(s)):i.body=s,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),t))};function Oh(n,e,t,s,i,r){return Bo(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,CC(e,s,i,r)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>NC(c,o,s))})})}function Cp(n,e,t,s){return Bo(this,void 0,void 0,function*(){return Oh(n,"GET",e,t,s)})}function On(n,e,t,s,i){return Bo(this,void 0,void 0,function*(){return Oh(n,"POST",e,s,i,t)})}function S0(n,e,t,s,i){return Bo(this,void 0,void 0,function*(){return Oh(n,"PUT",e,s,i,t)})}function TC(n,e,t,s){return Bo(this,void 0,void 0,function*(){return Oh(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function L1(n,e,t,s,i){return Bo(this,void 0,void 0,function*(){return Oh(n,"DELETE",e,s,i,t)})}var zt=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function c(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?r(h.value):i(h.value).then(o,c)}d((s=s.apply(n,e||[])).next())})};const jC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Eb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class PC{constructor(e,t={},s,i){this.url=e,this.headers=t,this.bucketId=s,this.fetch=I1(i)}uploadOrUpdate(e,t,s,i){return zt(this,void 0,void 0,function*(){try{let r;const a=Object.assign(Object.assign({},Eb),i);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&s instanceof Blob?(r=new FormData,r.append("cacheControl",a.cacheControl),c&&r.append("metadata",this.encodeMetadata(c)),r.append("",s)):typeof FormData<"u"&&s instanceof FormData?(r=s,r.append("cacheControl",a.cacheControl),c&&r.append("metadata",this.encodeMetadata(c))):(r=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const d=this._removeEmptyFolders(t),h=this._getFinalPath(d),f=yield(e=="PUT"?S0:On)(this.fetch,`${this.url}/object/${h}`,r,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(r){if(at(r))return{data:null,error:r};throw r}})}upload(e,t,s){return zt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,i){return zt(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(e),a=this._getFinalPath(r),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:Eb.upsert},i),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const f=yield S0(this.fetch,o.toString(),c,{headers:h});return{data:{path:r,fullPath:f.Key},error:null}}catch(c){if(at(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return zt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const r=yield On(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),a=new URL(this.url+r.url),o=a.searchParams.get("token");if(!o)throw new Uv("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}update(e,t,s){return zt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return zt(this,void 0,void 0,function*(){try{return{data:yield On(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}copy(e,t,s){return zt(this,void 0,void 0,function*(){try{return{data:{path:(yield On(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,s){return zt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),r=yield On(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${a}`)},{data:r,error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,s){return zt(this,void 0,void 0,function*(){try{const i=yield On(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),r=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${r}`):null})),error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}download(e,t){return zt(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=r?`?${r}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Cp(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(at(o))return{data:null,error:o};throw o}})}info(e){return zt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Cp(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:_0(s),error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}exists(e){return zt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield TC(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(at(s)&&s instanceof w0){const i=s.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),i=[],r=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";r!==""&&i.push(r);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${d}`)}}}remove(e){return zt(this,void 0,void 0,function*(){try{return{data:yield L1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(at(t))return{data:null,error:t};throw t}})}list(e,t,s){return zt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},jC),t),{prefix:e||""});return{data:yield On(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}listV2(e,t){return zt(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield On(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const RC="2.11.0",IC={"X-Client-Info":`storage-js/${RC}`};var Vo=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function c(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?r(h.value):i(h.value).then(o,c)}d((s=s.apply(n,e||[])).next())})};class LC{constructor(e,t={},s,i){const r=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href,this.headers=Object.assign(Object.assign({},IC),t),this.fetch=I1(s)}listBuckets(){return Vo(this,void 0,void 0,function*(){try{return{data:yield Cp(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(at(e))return{data:null,error:e};throw e}})}getBucket(e){return Vo(this,void 0,void 0,function*(){try{return{data:yield Cp(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(at(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Vo(this,void 0,void 0,function*(){try{return{data:yield On(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Vo(this,void 0,void 0,function*(){try{return{data:yield S0(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Vo(this,void 0,void 0,function*(){try{return{data:yield On(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(at(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Vo(this,void 0,void 0,function*(){try{return{data:yield L1(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(at(t))return{data:null,error:t};throw t}})}}class MC extends LC{constructor(e,t={},s,i){super(e,t,s,i)}from(e){return new PC(this.url,this.headers,e,this.fetch)}}const DC="2.56.0";let ou="";typeof Deno<"u"?ou="deno":typeof document<"u"?ou="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ou="react-native":ou="node";const OC={"X-Client-Info":`supabase-js-${ou}/${DC}`},FC={headers:OC},$C={schema:"public"},BC={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},UC={};var zC=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function c(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?r(h.value):i(h.value).then(o,c)}d((s=s.apply(n,e||[])).next())})};const HC=n=>{let e;return n?e=n:typeof fetch>"u"?e=x1:e=fetch,(...t)=>e(...t)},VC=()=>typeof Headers>"u"?b1:Headers,WC=(n,e,t)=>{const s=HC(t),i=VC();return(r,a)=>zC(void 0,void 0,void 0,function*(){var o;const c=(o=yield e())!==null&&o!==void 0?o:n;let d=new i(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(r,Object.assign(Object.assign({},a),{headers:d}))})};var qC=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function c(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?r(h.value):i(h.value).then(o,c)}d((s=s.apply(n,e||[])).next())})};function GC(n){return n.endsWith("/")?n:n+"/"}function XC(n,e){var t,s;const{db:i,auth:r,realtime:a,global:o}=n,{db:c,auth:d,realtime:h,global:f}=e,p={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},d),r),realtime:Object.assign(Object.assign({},h),a),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(t=f==null?void 0:f.headers)!==null&&t!==void 0?t:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>qC(this,void 0,void 0,function*(){return""})};return n.accessToken?p.accessToken=n.accessToken:delete p.accessToken,p}const M1="2.71.1",Ko=30*1e3,A0=3,dg=A0*Ko,KC="http://localhost:9999",YC="supabase.auth.token",QC={"X-Client-Info":`gotrue-js/${M1}`},E0="X-Supabase-Api-Version",D1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},JC=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ZC=10*60*1e3;class zv extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function J(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class eT extends zv{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function tT(n){return J(n)&&n.name==="AuthApiError"}class O1 extends zv{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ra extends zv{constructor(e,t,s,i){super(e,s,i),this.name=t,this.status=s}}class tr extends ra{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function sT(n){return J(n)&&n.name==="AuthSessionMissingError"}class lf extends ra{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cf extends ra{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class uf extends ra{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function nT(n){return J(n)&&n.name==="AuthImplicitGrantRedirectError"}class kb extends ra{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class k0 extends ra{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function hg(n){return J(n)&&n.name==="AuthRetryableFetchError"}class Nb extends ra{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class N0 extends ra{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Tp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Cb=` 	
\r=`.split(""),iT=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Cb.length;e+=1)n[Cb[e].charCodeAt(0)]=-2;for(let e=0;e<Tp.length;e+=1)n[Tp[e].charCodeAt(0)]=e;return n})();function Tb(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Tp[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Tp[s]),e.queuedBits-=6}}function F1(n,e,t){const s=iT[n];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function jb(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},r=a=>{oT(a,s,t)};for(let a=0;a<n.length;a+=1)F1(n.charCodeAt(a),i,r);return e.join("")}function rT(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function aT(n,e){for(let t=0;t<n.length;t+=1){let s=n.charCodeAt(t);if(s>55295&&s<=56319){const i=(s-55296)*1024&65535;s=(n.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}rT(s,e)}}function oT(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let s=1;s<6;s+=1)if(!(n>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function lT(n){const e=[],t={queue:0,queuedBits:0},s=i=>{e.push(i)};for(let i=0;i<n.length;i+=1)F1(n.charCodeAt(i),t,s);return new Uint8Array(e)}function cT(n){const e=[];return aT(n,t=>e.push(t)),new Uint8Array(e)}function uT(n){const e=[],t={queue:0,queuedBits:0},s=i=>{e.push(i)};return n.forEach(i=>Tb(i,t,s)),Tb(null,t,s),e.join("")}function dT(n){return Math.round(Date.now()/1e3)+n}function hT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const an=()=>typeof window<"u"&&typeof document<"u",oa={tested:!1,writable:!1},$1=()=>{if(!an())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(oa.tested)return oa.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),oa.tested=!0,oa.writable=!0}catch{oa.tested=!0,oa.writable=!1}return oa.writable};function fT(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,r)=>{e[r]=i})}catch{}return t.searchParams.forEach((s,i)=>{e[i]=s}),e}const B1=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Mh(async()=>{const{default:s}=await Promise.resolve().then(()=>zc);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},pT=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Yo=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},la=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},er=async(n,e)=>{await n.removeItem(e)};class Sm{constructor(){this.promise=new Sm.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Sm.promiseConstructor=Promise;function fg(n){const e=n.split(".");if(e.length!==3)throw new N0("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!JC.test(e[s]))throw new N0("JWT not in base64url format");return{header:JSON.parse(jb(e[0])),payload:JSON.parse(jb(e[1])),signature:lT(e[2]),raw:{header:e[0],payload:e[1]}}}async function mT(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function gT(n,e){return new Promise((s,i)=>{(async()=>{for(let r=0;r<1/0;r++)try{const a=await n(r);if(!e(r,null,a)){s(a);return}}catch(a){if(!e(r,a)){i(a);return}}})()})}function yT(n){return("0"+n.toString(16)).substr(-2)}function vT(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let i="";for(let r=0;r<56;r++)i+=t.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(e),Array.from(e,yT).join("")}async function xT(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(s);return Array.from(i).map(r=>String.fromCharCode(r)).join("")}async function bT(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await xT(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wo(n,e,t=!1){const s=vT();let i=s;t&&(i+="/PASSWORD_RECOVERY"),await Yo(n,`${e}-code-verifier`,i);const r=await bT(s);return[r,s===r?"plain":"s256"]}const wT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _T(n){const e=n.headers.get(E0);if(!e||!e.match(wT))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function ST(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function AT(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ET=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function qo(n){if(!ET.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function pg(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Pb(n){return JSON.parse(JSON.stringify(n))}var kT=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};const da=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),NT=[502,503,504];async function Rb(n){var e;if(!pT(n))throw new k0(da(n),0);if(NT.includes(n.status))throw new k0(da(n),n.status);let t;try{t=await n.json()}catch(r){throw new O1(da(r),r)}let s;const i=_T(n);if(i&&i.getTime()>=D1["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new Nb(da(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new tr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0))throw new Nb(da(t),n.status,t.weak_password.reasons);throw new eT(da(t),n.status||500,s)}const CT=(n,e,t,s)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),t))};async function oe(n,e,t,s){var i;const r=Object.assign({},s==null?void 0:s.headers);r[E0]||(r[E0]=D1["2024-01-01"].name),s!=null&&s.jwt&&(r.Authorization=`Bearer ${s.jwt}`);const a=(i=s==null?void 0:s.query)!==null&&i!==void 0?i:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await TT(n,e,t+o,{headers:r,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function TT(n,e,t,s,i,r){const a=CT(e,s,i,r);let o;try{o=await n(t,Object.assign({},a))}catch(c){throw console.error(c),new k0(da(c),0)}if(o.ok||await Rb(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(c){await Rb(c)}}function ai(n){var e;let t=null;IT(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=dT(n.expires_in)));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function Ib(n){const e=ai(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=n.weak_password),e}function or(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function jT(n){return{data:n,error:null}}function PT(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:r}=n,a=kT(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:r},c=Object.assign({},a);return{data:{properties:o,user:c},error:null}}function RT(n){return n}function IT(n){return n.access_token&&n.refresh_token&&n.expires_in}const mg=["global","local","others"];var LT=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};class MT{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=B1(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=mg[0]){if(mg.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${mg.join(", ")}`);try{return await oe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(J(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await oe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:or})}catch(s){if(J(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=LT(e,["options"]),i=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(i.new_email=s==null?void 0:s.newEmail,delete i.newEmail),await oe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:PT,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(J(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await oe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:or})}catch(t){if(J(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,i,r,a,o,c;try{const d={nextPage:null,lastPage:0,total:0},h=await oe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(r=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&r!==void 0?r:""},xform:RT});if(h.error)throw h.error;const f=await h.json(),p=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(c=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(g=>{const b=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(g.split(";")[1].split("=")[1]);d[`${A}Page`]=b}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(J(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){qo(e);try{return await oe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:or})}catch(t){if(J(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){qo(e);try{return await oe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:or})}catch(s){if(J(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){qo(e);try{return await oe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:or})}catch(s){if(J(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){qo(e.userId);try{const{data:t,error:s}=await oe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:s}}catch(t){if(J(t))return{data:null,error:t};throw t}}async _deleteFactor(e){qo(e.userId),qo(e.id);try{return{data:await oe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}}}function Lb(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function DT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Go={debug:!!(globalThis&&$1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class U1 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class OT extends U1{}async function FT(n,e,t){Go.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Go.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){Go.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,i.name);try{return await t()}finally{Go.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,i.name)}}else{if(e===0)throw Go.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new OT(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Go.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}DT();const $T={url:KC,storageKey:YC,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:QC,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Mb(n,e,t){return await t()}const Xo={};class td{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=td.nextInstanceID,td.nextInstanceID+=1,this.instanceID>0&&an()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},$T),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new MT({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=B1(i.fetch),this.lock=i.lock||Mb,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:an()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=FT:this.lock=Mb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:$1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Lb(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Lb(this.memoryStorage)),an()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Xo[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Xo[this.storageKey]=Object.assign(Object.assign({},Xo[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Xo[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Xo[this.storageKey]=Object.assign(Object.assign({},Xo[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${M1}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=fT(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),an()&&this.detectSessionInUrl&&s!=="none"){const{data:i,error:r}=await this._getSessionFromURL(t,s);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),nT(r)){const c=(e=r.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:r}}return await this._removeSession(),{error:r}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return J(t)?{error:t}:{error:new O1("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,i;try{const r=await oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:ai}),{data:a,error:o}=r;if(o||!a)return{data:{user:null,session:null},error:o};const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(r){if(J(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var t,s,i;try{let r;if("email"in e){const{email:h,password:f,options:p}=e;let m=null,g=null;this.flowType==="pkce"&&([m,g]=await Wo(this.storage,this.storageKey)),r=await oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:h,password:f,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:m,code_challenge_method:g},xform:ai})}else if("phone"in e){const{phone:h,password:f,options:p}=e;r=await oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:f,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:ai})}else throw new cf("You must provide either an email or phone number and a password");const{data:a,error:o}=r;if(o||!a)return{data:{user:null,session:null},error:o};const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(r){if(J(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:a,options:o}=e;t=await oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ib})}else if("phone"in e){const{phone:r,password:a,options:o}=e;t=await oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ib})}else throw new cf("You must provide either an email or phone number and a password");const{data:s,error:i}=t;return i?{data:{user:null,session:null},error:i}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new lf}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(t){if(J(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,i,r;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(r=e.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,i,r,a,o,c,d,h,f,p,m;let g,b;if("message"in e)g=e.message,b=e.signature;else{const{chain:A,wallet:x,statement:v,options:S}=e;let E;if(an())if(typeof x=="object")E=x;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))E=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(S!=null&&S.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=x}const C=new URL((t=S==null?void 0:S.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in E&&E.signIn){const N=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S==null?void 0:S.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),v?{statement:v}:null));let k;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")k=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)k=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)g=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),b=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${C.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(i=(s=S==null?void 0:S.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((r=S==null?void 0:S.signInWithSolana)===null||r===void 0)&&r.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((a=S==null?void 0:S.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((o=S==null?void 0:S.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((c=S==null?void 0:S.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((d=S==null?void 0:S.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((f=(h=S==null?void 0:S.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||f===void 0)&&f.length?["Resources",...S.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const N=await E.signMessage(new TextEncoder().encode(g),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=N}}try{const{data:A,error:x}=await oe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:uT(b)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:ai});if(x)throw x;return!A||!A.session||!A.user?{data:{user:null,session:null},error:new lf}:(A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),{data:Object.assign({},A),error:x})}catch(A){if(J(A))return{data:{user:null,session:null},error:A};throw A}}async _exchangeCodeForSession(e){const t=await la(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(t??"").split("/");try{const{data:r,error:a}=await oe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ai});if(await er(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!r||!r.session||!r.user?{data:{user:null,session:null,redirectType:null},error:new lf}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign(Object.assign({},r),{redirectType:i??null}),error:a})}catch(r){if(J(r))return{data:{user:null,session:null,redirectType:null},error:r};throw r}}async signInWithIdToken(e){try{const{options:t,provider:s,token:i,access_token:r,nonce:a}=e,o=await oe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:r,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ai}),{data:c,error:d}=o;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new lf}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(t){if(J(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,i,r,a;try{if("email"in e){const{email:o,options:c}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Wo(this.storage,this.storageKey));const{error:f}=await oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:o,options:c}=e,{data:d,error:h}=await oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:h}}throw new cf("You must provide either an email or phone number.")}catch(o){if(J(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let i,r;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,r=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await oe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:i,xform:ai});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,d=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(J(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,s,i;try{let r=null,a=null;return this.flowType==="pkce"&&([r,a]=await Wo(this.storage,this.storageKey)),await oe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:a}),headers:this.headers,xform:jT})}catch(r){if(J(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new tr;const{error:i}=await oe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(J(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:i,options:r}=e,{error:a}=await oe(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},redirectTo:r==null?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:i,options:r}=e,{data:a,error:o}=await oe(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new cf("You must provide either an email or phone number and a type")}catch(t){if(J(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await la(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<dg:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const a=await la(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=pg()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,h)=>(!a&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,h))})}return{data:{session:e},error:null}}const{session:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:or}):await this._useSession(async t=>{var s,i,r;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new tr}:await oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0,xform:or})})}catch(t){if(J(t))return sT(t)&&(await this._removeSession(),await er(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:i,error:r}=s;if(r)throw r;if(!i.session)throw new tr;const a=i.session;let o=null,c=null;this.flowType==="pkce"&&e.email!=null&&([o,c]=await Wo(this.storage,this.storageKey));const{data:d,error:h}=await oe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:c}),jwt:a.access_token,xform:or});if(h)throw h;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(J(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new tr;const t=Date.now()/1e3;let s=t,i=!0,r=null;const{payload:a}=fg(e.access_token);if(a.exp&&(s=a.exp,i=s<=t),i){const{session:o,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};r=o}else{const{data:o,error:c}=await this._getUser(e.access_token);if(c)throw c;r={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(t){if(J(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new tr;const{session:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(J(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!an())throw new uf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new uf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new kb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new uf("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new kb("No code detected.");const{data:v,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:r,refresh_token:a,expires_in:o,expires_at:c,token_type:d}=e;if(!r||!o||!a||!d)throw new uf("No session defined in URL");const h=Math.round(Date.now()/1e3),f=parseInt(o);let p=h+f;c&&(p=parseInt(c));const m=p-h;m*1e3<=Ko&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const g=p-f;h-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,p,h):h-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,p,h);const{data:b,error:A}=await this._getUser(r);if(A)throw A;const x={provider_token:s,provider_refresh_token:i,access_token:r,expires_in:f,expires_at:p,refresh_token:a,token_type:d,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(s){if(J(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await la(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:i,error:r}=t;if(r)return{error:r};const a=(s=i.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(tT(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await er(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=hT(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,i;try{const{data:{session:r},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(r){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e,t={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await Wo(this.storage,this.storageKey,!0));try{return await oe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(J(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:i}=await this._useSession(async r=>{var a,o,c,d,h;const{data:f,error:p}=r;if(p)throw p;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await oe(this.fetch,"GET",m,{headers:this.headers,jwt:(h=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(i)throw i;return an()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(J(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,i;const{data:r,error:a}=t;if(a)throw a;return await oe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(J(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await gT(async i=>(i>0&&await mT(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await oe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ai})),(i,r)=>{const a=200*Math.pow(2,i);return r&&hg(r)&&Date.now()+a-s<Ko})}catch(s){if(this._debug(t,"error",s),J(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),an()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const i=await la(this.storage,this.storageKey);if(i&&this.userStorage){let a=await la(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Yo(this.userStorage,this.storageKey+"-user",a)),i.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:pg()}else if(i&&!i.user&&!i.user){const a=await la(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await er(this.storage,this.storageKey+"-user"),await Yo(this.storage,this.storageKey,i)):i.user=pg()}if(this._debug(s,"session from storage",i),!this._isValidSession(i)){this._debug(s,"session is not valid"),i!==null&&await this._removeSession();return}const r=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<dg;if(this._debug(s,`session has${r?"":" not"} expired with margin of ${dg}s`),r){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),hg(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(s,"error",i),console.error(i);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new tr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Sm;const{data:r,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!r.session)throw new tr;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const o={session:r.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(r){if(this._debug(i,"error",r),J(r)){const a={session:null,error:r};return hg(r)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(r),r}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,s=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(c){r.push(c)}});if(await Promise.all(a),r.length>0){for(let o=0;o<r.length;o+=1)console.error(r[o]);throw r[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await Yo(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const r=Pb(i);await Yo(this.storage,this.storageKey,r)}else{const i=Pb(t);await Yo(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await er(this.storage,this.storageKey),await er(this.storage,this.storageKey+"-code-verifier"),await er(this.storage,this.storageKey+"-user"),this.userStorage&&await er(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&an()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ko);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-e)/Ko);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Ko}ms, refresh threshold is ${A0} ticks`),i<=A0&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof U1)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!an()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const i=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[r,a]=await Wo(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(s!=null&&s.queryParams){const r=new URLSearchParams(s.queryParams);i.push(r.toString())}return s!=null&&s.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:i,error:r}=t;return r?{data:null,error:r}:await oe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(J(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,i;const{data:r,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await oe(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(J(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:r}=t;if(r)return{data:null,error:r};const{data:a,error:o}=await oe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(J(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:r}=t;return r?{data:null,error:r}:await oe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(J(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],i=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),r=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:i,phone:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:i},error:r}=e;if(r)return{data:null,error:r};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=fg(i.access_token);let o=null;a.aal&&(o=a.aal);let c=o;((s=(t=i.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const h=a.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(o=>o.kid===e);if(s)return s;const i=Date.now();if(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+ZC>i)return s;const{data:r,error:a}=await oe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!r.keys||r.keys.length===0||(this.jwks=r,this.jwks_cached_at=i,s=r.keys.find(o=>o.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:m,error:g}=await this.getSession();if(g||!m.session)return{data:null,error:g};s=m.session.access_token}const{header:i,payload:r,signature:a,raw:{header:o,payload:c}}=fg(s);t!=null&&t.allowExpired||ST(r.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!d){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:r,header:i,signature:a},error:null}}const h=AT(i.alg),f=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,f,a,cT(`${o}.${c}`)))throw new N0("Invalid JWT signature");return{data:{claims:r,header:i,signature:a},error:null}}catch(s){if(J(s))return{data:null,error:s};throw s}}}td.nextInstanceID=0;const BT=td;class UT extends BT{constructor(e){super(e)}}var zT=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{d(s.next(h))}catch(f){a(f)}}function c(h){try{d(s.throw(h))}catch(f){a(f)}}function d(h){h.done?r(h.value):i(h.value).then(o,c)}d((s=s.apply(n,e||[])).next())})};class HT{constructor(e,t,s){var i,r,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=GC(e),c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,h={db:$C,realtime:UC,auth:Object.assign(Object.assign({},BC),{storageKey:d}),global:FC},f=XC(s??{},h);this.storageKey=(i=f.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(r=f.global.headers)!==null&&r!==void 0?r:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=WC(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new rC(new URL("rest/v1",c).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new MC(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new ON(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return zT(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:i,storageKey:r,flowType:a,lock:o,debug:c},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new UT({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),d),storageKey:r,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:i,flowType:a,lock:o,debug:c,fetch:h,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new _C(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const VT=(n,e,t)=>new HT(n,e,t);function WT(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}WT()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const qT="https://lkwrmqpmgkwyvykjqvel.supabase.co",GT="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxrd3JtcXBtZ2t3eXZ5a2pxdmVsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxNTE2NTUsImV4cCI6MjA3MTcyNzY1NX0.Q7XUj3hTLz0XdfnhsrrhrG9EetC7a_5F98nufecKx4Q",Pn=VT(qT,GT),XT=async n=>{const{data:e,error:t}=await Pn.from("applications").insert([n]).select().single();if(t)throw t;return e},z1=async()=>{const{data:n,error:e}=await Pn.from("applications").select("*").order("created_at",{ascending:!1});if(e)throw e;return n},KT=async(n,e)=>{const{data:t,error:s}=await Pn.from("applications").update({...e,updated_at:new Date().toISOString()}).eq("id",n).select().single();if(s)throw s;return t},YT=async n=>{const{error:e}=await Pn.from("applications").delete().eq("id",n);if(e)throw e},Hv=async()=>{const{data:n,error:e}=await Pn.from("lenders").select("*").order("name");if(e)throw e;return n},QT=async n=>{const{data:e,error:t}=await Pn.from("lenders").insert([n]).select().single();if(t)throw t;return e},JT=async(n,e)=>{const{data:t,error:s}=await Pn.from("lenders").update({...e,updated_at:new Date().toISOString()}).eq("id",n).select().single();if(s)throw s;return t},ZT=async n=>{const{error:e}=await Pn.from("lenders").delete().eq("id",n);if(e)throw e},H1=async(n,e)=>{const t=e.map(r=>({application_id:n,lender_id:r,status:"pending"})),{data:s,error:i}=await Pn.from("lender_submissions").insert(t).select();if(i)throw i;return s},C0=async n=>{const{data:e,error:t}=await Pn.from("lender_submissions").select(`
      *,
      lender:lenders(*)
    `).eq("application_id",n);if(t)throw t;return e},ej=async(n,e)=>{const{data:t,error:s}=await Pn.from("lender_submissions").update({...e,updated_at:new Date().toISOString()}).eq("id",n).select().single();if(s)throw s;return t},tj=(n,e)=>n.map(t=>{let s=!0,i=100;return(e.requested_amount<t.min_amount||e.requested_amount>t.max_amount)&&(s=!1,i-=30),(e.credit_score<t.min_credit_score||e.credit_score>t.max_credit_score)&&(s=!1,i-=25),e.years_in_business<t.min_time_in_business&&(s=!1,i-=20),e.monthly_revenue<t.min_monthly_revenue&&(s=!1,i-=15),!t.industries.includes("All Industries")&&!t.industries.includes(e.industry)&&(i-=10),parseFloat(t.factor_rate.split(" - ")[0])<1.15&&(i+=5),(t.approval_time.includes("24 hours")||t.approval_time.includes("2 hours"))&&(i+=3),{...t,qualified:s,matchScore:Math.max(0,i)}});var Du={};Du.d=(n,e)=>{for(var t in e)Du.o(e,t)&&!Du.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};Du.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Q=globalThis.pdfjsLib={};Du.d(Q,{AbortException:()=>Zr,AnnotationEditorLayer:()=>Oy,AnnotationEditorParamsType:()=>de,AnnotationEditorType:()=>ee,AnnotationEditorUIManager:()=>Mo,AnnotationLayer:()=>Y2,AnnotationMode:()=>lr,ColorPicker:()=>Mp,DOMSVGFactory:()=>Jv,DrawLayer:()=>By,FeatureTest:()=>Yt,GlobalWorkerOptions:()=>Bi,ImageKind:()=>Nf,InvalidPDFException:()=>j0,MissingPDFException:()=>sd,OPS:()=>cn,OutputScale:()=>R0,PDFDataRangeTransport:()=>WS,PDFDateString:()=>Xv,PDFWorker:()=>El,PasswordResponses:()=>rj,PermissionFlag:()=>ij,PixelsPerInch:()=>ea,RenderingCancelledException:()=>qv,TextLayer:()=>nd,TouchManager:()=>Ip,UnexpectedResponseException:()=>jp,Util:()=>W,VerbosityLevel:()=>Am,XfaLayer:()=>GS,build:()=>j2,createValidAbsoluteUrl:()=>cj,fetchData:()=>Cm,getDocument:()=>w2,getFilenameFromUrl:()=>vj,getPdfFilenameFromUrl:()=>xj,getXfaPageViewport:()=>bj,isDataScheme:()=>Tm,isPdfFile:()=>Gv,noContextMenu:()=>Tn,normalizeUnicode:()=>mj,setLayerDimensions:()=>Lo,shadow:()=>re,stopEvent:()=>Ps,version:()=>T2});const $t=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),V1=[1,0,0,1,0,0],T0=[.001,0,0,.001,0,0],sj=1e7,gg=1.35,Cs={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},lr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},nj="pdfjs_internal_editor_",ee={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},de={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},ij={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},jt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Nf={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},tt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Zc={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Am={ERRORS:0,WARNINGS:1,INFOS:5},cn={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},rj={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Em=Am.WARNINGS;function aj(n){Number.isInteger(n)&&(Em=n)}function oj(){return Em}function km(n){Em>=Am.INFOS&&console.log(`Info: ${n}`)}function te(n){Em>=Am.WARNINGS&&console.log(`Warning: ${n}`)}function Ae(n){throw new Error(n)}function Ze(n,e){n||Ae(e)}function lj(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function cj(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=pj(n)}catch{}}const s=e?new URL(n,e):new URL(n);if(lj(s))return s}catch{}return null}function re(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const aa=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class Db extends aa{constructor(e,t){super(e,"PasswordException"),this.code=t}}class yg extends aa{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class j0 extends aa{constructor(e){super(e,"InvalidPDFException")}}class sd extends aa{constructor(e){super(e,"MissingPDFException")}}class jp extends aa{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class uj extends aa{constructor(e){super(e,"FormatError")}}class Zr extends aa{constructor(e){super(e,"AbortException")}}function W1(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Ae("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),a=n.subarray(i,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function Nm(n){typeof n!="string"&&Ae("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function dj(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Vv(n){const e=Object.create(null);for(const[t,s]of n)e[t]=s;return e}function hj(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function fj(){try{return new Function(""),!0}catch{return!1}}class Yt{static get isLittleEndian(){return re(this,"isLittleEndian",hj())}static get isEvalSupported(){return re(this,"isEvalSupported",fj())}static get isOffscreenCanvasSupported(){return re(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return re(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?re(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):re(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return re(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const vg=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Vi,Cf,P0;class W{static makeHexColor(e,t,s){return`#${vg[e]}${vg[t]}${vg[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const s=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[s,i]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s;return[i,r]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],r[0],a[0]),Math.min(s[1],i[1],r[1],a[1]),Math.max(s[0],i[0],r[0],a[0]),Math.max(s[1],i[1],r[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(s+a)/2,c=Math.sqrt((s+a)**2-4*(s*a-r*i))/2,d=o+c||1,h=o-c||1;return[Math.sqrt(d),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,i,a]}static bezierBoundingBox(e,t,s,i,r,a,o,c,d){return d?(d[0]=Math.min(d[0],e,o),d[1]=Math.min(d[1],t,c),d[2]=Math.max(d[2],e,o),d[3]=Math.max(d[3],t,c)):d=[Math.min(e,o),Math.min(t,c),Math.max(e,o),Math.max(t,c)],_(this,Vi,P0).call(this,e,s,r,o,t,i,a,c,3*(-e+3*(s-r)+o),6*(e-2*s+r),3*(s-e),d),_(this,Vi,P0).call(this,e,s,r,o,t,i,a,c,3*(-t+3*(i-a)+c),6*(t-2*i+a),3*(i-t),d),d}}Vi=new WeakSet,Cf=function(e,t,s,i,r,a,o,c,d,h){if(d<=0||d>=1)return;const f=1-d,p=d*d,m=p*d,g=f*(f*(f*e+3*d*t)+3*p*s)+m*i,b=f*(f*(f*r+3*d*a)+3*p*o)+m*c;h[0]=Math.min(h[0],g),h[1]=Math.min(h[1],b),h[2]=Math.max(h[2],g),h[3]=Math.max(h[3],b)},P0=function(e,t,s,i,r,a,o,c,d,h,f,p){if(Math.abs(d)<1e-12){Math.abs(h)>=1e-12&&_(this,Vi,Cf).call(this,e,t,s,i,r,a,o,c,-f/h,p);return}const m=h**2-4*f*d;if(m<0)return;const g=Math.sqrt(m),b=2*d;_(this,Vi,Cf).call(this,e,t,s,i,r,a,o,c,(-h+g)/b,p),_(this,Vi,Cf).call(this,e,t,s,i,r,a,o,c,(-h-g)/b,p)},w(W,Vi);function pj(n){return decodeURIComponent(escape(n))}let xg=null,Ob=null;function mj(n){return xg||(xg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ob=new Map([["","t"]])),n.replaceAll(xg,(e,t,s)=>t?t.normalize("NFKC"):Ob.get(s))}function gj(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),W1(n)}const Wv="pdfjs_internal_id_";function yj(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(W1(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const oi="http://www.w3.org/2000/svg",ga=class ga{};K(ga,"CSS",96),K(ga,"PDF",72),K(ga,"PDF_TO_CSS_UNITS",ga.CSS/ga.PDF);let ea=ga;async function Cm(n,e="text"){if(lu(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Fh{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=a,s*=t;const c=(e[2]+e[0])/2,d=(e[3]+e[1])/2;let h,f,p,m;switch(i%=360,i<0&&(i+=360),i){case 180:h=-1,f=0,p=0,m=1;break;case 90:h=0,f=1,p=1,m=0;break;case 270:h=0,f=-1,p=-1,m=0;break;case 0:h=1,f=0,p=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,m=-m);let g,b,A,x;h===0?(g=Math.abs(d-e[1])*s+r,b=Math.abs(c-e[0])*s+a,A=(e[3]-e[1])*s,x=(e[2]-e[0])*s):(g=Math.abs(c-e[0])*s+r,b=Math.abs(d-e[1])*s+a,A=(e[2]-e[0])*s,x=(e[3]-e[1])*s),this.transform=[h*s,f*s,p*s,m*s,g-h*s*c-p*s*d,b-f*s*c-m*s*d],this.width=A,this.height=x}get rawDims(){const{userUnit:e,viewBox:t}=this,s=t.map(i=>i*e);return re(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new Fh({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){return W.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=W.applyTransform([e[0],e[1]],this.transform),s=W.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return W.applyInverseTransform([e,t],this.transform)}}class qv extends aa{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Tm(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function Gv(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function vj(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function xj(n,e="document.pdf"){if(typeof n!="string")return e;if(Tm(n))return te('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class Fb{constructor(){K(this,"started",Object.create(null));K(this,"times",[])}time(e){e in this.started&&te(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||te(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function lu(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function Tn(n){n.preventDefault()}function Ps(n){n.preventDefault(),n.stopPropagation()}var rd;class Xv{static toDateObject(e){if(!e||typeof e!="string")return null;l(this,rd)||y(this,rd,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=l(this,rd).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const d=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,d==="-"?(a+=h,o+=f):d==="+"&&(a-=h,o-=f),new Date(Date.UTC(s,i,r,a,o,c))}}rd=new WeakMap,w(Xv,rd);function bj(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new Fh({viewBox:r,userUnit:1,scale:e,rotation:t})}function Kv(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(te(`Not a valid color format: "${n}"`),[0,0,0])}function wj(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Kv(s))}e.remove()}function Ie(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform();return[e,t,s,i,r,a]}function In(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform().invertSelf();return[e,t,s,i,r,a]}function Lo(n,e,t=!1,s=!0){if(e instanceof Fh){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=n,o=Yt.isCSSRoundSupported,c=`var(--scale-factor) * ${i}px`,d=`var(--scale-factor) * ${r}px`,h=o?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,f=o?`round(down, ${d}, var(--scale-round-y, 1px))`:`calc(${d})`;!t||e.rotation%180===0?(a.width=h,a.height=f):(a.width=f,a.height=h)}s&&n.setAttribute("data-main-rotation",e.rotation)}class R0{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var cr,_a,un,Sa,ad,od,Fp,q1,Qt,G1,X1,Tf,K1,L0;const hi=class hi{constructor(e){w(this,Qt);w(this,cr,null);w(this,_a,null);w(this,un);w(this,Sa,null);w(this,ad,null);y(this,un,e),l(hi,od)||y(hi,od,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=y(this,cr,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=l(this,un)._uiManager._signal;e.addEventListener("contextmenu",Tn,{signal:t}),e.addEventListener("pointerdown",_(hi,Fp,q1),{signal:t});const s=y(this,Sa,document.createElement("div"));s.className="buttons",e.append(s);const i=l(this,un).toolbarPosition;if(i){const{style:r}=e,a=l(this,un)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return _(this,Qt,K1).call(this),e}get div(){return l(this,cr)}hide(){var e;l(this,cr).classList.add("hidden"),(e=l(this,_a))==null||e.hideDropdown()}show(){var e;l(this,cr).classList.remove("hidden"),(e=l(this,ad))==null||e.shown()}async addAltText(e){const t=await e.render();_(this,Qt,Tf).call(this,t),l(this,Sa).prepend(t,l(this,Qt,L0)),y(this,ad,e)}addColorPicker(e){y(this,_a,e);const t=e.renderButton();_(this,Qt,Tf).call(this,t),l(this,Sa).prepend(t,l(this,Qt,L0))}remove(){var e;l(this,cr).remove(),(e=l(this,_a))==null||e.destroy(),y(this,_a,null)}};cr=new WeakMap,_a=new WeakMap,un=new WeakMap,Sa=new WeakMap,ad=new WeakMap,od=new WeakMap,Fp=new WeakSet,q1=function(e){e.stopPropagation()},Qt=new WeakSet,G1=function(e){l(this,un)._focusEventsAllowed=!1,Ps(e)},X1=function(e){l(this,un)._focusEventsAllowed=!0,Ps(e)},Tf=function(e){const t=l(this,un)._uiManager._signal;e.addEventListener("focusin",_(this,Qt,G1).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",_(this,Qt,X1).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Tn,{signal:t})},K1=function(){const{editorType:e,_uiManager:t}=l(this,un),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",l(hi,od)[e]),_(this,Qt,Tf).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),l(this,Sa).append(s)},L0=function(){const e=document.createElement("div");return e.className="divider",e},w(hi,Fp),w(hi,od,null);let I0=hi;var ld,Aa,Ea,ta,Y1,Q1,J1;class _j{constructor(e){w(this,ta);w(this,ld,null);w(this,Aa,null);w(this,Ea);y(this,Ea,e)}show(e,t,s){const[i,r]=_(this,ta,Q1).call(this,t,s),{style:a}=l(this,Aa)||y(this,Aa,_(this,ta,Y1).call(this));e.append(l(this,Aa)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,Aa).remove()}}ld=new WeakMap,Aa=new WeakMap,Ea=new WeakMap,ta=new WeakSet,Y1=function(){const e=y(this,Aa,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Tn,{signal:l(this,Ea)._signal});const t=y(this,ld,document.createElement("div"));return t.className="buttons",e.append(t),_(this,ta,J1).call(this),e},Q1=function(e,t){let s=0,i=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const o=r.x+(t?r.width:0);if(a>s){i=o,s=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,s]},J1=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=l(this,Ea)._signal;e.addEventListener("contextmenu",Tn,{signal:s}),e.addEventListener("click",()=>{l(this,Ea).highlightSelection("floating_button")},{signal:s}),l(this,ld).append(e)};function Pp(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var $p;class Sj{constructor(){w(this,$p,0)}get id(){return`${nj}${Ut(this,$p)._++}`}}$p=new WeakMap;var kl,cd,It,Nl,jf;const ex=class ex{constructor(){w(this,Nl);w(this,kl,gj());w(this,cd,0);w(this,It,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return re(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return _(this,Nl,jf).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return _(this,Nl,jf).call(this,e,e)}async getFromBlob(e,t){const s=await t;return _(this,Nl,jf).call(this,e,s)}async getFromId(e){l(this,It)||y(this,It,new Map);const t=l(this,It).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){l(this,It)||y(this,It,new Map);let s=l(this,It).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${l(this,kl)}_${Ut(this,cd)._++}`,refCounter:1,isSvg:!1},l(this,It).set(e,s),l(this,It).set(s.id,s),s}getSvgUrl(e){const t=l(this,It).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;l(this,It)||y(this,It,new Map);const t=l(this,It).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${l(this,kl)}_`)}};kl=new WeakMap,cd=new WeakMap,It=new WeakMap,Nl=new WeakSet,jf=async function(e,t){l(this,It)||y(this,It,new Map);let s=l(this,It).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,kl)}_${Ut(this,cd)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await Cm(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=ex._isSVGFittingCanvas,a=new FileReader,o=new Image,c=new Promise((d,h)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,d()},a.onload=async()=>{const f=s.svgUrl=a.result;o.src=await r?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=h});a.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){te(i),s=null}return l(this,It).set(e,s),s&&l(this,It).set(s.id,s),s};let M0=ex;var Ge,ur,ud,Oe;class Aj{constructor(e=128){w(this,Ge,[]);w(this,ur,!1);w(this,ud);w(this,Oe,-1);y(this,ud,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),l(this,ur))return;const c={cmd:e,undo:t,post:s,type:r};if(l(this,Oe)===-1){l(this,Ge).length>0&&(l(this,Ge).length=0),y(this,Oe,0),l(this,Ge).push(c);return}if(a&&l(this,Ge)[l(this,Oe)].type===r){o&&(c.undo=l(this,Ge)[l(this,Oe)].undo),l(this,Ge)[l(this,Oe)]=c;return}const d=l(this,Oe)+1;d===l(this,ud)?l(this,Ge).splice(0,1):(y(this,Oe,d),d<l(this,Ge).length&&l(this,Ge).splice(d)),l(this,Ge).push(c)}undo(){if(l(this,Oe)===-1)return;y(this,ur,!0);const{undo:e,post:t}=l(this,Ge)[l(this,Oe)];e(),t==null||t(),y(this,ur,!1),y(this,Oe,l(this,Oe)-1)}redo(){if(l(this,Oe)<l(this,Ge).length-1){y(this,Oe,l(this,Oe)+1),y(this,ur,!0);const{cmd:e,post:t}=l(this,Ge)[l(this,Oe)];e(),t==null||t(),y(this,ur,!1)}}hasSomethingToUndo(){return l(this,Oe)!==-1}hasSomethingToRedo(){return l(this,Oe)<l(this,Ge).length-1}cleanType(e){if(l(this,Oe)!==-1){for(let t=l(this,Oe);t>=0;t--)if(l(this,Ge)[t].type!==e){l(this,Ge).splice(t+1,l(this,Oe)-t),y(this,Oe,t);return}l(this,Ge).length=0,y(this,Oe,-1)}}destroy(){y(this,Ge,null)}}Ge=new WeakMap,ur=new WeakMap,ud=new WeakMap,Oe=new WeakMap;var Bp,Z1;class $h{constructor(e){w(this,Bp);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Yt.platform;for(const[s,i,r={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(_(this,Bp,Z1).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(i.bind(e,...a,t)(),r||Ps(t))}}Bp=new WeakSet,Z1=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Up=class Up{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return wj(e),re(this,"_colors",e)}convert(e){const t=Kv(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,a)=>r===t[a]))return Up._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?W.makeHexColor(...t):e}};K(Up,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let D0=Up;var Cl,gs,it,vt,Tl,mi,jl,$s,dr,ka,Pl,Na,Fn,dn,Ca,dd,hd,Rl,fd,$n,hr,Il,fr,Bn,zp,pr,pd,mr,Ta,md,gd,ut,ve,gi,ja,yd,vd,gr,Un,yi,xd,Bs,O,Pf,O0,eS,tS,Rf,sS,nS,iS,F0,rS,$0,B0,aS,Ht,li,oS,lS,U0,cS,cu,z0;const gl=class gl{constructor(e,t,s,i,r,a,o,c,d,h,f,p,m){w(this,O);w(this,Cl,new AbortController);w(this,gs,null);w(this,it,new Map);w(this,vt,new Map);w(this,Tl,null);w(this,mi,null);w(this,jl,null);w(this,$s,new Aj);w(this,dr,null);w(this,ka,null);w(this,Pl,0);w(this,Na,new Set);w(this,Fn,null);w(this,dn,null);w(this,Ca,new Set);K(this,"_editorUndoBar",null);w(this,dd,!1);w(this,hd,!1);w(this,Rl,!1);w(this,fd,null);w(this,$n,null);w(this,hr,null);w(this,Il,null);w(this,fr,!1);w(this,Bn,null);w(this,zp,new Sj);w(this,pr,!1);w(this,pd,!1);w(this,mr,null);w(this,Ta,null);w(this,md,null);w(this,gd,null);w(this,ut,ee.NONE);w(this,ve,new Set);w(this,gi,null);w(this,ja,null);w(this,yd,null);w(this,vd,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});w(this,gr,[0,0]);w(this,Un,null);w(this,yi,null);w(this,xd,null);w(this,Bs,null);const g=this._signal=l(this,Cl).signal;y(this,yi,e),y(this,xd,t),y(this,Tl,s),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:g}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),i._on("setpreference",this.onSetPreference.bind(this),{signal:g}),i._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:g}),_(this,O,sS).call(this),_(this,O,aS).call(this),_(this,O,F0).call(this),y(this,mi,r.annotationStorage),y(this,fd,r.filterFactory),y(this,ja,a),y(this,Il,o||null),y(this,dd,c),y(this,hd,d),y(this,Rl,h),y(this,gd,f||null),this.viewParameters={realScale:ea.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const e=gl.prototype,t=a=>l(a,yi).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:c}=o;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return re(this,"_keyboardManager",new $h([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,yi).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,yi).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r;(e=l(this,Bs))==null||e.resolve(),y(this,Bs,null),(t=l(this,Cl))==null||t.abort(),y(this,Cl,null),this._signal=null;for(const a of l(this,vt).values())a.destroy();l(this,vt).clear(),l(this,it).clear(),l(this,Ca).clear(),y(this,gs,null),l(this,ve).clear(),l(this,$s).destroy(),(s=l(this,Tl))==null||s.destroy(),(i=l(this,Bn))==null||i.hide(),y(this,Bn,null),l(this,$n)&&(clearTimeout(l(this,$n)),y(this,$n,null)),l(this,Un)&&(clearTimeout(l(this,Un)),y(this,Un,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return l(this,gd)}get useNewAltTextFlow(){return l(this,hd)}get useNewAltTextWhenAddingImage(){return l(this,Rl)}get hcmFilter(){return re(this,"hcmFilter",l(this,ja)?l(this,fd).addHCMFilter(l(this,ja).foreground,l(this,ja).background):"none")}get direction(){return re(this,"direction",getComputedStyle(l(this,yi)).direction)}get highlightColors(){return re(this,"highlightColors",l(this,Il)?new Map(l(this,Il).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return re(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),y(this,ka,e)}setMainHighlightColorPicker(e){y(this,md,e)}editAltText(e,t=!1){var s;(s=l(this,Tl))==null||s.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":y(this,Rl,t);break}}onPageChanging({pageNumber:e}){y(this,Pl,e-1)}focusMainContainer(){l(this,yi).focus()}findParent(e,t){for(const s of l(this,vt).values()){const{x:i,y:r,width:a,height:o}=s.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+o)return s}return null}disableUserSelect(e=!1){l(this,xd).classList.toggle("noUserSelect",e)}addShouldRescale(e){l(this,Ca).add(e)}removeShouldRescale(e){l(this,Ca).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*ea.PDF_TO_CSS_UNITS;for(const s of l(this,Ca))s.onScaleChanging();(t=l(this,ka))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a}=t,o=t.toString(),d=_(this,O,Pf).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(d);if(!h)return;t.empty();const f=_(this,O,O0).call(this,d),p=l(this,ut)===ee.NONE,m=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a,text:o}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(ee.HIGHLIGHT,m);return}m()}addToAnnotationStorage(e){!e.isEmpty()&&l(this,mi)&&!l(this,mi).has(e.id)&&l(this,mi).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,l(this,fr)&&(y(this,fr,!1),_(this,O,Rf).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of l(this,ve))if(t.div.contains(e)){y(this,Ta,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!l(this,Ta))return;const[e,t]=l(this,Ta);y(this,Ta,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){_(this,O,F0).call(this),_(this,O,$0).call(this)}removeEditListeners(){_(this,O,rS).call(this),_(this,O,B0).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of l(this,dn))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of l(this,dn))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=l(this,gs))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of l(this,ve)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of l(this,dn))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){te(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const d=await i.deserialize(c);if(!d)return;r.push(d)}const a=()=>{for(const c of r)_(this,O,U0).call(this,c);_(this,O,z0).call(this,r)},o=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){te(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,ut)!==ee.NONE&&!this.isEditorHandlingKeyboard&&gl._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,fr)&&(y(this,fr,!1),_(this,O,Rf).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(_(this,O,nS).call(this),_(this,O,$0).call(this),_(this,O,Ht).call(this,{isEditing:l(this,ut)!==ee.NONE,isEmpty:_(this,O,cu).call(this),hasSomethingToUndo:l(this,$s).hasSomethingToUndo(),hasSomethingToRedo:l(this,$s).hasSomethingToRedo(),hasSelectedEditor:!1})):(_(this,O,iS).call(this),_(this,O,B0).call(this),_(this,O,Ht).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!l(this,dn)){y(this,dn,e);for(const t of l(this,dn))_(this,O,li).call(this,t.defaultPropertiesToUpdate)}}getId(){return l(this,zp).id}get currentLayer(){return l(this,vt).get(l(this,Pl))}getLayer(e){return l(this,vt).get(e)}get currentPageIndex(){return l(this,Pl)}addLayer(e){l(this,vt).set(e.pageIndex,e),l(this,pr)?e.enable():e.disable()}removeLayer(e){l(this,vt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){var i;if(l(this,ut)!==e&&!(l(this,Bs)&&(await l(this,Bs).promise,!l(this,Bs)))){if(y(this,Bs,Promise.withResolvers()),y(this,ut,e),e===ee.NONE){this.setEditingState(!1),_(this,O,lS).call(this),(i=this._editorUndoBar)==null||i.hide(),l(this,Bs).resolve();return}this.setEditingState(!0),await _(this,O,oS).call(this),this.unselectAll();for(const r of l(this,vt).values())r.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),l(this,Bs).resolve();return}for(const r of l(this,it).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();l(this,Bs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==l(this,ut)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var s;if(l(this,dn)){switch(e){case de.CREATE:this.currentLayer.addNewEditor();return;case de.HIGHLIGHT_DEFAULT_COLOR:(s=l(this,md))==null||s.updateColor(t);break;case de.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,yd)||y(this,yd,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of l(this,ve))i.updateParams(e,t);for(const i of l(this,dn))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const a of l(this,it).values())a.editorType===e&&a.show(t);(((r=l(this,yd))==null?void 0:r.get(de.HIGHLIGHT_SHOW_ALL))??!0)!==t&&_(this,O,li).call(this,[[de.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(l(this,pd)!==e){y(this,pd,e);for(const t of l(this,vt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of l(this,it).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return l(this,it).get(e)}addEditor(e){l(this,it).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(l(this,$n)&&clearTimeout(l(this,$n)),y(this,$n,setTimeout(()=>{this.focusMainContainer(),y(this,$n,null)},0))),l(this,it).delete(e.id),this.unselect(e),(!e.annotationElementId||!l(this,Na).has(e.annotationElementId))&&((t=l(this,mi))==null||t.remove(e.id))}addDeletedAnnotationElement(e){l(this,Na).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return l(this,Na).has(e)}removeDeletedAnnotationElement(e){l(this,Na).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){l(this,gs)!==e&&(y(this,gs,e),e&&_(this,O,li).call(this,e.propertiesToUpdate))}updateUI(e){l(this,O,cS)===e&&_(this,O,li).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){_(this,O,li).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(l(this,ve).has(e)){l(this,ve).delete(e),e.unselect(),_(this,O,Ht).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,ve).add(e),e.select(),_(this,O,li).call(this,e.propertiesToUpdate),_(this,O,Ht).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=l(this,ka))==null||t.commitOrRemove();for(const s of l(this,ve))s!==e&&s.unselect();l(this,ve).clear(),l(this,ve).add(e),e.select(),_(this,O,li).call(this,e.propertiesToUpdate),_(this,O,Ht).call(this,{hasSelectedEditor:!0})}isSelected(e){return l(this,ve).has(e)}get firstSelectedEditor(){return l(this,ve).values().next().value}unselect(e){e.unselect(),l(this,ve).delete(e),_(this,O,Ht).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,ve).size!==0}get isEnterHandled(){return l(this,ve).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;l(this,$s).undo(),_(this,O,Ht).call(this,{hasSomethingToUndo:l(this,$s).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:_(this,O,cu).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){l(this,$s).redo(),_(this,O,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,$s).hasSomethingToRedo(),isEmpty:_(this,O,cu).call(this)})}addCommands(e){l(this,$s).add(e),_(this,O,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:_(this,O,cu).call(this)})}cleanUndoStack(e){l(this,$s).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...l(this,ve)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const a of t)_(this,O,U0).call(this,a)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=l(this,gs))==null||e.commitOrRemove()}hasSomethingToControl(){return l(this,gs)||this.hasSelection}selectAll(){for(const e of l(this,ve))e.commit();_(this,O,z0).call(this,l(this,it).values())}unselectAll(){var e;if(!(l(this,gs)&&(l(this,gs).commitOrRemove(),l(this,ut)!==ee.NONE))&&!((e=l(this,ka))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of l(this,ve))t.unselect();l(this,ve).clear(),_(this,O,Ht).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,gr)[0]+=e,l(this,gr)[1]+=t;const[i,r]=l(this,gr),a=[...l(this,ve)],o=1e3;l(this,Un)&&clearTimeout(l(this,Un)),y(this,Un,setTimeout(()=>{y(this,Un,null),l(this,gr)[0]=l(this,gr)[1]=0,this.addCommands({cmd:()=>{for(const c of a)l(this,it).has(c.id)&&c.translateInPage(i,r)},undo:()=>{for(const c of a)l(this,it).has(c.id)&&c.translateInPage(-i,-r)},mustExec:!1})},o));for(const c of a)c.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),y(this,Fn,new Map);for(const e of l(this,ve))l(this,Fn).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,Fn))return!1;this.disableUserSelect(!1);const e=l(this,Fn);y(this,Fn,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},o]of e)o.newX=i,o.newY=r,o.newPageIndex=a,t||(t=i!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const s=(i,r,a,o)=>{if(l(this,it).has(i.id)){const c=l(this,vt).get(o);c?i._setParentAndPosition(c,r,a):(i.pageIndex=o,i.x=r,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:a,newPageIndex:o}]of e)s(i,r,a,o)},undo:()=>{for(const[i,{savedX:r,savedY:a,savedPageIndex:o}]of e)s(i,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(l(this,Fn))for(const s of l(this,Fn).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||l(this,ve).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return l(this,gs)===e}getActive(){return l(this,gs)}getMode(){return l(this,ut)}get imageManager(){return re(this,"imageManager",new M0)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let d=0,h=t.rangeCount;d<h;d++)if(!e.contains(t.getRangeAt(d).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(d,h,f,p)=>({x:(h-i)/a,y:1-(d+f-s)/r,width:p/a,height:f/r});break;case"180":o=(d,h,f,p)=>({x:1-(d+f-s)/r,y:1-(h+p-i)/a,width:f/r,height:p/a});break;case"270":o=(d,h,f,p)=>({x:1-(h+p-i)/a,y:(d-s)/r,width:p/a,height:f/r});break;default:o=(d,h,f,p)=>({x:(d-s)/r,y:(h-i)/a,width:f/r,height:p/a});break}const c=[];for(let d=0,h=t.rangeCount;d<h;d++){const f=t.getRangeAt(d);if(!f.collapsed)for(const{x:p,y:m,width:g,height:b}of f.getClientRects())g===0||b===0||c.push(o(p,m,g,b))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(l(this,jl)||y(this,jl,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=l(this,jl))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=l(this,jl))==null?void 0:i.get(e.data.id);if(!t)return;const s=l(this,mi).getRawValue(t);s&&(l(this,ut)===ee.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}};Cl=new WeakMap,gs=new WeakMap,it=new WeakMap,vt=new WeakMap,Tl=new WeakMap,mi=new WeakMap,jl=new WeakMap,$s=new WeakMap,dr=new WeakMap,ka=new WeakMap,Pl=new WeakMap,Na=new WeakMap,Fn=new WeakMap,dn=new WeakMap,Ca=new WeakMap,dd=new WeakMap,hd=new WeakMap,Rl=new WeakMap,fd=new WeakMap,$n=new WeakMap,hr=new WeakMap,Il=new WeakMap,fr=new WeakMap,Bn=new WeakMap,zp=new WeakMap,pr=new WeakMap,pd=new WeakMap,mr=new WeakMap,Ta=new WeakMap,md=new WeakMap,gd=new WeakMap,ut=new WeakMap,ve=new WeakMap,gi=new WeakMap,ja=new WeakMap,yd=new WeakMap,vd=new WeakMap,gr=new WeakMap,Un=new WeakMap,yi=new WeakMap,xd=new WeakMap,Bs=new WeakMap,O=new WeakSet,Pf=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},O0=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of l(this,vt).values())if(s.hasTextLayer(e))return s;return null},eS=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=_(this,O,Pf).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(l(this,Bn)||y(this,Bn,new _j(this)),l(this,Bn).show(s,i,this.direction==="ltr"))},tS=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){l(this,gi)&&((r=l(this,Bn))==null||r.hide(),y(this,gi,null),_(this,O,Ht).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===l(this,gi))return;const i=_(this,O,Pf).call(this,e).closest(".textLayer");if(!i){l(this,gi)&&((a=l(this,Bn))==null||a.hide(),y(this,gi,null),_(this,O,Ht).call(this,{hasSelectedText:!1}));return}if((o=l(this,Bn))==null||o.hide(),y(this,gi,t),_(this,O,Ht).call(this,{hasSelectedText:!0}),!(l(this,ut)!==ee.HIGHLIGHT&&l(this,ut)!==ee.NONE)&&(l(this,ut)===ee.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),y(this,fr,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,ut)===ee.HIGHLIGHT?_(this,O,O0).call(this,i):null;c==null||c.toggleDrawing();const d=new AbortController,h=this.combinedSignal(d),f=p=>{p.type==="pointerup"&&p.button!==0||(d.abort(),c==null||c.toggleDrawing(!0),p.type==="pointerup"&&_(this,O,Rf).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:h}),window.addEventListener("blur",f,{signal:h})}},Rf=function(e=""){l(this,ut)===ee.HIGHLIGHT?this.highlightSelection(e):l(this,dd)&&_(this,O,eS).call(this)},sS=function(){document.addEventListener("selectionchange",_(this,O,tS).bind(this),{signal:this._signal})},nS=function(){if(l(this,hr))return;y(this,hr,new AbortController);const e=this.combinedSignal(l(this,hr));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},iS=function(){var e;(e=l(this,hr))==null||e.abort(),y(this,hr,null)},F0=function(){if(l(this,mr))return;y(this,mr,new AbortController);const e=this.combinedSignal(l(this,mr));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},rS=function(){var e;(e=l(this,mr))==null||e.abort(),y(this,mr,null)},$0=function(){if(l(this,dr))return;y(this,dr,new AbortController);const e=this.combinedSignal(l(this,dr));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},B0=function(){var e;(e=l(this,dr))==null||e.abort(),y(this,dr,null)},aS=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Ht=function(e){Object.entries(e).some(([s,i])=>l(this,vd)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,vd),e)}),l(this,ut)===ee.HIGHLIGHT&&e.hasSelectedEditor===!1&&_(this,O,li).call(this,[[de.HIGHLIGHT_FREE,!0]]))},li=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},oS=async function(){if(!l(this,pr)){y(this,pr,!0);const e=[];for(const t of l(this,vt).values())e.push(t.enable());await Promise.all(e);for(const t of l(this,it).values())t.enable()}},lS=function(){if(this.unselectAll(),l(this,pr)){y(this,pr,!1);for(const e of l(this,vt).values())e.disable();for(const e of l(this,it).values())e.disable()}},U0=function(e){const t=l(this,vt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},cS=function(){let e=null;for(e of l(this,ve));return e},cu=function(){if(l(this,it).size===0)return!0;if(l(this,it).size===1)for(const e of l(this,it).values())return e.isEmpty();return!1},z0=function(e){for(const t of l(this,ve))t.unselect();l(this,ve).clear();for(const t of e)t.isEmpty()||(l(this,ve).add(t),t.select());_(this,O,Ht).call(this,{hasSelectedEditor:this.hasSelection})},K(gl,"TRANSLATE_SMALL",1),K(gl,"TRANSLATE_BIG",10);let Mo=gl;var dt,zn,hn,Ll,Hn,ys,Ml,Vn,is,vi,Pa,Wn,yr,En,uu,If;const Vt=class Vt{constructor(e){w(this,En);w(this,dt,null);w(this,zn,!1);w(this,hn,null);w(this,Ll,null);w(this,Hn,null);w(this,ys,null);w(this,Ml,!1);w(this,Vn,null);w(this,is,null);w(this,vi,null);w(this,Pa,null);w(this,Wn,!1);y(this,is,e),y(this,Wn,e._uiManager.useNewAltTextFlow),l(Vt,yr)||y(Vt,yr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Vt._l10n??(Vt._l10n=e)}async render(){const e=y(this,hn,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=y(this,Ll,document.createElement("span"));e.append(t),l(this,Wn)?(e.classList.add("new"),e.setAttribute("data-l10n-id",l(Vt,yr).missing),t.setAttribute("data-l10n-id",l(Vt,yr)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,is)._uiManager._signal;e.addEventListener("contextmenu",Tn,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),l(this,is)._uiManager.editAltText(l(this,is)),l(this,Wn)&&l(this,is)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,En,uu)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(y(this,Ml,!0),i(r))},{signal:s}),await _(this,En,If).call(this),e}finish(){l(this,hn)&&(l(this,hn).focus({focusVisible:l(this,Ml)}),y(this,Ml,!1))}isEmpty(){return l(this,Wn)?l(this,dt)===null:!l(this,dt)&&!l(this,zn)}hasData(){return l(this,Wn)?l(this,dt)!==null||!!l(this,vi):this.isEmpty()}get guessedText(){return l(this,vi)}async setGuessedText(e){l(this,dt)===null&&(y(this,vi,e),y(this,Pa,await Vt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),_(this,En,If).call(this))}toggleAltTextBadge(e=!1){var t;if(!l(this,Wn)||l(this,dt)){(t=l(this,Vn))==null||t.remove(),y(this,Vn,null);return}if(!l(this,Vn)){const s=y(this,Vn,document.createElement("div"));s.className="noAltTextBadge",l(this,is).div.append(s)}l(this,Vn).classList.toggle("hidden",!e)}serialize(e){let t=l(this,dt);return!e&&l(this,vi)===t&&(t=l(this,Pa)),{altText:t,decorative:l(this,zn),guessedText:l(this,vi),textWithDisclaimer:l(this,Pa)}}get data(){return{altText:l(this,dt),decorative:l(this,zn)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(y(this,vi,s),y(this,Pa,i)),!(l(this,dt)===e&&l(this,zn)===t)&&(r||(y(this,dt,e),y(this,zn,t)),_(this,En,If).call(this))}toggle(e=!1){l(this,hn)&&(!e&&l(this,ys)&&(clearTimeout(l(this,ys)),y(this,ys,null)),l(this,hn).disabled=!e)}shown(){l(this,is)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,En,uu)}})}destroy(){var e,t;(e=l(this,hn))==null||e.remove(),y(this,hn,null),y(this,Ll,null),y(this,Hn,null),(t=l(this,Vn))==null||t.remove(),y(this,Vn,null)}};dt=new WeakMap,zn=new WeakMap,hn=new WeakMap,Ll=new WeakMap,Hn=new WeakMap,ys=new WeakMap,Ml=new WeakMap,Vn=new WeakMap,is=new WeakMap,vi=new WeakMap,Pa=new WeakMap,Wn=new WeakMap,yr=new WeakMap,En=new WeakSet,uu=function(){return l(this,dt)&&"added"||l(this,dt)===null&&this.guessedText&&"review"||"missing"},If=async function(){var i,r,a;const e=l(this,hn);if(!e)return;if(l(this,Wn)){if(e.classList.toggle("done",!!l(this,dt)),e.setAttribute("data-l10n-id",l(Vt,yr)[l(this,En,uu)]),(i=l(this,Ll))==null||i.setAttribute("data-l10n-id",l(Vt,yr)[`${l(this,En,uu)}-label`]),!l(this,dt)){(r=l(this,Hn))==null||r.remove();return}}else{if(!l(this,dt)&&!l(this,zn)){e.classList.remove("done"),(a=l(this,Hn))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=l(this,Hn);if(!t){y(this,Hn,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${l(this,is).id}`;const o=100,c=l(this,is)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,ys)),y(this,ys,null)},{once:!0}),e.addEventListener("mouseenter",()=>{y(this,ys,setTimeout(()=>{y(this,ys,null),l(this,Hn).classList.add("show"),l(this,is)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:c}),e.addEventListener("mouseleave",()=>{var d;l(this,ys)&&(clearTimeout(l(this,ys)),y(this,ys,null)),(d=l(this,Hn))==null||d.classList.remove("show")},{signal:c})}l(this,zn)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=l(this,dt)),t.parentNode||e.append(t);const s=l(this,is).getImageForAltText();s==null||s.setAttribute("aria-describedby",t.id)},w(Vt,yr,null),K(Vt,"_l10n",null);let Rp=Vt;var bd,Ra,wd,_d,Sd,Ad,Ed,Dl,xi,Ia,vr,Yi,uS,dS,H0;const tx=class tx{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){w(this,Yi);w(this,bd);w(this,Ra,!1);w(this,wd,null);w(this,_d);w(this,Sd);w(this,Ad);w(this,Ed);w(this,Dl);w(this,xi,null);w(this,Ia);w(this,vr,null);y(this,bd,e),y(this,wd,s),y(this,_d,t),y(this,Sd,i),y(this,Ad,r),y(this,Ed,a),y(this,Ia,new AbortController),y(this,Dl,AbortSignal.any([o,l(this,Ia).signal])),e.addEventListener("touchstart",_(this,Yi,uS).bind(this),{passive:!1,signal:l(this,Dl)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return re(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=l(this,Ia))==null||e.abort(),y(this,Ia,null)}};bd=new WeakMap,Ra=new WeakMap,wd=new WeakMap,_d=new WeakMap,Sd=new WeakMap,Ad=new WeakMap,Ed=new WeakMap,Dl=new WeakMap,xi=new WeakMap,Ia=new WeakMap,vr=new WeakMap,Yi=new WeakSet,uS=function(e){var i,r,a;if((i=l(this,_d))!=null&&i.call(this)||e.touches.length<2)return;if(!l(this,vr)){y(this,vr,new AbortController);const o=AbortSignal.any([l(this,Dl),l(this,vr).signal]),c=l(this,bd),d={signal:o,passive:!1};c.addEventListener("touchmove",_(this,Yi,dS).bind(this),d),c.addEventListener("touchend",_(this,Yi,H0).bind(this),d),c.addEventListener("touchcancel",_(this,Yi,H0).bind(this),d),(r=l(this,Sd))==null||r.call(this)}if(Ps(e),e.touches.length!==2||(a=l(this,wd))!=null&&a.call(this)){y(this,xi,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),y(this,xi,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},dS=function(e){var E;if(!l(this,xi)||e.touches.length!==2)return;let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:a,screenY:o}=s,c=l(this,xi),{touch0X:d,touch0Y:h,touch1X:f,touch1Y:p}=c,m=f-d,g=p-h,b=a-i,A=o-r,x=Math.hypot(b,A)||1,v=Math.hypot(m,g)||1;if(!l(this,Ra)&&Math.abs(v-x)<=tx.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=a,c.touch1Y=o,e.preventDefault(),!l(this,Ra)){y(this,Ra,!0);return}const S=[(i+a)/2,(r+o)/2];(E=l(this,Ad))==null||E.call(this,S,v,x)},H0=function(e){var t;l(this,vr).abort(),y(this,vr,null),(t=l(this,Ed))==null||t.call(this),l(this,xi)&&(e.preventDefault(),y(this,xi,null),y(this,Ra,!1))};let Ip=tx;var La,fn,Te,Ol,xr,kd,Ma,xt,Da,bi,br,Nd,Oa,vs,Cd,Fa,wi,qn,Fl,$l,Us,$a,Td,Hp,Y,V0,jd,W0,Lf,hS,fS,q0,Mf,G0,pS,mS,gS,X0,yS,K0,vS,xS,bS,Y0,du;const ne=class ne{constructor(e){w(this,Y);w(this,La,null);w(this,fn,null);w(this,Te,null);w(this,Ol,!1);w(this,xr,null);w(this,kd,"");w(this,Ma,!1);w(this,xt,null);w(this,Da,null);w(this,bi,null);w(this,br,null);w(this,Nd,"");w(this,Oa,!1);w(this,vs,null);w(this,Cd,!1);w(this,Fa,!1);w(this,wi,!1);w(this,qn,null);w(this,Fl,0);w(this,$l,0);w(this,Us,null);w(this,$a,null);K(this,"_editToolbar",null);K(this,"_initialOptions",Object.create(null));K(this,"_initialData",null);K(this,"_isVisible",!0);K(this,"_uiManager",null);K(this,"_focusEventsAllowed",!0);w(this,Td,!1);w(this,Hp,ne._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,a];const[o,c]=this.parentDimensions;this.x=e.x/o,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ne.prototype._resizeWithKeyboard,t=Mo.TRANSLATE_SMALL,s=Mo.TRANSLATE_BIG;return re(this,"_resizerKeyboardManager",new $h([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],ne.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return re(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Ej({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ne._l10n??(ne._l10n=e),ne._l10nResizer||(ne._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ne._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ne._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ae("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,Td)}set _isDraggable(e){var t;y(this,Td,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,Hp)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):_(this,Y,du).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(l(this,Oa)?y(this,Oa,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,a]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/a,this.fixAndSetPosition()}translate(e,t){_(this,Y,V0).call(this,this.parentDimensions,e,t)}translateInPage(e,t){l(this,vs)||y(this,vs,[this.x,this.y,this.width,this.height]),_(this,Y,V0).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){l(this,vs)||y(this,vs,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[c,d]=this.getBaseTranslation();a+=c,o+=d;const{style:h}=s;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!l(this,vs)&&(l(this,vs)[0]!==this.x||l(this,vs)[1]!==this.y)}get _hasBeenResized(){return!!l(this,vs)&&(l(this,vs)[2]!==this.width||l(this,vs)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=ne,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:a,width:o,height:c}=this;if(o*=s,c*=i,r*=s,a*=i,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(s-o,r)),a=Math.max(0,Math.min(i-c,a));break;case 90:r=Math.max(0,Math.min(s-c,r)),a=Math.min(i,Math.max(o,a));break;case 180:r=Math.min(s,Math.max(o,r)),a=Math.min(i,Math.max(c,a));break;case 270:r=Math.min(s,Math.max(c,r)),a=Math.max(0,Math.min(i-o,a));break}this.x=r/=s,this.y=a/=i;const[d,h]=this.getBaseTranslation();r+=d,a+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return _(s=ne,jd,W0).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return _(s=ne,jd,W0).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,l(this,Ma)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),r=!l(this,Ma)&&t.endsWith("%");if(i&&r)return;const[a,o]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),!l(this,Ma)&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=l(this,Te))==null||e.finish()}async addEditToolbar(){return this._editToolbar||l(this,Fa)?this._editToolbar:(this._editToolbar=new I0(this),this.div.append(this._editToolbar.render()),l(this,Te)&&await this._editToolbar.addAltText(l(this,Te)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=l(this,Te))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,Te)||(Rp.initialize(ne._l10n),y(this,Te,new Rp(this)),l(this,La)&&(l(this,Te).data=l(this,La),y(this,La,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=l(this,Te))==null?void 0:e.data}set altTextData(e){l(this,Te)&&(l(this,Te).data=e)}get guessedAltText(){var e;return(e=l(this,Te))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=l(this,Te))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=l(this,Te))==null?void 0:t.serialize(e)}hasAltText(){return!!l(this,Te)&&!l(this,Te).isEmpty()}hasAltTextData(){var e;return((e=l(this,Te))==null?void 0:e.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=l(this,Ol)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),_(this,Y,K0).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),Pp(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,$a)||y(this,$a,new Ip({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:_(this,Y,pS).bind(this),onPinching:_(this,Y,mS).bind(this),onPinchEnd:_(this,Y,gS).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(e){const{isMac:t}=Yt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(y(this,Oa,!0),this._isDraggable){_(this,Y,yS).call(this,e);return}_(this,Y,X0).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,qn)&&clearTimeout(l(this,qn)),y(this,qn,setTimeout(()=>{var e;y(this,qn,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[o,c]=this.pageTranslation,d=e/i,h=t/i,f=this.x*r,p=this.y*a,m=this.width*r,g=this.height*a;switch(s){case 0:return[f+d+o,a-p-h-g+c,f+d+m+o,a-p-h+c];case 90:return[f+h+o,a-p+d+c,f+h+g+o,a-p+d+m+c];case 180:return[f-d-m+o,a-p+h+c,f-d+o,a-p+h+g+c];case 270:return[f-h-g+o,a-p-d-m+c,f-h+o,a-p-d+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,a]=e,o=r-s,c=a-i;switch(this.rotation){case 0:return[s,t-a,o,c];case 90:return[s,t-i,c,o];case 180:return[r,t-i,o,c];case 270:return[r,t-a,c,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){y(this,Fa,!0)}disableEditMode(){y(this,Fa,!1)}isInEditMode(){return l(this,Fa)}shouldGetKeyboardEvents(){return l(this,wi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&s>0}rebuild(){_(this,Y,K0).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Ae("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,y(i,La,e.accessibilityData);const[r,a]=i.pageDimensions,[o,c,d,h]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/r,i.y=c/a,i.width=d/r,i.height=h/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=l(this,br))==null||e.abort(),y(this,br,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,qn)&&(clearTimeout(l(this,qn)),y(this,qn,null)),_(this,Y,du).call(this),this.removeEditToolbar(),l(this,Us)){for(const s of l(this,Us).values())clearTimeout(s);y(this,Us,null)}this.parent=null,(t=l(this,$a))==null||t.destroy(),y(this,$a,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(_(this,Y,hS).call(this),l(this,xt).classList.remove("hidden"),Pp(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),y(this,bi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=l(this,xt).children;if(!l(this,fn)){y(this,fn,Array.from(t));const a=_(this,Y,vS).bind(this),o=_(this,Y,xS).bind(this),c=this._uiManager._signal;for(const d of l(this,fn)){const h=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",a,{signal:c}),d.addEventListener("blur",o,{signal:c}),d.addEventListener("focus",_(this,Y,bS).bind(this,h),{signal:c}),d.setAttribute("data-l10n-id",ne._l10nResizer[h])}}const s=l(this,fn)[0];let i=0;for(const a of t){if(a===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,fn).length/4);if(r!==i){if(r<i)for(let o=0;o<i-r;o++)l(this,xt).append(l(this,xt).firstChild);else if(r>i)for(let o=0;o<r-i;o++)l(this,xt).firstChild.before(l(this,xt).lastChild);let a=0;for(const o of t){const d=l(this,fn)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",ne._l10nResizer[d])}}_(this,Y,Y0).call(this,0),y(this,wi,!0),l(this,xt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){l(this,wi)&&_(this,Y,G0).call(this,l(this,Nd),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){_(this,Y,du).call(this),this.div.focus()}select(){var e,t,s;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=l(this,Te))==null||s.toggleAltTextBadge(!1)}unselect(){var e,t,s,i,r;(e=l(this,xt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=l(this,Te))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return l(this,Cd)}set isEditing(e){y(this,Cd,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){y(this,Ma,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){l(this,Us)||y(this,Us,new Map);const{action:s}=e;let i=l(this,Us).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),l(this,Us).delete(s),l(this,Us).size===0&&y(this,Us,null)},ne._telemetryTimeout),l(this,Us).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),y(this,Ol,!1)}disable(){this.div&&(this.div.tabIndex=-1),y(this,Ol,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};La=new WeakMap,fn=new WeakMap,Te=new WeakMap,Ol=new WeakMap,xr=new WeakMap,kd=new WeakMap,Ma=new WeakMap,xt=new WeakMap,Da=new WeakMap,bi=new WeakMap,br=new WeakMap,Nd=new WeakMap,Oa=new WeakMap,vs=new WeakMap,Cd=new WeakMap,Fa=new WeakMap,wi=new WeakMap,qn=new WeakMap,Fl=new WeakMap,$l=new WeakMap,Us=new WeakMap,$a=new WeakMap,Td=new WeakMap,Hp=new WeakMap,Y=new WeakSet,V0=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},jd=new WeakSet,W0=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Lf=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},hS=function(){if(l(this,xt))return;y(this,xt,document.createElement("div")),l(this,xt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");l(this,xt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",_(this,Y,fS).bind(this,s),{signal:t}),i.addEventListener("contextmenu",Tn,{signal:t}),i.tabIndex=-1}this.div.prepend(l(this,xt))},fS=function(e,t){var h;t.preventDefault();const{isMac:s}=Yt.platform;if(t.button!==0||t.ctrlKey&&s)return;(h=l(this,Te))==null||h.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,y(this,Da,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",_(this,Y,G0).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Ps,{passive:!1,signal:a}),window.addEventListener("contextmenu",Tn,{signal:a}),y(this,bi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const d=()=>{var f;r.abort(),this.parent.togglePointerEvents(!0),(f=l(this,Te))==null||f.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=c,_(this,Y,Mf).call(this)};window.addEventListener("pointerup",d,{signal:a}),window.addEventListener("blur",d,{signal:a})},q0=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*s,a*i),this.fixAndSetPosition(),this._onResized()},Mf=function(){if(!l(this,bi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=l(this,bi);y(this,bi,null);const r=this.x,a=this.y,o=this.width,c=this.height;r===e&&a===t&&o===s&&c===i||this.addCommands({cmd:_(this,Y,q0).bind(this,r,a,o,c),undo:_(this,Y,q0).bind(this,e,t,s,i),mustExec:!0})},G0=function(e,t){const[s,i]=this.parentDimensions,r=this.x,a=this.y,o=this.width,c=this.height,d=ne.MIN_SIZE/s,h=ne.MIN_SIZE/i,f=_(this,Y,Lf).call(this,this.rotation),p=(L,F)=>[f[0]*L+f[2]*F,f[1]*L+f[3]*F],m=_(this,Y,Lf).call(this,360-this.rotation),g=(L,F)=>[m[0]*L+m[2]*F,m[1]*L+m[3]*F];let b,A,x=!1,v=!1;switch(e){case"topLeft":x=!0,b=(L,F)=>[0,0],A=(L,F)=>[L,F];break;case"topMiddle":b=(L,F)=>[L/2,0],A=(L,F)=>[L/2,F];break;case"topRight":x=!0,b=(L,F)=>[L,0],A=(L,F)=>[0,F];break;case"middleRight":v=!0,b=(L,F)=>[L,F/2],A=(L,F)=>[0,F/2];break;case"bottomRight":x=!0,b=(L,F)=>[L,F],A=(L,F)=>[0,0];break;case"bottomMiddle":b=(L,F)=>[L/2,F],A=(L,F)=>[L/2,0];break;case"bottomLeft":x=!0,b=(L,F)=>[0,F],A=(L,F)=>[L,0];break;case"middleLeft":v=!0,b=(L,F)=>[0,F/2],A=(L,F)=>[L,F/2];break}const S=b(o,c),E=A(o,c);let C=p(...E);const N=ne._round(r+C[0]),k=ne._round(a+C[1]);let T=1,I=1,R,z;if(t.fromKeyboard)({deltaX:R,deltaY:z}=t);else{const{screenX:L,screenY:F}=t,[D,q]=l(this,Da);[R,z]=this.screenToPageTranslation(L-D,F-q),l(this,Da)[0]=L,l(this,Da)[1]=F}if([R,z]=g(R/s,z/i),x){const L=Math.hypot(o,c);T=I=Math.max(Math.min(Math.hypot(E[0]-S[0]-R,E[1]-S[1]-z)/L,1/o,1/c),d/o,h/c)}else v?T=Math.max(d,Math.min(1,Math.abs(E[0]-S[0]-R)))/o:I=Math.max(h,Math.min(1,Math.abs(E[1]-S[1]-z)))/c;const ce=ne._round(o*T),ye=ne._round(c*I);C=p(...A(ce,ye));const ue=N-C[0],qe=k-C[1];l(this,vs)||y(this,vs,[this.x,this.y,this.width,this.height]),this.width=ce,this.height=ye,this.x=ue,this.y=qe,this.setDims(s*ce,i*ye),this.fixAndSetPosition(),this._onResizing()},pS=function(){var e;y(this,bi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=l(this,Te))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},mS=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const a=_(this,Y,Lf).call(this,this.rotation),o=(N,k)=>[a[0]*N+a[2]*k,a[1]*N+a[3]*k],[c,d]=this.parentDimensions,h=this.x,f=this.y,p=this.width,m=this.height,g=ne.MIN_SIZE/c,b=ne.MIN_SIZE/d;r=Math.max(Math.min(r,1/p,1/m),g/p,b/m);const A=ne._round(p*r),x=ne._round(m*r);if(A===p&&x===m)return;l(this,vs)||y(this,vs,[h,f,p,m]);const v=o(p/2,m/2),S=ne._round(h+v[0]),E=ne._round(f+v[1]),C=o(A/2,x/2);this.x=S-C[0],this.y=E-C[1],this.width=A,this.height=x,this.setDims(c*A,d*x),this.fixAndSetPosition(),this._onResizing()},gS=function(){var e;(e=l(this,Te))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),_(this,Y,Mf).call(this)},X0=function(e){const{isMac:t}=Yt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},yS=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},o=d=>{i.abort(),y(this,xr,null),y(this,Oa,!1),this._uiManager.endDragSession()||_(this,Y,X0).call(this,d),s&&this._onStopDragging()};t&&(y(this,Fl,e.clientX),y(this,$l,e.clientY),y(this,xr,e.pointerId),y(this,kd,e.pointerType),window.addEventListener("pointermove",d=>{s||(s=!0,this._onStartDragging());const{clientX:h,clientY:f,pointerId:p}=d;if(p!==l(this,xr)){Ps(d);return}const[m,g]=this.screenToPageTranslation(h-l(this,Fl),f-l(this,$l));y(this,Fl,h),y(this,$l,f),this._uiManager.dragSelectedEditors(m,g)},a),window.addEventListener("touchmove",Ps,a),window.addEventListener("pointerdown",d=>{d.pointerType===l(this,kd)&&(l(this,$a)||d.isPrimary)&&o(d),Ps(d)},a));const c=d=>{if(!l(this,xr)||l(this,xr)===d.pointerId){o(d);return}Ps(d)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},K0=function(){if(l(this,br)||!this.div)return;y(this,br,new AbortController);const e=this._uiManager.combinedSignal(l(this,br));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},vS=function(e){ne._resizerKeyboardManager.exec(this,e)},xS=function(e){var t;l(this,wi)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==l(this,xt)&&_(this,Y,du).call(this)},bS=function(e){y(this,Nd,l(this,wi)?e:"")},Y0=function(e){if(l(this,fn))for(const t of l(this,fn))t.tabIndex=e},du=function(){y(this,wi,!1),_(this,Y,Y0).call(this,-1),_(this,Y,Mf).call(this)},w(ne,jd),K(ne,"_l10n",null),K(ne,"_l10nResizer",null),K(ne,"_borderLineWidth",-1),K(ne,"_colorManager",new D0),K(ne,"_zIndex",1),K(ne,"_telemetryTimeout",1e3);let Be=ne;class Ej extends Be{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const $b=3285377520,Fs=4294901760,Ln=65535;class wS{constructor(e){this.h1=e?e&4294967295:$b,this.h2=e?e&4294967295:$b}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let b=0,A=e.length;b<A;b++){const x=e.charCodeAt(b);x<=255?t[s++]=x:(t[s++]=x>>>8,t[s++]=x&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,c=0,d=this.h1,h=this.h2;const f=3432918353,p=461845907,m=f&Ln,g=p&Ln;for(let b=0;b<i;b++)b&1?(o=a[b],o=o*f&Fs|o*m&Ln,o=o<<15|o>>>17,o=o*p&Fs|o*g&Ln,d^=o,d=d<<13|d>>>19,d=d*5+3864292196):(c=a[b],c=c*f&Fs|c*m&Ln,c=c<<15|c>>>17,c=c*p&Fs|c*g&Ln,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*f&Fs|o*m&Ln,o=o<<15|o>>>17,o=o*p&Fs|o*g&Ln,i&1?d^=o:h^=o}this.h1=d,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Fs|e*36045&Ln,t=t*4283543511&Fs|((t<<16|e>>>16)*2950163797&Fs)>>>16,e^=t>>>1,e=e*444984403&Fs|e*60499&Ln,t=t*3301882366&Fs|((t<<16|e>>>16)*3120437893&Fs)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Q0=Object.freeze({map:null,hash:"",transfer:void 0});var Ba,Ua,ht,Vp,_S;class Yv{constructor(){w(this,Vp);w(this,Ba,!1);w(this,Ua,null);w(this,ht,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=l(this,ht).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return l(this,ht).get(e)}remove(e){if(l(this,ht).delete(e),l(this,ht).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of l(this,ht).values())if(t instanceof Be)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=l(this,ht).get(e);let i=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(i=!0,s[r]=a);else i=!0,l(this,ht).set(e,t);i&&_(this,Vp,_S).call(this),t instanceof Be&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return l(this,ht).has(e)}getAll(){return l(this,ht).size>0?Vv(l(this,ht)):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return l(this,ht).size}resetModified(){l(this,Ba)&&(y(this,Ba,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new SS(this)}get serializable(){if(l(this,ht).size===0)return Q0;const e=new Map,t=new wS,s=[],i=Object.create(null);let r=!1;for(const[a,o]of l(this,ht)){const c=o instanceof Be?o.serialize(!1,i):o;c&&(e.set(a,c),t.update(`${a}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Q0}get editorStats(){let e=null;const t=new Map;for(const s of l(this,ht).values()){if(!(s instanceof Be))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[o,c]of Object.entries(i)){if(o==="type")continue;let d=a.get(o);d||(d=new Map,a.set(o,d));const h=d.get(c)??0;d.set(c,h+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){y(this,Ua,null)}get modifiedIds(){if(l(this,Ua))return l(this,Ua);const e=[];for(const t of l(this,ht).values())!(t instanceof Be)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return y(this,Ua,{ids:new Set(e),hash:e.join(",")})}}Ba=new WeakMap,Ua=new WeakMap,ht=new WeakMap,Vp=new WeakSet,_S=function(){l(this,Ba)||(y(this,Ba,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Pd;class SS extends Yv{constructor(t){super();w(this,Pd);const{map:s,hash:i,transfer:r}=t.serializable,a=structuredClone(s,r?{transfer:r}:null);y(this,Pd,{map:a,hash:i,transfer:r})}get print(){Ae("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,Pd)}get modifiedIds(){return re(this,"modifiedIds",{ids:new Set,hash:""})}}Pd=new WeakMap;var Bl;class kj{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){w(this,Bl,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),l(this,Bl).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||l(this,Bl).has(e.loadedName))){if(Ze(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:r}=e,a=new FontFace(s,i,r);this.addNativeFontFace(a);try{await a.load(),l(this,Bl).add(s),t==null||t(e)}catch{te(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Ae("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw te(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return re(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return($t||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),re(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Ze(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return re(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(E,C){return E.charCodeAt(C)<<24|E.charCodeAt(C+1)<<16|E.charCodeAt(C+2)<<8|E.charCodeAt(C+3)&255}function i(E,C,N,k){const T=E.substring(0,C),I=E.substring(C+N);return T+k+I}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const c=o.getContext("2d");let d=0;function h(E,C){if(++d>30){te("Load test font never loaded."),C();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(h.bind(null,E,C))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=i(p,976,f.length,f);const g=16,b=1482184792;let A=s(p,g);for(r=0,a=f.length-3;r<a;r+=4)A=A-b+s(f,r)|0;r<f.length&&(A=A-b+s(f+"XXX",r)|0),p=i(p,g,4,dj(A));const x=`url(data:font/opentype;base64,${btoa(p)});`,v=`@font-face {font-family:"${f}";src:${x}}`;this.insertRule(v);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const E of[e.loadedName,f]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=E,S.append(C)}this._document.body.append(S),h(f,()=>{S.remove(),t.complete()})}}Bl=new WeakMap;class Nj{constructor(e,{disableFontFace:t=!1,fontExtraProperties:s=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this.fontExtraProperties=s===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${yj(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(a){te(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}}const df={DATA:1,ERROR:2},Qe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Bb(){}function ss(n){if(n instanceof Zr||n instanceof j0||n instanceof sd||n instanceof Db||n instanceof jp||n instanceof yg)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Ae('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Zr(n.message);case"InvalidPDFException":return new j0(n.message);case"MissingPDFException":return new sd(n.message);case"PasswordException":return new Db(n.message,n.code);case"UnexpectedResponseException":return new jp(n.message,n.status);case"UnknownErrorException":return new yg(n.message,n.details)}return new yg(n.message,n.toString())}var Ul,Js,AS,ES,kS,Df;class hu{constructor(e,t,s){w(this,Js);w(this,Ul,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",_(this,Js,AS).bind(this),{signal:l(this,Ul).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,a=this.sourceName,o=this.targetName,c=this.comObj;return new ReadableStream({start:d=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:d,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:d.desiredSize},i),h.promise},pull:d=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,c.postMessage({sourceName:a,targetName:o,stream:Qe.PULL,streamId:r,desiredSize:d.desiredSize}),h.promise},cancel:d=>{Ze(d instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:o,stream:Qe.CANCEL,streamId:r,reason:ss(d)}),h.promise}},s)}destroy(){var e;(e=l(this,Ul))==null||e.abort(),y(this,Ul,null)}}Ul=new WeakMap,Js=new WeakSet,AS=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){_(this,Js,kS).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===df.DATA)i.resolve(e.data);else if(e.callback===df.ERROR)i.reject(ss(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:i,callback:df.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:i,callback:df.ERROR,callbackId:e.callbackId,reason:ss(a)})});return}if(e.streamId){_(this,Js,ES).call(this,e);return}t(e.data)},ES=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],c={enqueue(d,h=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=h,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:Qe.ENQUEUE,streamId:t,chunk:d},f)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Qe.CLOSE,streamId:t}),delete a.streamSinks[t])},error(d){Ze(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Qe.ERROR,streamId:t,reason:ss(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(o,e.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Qe.START_COMPLETE,streamId:t,success:!0})},function(d){r.postMessage({sourceName:s,targetName:i,stream:Qe.START_COMPLETE,streamId:t,reason:ss(d)})})},kS=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Qe.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ss(e.reason));break;case Qe.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ss(e.reason));break;case Qe.PULL:if(!o){r.postMessage({sourceName:s,targetName:i,stream:Qe.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||Bb).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Qe.PULL_COMPLETE,streamId:t,success:!0})},function(d){r.postMessage({sourceName:s,targetName:i,stream:Qe.PULL_COMPLETE,streamId:t,reason:ss(d)})});break;case Qe.ENQUEUE:if(Ze(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Qe.CLOSE:if(Ze(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),_(this,Js,Df).call(this,a,t);break;case Qe.ERROR:Ze(a,"error should have stream controller"),a.controller.error(ss(e.reason)),_(this,Js,Df).call(this,a,t);break;case Qe.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ss(e.reason)),_(this,Js,Df).call(this,a,t);break;case Qe.CANCEL:if(!o)break;const c=ss(e.reason);Promise.try(o.onCancel||Bb,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Qe.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){r.postMessage({sourceName:s,targetName:i,stream:Qe.CANCEL_COMPLETE,streamId:t,reason:ss(d)})}),o.sinkCapability.reject(c),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Df=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var Rd;class NS{constructor({enableHWA:e=!1}){w(this,Rd,!1);y(this,Rd,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,Rd)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ae("Abstract method `_createCanvas` called.")}}Rd=new WeakMap;class Cj extends NS{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class CS{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ae("Abstract method `_fetch` called.")}}class TS extends CS{async _fetch(e){const t=await Cm(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Nm(t)}}class jS{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var za,zl,_i,Si,Lt,Ha,Va,$,Pt,fu,Qo,Of,Jo,PS,J0,Zo,pu,mu,Z0,gu;class Tj extends jS{constructor({docId:t,ownerDocument:s=globalThis.document}){super();w(this,$);w(this,za);w(this,zl);w(this,_i);w(this,Si);w(this,Lt);w(this,Ha);w(this,Va,0);y(this,Si,t),y(this,Lt,s)}addFilter(t){if(!t)return"none";let s=l(this,$,Pt).get(t);if(s)return s;const[i,r,a]=_(this,$,Of).call(this,t),o=t.length===1?i:`${i}${r}${a}`;if(s=l(this,$,Pt).get(o),s)return l(this,$,Pt).set(t,s),s;const c=`g_${l(this,Si)}_transfer_map_${Ut(this,Va)._++}`,d=_(this,$,Jo).call(this,c);l(this,$,Pt).set(t,d),l(this,$,Pt).set(o,d);const h=_(this,$,Zo).call(this,c);return _(this,$,mu).call(this,i,r,a,h),d}addHCMFilter(t,s){var g;const i=`${t}-${s}`,r="base";let a=l(this,$,fu).get(r);if((a==null?void 0:a.key)===i||(a?((g=a.filter)==null||g.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},l(this,$,fu).set(r,a)),!t||!s))return a.url;const o=_(this,$,gu).call(this,t);t=W.makeHexColor(...o);const c=_(this,$,gu).call(this,s);if(s=W.makeHexColor(...c),l(this,$,Qo).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const d=new Array(256);for(let b=0;b<=255;b++){const A=b/255;d[b]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const h=d.join(","),f=`g_${l(this,Si)}_hcm_filter`,p=a.filter=_(this,$,Zo).call(this,f);_(this,$,mu).call(this,h,h,h,p),_(this,$,J0).call(this,p);const m=(b,A)=>{const x=o[b]/255,v=c[b]/255,S=new Array(A+1);for(let E=0;E<=A;E++)S[E]=x+E/A*(v-x);return S.join(",")};return _(this,$,mu).call(this,m(0,5),m(1,5),m(2,5),p),a.url=_(this,$,Jo).call(this,f),a.url}addAlphaFilter(t){let s=l(this,$,Pt).get(t);if(s)return s;const[i]=_(this,$,Of).call(this,[t]),r=`alpha_${i}`;if(s=l(this,$,Pt).get(r),s)return l(this,$,Pt).set(t,s),s;const a=`g_${l(this,Si)}_alpha_map_${Ut(this,Va)._++}`,o=_(this,$,Jo).call(this,a);l(this,$,Pt).set(t,o),l(this,$,Pt).set(r,o);const c=_(this,$,Zo).call(this,a);return _(this,$,Z0).call(this,i,c),o}addLuminosityFilter(t){let s=l(this,$,Pt).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=_(this,$,Of).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=l(this,$,Pt).get(r),s)return l(this,$,Pt).set(t,s),s;const a=`g_${l(this,Si)}_luminosity_map_${Ut(this,Va)._++}`,o=_(this,$,Jo).call(this,a);l(this,$,Pt).set(t,o),l(this,$,Pt).set(r,o);const c=_(this,$,Zo).call(this,a);return _(this,$,PS).call(this,c),t&&_(this,$,Z0).call(this,i,c),o}addHighlightHCMFilter(t,s,i,r,a){var v;const o=`${s}-${i}-${r}-${a}`;let c=l(this,$,fu).get(t);if((c==null?void 0:c.key)===o||(c?((v=c.filter)==null||v.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},l(this,$,fu).set(t,c)),!s||!i))return c.url;const[d,h]=[s,i].map(_(this,$,gu).bind(this));let f=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[m,g]=[r,a].map(_(this,$,gu).bind(this));p<f&&([f,p,m,g]=[p,f,g,m]),l(this,$,Qo).style.color="";const b=(S,E,C)=>{const N=new Array(256),k=(p-f)/C,T=S/255,I=(E-S)/(255*C);let R=0;for(let z=0;z<=C;z++){const ce=Math.round(f+z*k),ye=T+z*I;for(let ue=R;ue<=ce;ue++)N[ue]=ye;R=ce+1}for(let z=R;z<256;z++)N[z]=N[R-1];return N.join(",")},A=`g_${l(this,Si)}_hcm_${t}_filter`,x=c.filter=_(this,$,Zo).call(this,A);return _(this,$,J0).call(this,x),_(this,$,mu).call(this,b(m[0],g[0],5),b(m[1],g[1],5),b(m[2],g[2],5),x),c.url=_(this,$,Jo).call(this,A),c.url}destroy(t=!1){var s,i,r,a;t&&((s=l(this,Ha))!=null&&s.size)||((i=l(this,_i))==null||i.parentNode.parentNode.remove(),y(this,_i,null),(r=l(this,zl))==null||r.clear(),y(this,zl,null),(a=l(this,Ha))==null||a.clear(),y(this,Ha,null),y(this,Va,0))}}za=new WeakMap,zl=new WeakMap,_i=new WeakMap,Si=new WeakMap,Lt=new WeakMap,Ha=new WeakMap,Va=new WeakMap,$=new WeakSet,Pt=function(){return l(this,zl)||y(this,zl,new Map)},fu=function(){return l(this,Ha)||y(this,Ha,new Map)},Qo=function(){if(!l(this,_i)){const t=l(this,Lt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=l(this,Lt).createElementNS(oi,"svg");i.setAttribute("width",0),i.setAttribute("height",0),y(this,_i,l(this,Lt).createElementNS(oi,"defs")),t.append(i),i.append(l(this,_i)),l(this,Lt).body.append(t)}return l(this,_i)},Of=function(t){if(t.length===1){const d=t[0],h=new Array(256);for(let p=0;p<256;p++)h[p]=d[p]/255;const f=h.join(",");return[f,f,f]}const[s,i,r]=t,a=new Array(256),o=new Array(256),c=new Array(256);for(let d=0;d<256;d++)a[d]=s[d]/255,o[d]=i[d]/255,c[d]=r[d]/255;return[a.join(","),o.join(","),c.join(",")]},Jo=function(t){if(l(this,za)===void 0){y(this,za,"");const s=l(this,Lt).URL;s!==l(this,Lt).baseURI&&(Tm(s)?te('#createUrl: ignore "data:"-URL for performance reasons.'):y(this,za,s.split("#",1)[0]))}return`url(${l(this,za)}#${t})`},PS=function(t){const s=l(this,Lt).createElementNS(oi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},J0=function(t){const s=l(this,Lt).createElementNS(oi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Zo=function(t){const s=l(this,Lt).createElementNS(oi,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),l(this,$,Qo).append(s),s},pu=function(t,s,i){const r=l(this,Lt).createElementNS(oi,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},mu=function(t,s,i,r){const a=l(this,Lt).createElementNS(oi,"feComponentTransfer");r.append(a),_(this,$,pu).call(this,a,"feFuncR",t),_(this,$,pu).call(this,a,"feFuncG",s),_(this,$,pu).call(this,a,"feFuncB",i)},Z0=function(t,s){const i=l(this,Lt).createElementNS(oi,"feComponentTransfer");s.append(i),_(this,$,pu).call(this,i,"feFuncA",t)},gu=function(t){return l(this,$,Qo).style.color=t,Kv(getComputedStyle(l(this,$,Qo)).getPropertyValue("color"))};class RS{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ae("Abstract method `_fetch` called.")}}class IS extends RS{async _fetch(e){const t=await Cm(e,"arraybuffer");return new Uint8Array(t)}}$t&&te("Please use the `legacy` build in Node.js environments.");async function LS(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class jj extends jS{}class Pj extends NS{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class Rj extends CS{async _fetch(e){return LS(e)}}class Ij extends RS{async _fetch(e){return LS(e)}}const Ot={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function ey(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class Qv{getPattern(){Ae("Abstract method `getPattern` called.")}}class Lj extends Qv{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Ot.STROKE||i===Ot.FILL){const a=t.current.getClippedPathBoundingBox(i,Ie(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,d=t.cachedCanvases.getCanvas("pattern",o,c),h=d.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),s=W.transform(s,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),ey(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(d.canvas,"no-repeat");const f=new DOMMatrix(s);r.setTransform(f)}else ey(e,this._bbox),r=this._createGradient(e);return r}}function bg(n,e,t,s,i,r,a,o){const c=e.coords,d=e.colors,h=n.data,f=n.width*4;let p;c[t+1]>c[s+1]&&(p=t,t=s,s=p,p=r,r=a,a=p),c[s+1]>c[i+1]&&(p=s,s=i,i=p,p=a,a=o,o=p),c[t+1]>c[s+1]&&(p=t,t=s,s=p,p=r,r=a,a=p);const m=(c[t]+e.offsetX)*e.scaleX,g=(c[t+1]+e.offsetY)*e.scaleY,b=(c[s]+e.offsetX)*e.scaleX,A=(c[s+1]+e.offsetY)*e.scaleY,x=(c[i]+e.offsetX)*e.scaleX,v=(c[i+1]+e.offsetY)*e.scaleY;if(g>=v)return;const S=d[r],E=d[r+1],C=d[r+2],N=d[a],k=d[a+1],T=d[a+2],I=d[o],R=d[o+1],z=d[o+2],ce=Math.round(g),ye=Math.round(v);let ue,qe,L,F,D,q,X,se;for(let ae=ce;ae<=ye;ae++){if(ae<A){const me=ae<g?0:(g-ae)/(g-A);ue=m-(m-b)*me,qe=S-(S-N)*me,L=E-(E-k)*me,F=C-(C-T)*me}else{let me;ae>v?me=1:A===v?me=0:me=(A-ae)/(A-v),ue=b-(b-x)*me,qe=N-(N-I)*me,L=k-(k-R)*me,F=T-(T-z)*me}let Se;ae<g?Se=0:ae>v?Se=1:Se=(g-ae)/(g-v),D=m-(m-x)*Se,q=S-(S-I)*Se,X=E-(E-R)*Se,se=C-(C-z)*Se;const Nt=Math.round(Math.min(ue,D)),sn=Math.round(Math.max(ue,D));let Pe=f*ae+Nt*4;for(let me=Nt;me<=sn;me++)Se=(ue-me)/(ue-D),Se<0?Se=0:Se>1&&(Se=1),h[Pe++]=qe-(qe-q)*Se|0,h[Pe++]=L-(L-X)*Se|0,h[Pe++]=F-(F-se)*Se|0,h[Pe++]=255}}function Mj(n,e,t){const s=e.coords,i=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,c=Math.floor(s.length/o)-1,d=o-1;for(r=0;r<c;r++){let h=r*o;for(let f=0;f<d;f++,h++)bg(n,t,s[h],s[h+1],s[h+o],i[h],i[h+1],i[h+o]),bg(n,t,s[h+o+1],s[h+1],s[h+o],i[h+o+1],i[h+1],i[h+o])}break;case"triangles":for(r=0,a=s.length;r<a;r+=3)bg(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class Dj extends Qv{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-c,f=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),m=d/f,g=h/p,b={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-c,scaleX:1/m,scaleY:1/g},A=f+2*2,x=p+2*2,v=s.getCanvas("mesh",A,x),S=v.context,E=S.createImageData(f,p);if(t){const N=E.data;for(let k=0,T=N.length;k<T;k+=4)N[k]=t[0],N[k+1]=t[1],N[k+2]=t[2],N[k+3]=255}for(const N of this._figures)Mj(E,N,b);return S.putImageData(E,2,2),{canvas:v.canvas,offsetX:o-2*m,offsetY:c-2*g,scaleX:m,scaleY:g}}getPattern(e,t,s,i){ey(e,this._bbox);let r;if(i===Ot.SHADING)r=W.singularValueDecompose2dScale(Ie(e));else if(r=W.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=W.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,i===Ot.SHADING?null:this._background,t.cachedCanvases);return i!==Ot.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class Oj extends Qv{getPattern(){return"hotpink"}}function Fj(n){switch(n[0]){case"RadialAxial":return new Lj(n);case"Mesh":return new Dj(n);case"Dummy":return new Oj}throw new Error(`Unknown IR type: ${n[0]}`)}const Ub={COLORED:1,UNCOLORED:2},Wp=class Wp{constructor(e,t,s,i,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:c,ystep:d}=this;c=Math.abs(c),d=Math.abs(d),km("TilingType: "+r);const h=t[0],f=t[1],p=t[2],m=t[3],g=p-h,b=m-f,A=W.singularValueDecompose2dScale(this.matrix),x=W.singularValueDecompose2dScale(this.baseTransform),v=A[0]*x[0],S=A[1]*x[1];let E=g,C=b,N=!1,k=!1;const T=Math.ceil(c*v),I=Math.ceil(d*S),R=Math.ceil(g*v),z=Math.ceil(b*S);T>=R?E=c:N=!0,I>=z?C=d:k=!0;const ce=this.getSizeAndScale(E,this.ctx.canvas.width,v),ye=this.getSizeAndScale(C,this.ctx.canvas.height,S),ue=e.cachedCanvases.getCanvas("pattern",ce.size,ye.size),qe=ue.context,L=o.createCanvasGraphics(qe);if(L.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(L,i,a),qe.translate(-ce.scale*h,-ye.scale*f),L.transform(ce.scale,0,0,ye.scale,0,0),qe.save(),this.clipBbox(L,h,f,p,m),L.baseTransform=Ie(L.ctx),L.executeOperatorList(s),L.endDrawing(),qe.restore(),N||k){const F=ue.canvas;N&&(E=c),k&&(C=d);const D=this.getSizeAndScale(E,this.ctx.canvas.width,v),q=this.getSizeAndScale(C,this.ctx.canvas.height,S),X=D.size,se=q.size,ae=e.cachedCanvases.getCanvas("pattern-workaround",X,se),Se=ae.context,Nt=N?Math.floor(g/c):0,sn=k?Math.floor(b/d):0;for(let Pe=0;Pe<=Nt;Pe++)for(let me=0;me<=sn;me++)Se.drawImage(F,X*Pe,se*me,X,se,0,0,X,se);return{canvas:ae.canvas,scaleX:D.scale,scaleY:q.scale,offsetX:h,offsetY:f}}return{canvas:ue.canvas,scaleX:ce.scale,scaleY:ye.scale,offsetX:h,offsetY:f}}getSizeAndScale(e,t,s){const i=Math.max(Wp.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const a=i-t,o=r-s;e.ctx.rect(t,s,a,o),e.current.updateRectMinMax(Ie(e.ctx),[t,s,i,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case Ub.COLORED:const a=this.ctx;i.fillStyle=a.fillStyle,i.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case Ub.UNCOLORED:const o=W.makeHexColor(s[0],s[1],s[2]);i.fillStyle=o,i.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new uj(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,i){let r=s;i!==Ot.SHADING&&(r=W.transform(r,t.baseTransform),this.matrix&&(r=W.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const c=e.createPattern(a.canvas,"repeat");return c.setTransform(o),c}};K(Wp,"MAX_PATTERN_SIZE",3e3);let ty=Wp;function $j({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=Yt.isLittleEndian?4278190080:255,[c,d]=a?[r,o]:[o,r],h=s>>3,f=s&7,p=n.length;t=new Uint32Array(t.buffer);let m=0;for(let g=0;g<i;g++){for(const A=e+h;e<A;e++){const x=e<p?n[e]:255;t[m++]=x&128?d:c,t[m++]=x&64?d:c,t[m++]=x&32?d:c,t[m++]=x&16?d:c,t[m++]=x&8?d:c,t[m++]=x&4?d:c,t[m++]=x&2?d:c,t[m++]=x&1?d:c}if(f===0)continue;const b=e<p?n[e++]:255;for(let A=0;A<f;A++)t[m++]=b&1<<7-A?d:c}return{srcPos:e,destPos:m}}const zb=16,Hb=100,Bj=15,Vb=10,Wb=1e3,os=16;function Uj(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(s,i){e.translate(s,i),this.__originalTranslate(s,i)},n.scale=function(s,i){e.scale(s,i),this.__originalScale(s,i)},n.transform=function(s,i,r,a,o,c){e.transform(s,i,r,a,o,c),this.__originalTransform(s,i,r,a,o,c)},n.setTransform=function(s,i,r,a,o,c){e.setTransform(s,i,r,a,o,c),this.__originalSetTransform(s,i,r,a,o,c)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(s){e.rotate(s),this.__originalRotate(s)},n.clip=function(s){e.clip(s),this.__originalClip(s)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,a,o){e.bezierCurveTo(t,s,i,r,a,o),this.__originalBezierCurveTo(t,s,i,r,a,o)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class zj{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function hf(n,e,t,s,i,r,a,o,c,d){const[h,f,p,m,g,b]=Ie(n);if(f===0&&p===0){const v=a*h+g,S=Math.round(v),E=o*m+b,C=Math.round(E),N=(a+c)*h+g,k=Math.abs(Math.round(N)-S)||1,T=(o+d)*m+b,I=Math.abs(Math.round(T)-C)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(m),S,C),n.drawImage(e,t,s,i,r,0,0,k,I),n.setTransform(h,f,p,m,g,b),[k,I]}if(h===0&&m===0){const v=o*p+g,S=Math.round(v),E=a*f+b,C=Math.round(E),N=(o+d)*p+g,k=Math.abs(Math.round(N)-S)||1,T=(a+c)*f+b,I=Math.abs(Math.round(T)-C)||1;return n.setTransform(0,Math.sign(f),Math.sign(p),0,S,C),n.drawImage(e,t,s,i,r,0,0,I,k),n.setTransform(h,f,p,m,g,b),[I,k]}n.drawImage(e,t,s,i,r,a,o,c,d);const A=Math.hypot(h,f),x=Math.hypot(p,m);return[A*c,x*d]}function Hj(n){const{width:e,height:t}=n;if(e>Wb||t>Wb)return null;const s=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let a=new Uint8Array(r*(t+1)),o,c,d;const h=e+7&-8;let f=new Uint8Array(h*t),p=0;for(const x of n.data){let v=128;for(;v>0;)f[p++]=x&v?0:255,v>>=1}let m=0;for(p=0,f[p]!==0&&(a[0]=1,++m),c=1;c<e;c++)f[p]!==f[p+1]&&(a[c]=f[p]?2:1,++m),p++;for(f[p]!==0&&(a[c]=2,++m),o=1;o<t;o++){p=o*h,d=o*r,f[p-h]!==f[p]&&(a[d]=f[p]?1:8,++m);let x=(f[p]?4:0)+(f[p-h]?8:0);for(c=1;c<e;c++)x=(x>>2)+(f[p+1]?4:0)+(f[p-h+1]?8:0),i[x]&&(a[d+c]=i[x],++m),p++;if(f[p-h]!==f[p]&&(a[d+c]=f[p]?2:4,++m),m>s)return null}for(p=h*(t-1),d=o*r,f[p]!==0&&(a[d]=8,++m),c=1;c<e;c++)f[p]!==f[p+1]&&(a[d+c]=f[p]?4:8,++m),p++;if(f[p]!==0&&(a[d+c]=4,++m),m>s)return null;const g=new Int32Array([0,r,-1,0,-r,0,0,0,1]),b=new Path2D;for(o=0;m&&o<=t;o++){let x=o*r;const v=x+e;for(;x<v&&!a[x];)x++;if(x===v)continue;b.moveTo(x%r,o);const S=x;let E=a[x];do{const C=g[E];do x+=C;while(!a[x]);const N=a[x];N!==5&&N!==10?(E=N,a[x]=0):(E=N&51*E>>4,a[x]&=E>>2|E<<2),b.lineTo(x%r,x/r|0),a[x]||--m}while(S!==x);--o}return f=null,a=null,function(x){x.save(),x.scale(1/e,-1/t),x.translate(0,-t),x.fill(b),x.beginPath(),x.restore()}}class qb{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=V1,this.textMatrixScale=1,this.fontMatrix=T0,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=jt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=W.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=W.applyTransform(t,e),i=W.applyTransform(t.slice(2),e),r=W.applyTransform([t[0],t[3]],e),a=W.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],i[0],r[0],a[0]),this.minY=Math.min(this.minY,s[1],i[1],r[1],a[1]),this.maxX=Math.max(this.maxX,s[0],i[0],r[0],a[0]),this.maxY=Math.max(this.maxY,s[1],i[1],r[1],a[1])}updateScalingPathMinMax(e,t){W.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,r,a,o,c,d,h){const f=W.bezierBoundingBox(t,s,i,r,a,o,c,d,h);h||this.updateRectMinMax(e,f)}getPathBoundingBox(e=Ot.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Ot.STROKE){t||Ae("Stroke bounding box must include transform.");const i=W.singularValueDecompose2dScale(t),r=i[0]*this.lineWidth/2,a=i[1]*this.lineWidth/2;s[0]-=r,s[1]-=a,s[2]+=r,s[3]+=a}return s}updateClipFromPath(){const e=W.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Ot.FILL,t=null){return W.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Gb(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%os,r=(t-i)/os,a=i===0?r:r+1,o=n.createImageData(s,os);let c=0,d;const h=e.data,f=o.data;let p,m,g,b;if(e.kind===Nf.GRAYSCALE_1BPP){const A=h.byteLength,x=new Uint32Array(f.buffer,0,f.byteLength>>2),v=x.length,S=s+7>>3,E=4294967295,C=Yt.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(g=p<r?os:i,d=0,m=0;m<g;m++){const N=A-c;let k=0;const T=N>S?s:N*8-7,I=T&-8;let R=0,z=0;for(;k<I;k+=8)z=h[c++],x[d++]=z&128?E:C,x[d++]=z&64?E:C,x[d++]=z&32?E:C,x[d++]=z&16?E:C,x[d++]=z&8?E:C,x[d++]=z&4?E:C,x[d++]=z&2?E:C,x[d++]=z&1?E:C;for(;k<T;k++)R===0&&(z=h[c++],R=128),x[d++]=z&R?E:C,R>>=1}for(;d<v;)x[d++]=0;n.putImageData(o,0,p*os)}}else if(e.kind===Nf.RGBA_32BPP){for(m=0,b=s*os*4,p=0;p<r;p++)f.set(h.subarray(c,c+b)),c+=b,n.putImageData(o,0,m),m+=os;p<a&&(b=s*i*4,f.set(h.subarray(c,c+b)),n.putImageData(o,0,m))}else if(e.kind===Nf.RGB_24BPP)for(g=os,b=s*g,p=0;p<a;p++){for(p>=r&&(g=i,b=s*g),d=0,m=b;m--;)f[d++]=h[c++],f[d++]=h[c++],f[d++]=h[c++],f[d++]=255;n.putImageData(o,0,p*os)}else throw new Error(`bad image kind: ${e.kind}`)}function Xb(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%os,r=(t-i)/os,a=i===0?r:r+1,o=n.createImageData(s,os);let c=0;const d=e.data,h=o.data;for(let f=0;f<a;f++){const p=f<r?os:i;({srcPos:c}=$j({src:d,srcPos:c,dest:h,width:s,height:p,nonBlackColor:0})),n.putImageData(o,0,f*os)}}function eu(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function ff(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!$t){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function Kb(n,e){if(e)return!0;const t=W.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*ea.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const Vj=["butt","round","square"],Wj=["miter","round","bevel"],qj={},Yb={};var jn,sy,ny,iy;const sx=class sx{constructor(e,t,s,i,r,{optionalContentConfig:a,markedContentStack:o=null},c,d){w(this,jn);this.ctx=e,this.current=new qb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new zj(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,s){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Ie(this.compositeCtx))}this.ctx.save(),ff(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ie(this.ctx)}executeOperatorList(e,t,s,i){const r=e.argsArray,a=e.fnArray;let o=t||0;const c=r.length;if(c===o)return o;const d=c-o>Vb&&typeof s=="function",h=d?Date.now()+Bj:0;let f=0;const p=this.commonObjs,m=this.objs;let g;for(;;){if(i!==void 0&&o===i.nextBreakPoint)return i.breakIt(o,s),o;if(g=a[o],g!==cn.dependency)this[g].apply(this,r[o]);else for(const b of r[o]){const A=b.startsWith("g_")?p:m;if(!A.has(b))return A.get(b,s),o}if(o++,o===c)return o;if(d&&++f>Vb){if(Date.now()>h)return s(),o;f=0}}}endDrawing(){_(this,jn,sy).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),_(this,jn,ny).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,c=i,d="prescale1",h,f;for(;r>2&&o>1||a>2&&c>1;){let p=o,m=c;r>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/p),a>2&&c>1&&(m=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/m),h=this.cachedCanvases.getCanvas(d,p,m),f=h.context,f.clearRect(0,0,p,m),f.drawImage(e,0,0,o,c,0,0,p,m),e=h.canvas,o=p,c=m,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,r=this.current.fillColor,a=this.current.patternFill,o=Ie(t);let c,d,h,f;if((e.bitmap||e.data)&&e.count>1){const T=e.bitmap||e.data.buffer;d=JSON.stringify(a?o:[o.slice(0,4),r]),c=this._cachedBitmapsMap.get(T),c||(c=new Map,this._cachedBitmapsMap.set(T,c));const I=c.get(d);if(I&&!a){const R=Math.round(Math.min(o[0],o[2])+o[4]),z=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:I,offsetX:R,offsetY:z}}h=I}h||(f=this.cachedCanvases.getCanvas("maskCanvas",s,i),Xb(f.context,e));let p=W.transform(o,[1/s,0,0,-1/i,0,0]);p=W.transform(p,[1,0,0,1,0,-i]);const[m,g,b,A]=W.getAxialAlignedBoundingBox([0,0,s,i],p),x=Math.round(b-m)||1,v=Math.round(A-g)||1,S=this.cachedCanvases.getCanvas("fillCanvas",x,v),E=S.context,C=m,N=g;E.translate(-C,-N),E.transform(...p),h||(h=this._scaleImage(f.canvas,In(E)),h=h.img,c&&a&&c.set(d,h)),E.imageSmoothingEnabled=Kb(Ie(E),e.interpolate),hf(E,h,0,0,h.width,h.height,0,0,s,i),E.globalCompositeOperation="source-in";const k=W.transform(In(E),[1,0,0,1,-C,-N]);return E.fillStyle=a?r.getPattern(t,this,k,Ot.FILL):r,E.fillRect(0,0,s,i),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(d,S.canvas)),{canvas:S.canvas,offsetX:Math.round(C),offsetY:Math.round(N)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Vj[e]}setLineJoin(e){this.ctx.lineJoin=Wj[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const r=this.ctx;r.setTransform(...Ie(this.suspendedCtx)),eu(this.suspendedCtx,r),Uj(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),eu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],a=i[1],o=i[2]-r,c=i[3]-a;o===0||c===0||(this.genericComposeSMask(t.context,s,o,c,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,a,o,c,d,h,f){let p=e.canvas,m=c-h,g=d-f;if(a){const A=W.makeHexColor(...a);if(m<0||g<0||m+s>p.width||g+i>p.height){const x=this.cachedCanvases.getCanvas("maskExtension",s,i),v=x.context;v.drawImage(p,-m,-g),v.globalCompositeOperation="destination-atop",v.fillStyle=A,v.fillRect(0,0,s,i),v.globalCompositeOperation="source-over",p=x.canvas,m=g=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(m,g,s,i),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=A,e.fillRect(m,g,s,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const b=new Path2D;b.rect(c,d,s,i),t.clip(b),t.globalCompositeOperation="destination-in",t.drawImage(p,m,g,s,i,c,d,s,i),t.restore()}save(){this.inSMaskMode?(eu(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),eu(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,r,a){this.ctx.transform(e,t,s,i,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const i=this.ctx,r=this.current;let a=r.x,o=r.y,c,d;const h=Ie(i),f=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,p=f?s.slice(0):null;for(let m=0,g=0,b=e.length;m<b;m++)switch(e[m]|0){case cn.rectangle:a=t[g++],o=t[g++];const A=t[g++],x=t[g++],v=a+A,S=o+x;i.moveTo(a,o),A===0||x===0?i.lineTo(v,S):(i.lineTo(v,o),i.lineTo(v,S),i.lineTo(a,S)),f||r.updateRectMinMax(h,[a,o,v,S]),i.closePath();break;case cn.moveTo:a=t[g++],o=t[g++],i.moveTo(a,o),f||r.updatePathMinMax(h,a,o);break;case cn.lineTo:a=t[g++],o=t[g++],i.lineTo(a,o),f||r.updatePathMinMax(h,a,o);break;case cn.curveTo:c=a,d=o,a=t[g+4],o=t[g+5],i.bezierCurveTo(t[g],t[g+1],t[g+2],t[g+3],a,o),r.updateCurvePathMinMax(h,c,d,t[g],t[g+1],t[g+2],t[g+3],a,o,p),g+=6;break;case cn.curveTo2:c=a,d=o,i.bezierCurveTo(a,o,t[g],t[g+1],t[g+2],t[g+3]),r.updateCurvePathMinMax(h,c,d,a,o,t[g],t[g+1],t[g+2],t[g+3],p),a=t[g+2],o=t[g+3],g+=4;break;case cn.curveTo3:c=a,d=o,a=t[g+2],o=t[g+3],i.bezierCurveTo(t[g],t[g+1],a,o,a,o),r.updateCurvePathMinMax(h,c,d,t[g],t[g+1],a,o,a,o,p),g+=4;break;case cn.closePath:i.closePath();break}f&&r.updateScalingPathMinMax(h,p),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(t.save(),t.strokeStyle=s.getPattern(t,this,In(t),Ot.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;let r=!1;i&&(t.save(),t.fillStyle=s.getPattern(t,this,In(t),Ot.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=qj}eoClip(){this.pendingClip=Yb}beginText(){this.current.textMatrix=V1,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:c,path:d}of e)s.addPath(d,new DOMMatrix(r).preMultiplySelf(i).translate(a,o).scale(c,-c));t.clip(s),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||T0,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&te("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",a=((h=s.systemFontInfo)==null?void 0:h.css)||`"${r}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const c=s.italic?"italic":"normal";let d=t;t<zb?d=zb:t>Hb&&(d=Hb),this.current.fontSizeScale=t/d,this.ctx.font=`${c} ${o} ${d}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,r,a){this.current.textMatrix=[e,t,s,i,r,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i,r){const a=this.ctx,o=this.current,c=o.font,d=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,f=d&jt.FILL_STROKE_MASK,p=!!(d&jt.ADD_TO_PATH_FLAG),m=o.patternFill&&!c.missingFile,g=o.patternStroke&&!c.missingFile;let b;if((c.disableFontFace||p||m||g)&&(b=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||m||g){if(a.save(),a.translate(t,s),a.scale(h,-h),f===jt.FILL||f===jt.FILL_STROKE)if(i){const A=a.getTransform();a.setTransform(...i),a.fill(_(this,jn,iy).call(this,b,A,i))}else a.fill(b);if(f===jt.STROKE||f===jt.FILL_STROKE)if(r){const A=a.getTransform();a.setTransform(...r),a.stroke(_(this,jn,iy).call(this,b,A,r))}else a.lineWidth/=h,a.stroke(b);a.restore()}else(f===jt.FILL||f===jt.FILL_STROKE)&&a.fillText(e,t,s),(f===jt.STROKE||f===jt.FILL_STROKE)&&a.strokeText(e,t,s);p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ie(a),x:t,y:s,fontSize:h,path:b})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return re(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,c=t.wordSpacing,d=t.fontDirection,h=t.textHScale*d,f=e.length,p=s.vertical,m=p?1:-1,g=s.defaultVMetrics,b=i*t.fontMatrix[0],A=t.textRenderingMode===jt.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),d>0?r.scale(h,-1):r.scale(h,1);let x,v;if(t.patternFill){r.save();const k=t.fillColor.getPattern(r,this,In(r),Ot.FILL);x=Ie(r),r.restore(),r.fillStyle=k}if(t.patternStroke){r.save();const k=t.strokeColor.getPattern(r,this,In(r),Ot.STROKE);v=Ie(r),r.restore(),r.strokeStyle=k}let S=t.lineWidth;const E=t.textMatrixScale;if(E===0||S===0){const k=t.textRenderingMode&jt.FILL_STROKE_MASK;(k===jt.STROKE||k===jt.FILL_STROKE)&&(S=this.getSinglePixelWidth())}else S/=E;if(a!==1&&(r.scale(a,a),S/=a),r.lineWidth=S,s.isInvalidPDFjsFont){const k=[];let T=0;for(const I of e)k.push(I.unicode),T+=I.width;r.fillText(k.join(""),0,0),t.x+=T*b*h,r.restore(),this.compose();return}let C=0,N;for(N=0;N<f;++N){const k=e[N];if(typeof k=="number"){C+=m*k*i/1e3;continue}let T=!1;const I=(k.isSpace?c:0)+o,R=k.fontChar,z=k.accent;let ce,ye,ue=k.width;if(p){const L=k.vmetric||g,F=-(k.vmetric?L[1]:ue*.5)*b,D=L[2]*b;ue=L?-L[0]:ue,ce=F/a,ye=(C+D)/a}else ce=C/a,ye=0;if(s.remeasure&&ue>0){const L=r.measureText(R).width*1e3/i*a;if(ue<L&&this.isFontSubpixelAAEnabled){const F=ue/L;T=!0,r.save(),r.scale(F,1),ce/=F}else ue!==L&&(ce+=(ue-L)/2e3*i/a)}if(this.contentVisible&&(k.isInFont||s.missingFile)){if(A&&!z)r.fillText(R,ce,ye);else if(this.paintChar(R,ce,ye,x,v),z){const L=ce+i*z.offset.x/a,F=ye-i*z.offset.y/a;this.paintChar(z.fontChar,L,F,x,v)}}const qe=p?ue*b-I*d:ue*b+I*d;C+=qe,T&&r.restore()}p?t.y-=C:t.x+=C*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,a=s.fontDirection,o=i.vertical?1:-1,c=s.charSpacing,d=s.wordSpacing,h=s.textHScale*a,f=s.fontMatrix||T0,p=e.length,m=s.textRenderingMode===jt.INVISIBLE;let g,b,A,x;if(!(m||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(h,a),g=0;g<p;++g){if(b=e[g],typeof b=="number"){x=o*b*r/1e3,this.ctx.translate(x,0),s.x+=x*h;continue}const v=(b.isSpace?d:0)+c,S=i.charProcOperatorList[b.operatorListId];if(!S){te(`Type3 character "${b.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=b,this.save(),t.scale(r,r),t.transform(...f),this.executeOperatorList(S),this.restore()),A=W.applyTransform([b.width,0],f)[0]*r+v,t.translate(A,0),s.x+=A*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,r,a){this.ctx.rect(s,i,r-s,a-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],i=this.baseTransform||Ie(this.ctx),r={createCanvasGraphics:a=>new sx(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new ty(e,s,this.ctx,r,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=W.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=W.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=Fj(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,In(t),Ot.SHADING);const i=In(t);if(i){const{width:r,height:a}=t.canvas,[o,c,d,h]=W.getAxialAlignedBoundingBox([0,0,r,a],i);this.ctx.fillRect(o,c,d-o,h-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ae("Should not call beginInlineImage")}beginImageData(){Ae("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Ie(this.ctx),t)){const s=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],s,i),this.current.updateRectMinMax(Ie(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||km("TODO: Support non-isolated groups."),e.knockout&&te("Knockout groups not supported.");const s=Ie(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=W.getAxialAlignedBoundingBox(e.bbox,Ie(t));const r=[0,0,t.canvas.width,t.canvas.height];i=W.intersect(i,r)||[0,0,0,0];const a=Math.floor(i[0]),o=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-a,1),d=Math.max(Math.ceil(i[3])-o,1);this.current.startNewPathAndClipBox([0,0,c,d]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(h,c,d),p=f.context;p.translate(-a,-o),p.transform(...s),e.smask?this.smaskStack.push({canvas:f.canvas,context:p,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),eu(t,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Ie(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=W.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,i,r){if(_(this,jn,sy).call(this),ff(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[c,d]=W.singularValueDecompose2dScale(Ie(this.ctx)),{viewportScale:h}=this,f=Math.ceil(a*this.outputScaleX*h),p=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:m,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(c,0,0,-d,0,o*d),ff(this.ctx)}else ff(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new qb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),_(this,jn,ny).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=Hj(e)),i.compiled)){i.compiled(s);return}const r=this._createMaskCanvas(e),a=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const c=Ie(o);o.transform(t,s,i,r,0,0);const d=this._createMaskCanvas(e);o.setTransform(1,0,0,1,d.offsetX-c[4],d.offsetY-c[5]);for(let h=0,f=a.length;h<f;h+=2){const p=W.transform(c,[t,s,i,r,a[h],a[h+1]]),[m,g]=W.applyTransform([0,0],p);o.drawImage(d.canvas,m,g)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:a,width:o,height:c,transform:d}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,c),f=h.context;f.save();const p=this.getObject(a,r);Xb(f,p),f.globalCompositeOperation="source-in",f.fillStyle=i?s.getPattern(f,this,In(t),Ot.FILL):s,f.fillRect(0,0,o,c),f.restore(),t.save(),t.transform(...d),t.scale(1,-1),hf(t,h.canvas,0,0,o,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){te("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){te("Dependent image isn't ready yet");return}const a=r.width,o=r.height,c=[];for(let d=0,h=i.length;d<h;d+=2)c.push({transform:[t,0,0,s,i[d],i[d+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;if(this.save(),!$t){const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none")}i.scale(1/t,-1/s);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Gb(c,e),r=this.applyTransferMapsToCanvas(c)}const a=this._scaleImage(r,In(i));i.imageSmoothingEnabled=Kb(Ie(i),e.interpolate),hf(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const r=e.width,a=e.height,c=this.cachedCanvases.getCanvas("inlineImage",r,a).context;Gb(c,e),i=this.applyTransferMapsToCanvas(c)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),hf(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===Yb?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ie(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let a,o;if(s===0&&i===0){const c=Math.abs(t),d=Math.abs(r);if(c===d)if(e===0)a=o=1/c;else{const h=c*e;a=o=h<1?1/h:1}else if(e===0)a=1/c,o=1/d;else{const h=c*e,f=d*e;a=h<1?1/h:1,o=f<1?1/f:1}}else{const c=Math.abs(t*r-s*i),d=Math.hypot(t,s),h=Math.hypot(i,r);if(e===0)a=h/c,o=d/c;else{const f=e*c;a=h>f?h/f:1,o=d>f?d/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[i,r]=this.getScaleForStroking();if(t.lineWidth=s||1,i===1&&r===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(i,r),a.length>0){const o=Math.max(i,r);t.setLineDash(a.map(c=>c/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};jn=new WeakSet,sy=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ny=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},iy=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let Al=sx;for(const n in cn)Al.prototype[n]!==void 0&&(Al.prototype[cn[n]]=Al.prototype[n]);var Id,Ld;class Bi{static get workerPort(){return l(this,Id)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");y(this,Id,e)}static get workerSrc(){return l(this,Ld)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");y(this,Ld,e)}}Id=new WeakMap,Ld=new WeakMap,w(Bi,Id,null),w(Bi,Ld,"");var Wa,Md;class Gj{constructor({parsedData:e,rawData:t}){w(this,Wa);w(this,Md);y(this,Wa,e),y(this,Md,t)}getRaw(){return l(this,Md)}get(e){return l(this,Wa).get(e)??null}getAll(){return Vv(l(this,Wa))}has(e){return l(this,Wa).has(e)}}Wa=new WeakMap,Md=new WeakMap;const el=Symbol("INTERNAL");var Dd,Od,Fd,Hl;class Xj{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){w(this,Dd,!1);w(this,Od,!1);w(this,Fd,!1);w(this,Hl,!0);y(this,Dd,!!(e&Cs.DISPLAY)),y(this,Od,!!(e&Cs.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(l(this,Fd))return l(this,Hl);if(!l(this,Hl))return!1;const{print:e,view:t}=this.usage;return l(this,Dd)?(t==null?void 0:t.viewState)!=="OFF":l(this,Od)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==el&&Ae("Internal method `_setVisible` called."),y(this,Fd,s),y(this,Hl,t)}}Dd=new WeakMap,Od=new WeakMap,Fd=new WeakMap,Hl=new WeakMap;var wr,xe,Vl,Wl,$d,ry;class Kj{constructor(e,t=Cs.DISPLAY){w(this,$d);w(this,wr,null);w(this,xe,new Map);w(this,Vl,null);w(this,Wl,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,y(this,Wl,e.order);for(const s of e.groups)l(this,xe).set(s.id,new Xj(t,s));if(e.baseState==="OFF")for(const s of l(this,xe).values())s._setVisible(el,!1);for(const s of e.on)l(this,xe).get(s)._setVisible(el,!0);for(const s of e.off)l(this,xe).get(s)._setVisible(el,!1);y(this,Vl,this.getHash())}}isVisible(e){if(l(this,xe).size===0)return!0;if(!e)return km("Optional content group not defined."),!0;if(e.type==="OCG")return l(this,xe).has(e.id)?l(this,xe).get(e.id).visible:(te(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return _(this,$d,ry).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!l(this,xe).has(t))return te(`Optional content group not found: ${t}`),!0;if(l(this,xe).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!l(this,xe).has(t))return te(`Optional content group not found: ${t}`),!0;if(!l(this,xe).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!l(this,xe).has(t))return te(`Optional content group not found: ${t}`),!0;if(!l(this,xe).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!l(this,xe).has(t))return te(`Optional content group not found: ${t}`),!0;if(l(this,xe).get(t).visible)return!1}return!0}return te(`Unknown optional content policy ${e.policy}.`),!0}return te(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=l(this,xe).get(e);if(!i){te(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((r=l(this,xe).get(o))==null||r._setVisible(el,!1,!0));i._setVisible(el,!!t,!0),y(this,wr,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=l(this,xe).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}y(this,wr,null)}get hasInitialVisibility(){return l(this,Vl)===null||this.getHash()===l(this,Vl)}getOrder(){return l(this,xe).size?l(this,Wl)?l(this,Wl).slice():[...l(this,xe).keys()]:null}getGroups(){return l(this,xe).size>0?Vv(l(this,xe)):null}getGroup(e){return l(this,xe).get(e)||null}getHash(){if(l(this,wr)!==null)return l(this,wr);const e=new wS;for(const[t,s]of l(this,xe))e.update(`${t}:${s.visible}`);return y(this,wr,e.hexdigest())}}wr=new WeakMap,xe=new WeakMap,Vl=new WeakMap,Wl=new WeakMap,$d=new WeakSet,ry=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let a;if(Array.isArray(r))a=_(this,$d,ry).call(this,r);else if(l(this,xe).has(r))a=l(this,xe).get(r).visible;else return te(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class Yj{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Ze(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,d)=>{this._onReceiveData({begin:c,chunk:d})}),e.addProgressListener((c,d)=>{this._onProgress({loaded:c,total:d})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});Ze(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ze(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Qj(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Jj(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class Qj{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=Gv(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Jj{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Zj(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=c(h),h=d(h),r(h)}if(t=a(n),t){const h=d(t);return r(h)}if(t=s("filename","i").exec(n),t){t=t[1];let h=o(t);return h=d(h),r(h)}function s(h,f){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function i(h,f){if(h){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(h,{fatal:!0}),m=Nm(f);f=p.decode(m),e=!1}catch{}}return f}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=i("utf-8",h),e&&(h=i("iso-8859-1",h))),h}function a(h){const f=[];let p;const m=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=m.exec(h))!==null;){let[,b,A,x]=p;if(b=parseInt(b,10),b in f){if(b===0)break;continue}f[b]=[A,x]}const g=[];for(let b=0;b<f.length&&b in f;++b){let[A,x]=f[b];x=o(x),A&&(x=unescape(x),b===0&&(x=c(x))),g.push(x)}return g.join("")}function o(h){if(h.startsWith('"')){const f=h.slice(1).split('\\"');for(let p=0;p<f.length;++p){const m=f[p].indexOf('"');m!==-1&&(f[p]=f[p].slice(0,m),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}h=f.join('"')}return h}function c(h){const f=h.indexOf("'");if(f===-1)return h;const p=h.slice(0,f),g=h.slice(f+1).replace(/^[^']*'/,"");return i(p,g)}function d(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,m,g){if(m==="q"||m==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,A){return String.fromCharCode(parseInt(A,16))}),i(p,g);try{g=atob(g)}catch{}return i(p,g)})}return""}function MS(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function jm(n){try{return new URL(n).origin}catch{}return null}function DS({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function OS(n){const e=n.get("Content-Disposition");if(e){let t=Zj(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Gv(t))return t}return null}function Pm(n,e){return n===404||n===0&&e.startsWith("file:")?new sd('Missing PDF "'+e+'".'):new jp(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function FS(n){return n===200||n===206}function $S(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function BS(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(te(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class Qb{constructor(e){K(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=MS(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ze(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new e2(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new t2(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class e2{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,$S(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=jm(r.url),!FS(r.status))throw Pm(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:c}=DS({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=c||this._contentLength,this._filename=OS(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Zr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:BS(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class t2{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const a=i.url;fetch(a,$S(r,this._withCredentials,this._abortController)).then(o=>{const c=jm(o.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!FS(o.status))throw Pm(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:BS(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const wg=200,_g=206;function s2(n){const e=n.response;return typeof e!="string"?e:Nm(e).buffer}class n2{constructor({url:e,httpHeaders:t,withCredentials:s}){K(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=MS(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=_g):i.expectedStatus=wg,t.responseType="arraybuffer",Ze(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||wg;if(!(r===wg&&s.expectedStatus===_g)&&r!==s.expectedStatus){s.onError(i.status);return}const o=s2(i);if(r===_g){const c=i.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);d?s.onDone({begin:parseInt(d[1],10),chunk:o}):(te('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class i2{constructor(e){this._source=e,this._manager=new n2(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ze(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new r2(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new a2(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class r2{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=jm(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[c,...d]=o.split(": ");return[c,d.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=DS({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=OS(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Pm(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class a2{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=jm((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Pm(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const o2=/^[a-z][a-z0-9\-+.]+:/i;function l2(n){if(o2.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class c2{constructor(e){this.source=e,this.url=l2(e.url),Ze(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ze(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new u2(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new d2(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class u2{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new sd(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Zr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class d2{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const h2=1e5,ts=30,f2=.8;var tw,_r,rs,Bd,Ud,qa,Ai,zd,Hd,Ga,ql,Gl,Sr,Xl,Vd,Kl,Xa,Wd,qd,Ka,Ya,Gd,Ar,Yl,Qi,US,zS,ay,Ls,Ff,oy,HS,VS;const nt=class nt{constructor({textContentSource:e,container:t,viewport:s}){w(this,Qi);w(this,_r,Promise.withResolvers());w(this,rs,null);w(this,Bd,!1);w(this,Ud,!!((tw=globalThis.FontInspector)!=null&&tw.enabled));w(this,qa,null);w(this,Ai,null);w(this,zd,0);w(this,Hd,0);w(this,Ga,null);w(this,ql,null);w(this,Gl,0);w(this,Sr,0);w(this,Xl,Object.create(null));w(this,Vd,[]);w(this,Kl,null);w(this,Xa,[]);w(this,Wd,new WeakMap);w(this,qd,null);var c;if(e instanceof ReadableStream)y(this,Kl,e);else if(typeof e=="object")y(this,Kl,new ReadableStream({start(d){d.enqueue(e),d.close()}}));else throw new Error('No "textContentSource" parameter specified.');y(this,rs,y(this,ql,t)),y(this,Sr,s.scale*(globalThis.devicePixelRatio||1)),y(this,Gl,s.rotation),y(this,Ai,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:a,pageY:o}=s.rawDims;y(this,qd,[1,0,0,-1,-a,o+r]),y(this,Hd,i),y(this,zd,r),_(c=nt,Ls,HS).call(c),Lo(t,s),l(this,_r).promise.finally(()=>{l(nt,Yl).delete(this),y(this,Ai,null),y(this,Xl,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Yt.platform;return re(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{l(this,Ga).read().then(({value:t,done:s})=>{if(s){l(this,_r).resolve();return}l(this,qa)??y(this,qa,t.lang),Object.assign(l(this,Xl),t.styles),_(this,Qi,US).call(this,t.items),e()},l(this,_r).reject)};return y(this,Ga,l(this,Kl).getReader()),l(nt,Yl).add(this),e(),l(this,_r).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==l(this,Gl)&&(t==null||t(),y(this,Gl,i),Lo(l(this,ql),{rotation:i})),s!==l(this,Sr)){t==null||t(),y(this,Sr,s);const a={div:null,properties:null,ctx:_(r=nt,Ls,Ff).call(r,l(this,qa))};for(const o of l(this,Xa))a.properties=l(this,Wd).get(o),a.div=o,_(this,Qi,ay).call(this,a)}}cancel(){var t;const e=new Zr("TextLayer task cancelled.");(t=l(this,Ga))==null||t.cancel(e).catch(()=>{}),y(this,Ga,null),l(this,_r).reject(e)}get textDivs(){return l(this,Xa)}get textContentItemsStr(){return l(this,Vd)}static cleanup(){if(!(l(this,Yl).size>0)){l(this,Ka).clear();for(const{canvas:e}of l(this,Ya).values())e.remove();l(this,Ya).clear()}}};_r=new WeakMap,rs=new WeakMap,Bd=new WeakMap,Ud=new WeakMap,qa=new WeakMap,Ai=new WeakMap,zd=new WeakMap,Hd=new WeakMap,Ga=new WeakMap,ql=new WeakMap,Gl=new WeakMap,Sr=new WeakMap,Xl=new WeakMap,Vd=new WeakMap,Kl=new WeakMap,Xa=new WeakMap,Wd=new WeakMap,qd=new WeakMap,Ka=new WeakMap,Ya=new WeakMap,Gd=new WeakMap,Ar=new WeakMap,Yl=new WeakMap,Qi=new WeakSet,US=function(e){var i,r;if(l(this,Bd))return;(r=l(this,Ai)).ctx??(r.ctx=_(i=nt,Ls,Ff).call(i,l(this,qa)));const t=l(this,Xa),s=l(this,Vd);for(const a of e){if(t.length>h2){te("Ignoring additional textDivs for performance reasons."),y(this,Bd,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=l(this,rs);y(this,rs,document.createElement("span")),l(this,rs).classList.add("markedContent"),a.id!==null&&l(this,rs).setAttribute("id",`${a.id}`),o.append(l(this,rs))}else a.type==="endMarkedContent"&&y(this,rs,l(this,rs).parentNode);continue}s.push(a.str),_(this,Qi,zS).call(this,a)}},zS=function(e){var b;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};l(this,Xa).push(t);const i=W.transform(l(this,qd),e.transform);let r=Math.atan2(i[1],i[0]);const a=l(this,Xl)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=l(this,Ud)&&a.fontSubstitution||a.fontFamily;o=nt.fontFamilyMap.get(o)||o;const c=Math.hypot(i[2],i[3]),d=c*_(b=nt,Ls,VS).call(b,o,l(this,qa));let h,f;r===0?(h=i[4],f=i[5]-d):(h=i[4]+d*Math.sin(r),f=i[5]-d*Math.cos(r));const p="calc(var(--scale-factor)*",m=t.style;l(this,rs)===l(this,ql)?(m.left=`${(100*h/l(this,Hd)).toFixed(2)}%`,m.top=`${(100*f/l(this,zd)).toFixed(2)}%`):(m.left=`${p}${h.toFixed(2)}px)`,m.top=`${p}${f.toFixed(2)}px)`),m.fontSize=`${p}${(l(nt,Ar)*c).toFixed(2)}px)`,m.fontFamily=o,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,l(this,Ud)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const A=Math.abs(e.transform[0]),x=Math.abs(e.transform[3]);A!==x&&Math.max(A,x)/Math.min(A,x)>1.5&&(g=!0)}if(g&&(s.canvasWidth=a.vertical?e.height:e.width),l(this,Wd).set(t,s),l(this,Ai).div=t,l(this,Ai).properties=s,_(this,Qi,ay).call(this,l(this,Ai)),s.hasText&&l(this,rs).append(t),s.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),l(this,rs).append(A)}},ay=function(e){var o;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let a="";if(l(nt,Ar)>1&&(a=`scale(${1/l(nt,Ar)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:d,fontSize:h}=s;_(o=nt,Ls,oy).call(o,i,h*l(this,Sr),c);const{width:f}=i.measureText(t.textContent);f>0&&(a=`scaleX(${d*l(this,Sr)/f}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)},Ls=new WeakSet,Ff=function(e=null){let t=l(this,Ya).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,Ya).set(e,t),l(this,Gd).set(t,{size:0,family:""})}return t},oy=function(e,t,s){const i=l(this,Gd).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},HS=function(){if(l(this,Ar)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),y(this,Ar,e.getBoundingClientRect().height),e.remove()},VS=function(e,t){const s=l(this,Ka).get(e);if(s)return s;const i=_(this,Ls,Ff).call(this,t);i.canvas.width=i.canvas.height=ts,_(this,Ls,oy).call(this,i,ts,e);const r=i.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const h=a/(a+o);return l(this,Ka).set(e,h),i.canvas.width=i.canvas.height=0,h}i.strokeStyle="red",i.clearRect(0,0,ts,ts),i.strokeText("g",0,0);let c=i.getImageData(0,0,ts,ts).data;o=0;for(let h=c.length-1-3;h>=0;h-=4)if(c[h]>0){o=Math.ceil(h/4/ts);break}i.clearRect(0,0,ts,ts),i.strokeText("A",0,ts),c=i.getImageData(0,0,ts,ts).data,a=0;for(let h=0,f=c.length;h<f;h+=4)if(c[h]>0){a=ts-Math.floor(h/4/ts);break}i.canvas.width=i.canvas.height=0;const d=a?a/(a+o):f2;return l(this,Ka).set(e,d),d},w(nt,Ls),w(nt,Ka,new Map),w(nt,Ya,new Map),w(nt,Gd,new WeakMap),w(nt,Ar,null),w(nt,Yl,new Set);let nd=nt;class id{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var c;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(id.shouldBuildText(o))(c=r==null?void 0:r.attributes)!=null&&c.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const d of r.children)i(d)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const p2=65536,m2=100,g2=5e3,y2=$t?Pj:Cj,v2=$t?Rj:TS,x2=$t?jj:Tj,b2=$t?Ij:IS;function w2(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new ly,{docId:t}=e,s=n.url?_2(n.url):null,i=n.data?S2(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,c=n.range instanceof WS?n.range:null,d=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:p2;let h=n.worker instanceof El?n.worker:null;const f=n.verbosity,p=typeof n.docBaseUrl=="string"&&!Tm(n.docBaseUrl)?n.docBaseUrl:null,m=typeof n.cMapUrl=="string"?n.cMapUrl:null,g=n.cMapPacked!==!1,b=n.CMapReaderFactory||v2,A=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,x=n.StandardFontDataFactory||b2,v=n.stopAtErrors!==!0,S=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,E=n.isEvalSupported!==!1,C=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!$t,N=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!$t&&(Yt.platform.isFirefox||!globalThis.chrome),k=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,T=typeof n.disableFontFace=="boolean"?n.disableFontFace:$t,I=n.fontExtraProperties===!0,R=n.enableXfa===!0,z=n.ownerDocument||globalThis.document,ce=n.disableRange===!0,ye=n.disableStream===!0,ue=n.disableAutoFetch===!0,qe=n.pdfBug===!0,L=n.CanvasFactory||y2,F=n.FilterFactory||x2,D=n.enableHWA===!0,q=c?c.length:n.length??NaN,X=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!$t&&!T,se=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:b===TS&&x===IS&&m&&A&&lu(m,document.baseURI)&&lu(A,document.baseURI),ae=null;aj(f);const Se={canvasFactory:new L({ownerDocument:z,enableHWA:D}),filterFactory:new F({docId:t,ownerDocument:z}),cMapReaderFactory:se?null:new b({baseUrl:m,isCompressed:g}),standardFontDataFactory:se?null:new x({baseUrl:A})};if(!h){const Pe={verbosity:f,port:Bi.workerPort};h=Pe.port?El.fromPort(Pe):new El(Pe),e._worker=h}const Nt={docId:t,apiVersion:"4.10.38",data:i,password:o,disableAutoFetch:ue,rangeChunkSize:d,length:q,docBaseUrl:p,enableXfa:R,evaluatorOptions:{maxImageSize:S,disableFontFace:T,ignoreErrors:v,isEvalSupported:E,isOffscreenCanvasSupported:C,isImageDecoderSupported:N,canvasMaxAreaInBytes:k,fontExtraProperties:I,useSystemFonts:X,cMapUrl:se?m:null,standardFontDataUrl:se?A:null}},sn={disableFontFace:T,fontExtraProperties:I,ownerDocument:z,pdfBug:qe,styleElement:ae,loadingParams:{disableAutoFetch:ue,enableXfa:R}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Pe=h.messageHandler.sendWithPromise("GetDocRequest",Nt,i?[i.buffer]:null);let me;if(c)me=new Yj(c,{disableRange:ce,disableStream:ye});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");let ri;if($t)if(lu(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");ri=Qb}else ri=c2;else ri=lu(s)?Qb:i2;me=new ri({url:s,length:q,httpHeaders:r,withCredentials:a,rangeChunkSize:d,disableRange:ce,disableStream:ye})}return Pe.then(ri=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Uh=new hu(t,ri,h.port),Rm=new N2(Uh,e,me,sn,Se);e._transport=Rm,Uh.send("Ready",null)})}).catch(e._capability.reject),e}function _2(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if($t&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function S2(n){if($t&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Nm(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Jb(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var qp;const Gp=class Gp{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ut(Gp,qp)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};qp=new WeakMap,w(Gp,qp,0);let ly=Gp;class WS{constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Ae("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class A2{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return re(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Er,Ei,Xs,tl,$f;class E2{constructor(e,t,s,i=!1){w(this,Xs);w(this,Er,null);w(this,Ei,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new Fb:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new qS,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new Fh({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return re(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=lr.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:c=null,pageColors:d=null,printAnnotationStorage:h=null,isEditing:f=!1}){var E,C;(E=this._stats)==null||E.time("Overall");const p=this._transport.getRenderingIntent(s,i,h,f),{renderingIntent:m,cacheKey:g}=p;y(this,Ei,!1),_(this,Xs,$f).call(this),o||(o=this._transport.getOptionalContentConfig(m));let b=this._intentStates.get(g);b||(b=Object.create(null),this._intentStates.set(g,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const A=!!(m&Cs.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(p));const x=N=>{var k;b.renderTasks.delete(v),(this._maybeCleanupAfterRender||A)&&y(this,Ei,!0),_(this,Xs,tl).call(this,!A),N?(v.capability.reject(N),this._abortOperatorList({intentState:b,reason:N instanceof Error?N:new Error(N)})):v.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(k=globalThis.Stats)!=null&&k.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},v=new uy({callback:x,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!A,pdfBug:this._pdfBug,pageColors:d});(b.renderTasks||(b.renderTasks=new Set)).add(v);const S=v.task;return Promise.all([b.displayReadyCapability.promise,o]).then(([N,k])=>{var T;if(this.destroyed){x();return}if((T=this._stats)==null||T.time("Rendering"),!(k.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");v.initializeGraphics({transparency:N,optionalContentConfig:k}),v.operatorListChanged()}).catch(x),S}getOperatorList({intent:e="display",annotationMode:t=lr.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var d;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(e,t,s,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let c;return o.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(c),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(d=this._stats)==null||d.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>id.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){a.read().then(function({value:c,done:d}){if(d){s(o);return}o.lang??(o.lang=c.lang),Object.assign(o.styles,c.styles),o.items.push(...c.items),r()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),y(this,Ei,!1),_(this,Xs,$f).call(this),Promise.all(e)}cleanup(e=!1){y(this,Ei,!0);const t=_(this,Xs,tl).call(this,!1);return e&&t&&this._stats&&(this._stats=new Fb),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&_(this,Xs,tl).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:a}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),d=this._intentStates.get(t);d.streamReader=c;const h=()=>{c.read().then(({value:f,done:p})=>{if(p){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,d),h())},f=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const p of d.renderTasks)p.operatorListChanged();_(this,Xs,tl).call(this,!0)}if(d.displayReadyCapability)d.displayReadyCapability.reject(f);else if(d.opListReadCapability)d.opListReadCapability.reject(f);else throw f}})};h()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof qv){let i=m2;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Zr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Er=new WeakMap,Ei=new WeakMap,Xs=new WeakSet,tl=function(e=!1){if(_(this,Xs,$f).call(this),!l(this,Ei)||this.destroyed)return!1;if(e)return y(this,Er,setTimeout(()=>{y(this,Er,null),_(this,Xs,tl).call(this,!1)},g2)),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),y(this,Ei,!1),!0},$f=function(){l(this,Er)&&(clearTimeout(l(this,Er)),y(this,Er,null))};var ki,Xp;class k2{constructor(){w(this,ki,new Map);w(this,Xp,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};l(this,Xp).then(()=>{for(const[i]of l(this,ki))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){te("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}l(this,ki).set(t,i)}removeEventListener(e,t){const s=l(this,ki).get(t);s==null||s(),l(this,ki).delete(t)}terminate(){for(const[,e]of l(this,ki))e==null||e();l(this,ki).clear()}}ki=new WeakMap,Xp=new WeakMap;var Kp,Qa,Ja,Ql,Bf,Jl,Uf;const Re=class Re{constructor({name:e=null,port:t=null,verbosity:s=oj()}={}){w(this,Ql);var i;if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=l(Re,Ja))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(l(Re,Ja)||y(Re,Ja,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new hu("main","worker",e),this._messageHandler.on("ready",function(){}),_(this,Ql,Bf).call(this)}_initialize(){if(l(Re,Qa)||l(Re,Jl,Uf)){this._setupFakeWorker();return}let{workerSrc:e}=Re;try{Re._isSameOrigin(window.location.href,e)||(e=Re._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new hu("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:r.signal}),s.on("test",o=>{if(r.abort(),this.destroyed||!o){i();return}this._messageHandler=s,this._port=t,this._webWorker=t,_(this,Ql,Bf).call(this)}),s.on("ready",o=>{if(r.abort(),this.destroyed){i();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{km("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){l(Re,Qa)||(te("Setting up fake worker."),y(Re,Qa,!0)),Re._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new k2;this._port=t;const s=`fake${Ut(Re,Kp)._++}`,i=new hu(s+"_worker",s,t);e.setup(i,t),this._messageHandler=new hu(s,s+"_worker",t),_(this,Ql,Bf).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,s;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=l(Re,Ja))==null||t.delete(this._port),this._port=null,(s=this._messageHandler)==null||s.destroy(),this._messageHandler=null}static fromPort(e){var s;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(s=l(this,Ja))==null?void 0:s.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Re(e)}static get workerSrc(){if(Bi.workerSrc)return Bi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return re(this,"_setupFakeWorkerGlobal",(async()=>l(this,Jl,Uf)?l(this,Jl,Uf):(await import(this.workerSrc)).WorkerMessageHandler)())}};Kp=new WeakMap,Qa=new WeakMap,Ja=new WeakMap,Ql=new WeakSet,Bf=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Jl=new WeakSet,Uf=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},w(Re,Jl),w(Re,Kp,0),w(Re,Qa,!1),w(Re,Ja),$t&&(y(Re,Qa,!0),Bi.workerSrc||(Bi.workerSrc="./pdf.worker.mjs")),Re._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const i=new URL(t,s);return s.origin===i.origin},Re._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let El=Re;var Ni,Gn,Zl,ec,Ci,Za,yu;class N2{constructor(e,t,s,i,r){w(this,Za);w(this,Ni,new Map);w(this,Gn,new Map);w(this,Zl,new Map);w(this,ec,new Map);w(this,Ci,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new qS,this.fontLoader=new kj({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return re(this,"annotationStorage",new Yv)}getRenderingIntent(e,t=lr.ENABLE,s=null,i=!1,r=!1){let a=Cs.DISPLAY,o=Q0;switch(e){case"any":a=Cs.ANY;break;case"display":break;case"print":a=Cs.PRINT;break;default:te(`getRenderingIntent - invalid intent: ${e}`)}const c=a&Cs.PRINT&&s instanceof SS?s:this.annotationStorage;switch(t){case lr.DISABLE:a+=Cs.ANNOTATIONS_DISABLE;break;case lr.ENABLE:break;case lr.ENABLE_FORMS:a+=Cs.ANNOTATIONS_FORMS;break;case lr.ENABLE_STORAGE:a+=Cs.ANNOTATIONS_STORAGE,o=c.serializable;break;default:te(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=Cs.IS_EDITING),r&&(a+=Cs.OPLIST);const{ids:d,hash:h}=c.modifiedIds,f=[a,o.hash,h];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:d}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,Ci))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of l(this,Gn).values())e.push(i._destroy());l(this,Gn).clear(),l(this,Zl).clear(),l(this,ec).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,Ni).clear(),this.filterFactory.destroy(),nd.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Zr("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Ze(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){i.close();return}Ze(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var d;(d=t.onProgress)==null||d.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,i)=>{Ze(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){i.close();return}Ze(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{r.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new A2(s,this))}),e.on("DocException",s=>{t._capability.reject(ss(s))}),e.on("PasswordRequest",s=>{y(this,Ci,Promise.withResolvers());try{if(!t.onPassword)throw ss(s);const i=r=>{r instanceof Error?l(this,Ci).reject(r):l(this,Ci).resolve({password:r})};t.onPassword(i,s.code)}catch(i){l(this,Ci).reject(i)}return l(this,Ci).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,Gn).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":const{disableFontFace:o,fontExtraProperties:c,pdfBug:d}=this._params;if("error"in r){const m=r.error;te(`Error during font loading: ${m}`),this.commonObjs.resolve(s,m);break}const h=d&&((a=globalThis.FontInspector)!=null&&a.enabled)?(m,g)=>globalThis.FontInspector.fontAdded(m,g):null,f=new Nj(r,{disableFontFace:o,fontExtraProperties:c,inspectFont:h});this.fontLoader.bind(f).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c&&f.data&&(f.data=null),this.commonObjs.resolve(s,f)});break;case"CopyLocalImage":const{imageRef:p}=r;Ze(p,"The imageRef must be defined.");for(const m of l(this,Gn).values())for(const[,g]of m.objs)if((g==null?void 0:g.ref)===p)return g.dataLen?(this.commonObjs.resolve(s,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,a])=>{var c;if(this.destroyed)return;const o=l(this,Gn).get(i);if(!o.objs.has(s)){if(o._intentStates.size===0){(c=a==null?void 0:a.bitmap)==null||c.close();return}switch(r){case"Image":o.objs.resolve(s,a),(a==null?void 0:a.dataLen)>sj&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&te("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=l(this,Zl).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,ec).set(r.refStr,e);const a=new E2(t,r,this,this._params.pdfBug);return l(this,Gn).set(t,a),a});return l(this,Zl).set(t,i),i}getPageIndex(e){return Jb(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return _(this,Za,yu).call(this,"GetFieldObjects")}hasJSActions(){return _(this,Za,yu).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return _(this,Za,yu).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return _(this,Za,yu).call(this,"GetOptionalContentConfig").then(t=>new Kj(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=l(this,Ni).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,a;return{info:i[0],metadata:i[1]?new Gj(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return l(this,Ni).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of l(this,Gn).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),l(this,Ni).clear(),this.filterFactory.destroy(!0),nd.cleanup()}}cachedPageNumber(e){if(!Jb(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return l(this,ec).get(t)??null}}Ni=new WeakMap,Gn=new WeakMap,Zl=new WeakMap,ec=new WeakMap,Ci=new WeakMap,Za=new WeakSet,yu=function(e,t=null){const s=l(this,Ni).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return l(this,Ni).set(e,i),i};const tu=Symbol("INITIAL_DATA");var xs,Xd,cy;class qS{constructor(){w(this,Xd);w(this,xs,Object.create(null))}get(e,t=null){if(t){const i=_(this,Xd,cy).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=l(this,xs)[e];if(!s||s.data===tu)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=l(this,xs)[e];return!!t&&t.data!==tu}delete(e){const t=l(this,xs)[e];return!t||t.data===tu?!1:(delete l(this,xs)[e],!0)}resolve(e,t=null){const s=_(this,Xd,cy).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in l(this,xs)){const{data:s}=l(this,xs)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}y(this,xs,Object.create(null))}*[Symbol.iterator](){for(const e in l(this,xs)){const{data:t}=l(this,xs)[e];t!==tu&&(yield[e,t])}}}xs=new WeakMap,Xd=new WeakSet,cy=function(e){var t;return(t=l(this,xs))[e]||(t[e]={...Promise.withResolvers(),data:tu})};var kr;class C2{constructor(e){w(this,kr,null);y(this,kr,e),this.onContinue=null}get promise(){return l(this,kr).capability.promise}cancel(e=0){l(this,kr).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=l(this,kr).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=l(this,kr);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}kr=new WeakMap;var Nr,eo;const ya=class ya{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:c,filterFactory:d,useRequestAnimationFrame:h=!1,pdfBug:f=!1,pageColors:p=null}){w(this,Nr,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=c,this.filterFactory=d,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new C2(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,c;if(this.cancelled)return;if(this._canvas){if(l(ya,eo).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(ya,eo).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:a}=this.params;this.gfx=new Al(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,Nr)&&(window.cancelAnimationFrame(l(this,Nr)),y(this,Nr,null)),l(ya,eo).delete(this._canvas),this.callback(e||new qv(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?y(this,Nr,window.requestAnimationFrame(()=>{y(this,Nr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(ya,eo).delete(this._canvas),this.callback())))}};Nr=new WeakMap,eo=new WeakMap,w(ya,eo,new WeakSet);let uy=ya;const T2="4.10.38",j2="f9bea397f";function Zb(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function su(n){return Math.max(0,Math.min(255,255*n))}class ew{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=su(e),[e,e,e]}static G_HTML([e]){const t=Zb(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(su)}static RGB_HTML(e){return`#${e.map(Zb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[su(1-Math.min(1,e+i)),su(1-Math.min(1,s+i)),su(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,a=1-s,o=Math.min(i,r,a);return["CMYK",i,r,a,o]}}class P2{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ae("Abstract method `_createSVG` called.")}}class Jv extends P2{_createSVG(e){return document.createElementNS(oi,e)}}class GS{static setupStorage(e,t,s,i,r){const a=i.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const c=o.target.options,d=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[c,d]of Object.entries(a))if(d!=null)switch(c){case"class":d.length&&e.setAttribute(c,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!o||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,d)}o&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var f,p;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:s});const o=r!=="richText",c=e.div;if(c.append(a),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=m}o&&c.setAttribute("class","xfaLayer xfaFont");const d=[];if(i.children.length===0){if(i.value){const m=document.createTextNode(i.value);a.append(m),o&&id.shouldBuildText(i.name)&&d.push(m)}return{textDivs:d}}const h=[[i,-1,a]];for(;h.length>0;){const[m,g,b]=h.at(-1);if(g+1===m.children.length){h.pop();continue}const A=m.children[++h.at(-1)[1]];if(A===null)continue;const{name:x}=A;if(x==="#text"){const S=document.createTextNode(A.value);d.push(S),b.append(S);continue}const v=(f=A==null?void 0:A.attributes)!=null&&f.xmlns?document.createElementNS(A.attributes.xmlns,x):document.createElement(x);if(b.append(v),A.attributes&&this.setAttributes({html:v,element:A,storage:t,intent:r,linkService:s}),((p=A.children)==null?void 0:p.length)>0)h.push([A,-1,v]);else if(A.value){const S=document.createTextNode(A.value);o&&id.shouldBuildText(x)&&d.push(S),v.append(S)}}for(const m of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Bh=1e3,R2=9,Do=new WeakSet;function Yr(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class I2{static create(e){switch(e.data.annotationType){case tt.LINK:return new XS(e);case tt.TEXT:return new L2(e);case tt.WIDGET:switch(e.data.fieldType){case"Tx":return new M2(e);case"Btn":return e.data.radioButton?new QS(e):e.data.checkBox?new O2(e):new F2(e);case"Ch":return new $2(e);case"Sig":return new D2(e)}return new Uo(e);case tt.POPUP:return new hy(e);case tt.FREETEXT:return new sA(e);case tt.LINE:return new U2(e);case tt.SQUARE:return new z2(e);case tt.CIRCLE:return new H2(e);case tt.POLYLINE:return new nA(e);case tt.CARET:return new W2(e);case tt.INK:return new Zv(e);case tt.POLYGON:return new V2(e);case tt.HIGHLIGHT:return new iA(e);case tt.UNDERLINE:return new q2(e);case tt.SQUIGGLY:return new G2(e);case tt.STRIKEOUT:return new X2(e);case tt.STAMP:return new rA(e);case tt.FILEATTACHMENT:return new K2(e);default:return new Ye(e)}}}var to,tc,sc,Kd,dy;const nx=class nx{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){w(this,Kd);w(this,to,null);w(this,tc,!1);w(this,sc,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return nx._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;l(this,to)||y(this,to,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&_(this,Kd,dy).call(this,t),(s=l(this,sc))==null||s.popup.updateEdited(e)}resetEdited(){var e;l(this,to)&&(_(this,Kd,dy).call(this,l(this,to).rect),(e=l(this,sc))==null||e.popup.resetEdited(),y(this,to,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Uo||(r.tabIndex=Bh);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof hy){const{rotation:b}=t;return!t.hasOwnCanvas&&b!==0&&this.setRotation(b,r),r}const{width:o,height:c}=Yr(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const b=t.borderStyle.horizontalCornerRadius,A=t.borderStyle.verticalCornerRadius;if(b>0||A>0){const v=`calc(${b}px * var(--scale-factor)) / calc(${A}px * var(--scale-factor))`;a.borderRadius=v}else if(this instanceof QS){const v=`calc(${o}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;a.borderRadius=v}switch(t.borderStyle.style){case Zc.SOLID:a.borderStyle="solid";break;case Zc.DASHED:a.borderStyle="dashed";break;case Zc.BEVELED:te("Unimplemented border style: beveled");break;case Zc.INSET:te("Unimplemented border style: inset");break;case Zc.UNDERLINE:a.borderBottomStyle="solid";break}const x=t.borderColor||null;x?(y(this,tc,!0),a.borderColor=W.makeHexColor(x[0]|0,x[1]|0,x[2]|0)):a.borderWidth=0}const d=W.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:f,pageX:p,pageY:m}=i.rawDims;a.left=`${100*(d[0]-p)/h}%`,a.top=`${100*(d[1]-m)/f}%`;const{rotation:g}=t;return t.hasOwnCanvas||g===0?(a.width=`${100*o/h}%`,a.height=`${100*c/f}%`):this.setRotation(g,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims,{width:r,height:a}=Yr(this.data.rect);let o,c;e%180===0?(o=100*r/s,c=100*a/i):(o=100*a/s,c=100*r/i),t.style.width=`${o}%`,t.style.height=`${c}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],a=r[0],o=r.slice(1);i.target.style[s]=ew[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:ew[`${a}_rgb`](o)})};return re(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const a=s[i];if(a){const o={detail:{[i]:r},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(b=>Math.fround(b));if(e.length===8){const[b,A,x,v]=e.subarray(2,6);if(i===b&&r===A&&t===x&&s===v)return}const{style:a}=this.container;let o;if(l(this,tc)){const{borderColor:b,borderWidth:A}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const c=i-t,d=r-s,{svgFactory:h}=this,f=h.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const p=h.createElement("defs");f.append(p);const m=h.createElement("clipPath"),g=`clippath_${this.data.id}`;m.setAttribute("id",g),m.setAttribute("clipPathUnits","objectBoundingBox"),p.append(m);for(let b=2,A=e.length;b<A;b+=8){const x=e[b],v=e[b+1],S=e[b+2],E=e[b+3],C=h.createElement("rect"),N=(S-t)/c,k=(r-v)/d,T=(x-S)/c,I=(v-E)/d;C.setAttribute("x",N),C.setAttribute("y",k),C.setAttribute("width",T),C.setAttribute("height",I),m.append(C),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${k}" width="${T}" height="${I}"/>`)}l(this,tc)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:e}=this,t=y(this,sc,new hy({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Ae("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:a,exportValues:o}of i){if(r===-1||a===t)continue;const c=typeof o=="string"?o:null,d=document.querySelector(`[data-element-id="${a}"]`);if(d&&!Do.has(d)){te(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:c,domElement:d})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,a=i.getAttribute("data-element-id");a!==t&&Do.has(i)&&s.push({id:a,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};to=new WeakMap,tc=new WeakMap,sc=new WeakMap,Kd=new WeakSet,dy=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}}}=this;s==null||s.splice(0,4,...e);const{width:d,height:h}=Yr(e);t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+c)/a}%`,i===0?(t.width=`${100*d/r}%`,t.height=`${100*h/a}%`):this.setRotation(i)};let Ye=nx;var js,ha,KS,YS;class XS extends Ye{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});w(this,js);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(_(this,js,KS).call(this,i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(_(this,js,YS).call(this,i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&_(this,js,ha).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),_(this,js,ha).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=i.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),_(this,js,ha).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),_(this,js,ha).call(this),!this._fieldObjects){te('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var f;i==null||i();const{fields:r,refs:a,include:o}=s,c=[];if(r.length!==0||a.length!==0){const p=new Set(a);for(const m of r){const g=this._fieldObjects[m]||[];for(const{id:b}of g)p.add(b)}for(const m of Object.values(this._fieldObjects))for(const g of m)p.has(g.id)===o&&c.push(g)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const d=this.annotationStorage,h=[];for(const p of c){const{id:m}=p;switch(h.push(m),p.type){case"text":{const b=p.defaultValue||"";d.setValue(m,{value:b});break}case"checkbox":case"radiobutton":{const b=p.defaultValue===p.exportValues;d.setValue(m,{value:b});break}case"combobox":case"listbox":{const b=p.defaultValue||"";d.setValue(m,{value:b});break}default:continue}const g=document.querySelector(`[data-element-id="${m}"]`);if(g){if(!Do.has(g)){te(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}js=new WeakSet,ha=function(){this.container.setAttribute("data-internal-link","")},KS=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},_(this,js,ha).call(this)},YS=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),_(this,js,ha).call(this)};class L2 extends Ye{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Uo extends Ye{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Yt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var o;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a)}}))})}_setEventListeners(e,t,s,i){var r,a,o;for(const[c,d]of s)(d==="Action"||(r=this.data.actions)!=null&&r[d])&&((d==="Focus"||d==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,d,i),d==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):d==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":W.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||R2,r=e.style;let a;const o=2,c=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(d/(gg*i))||1,f=d/h;a=Math.min(i,c(f/gg))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,c(d/gg))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=W.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class M2 extends Uo{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let d=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;d&&this.data.comb&&(d=d.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:d,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=d??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",d??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Do.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=Bh,this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",p=>{e.setValue(t,{value:p.target.value}),this.setPropertyOnSiblings(s,"value",p.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue??"";s.value=h.userValue=m,h.formattedValue=null});let f=p=>{const{formattedValue:m}=h;m!=null&&(p.target.value=m),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",m=>{var b;if(h.focused)return;const{target:g}=m;h.userValue&&(g.value=h.userValue),h.lastCommittedValue=g.value,h.commitKey=1,(b=this.data.actions)!=null&&b.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);const g={value(b){h.userValue=b.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),b.target.value=h.userValue},formattedValue(b){const{formattedValue:A}=b.detail;h.formattedValue=A,A!=null&&b.target!==document.activeElement&&(b.target.value=A),e.setValue(t,{formattedValue:A})},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var S;const{charLimit:A}=b.detail,{target:x}=b;if(A===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",A);let v=h.userValue;!v||v.length<=A||(v=v.slice(0,A),x.value=h.userValue=v,e.setValue(t,{value:v}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(g,m)}),s.addEventListener("keydown",m=>{var A;h.commitKey=1;let g=-1;if(m.key==="Escape"?g=0:m.key==="Enter"&&!this.data.multiLine?g=2:m.key==="Tab"&&(h.commitKey=3),g===-1)return;const{value:b}=m.target;h.lastCommittedValue!==b&&(h.lastCommittedValue=b,h.userValue=b,(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:g,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});const p=f;f=null,s.addEventListener("blur",m=>{var b,A;if(!h.focused||!m.relatedTarget)return;(b=this.data.actions)!=null&&b.Blur||(h.focused=!1);const{value:g}=m.target;h.userValue=g,h.lastCommittedValue!==g&&((A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,willCommit:!0,commitKey:h.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}})),p(m)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",m=>{var C;h.lastCommittedValue=null;const{data:g,target:b}=m,{value:A,selectionStart:x,selectionEnd:v}=b;let S=x,E=v;switch(m.inputType){case"deleteWordBackward":{const N=A.substring(0,x).match(/\w*[^\w]*$/);N&&(S-=N[0].length);break}case"deleteWordForward":{const N=A.substring(x).match(/^[^\w]*\w*/);N&&(E+=N[0].length);break}case"deleteContentBackward":x===v&&(S-=1);break;case"deleteContentForward":x===v&&(E+=1);break}m.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,change:g||"",willCommit:!1,selStart:S,selEnd:E}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(f&&s.addEventListener("blur",f),this.data.comb){const m=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${m}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class D2 extends Uo{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class O2 extends Uo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Do.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=Bh,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const d of this._getElementsByName(o,s)){const h=c&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=h),e.setValue(d.id,{value:h})}e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class QS extends Uo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(Do.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=Bh,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const d of this._getElementsByName(o,s))e.setValue(d.id,{value:!1});e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const c={value:d=>{const h=a===d.detail.value;for(const f of this._getElementsByName(d.target.name)){const p=h&&f.id===s;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class F2 extends XS{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class $2 extends Uo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Do.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=Bh;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",h=>{const f=this.data.defaultFieldValue;for(const p of i.options)p.selected=p.value===f});for(const h of this.data.options){const f=document.createElement("option");f.textContent=h.displayValue,f.value=h.exportValue,s.value.includes(h.exportValue)&&(f.setAttribute("selected",!0),r=!1),i.append(f)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),i.prepend(h),a=()=>{h.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=h=>{const f=h?"value":"textContent",{options:p,multiple:m}=i;return m?Array.prototype.filter.call(p,g=>g.selected).map(g=>g[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let c=o(!1);const d=h=>{const f=h.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",h=>{const f={value(p){a==null||a();const m=p.detail.value,g=new Set(Array.isArray(m)?m:[m]);for(const b of i.options)b.selected=g.has(b.value);e.setValue(t,{value:o(!0)}),c=o(!1)},multipleSelection(p){i.multiple=!0},remove(p){const m=i.options,g=p.detail.remove;m[g].selected=!1,i.remove(g),m.length>0&&Array.prototype.findIndex.call(m,A=>A.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:o(!0),items:d(p)}),c=o(!1)},clear(p){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=o(!1)},insert(p){const{index:m,displayValue:g,exportValue:b}=p.detail.insert,A=i.children[m],x=document.createElement("option");x.textContent=g,x.value=b,A?A.before(x):i.append(x),e.setValue(t,{value:o(!0),items:d(p)}),c=o(!1)},items(p){const{items:m}=p.detail;for(;i.length!==0;)i.remove(0);for(const g of m){const{displayValue:b,exportValue:A}=g,x=document.createElement("option");x.textContent=b,x.value=A,i.append(x)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:d(p)}),c=o(!1)},indices(p){const m=new Set(p.detail.indices);for(const g of p.target.options)g.selected=m.has(g.index);e.setValue(t,{value:o(!0)}),c=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,h)}),i.addEventListener("input",h=>{var m;const f=o(!0),p=o(!1);e.setValue(t,{value:f}),h.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):i.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class hy extends Ye{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Ye._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new B2({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${Wv}${s}`).join(",")),this.container}}var nc,Yp,Qp,ic,so,Ve,Ti,rc,Yd,Qd,ac,ji,pn,Pi,Jd,Ri,Zd,no,io,_e,zf,fy,JS,ZS,eA,tA,Hf,Vf,py;class B2{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:a,richText:o,parent:c,rect:d,parentRect:h,open:f}){w(this,_e);w(this,nc,_(this,_e,eA).bind(this));w(this,Yp,_(this,_e,py).bind(this));w(this,Qp,_(this,_e,Vf).bind(this));w(this,ic,_(this,_e,Hf).bind(this));w(this,so,null);w(this,Ve,null);w(this,Ti,null);w(this,rc,null);w(this,Yd,null);w(this,Qd,null);w(this,ac,null);w(this,ji,!1);w(this,pn,null);w(this,Pi,null);w(this,Jd,null);w(this,Ri,null);w(this,Zd,null);w(this,no,null);w(this,io,!1);var p;y(this,Ve,e),y(this,Zd,i),y(this,Ti,a),y(this,Ri,o),y(this,Qd,c),y(this,so,t),y(this,Jd,d),y(this,ac,h),y(this,Yd,s),y(this,rc,Xv.toDateObject(r)),this.trigger=s.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",l(this,ic)),m.addEventListener("mouseenter",l(this,Qp)),m.addEventListener("mouseleave",l(this,Yp)),m.classList.add("popupTriggerArea");for(const m of s)(p=m.container)==null||p.addEventListener("keydown",l(this,nc));l(this,Ve).hidden=!0,f&&_(this,_e,Hf).call(this)}render(){if(l(this,pn))return;const e=y(this,pn,document.createElement("div"));if(e.className="popup",l(this,so)){const r=e.style.outlineColor=W.makeHexColor(...l(this,so));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=W.makeHexColor(...l(this,so).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=l(this,Zd),e.append(t),l(this,rc)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,rc).valueOf()})),t.append(r)}const i=l(this,_e,zf);if(i)GS.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,Ti));e.append(r)}l(this,Ve).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,a=i.length;r<a;++r){const o=i[r];s.append(document.createTextNode(o)),r<a-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;l(this,no)||y(this,no,{contentsObj:l(this,Ti),richText:l(this,Ri)}),e&&y(this,Pi,null),t&&(y(this,Ri,_(this,_e,ZS).call(this,t)),y(this,Ti,null)),(s=l(this,pn))==null||s.remove(),y(this,pn,null)}resetEdited(){var e;l(this,no)&&({contentsObj:Ut(this,Ti)._,richText:Ut(this,Ri)._}=l(this,no),y(this,no,null),(e=l(this,pn))==null||e.remove(),y(this,pn,null),y(this,Pi,null))}forceHide(){y(this,io,this.isVisible),l(this,io)&&(l(this,Ve).hidden=!0)}maybeShow(){l(this,io)&&(l(this,pn)||_(this,_e,Vf).call(this),y(this,io,!1),l(this,Ve).hidden=!1)}get isVisible(){return l(this,Ve).hidden===!1}}nc=new WeakMap,Yp=new WeakMap,Qp=new WeakMap,ic=new WeakMap,so=new WeakMap,Ve=new WeakMap,Ti=new WeakMap,rc=new WeakMap,Yd=new WeakMap,Qd=new WeakMap,ac=new WeakMap,ji=new WeakMap,pn=new WeakMap,Pi=new WeakMap,Jd=new WeakMap,Ri=new WeakMap,Zd=new WeakMap,no=new WeakMap,io=new WeakMap,_e=new WeakSet,zf=function(){const e=l(this,Ri),t=l(this,Ti);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&l(this,Ri).html||null},fy=function(){var e,t,s;return((s=(t=(e=l(this,_e,zf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},JS=function(){var e,t,s;return((s=(t=(e=l(this,_e,zf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},ZS=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:l(this,_e,JS),fontSize:l(this,_e,fy)?`calc(${l(this,_e,fy)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},eA=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&l(this,ji))&&_(this,_e,Hf).call(this)},tA=function(){if(l(this,Pi)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=l(this,Qd);let a=!!l(this,ac),o=a?l(this,ac):l(this,Jd);for(const g of l(this,Yd))if(!o||W.intersect(g.data.rect,o)!==null){o=g.data.rect,a=!0;break}const c=W.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,f=c[0]+h,p=c[1];y(this,Pi,[100*(f-i)/t,100*(p-r)/s]);const{style:m}=l(this,Ve);m.left=`${l(this,Pi)[0]}%`,m.top=`${l(this,Pi)[1]}%`},Hf=function(){y(this,ji,!l(this,ji)),l(this,ji)?(_(this,_e,Vf).call(this),l(this,Ve).addEventListener("click",l(this,ic)),l(this,Ve).addEventListener("keydown",l(this,nc))):(_(this,_e,py).call(this),l(this,Ve).removeEventListener("click",l(this,ic)),l(this,Ve).removeEventListener("keydown",l(this,nc)))},Vf=function(){l(this,pn)||this.render(),this.isVisible?l(this,ji)&&l(this,Ve).classList.add("focused"):(_(this,_e,tA).call(this),l(this,Ve).hidden=!1,l(this,Ve).style.zIndex=parseInt(l(this,Ve).style.zIndex)+1e3)},py=function(){l(this,Ve).classList.remove("focused"),!(l(this,ji)||!this.isVisible)&&(l(this,Ve).hidden=!0,l(this,Ve).style.zIndex=parseInt(l(this,Ve).style.zIndex)-1e3)};class sA extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ee.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var eh;class U2 extends Ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});w(this,eh,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:i}=Yr(t.rect),r=this.svgFactory.create(s,i,!0),a=y(this,eh,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,eh)}addHighlightArea(){this.container.classList.add("highlightArea")}}eh=new WeakMap;var th;class z2 extends Ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});w(this,th,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:i}=Yr(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=y(this,th,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",s-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,th)}addHighlightArea(){this.container.classList.add("highlightArea")}}th=new WeakMap;var sh;class H2 extends Ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});w(this,sh,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:i}=Yr(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=y(this,sh,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",i/2),o.setAttribute("rx",s/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,sh)}addHighlightArea(){this.container.classList.add("highlightArea")}}sh=new WeakMap;var nh;class nA extends Ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});w(this,nh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r}}=this;if(!s)return this.container;const{width:a,height:o}=Yr(t),c=this.svgFactory.create(a,o,!0);let d=[];for(let f=0,p=s.length;f<p;f+=2){const m=s[f]-t[0],g=t[3]-s[f+1];d.push(`${m},${g}`)}d=d.join(" ");const h=y(this,nh,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",d),h.setAttribute("stroke-width",i.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,nh)}addHighlightArea(){this.container.classList.add("highlightArea")}}nh=new WeakMap;class V2 extends nA{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class W2 extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var ih,ro,rh,my;class Zv extends Ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});w(this,rh);w(this,ih,null);w(this,ro,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ee.HIGHLIGHT:ee.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:o,width:c,height:d}=_(this,rh,my).call(this,s,t),h=this.svgFactory.create(c,d,!0),f=y(this,ih,this.svgFactory.createElement("svg:g"));h.append(f),f.setAttribute("stroke-width",r.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let p=0,m=i.length;p<m;p++){const g=this.svgFactory.createElement(this.svgElementName);l(this,ro).push(g),g.setAttribute("points",i[p].join(",")),f.append(g)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,a=l(this,ih);if(s>=0&&a.setAttribute("stroke-width",s||1),i)for(let o=0,c=l(this,ro).length;o<c;o++)l(this,ro)[o].setAttribute("points",i[o].join(","));if(r){const{transform:o,width:c,height:d}=_(this,rh,my).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${d}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return l(this,ro)}addHighlightArea(){this.container.classList.add("highlightArea")}}ih=new WeakMap,ro=new WeakMap,rh=new WeakSet,my=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class iA extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ee.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class q2 extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class G2 extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class X2 extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class rA extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ee.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ah,oh,gy;class K2 extends Ye{constructor(t){var i;super(t,{isRenderable:!0});w(this,oh);w(this,ah,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",_(this,oh,gy).bind(this)),y(this,ah,i);const{isMac:r}=Yt.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&_(this,oh,gy).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return l(this,ah)}addHighlightArea(){this.container.classList.add("highlightArea")}}ah=new WeakMap,oh=new WeakSet,gy=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var lh,ao,oo,ch,Oo,aA,yy;class Y2{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:o}){w(this,Oo);w(this,lh,null);w(this,ao,null);w(this,oo,new Map);w(this,ch,null);this.div=e,y(this,lh,t),y(this,ao,s),y(this,ch,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return l(this,oo).size>0}async render(e){var a;const{annotations:t}=e,s=this.div;Lo(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Jv,annotationStorage:e.annotationStorage||new Yv,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const c=o.annotationType===tt.POPUP;if(c){const f=i.get(o.id);if(!f)continue;r.elements=f}else{const{width:f,height:p}=Yr(o.rect);if(f<=0||p<=0)continue}r.data=o;const d=I2.create(r);if(!d.isRenderable)continue;if(!c&&o.popupRef){const f=i.get(o.popupRef);f?f.push(d):i.set(o.popupRef,[d])}const h=d.render();o.hidden&&(h.style.visibility="hidden"),await _(this,Oo,aA).call(this,h,o.id),d._isEditable&&(l(this,oo).set(d.data.id,d),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(d))}_(this,Oo,yy).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Lo(t,{rotation:e.rotation}),_(this,Oo,yy).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(l(this,oo).values())}getEditableAnnotation(e){return l(this,oo).get(e)}}lh=new WeakMap,ao=new WeakMap,oo=new WeakMap,ch=new WeakMap,Oo=new WeakSet,aA=async function(e,t){var a,o;const s=e.firstChild||e,i=s.id=`${Wv}${t}`,r=await((a=l(this,ch))==null?void 0:a.getAriaAttributes(i));if(r)for(const[c,d]of r)s.setAttribute(c,d);this.div.append(e),(o=l(this,lh))==null||o.moveElementInDOM(this.div,e,s,!1)},yy=function(){if(!l(this,ao))return;const e=this.div;for(const[t,s]of l(this,ao)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:r}=i;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):i.append(s)}l(this,ao).clear()};const pf=/\r\n?|\n/g;var mn,bs,uh,lo,ws,et,oA,lA,cA,Wf,Wi,qf,Gf,uA,xy,dA;const ke=class ke extends Be{constructor(t){super({...t,name:"freeTextEditor"});w(this,et);w(this,mn);w(this,bs,"");w(this,uh,`${this.id}-editor`);w(this,lo,null);w(this,ws);y(this,mn,t.color||ke._defaultColor||Be._defaultLineColor),y(this,ws,t.fontSize||ke._defaultFontSize)}static get _keyboardManager(){const t=ke.prototype,s=a=>a.isEmpty(),i=Mo.TRANSLATE_SMALL,r=Mo.TRANSLATE_BIG;return re(this,"_keyboardManager",new $h([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){Be.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case de.FREETEXT_SIZE:ke._defaultFontSize=s;break;case de.FREETEXT_COLOR:ke._defaultColor=s;break}}updateParams(t,s){switch(t){case de.FREETEXT_SIZE:_(this,et,oA).call(this,s);break;case de.FREETEXT_COLOR:_(this,et,lA).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[de.FREETEXT_SIZE,ke._defaultFontSize],[de.FREETEXT_COLOR,ke._defaultColor||Be._defaultLineColor]]}get propertiesToUpdate(){return[[de.FREETEXT_SIZE,l(this,ws)],[de.FREETEXT_COLOR,l(this,mn)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-ke._internalPadding*t,-(ke._internalPadding+l(this,ws))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(ee.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),y(this,lo,new AbortController);const t=this._uiManager.combinedSignal(l(this,lo));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,uh)),this._isDraggable=!0,(t=l(this,lo))==null||t.abort(),y(this,lo,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=l(this,bs),s=y(this,bs,_(this,et,cA).call(this).trimEnd());if(t===s)return;const i=r=>{if(y(this,bs,r),!r){this.remove();return}_(this,et,Gf).call(this),this._uiManager.rebuild(this),_(this,et,Wf).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),_(this,et,Wf).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){ke._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,uh)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${l(this,ws)}px * var(--scale-factor))`,i.color=l(this,mn),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Pp(this,this.div,["dblclick","keydown"]),this.width){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,d]=this.getInitialTranslation();[c,d]=this.pageTranslationToScreen(c,d);const[h,f]=this.pageDimensions,[p,m]=this.pageTranslation;let g,b;switch(this.rotation){case 0:g=t+(o[0]-p)/h,b=s+this.height-(o[1]-m)/f;break;case 90:g=t+(o[0]-p)/h,b=s-(o[1]-m)/f,[c,d]=[d,-c];break;case 180:g=t-this.width+(o[0]-p)/h,b=s-(o[1]-m)/f,[c,d]=[-c,-d];break;case 270:g=t+(o[0]-p-this.height*f)/h,b=s+(o[1]-m-this.width*h)/f,[c,d]=[-d,c];break}this.setAt(g*r,b*a,c,d)}else this.setAt(t*r,s*a,this.width*r,this.height*a);_(this,et,Gf).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var g,b,A;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=_(g=ke,Wi,xy).call(g,s.getData("text")||"").replaceAll(pf,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:d}=o,h=[],f=[];if(c.nodeType===Node.TEXT_NODE){const x=c.parentElement;if(f.push(c.nodeValue.slice(d).replaceAll(pf,"")),x!==this.editorDiv){let v=h;for(const S of this.editorDiv.childNodes){if(S===x){v=f;continue}v.push(_(b=ke,Wi,qf).call(b,S))}}h.push(c.nodeValue.slice(0,d).replaceAll(pf,""))}else if(c===this.editorDiv){let x=h,v=0;for(const S of this.editorDiv.childNodes)v++===d&&(x=f),x.push(_(A=ke,Wi,qf).call(A,S))}y(this,bs,`${h.join(`
`)}${r}${f.join(`
`)}`),_(this,et,Gf).call(this);const p=new Range;let m=h.reduce((x,v)=>x+v.length,0);for(const{firstChild:x}of this.editorDiv.childNodes)if(x.nodeType===Node.TEXT_NODE){const v=x.nodeValue.length;if(m<=v){p.setStart(x,m),p.setEnd(x,m);break}m-=v}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var o;let r=null;if(t instanceof sA){const{data:{defaultAppearanceData:{fontSize:c,fontColor:d},rect:h,rotation:f,id:p,popupRef:m},textContent:g,textPosition:b,parent:{page:{pageNumber:A}}}=t;if(!g||g.length===0)return null;r=t={annotationType:ee.FREETEXT,color:Array.from(d),fontSize:c,value:g.join(`
`),position:b,pageIndex:A-1,rect:h.slice(0),rotation:f,id:p,deleted:!1,popupRef:m}}const a=await super.deserialize(t,s,i);return y(a,ws,t.fontSize),y(a,mn,W.makeHexColor(...t.color)),y(a,bs,_(o=ke,Wi,xy).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=r,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=ke._internalPadding*this.parentScale,i=this.getRect(s,s),r=Be._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,mn)),a={annotationType:ee.FREETEXT,color:r,fontSize:l(this,ws),value:_(this,et,uA).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!_(this,et,dA).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${l(this,ws)}px * var(--scale-factor))`,i.color=l(this,mn),s.replaceChildren();for(const a of l(this,bs).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),s.append(o)}const r=ke._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:l(this,bs)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};mn=new WeakMap,bs=new WeakMap,uh=new WeakMap,lo=new WeakMap,ws=new WeakMap,et=new WeakSet,oA=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-l(this,ws))*this.parentScale),y(this,ws,r),_(this,et,Wf).call(this)},i=l(this,ws);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},lA=function(t){const s=r=>{y(this,mn,this.editorDiv.style.color=r)},i=l(this,mn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},cA=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(_(i=ke,Wi,qf).call(i,r)),s=r);return t.join(`
`)},Wf=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},Wi=new WeakSet,qf=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(pf,"")},Gf=function(){if(this.editorDiv.replaceChildren(),!!l(this,bs))for(const t of l(this,bs).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},uA=function(){return l(this,bs).replaceAll(""," ")},xy=function(t){return t.replaceAll(" ","")},dA=function(t){const{value:s,fontSize:i,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((o,c)=>o!==r[c])||t.pageIndex!==a},w(ke,Wi),K(ke,"_freeTextDefaultContent",""),K(ke,"_internalPadding",0),K(ke,"_defaultColor",null),K(ke,"_defaultFontSize",10),K(ke,"_type","freetext"),K(ke,"_editorType",ee.FREETEXT);let vy=ke;class B{toSVGPath(){Ae("Abstract method `toSVGPath` must be implemented.")}get box(){Ae("Abstract getter `box` must be implemented.")}serialize(e,t){Ae("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o]*i,a[o+1]=s+e[o+1]*r;return a}static _rescaleAndSwap(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o+1]*i,a[o+1]=s+e[o]*r;return a}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,a){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+a)/6,(s+r)/2,(i+a)/2]}}K(B,"PRECISION",1e-4);var _s,gn,oc,lc,Xn,ie,co,uo,dh,hh,cc,uc,Cr,fh,Jp,Zp,ct,vu,hA,fA,pA,mA,gA,yA;const fi=class fi{constructor({x:e,y:t},s,i,r,a,o=0){w(this,ct);w(this,_s);w(this,gn,[]);w(this,oc);w(this,lc);w(this,Xn,[]);w(this,ie,new Float32Array(18));w(this,co);w(this,uo);w(this,dh);w(this,hh);w(this,cc);w(this,uc);w(this,Cr,[]);y(this,_s,s),y(this,uc,r*i),y(this,lc,a),l(this,ie).set([NaN,NaN,NaN,NaN,e,t],6),y(this,oc,o),y(this,hh,l(fi,fh)*i),y(this,dh,l(fi,Zp)*i),y(this,cc,i),l(this,Cr).push(e,t)}isEmpty(){return isNaN(l(this,ie)[8])}add({x:e,y:t}){var I;y(this,co,e),y(this,uo,t);const[s,i,r,a]=l(this,_s);let[o,c,d,h]=l(this,ie).subarray(8,12);const f=e-d,p=t-h,m=Math.hypot(f,p);if(m<l(this,dh))return!1;const g=m-l(this,hh),b=g/m,A=b*f,x=b*p;let v=o,S=c;o=d,c=h,d+=A,h+=x,(I=l(this,Cr))==null||I.push(e,t);const E=-x/g,C=A/g,N=E*l(this,uc),k=C*l(this,uc);return l(this,ie).set(l(this,ie).subarray(2,8),0),l(this,ie).set([d+N,h+k],4),l(this,ie).set(l(this,ie).subarray(14,18),12),l(this,ie).set([d-N,h-k],16),isNaN(l(this,ie)[6])?(l(this,Xn).length===0&&(l(this,ie).set([o+N,c+k],2),l(this,Xn).push(NaN,NaN,NaN,NaN,(o+N-s)/r,(c+k-i)/a),l(this,ie).set([o-N,c-k],14),l(this,gn).push(NaN,NaN,NaN,NaN,(o-N-s)/r,(c-k-i)/a)),l(this,ie).set([v,S,o,c,d,h],6),!this.isEmpty()):(l(this,ie).set([v,S,o,c,d,h],6),Math.abs(Math.atan2(S-c,v-o)-Math.atan2(x,A))<Math.PI/2?([o,c,d,h]=l(this,ie).subarray(2,6),l(this,Xn).push(NaN,NaN,NaN,NaN,((o+d)/2-s)/r,((c+h)/2-i)/a),[o,c,v,S]=l(this,ie).subarray(14,18),l(this,gn).push(NaN,NaN,NaN,NaN,((v+o)/2-s)/r,((S+c)/2-i)/a),!0):([v,S,o,c,d,h]=l(this,ie).subarray(0,6),l(this,Xn).push(((v+5*o)/6-s)/r,((S+5*c)/6-i)/a,((5*o+d)/6-s)/r,((5*c+h)/6-i)/a,((o+d)/2-s)/r,((c+h)/2-i)/a),[d,h,o,c,v,S]=l(this,ie).subarray(12,18),l(this,gn).push(((v+5*o)/6-s)/r,((S+5*c)/6-i)/a,((5*o+d)/6-s)/r,((5*c+h)/6-i)/a,((o+d)/2-s)/r,((c+h)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=l(this,Xn),t=l(this,gn);if(isNaN(l(this,ie)[6])&&!this.isEmpty())return _(this,ct,hA).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);_(this,ct,pA).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return _(this,ct,fA).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,a){return new vA(e,t,s,i,r,a)}getOutlines(){var f;const e=l(this,Xn),t=l(this,gn),s=l(this,ie),[i,r,a,o]=l(this,_s),c=new Float32Array((((f=l(this,Cr))==null?void 0:f.length)??0)+2);for(let p=0,m=c.length-2;p<m;p+=2)c[p]=(l(this,Cr)[p]-i)/a,c[p+1]=(l(this,Cr)[p+1]-r)/o;if(c[c.length-2]=(l(this,co)-i)/a,c[c.length-1]=(l(this,uo)-r)/o,isNaN(s[6])&&!this.isEmpty())return _(this,ct,mA).call(this,c);const d=new Float32Array(l(this,Xn).length+24+l(this,gn).length);let h=e.length;for(let p=0;p<h;p+=2){if(isNaN(e[p])){d[p]=d[p+1]=NaN;continue}d[p]=e[p],d[p+1]=e[p+1]}h=_(this,ct,yA).call(this,d,h);for(let p=t.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(t[p+m])){d[h]=d[h+1]=NaN,h+=2;continue}d[h]=t[p+m],d[h+1]=t[p+m+1],h+=2}return _(this,ct,gA).call(this,d,h),this.newFreeDrawOutline(d,c,l(this,_s),l(this,cc),l(this,oc),l(this,lc))}};_s=new WeakMap,gn=new WeakMap,oc=new WeakMap,lc=new WeakMap,Xn=new WeakMap,ie=new WeakMap,co=new WeakMap,uo=new WeakMap,dh=new WeakMap,hh=new WeakMap,cc=new WeakMap,uc=new WeakMap,Cr=new WeakMap,fh=new WeakMap,Jp=new WeakMap,Zp=new WeakMap,ct=new WeakSet,vu=function(){const e=l(this,ie).subarray(4,6),t=l(this,ie).subarray(16,18),[s,i,r,a]=l(this,_s);return[(l(this,co)+(e[0]-t[0])/2-s)/r,(l(this,uo)+(e[1]-t[1])/2-i)/a,(l(this,co)+(t[0]-e[0])/2-s)/r,(l(this,uo)+(t[1]-e[1])/2-i)/a]},hA=function(){const[e,t,s,i]=l(this,_s),[r,a,o,c]=_(this,ct,vu).call(this);return`M${(l(this,ie)[2]-e)/s} ${(l(this,ie)[3]-t)/i} L${(l(this,ie)[4]-e)/s} ${(l(this,ie)[5]-t)/i} L${r} ${a} L${o} ${c} L${(l(this,ie)[16]-e)/s} ${(l(this,ie)[17]-t)/i} L${(l(this,ie)[14]-e)/s} ${(l(this,ie)[15]-t)/i} Z`},fA=function(e){const t=l(this,gn);e.push(`L${t[4]} ${t[5]} Z`)},pA=function(e){const[t,s,i,r]=l(this,_s),a=l(this,ie).subarray(4,6),o=l(this,ie).subarray(16,18),[c,d,h,f]=_(this,ct,vu).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-s)/r} L${c} ${d} L${h} ${f} L${(o[0]-t)/i} ${(o[1]-s)/r}`)},mA=function(e){const t=l(this,ie),[s,i,r,a]=l(this,_s),[o,c,d,h]=_(this,ct,vu).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,c,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(f,e,l(this,_s),l(this,cc),l(this,oc),l(this,lc))},gA=function(e,t){const s=l(this,gn);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},yA=function(e,t){const s=l(this,ie).subarray(4,6),i=l(this,ie).subarray(16,18),[r,a,o,c]=l(this,_s),[d,h,f,p]=_(this,ct,vu).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/c,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/c],t),t+=24},w(fi,fh,8),w(fi,Jp,2),w(fi,Zp,l(fi,fh)+l(fi,Jp));let Lp=fi;var dc,ho,Ii,ph,Ss,mh,Xe,em,xA;class vA extends B{constructor(t,s,i,r,a,o){super();w(this,em);w(this,dc);w(this,ho,new Float32Array(4));w(this,Ii);w(this,ph);w(this,Ss);w(this,mh);w(this,Xe);y(this,Xe,t),y(this,Ss,s),y(this,dc,i),y(this,mh,r),y(this,Ii,a),y(this,ph,o),this.lastPoint=[NaN,NaN],_(this,em,xA).call(this,o);const[c,d,h,f]=l(this,ho);for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-c)/h,t[p+1]=(t[p+1]-d)/f;for(let p=0,m=s.length;p<m;p+=2)s[p]=(s[p]-c)/h,s[p+1]=(s[p+1]-d)/f}toSVGPath(){const t=[`M${l(this,Xe)[4]} ${l(this,Xe)[5]}`];for(let s=6,i=l(this,Xe).length;s<i;s+=6){if(isNaN(l(this,Xe)[s])){t.push(`L${l(this,Xe)[s+4]} ${l(this,Xe)[s+5]}`);continue}t.push(`C${l(this,Xe)[s]} ${l(this,Xe)[s+1]} ${l(this,Xe)[s+2]} ${l(this,Xe)[s+3]} ${l(this,Xe)[s+4]} ${l(this,Xe)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],a){const o=i-t,c=r-s;let d,h;switch(a){case 0:d=B._rescale(l(this,Xe),t,r,o,-c),h=B._rescale(l(this,Ss),t,r,o,-c);break;case 90:d=B._rescaleAndSwap(l(this,Xe),t,s,o,c),h=B._rescaleAndSwap(l(this,Ss),t,s,o,c);break;case 180:d=B._rescale(l(this,Xe),i,s,-o,c),h=B._rescale(l(this,Ss),i,s,-o,c);break;case 270:d=B._rescaleAndSwap(l(this,Xe),i,r,-o,-c),h=B._rescaleAndSwap(l(this,Ss),i,r,-o,-c);break}return{outline:Array.from(d),points:[Array.from(h)]}}get box(){return l(this,ho)}newOutliner(t,s,i,r,a,o=0){return new Lp(t,s,i,r,a,o)}getNewOutline(t,s){const[i,r,a,o]=l(this,ho),[c,d,h,f]=l(this,dc),p=a*h,m=o*f,g=i*h+c,b=r*f+d,A=this.newOutliner({x:l(this,Ss)[0]*p+g,y:l(this,Ss)[1]*m+b},l(this,dc),l(this,mh),t,l(this,ph),s??l(this,Ii));for(let x=2;x<l(this,Ss).length;x+=2)A.add({x:l(this,Ss)[x]*p+g,y:l(this,Ss)[x+1]*m+b});return A.getOutlines()}}dc=new WeakMap,ho=new WeakMap,Ii=new WeakMap,ph=new WeakMap,Ss=new WeakMap,mh=new WeakMap,Xe=new WeakMap,em=new WeakSet,xA=function(t){const s=l(this,Xe);let i=s[4],r=s[5],a=i,o=r,c=i,d=r,h=i,f=r;const p=t?Math.max:Math.min;for(let g=6,b=s.length;g<b;g+=6){if(isNaN(s[g]))a=Math.min(a,s[g+4]),o=Math.min(o,s[g+5]),c=Math.max(c,s[g+4]),d=Math.max(d,s[g+5]),f<s[g+5]?(h=s[g+4],f=s[g+5]):f===s[g+5]&&(h=p(h,s[g+4]));else{const A=W.bezierBoundingBox(i,r,...s.slice(g,g+6));a=Math.min(a,A[0]),o=Math.min(o,A[1]),c=Math.max(c,A[2]),d=Math.max(d,A[3]),f<A[3]?(h=A[2],f=A[3]):f===A[3]&&(h=p(h,A[2]))}i=s[g+4],r=s[g+5]}const m=l(this,ho);m[0]=a-l(this,Ii),m[1]=o-l(this,Ii),m[2]=c-a+2*l(this,Ii),m[3]=d-o+2*l(this,Ii),this.lastPoint=[h,f]};var gh,yh,Tr,yn,Jt,bA,Xf,wA,_A,wy;class by{constructor(e,t=0,s=0,i=!0){w(this,Jt);w(this,gh);w(this,yh);w(this,Tr,[]);w(this,yn,[]);let r=1/0,a=-1/0,o=1/0,c=-1/0;const h=10**-4;for(const{x,y:v,width:S,height:E}of e){const C=Math.floor((x-t)/h)*h,N=Math.ceil((x+S+t)/h)*h,k=Math.floor((v-t)/h)*h,T=Math.ceil((v+E+t)/h)*h,I=[C,k,T,!0],R=[N,k,T,!1];l(this,Tr).push(I,R),r=Math.min(r,C),a=Math.max(a,N),o=Math.min(o,k),c=Math.max(c,T)}const f=a-r+2*s,p=c-o+2*s,m=r-s,g=o-s,b=l(this,Tr).at(i?-1:-2),A=[b[0],b[2]];for(const x of l(this,Tr)){const[v,S,E]=x;x[0]=(v-m)/f,x[1]=(S-g)/p,x[2]=(E-g)/p}y(this,gh,new Float32Array([m,g,f,p])),y(this,yh,A)}getOutlines(){l(this,Tr).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of l(this,Tr))t[3]?(e.push(..._(this,Jt,wy).call(this,t)),_(this,Jt,wA).call(this,t)):(_(this,Jt,_A).call(this,t),e.push(..._(this,Jt,wy).call(this,t)));return _(this,Jt,bA).call(this,e)}}gh=new WeakMap,yh=new WeakMap,Tr=new WeakMap,yn=new WeakMap,Jt=new WeakSet,bA=function(e){const t=[],s=new Set;for(const a of e){const[o,c,d]=a;t.push([o,c,a],[o,d,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const c=t[a][2],d=t[a+1][2];c.push(d),d.push(c),s.add(c),s.add(d)}const i=[];let r;for(;s.size>0;){const a=s.values().next().value;let[o,c,d,h,f]=a;s.delete(a);let p=o,m=c;for(r=[o,d],i.push(r);;){let g;if(s.has(h))g=h;else if(s.has(f))g=f;else break;s.delete(g),[o,c,d,h,f]=g,p!==o&&(r.push(p,m,o,m===c?c:d),p=o),m=m===c?d:c}r.push(p,m)}return new Q2(i,l(this,gh),l(this,yh))},Xf=function(e){const t=l(this,yn);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:i=r-1}return i+1},wA=function([,e,t]){const s=_(this,Jt,Xf).call(this,e);l(this,yn).splice(s,0,[e,t])},_A=function([,e,t]){const s=_(this,Jt,Xf).call(this,e);for(let i=s;i<l(this,yn).length;i++){const[r,a]=l(this,yn)[i];if(r!==e)break;if(r===e&&a===t){l(this,yn).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,a]=l(this,yn)[i];if(r!==e)break;if(r===e&&a===t){l(this,yn).splice(i,1);return}}},wy=function(e){const[t,s,i]=e,r=[[t,s,i]],a=_(this,Jt,Xf).call(this,i);for(let o=0;o<a;o++){const[c,d]=l(this,yn)[o];for(let h=0,f=r.length;h<f;h++){const[,p,m]=r[h];if(!(d<=p||m<=c)){if(p>=c){if(m>d)r[h][1]=d;else{if(f===1)return[];r.splice(h,1),h--,f--}continue}r[h][2]=c,m>d&&r.push([t,d,m])}}}return r};var vh,hc;class Q2 extends B{constructor(t,s,i){super();w(this,vh);w(this,hc);y(this,hc,t),y(this,vh,s),this.lastPoint=i}toSVGPath(){const t=[];for(const s of l(this,hc)){let[i,r]=s;t.push(`M${i} ${r}`);for(let a=2;a<s.length;a+=2){const o=s[a],c=s[a+1];o===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],a){const o=[],c=i-t,d=r-s;for(const h of l(this,hc)){const f=new Array(h.length);for(let p=0;p<h.length;p+=2)f[p]=t+h[p]*c,f[p+1]=r-h[p+1]*d;o.push(f)}return o}get box(){return l(this,vh)}get classNamesForOutlining(){return["highlightOutline"]}}vh=new WeakMap,hc=new WeakMap;class _y extends Lp{newFreeDrawOutline(e,t,s,i,r,a){return new J2(e,t,s,i,r,a)}}class J2 extends vA{newOutliner(e,t,s,i,r,a=0){return new _y(e,t,s,i,r,a)}}var vn,fo,fc,rt,xh,pc,bh,wh,jr,xn,mc,_h,we,Sy,Ay,Ey,fa,SA,sr;const ns=class ns{constructor({editor:e=null,uiManager:t=null}){w(this,we);w(this,vn,null);w(this,fo,null);w(this,fc);w(this,rt,null);w(this,xh,!1);w(this,pc,!1);w(this,bh,null);w(this,wh);w(this,jr,null);w(this,xn,null);w(this,mc);var s;e?(y(this,pc,!1),y(this,mc,de.HIGHLIGHT_COLOR),y(this,bh,e)):(y(this,pc,!0),y(this,mc,de.HIGHLIGHT_DEFAULT_COLOR)),y(this,xn,(e==null?void 0:e._uiManager)||t),y(this,wh,l(this,xn)._eventBus),y(this,fc,(e==null?void 0:e.color)||((s=l(this,xn))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),l(ns,_h)||y(ns,_h,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return re(this,"_keyboardManager",new $h([[["Escape","mac+Escape"],ns.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ns.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ns.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ns.prototype._moveToPrevious],[["Home","mac+Home"],ns.prototype._moveToBeginning],[["End","mac+End"],ns.prototype._moveToEnd]]))}renderButton(){const e=y(this,vn,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=l(this,xn)._signal;e.addEventListener("click",_(this,we,fa).bind(this),{signal:t}),e.addEventListener("keydown",_(this,we,Ey).bind(this),{signal:t});const s=y(this,fo,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=l(this,fc),e.append(s),e}renderMainDropdown(){const e=y(this,rt,_(this,we,Sy).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===l(this,vn)){_(this,we,fa).call(this,e);return}const t=e.target.getAttribute("data-color");t&&_(this,we,Ay).call(this,t,e)}_moveToNext(e){var t,s;if(!l(this,we,sr)){_(this,we,fa).call(this,e);return}if(e.target===l(this,vn)){(t=l(this,rt).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=l(this,rt))==null?void 0:t.firstChild)||e.target===l(this,vn)){l(this,we,sr)&&this._hideDropdownFromKeyboard();return}l(this,we,sr)||_(this,we,fa).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!l(this,we,sr)){_(this,we,fa).call(this,e);return}(t=l(this,rt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!l(this,we,sr)){_(this,we,fa).call(this,e);return}(t=l(this,rt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=l(this,rt))==null||e.classList.add("hidden"),(t=l(this,jr))==null||t.abort(),y(this,jr,null)}_hideDropdownFromKeyboard(){var e;if(!l(this,pc)){if(!l(this,we,sr)){(e=l(this,bh))==null||e.unselect();return}this.hideDropdown(),l(this,vn).focus({preventScroll:!0,focusVisible:l(this,xh)})}}updateColor(e){if(l(this,fo)&&(l(this,fo).style.backgroundColor=e),!l(this,rt))return;const t=l(this,xn).highlightColors.values();for(const s of l(this,rt).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=l(this,vn))==null||e.remove(),y(this,vn,null),y(this,fo,null),(t=l(this,rt))==null||t.remove(),y(this,rt,null)}};vn=new WeakMap,fo=new WeakMap,fc=new WeakMap,rt=new WeakMap,xh=new WeakMap,pc=new WeakMap,bh=new WeakMap,wh=new WeakMap,jr=new WeakMap,xn=new WeakMap,mc=new WeakMap,_h=new WeakMap,we=new WeakSet,Sy=function(){const e=document.createElement("div"),t=l(this,xn)._signal;e.addEventListener("contextmenu",Tn,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of l(this,xn).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",l(ns,_h)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.setAttribute("aria-selected",i===l(this,fc)),r.addEventListener("click",_(this,we,Ay).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",_(this,we,Ey).bind(this),{signal:t}),e},Ay=function(e,t){t.stopPropagation(),l(this,wh).dispatch("switchannotationeditorparams",{source:this,type:l(this,mc),value:e})},Ey=function(e){ns._keyboardManager.exec(this,e)},fa=function(e){if(l(this,we,sr)){this.hideDropdown();return}if(y(this,xh,e.detail===0),l(this,jr)||(y(this,jr,new AbortController),window.addEventListener("pointerdown",_(this,we,SA).bind(this),{signal:l(this,xn).combinedSignal(l(this,jr))})),l(this,rt)){l(this,rt).classList.remove("hidden");return}const t=y(this,rt,_(this,we,Sy).call(this));l(this,vn).append(t)},SA=function(e){var t;(t=l(this,rt))!=null&&t.contains(e.target)||this.hideDropdown()},sr=function(){return l(this,rt)&&!l(this,rt).classList.contains("hidden")},w(ns,_h,null);let Mp=ns;var gc,Sh,Li,po,yc,as,Ah,Eh,mo,zs,As,bt,vc,Mi,Mt,xc,Hs,kh,Z,ky,Kf,AA,EA,kA,Ny,pa,Ks,sl,NA,Yf,xu,CA,TA,jA,PA,RA;const ge=class ge extends Be{constructor(t){super({...t,name:"highlightEditor"});w(this,Z);w(this,gc,null);w(this,Sh,0);w(this,Li);w(this,po,null);w(this,yc,null);w(this,as,null);w(this,Ah,null);w(this,Eh,0);w(this,mo,null);w(this,zs,null);w(this,As,null);w(this,bt,!1);w(this,vc,null);w(this,Mi);w(this,Mt,null);w(this,xc,"");w(this,Hs);w(this,kh,"");this.color=t.color||ge._defaultColor,y(this,Hs,t.thickness||ge._defaultThickness),y(this,Mi,t.opacity||ge._defaultOpacity),y(this,Li,t.boxes||null),y(this,kh,t.methodOfCreation||""),y(this,xc,t.text||""),this._isDraggable=!1,t.highlightId>-1?(y(this,bt,!0),_(this,Z,Kf).call(this,t),_(this,Z,pa).call(this)):l(this,Li)&&(y(this,gc,t.anchorNode),y(this,Sh,t.anchorOffset),y(this,Ah,t.focusNode),y(this,Eh,t.focusOffset),_(this,Z,ky).call(this),_(this,Z,pa).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=ge.prototype;return re(this,"_keyboardManager",new $h([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,bt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,Hs),methodOfCreation:l(this,kh)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;Be.initialize(t,s),ge._defaultColor||(ge._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case de.HIGHLIGHT_DEFAULT_COLOR:ge._defaultColor=s;break;case de.HIGHLIGHT_THICKNESS:ge._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return l(this,vc)}updateParams(t,s){switch(t){case de.HIGHLIGHT_COLOR:_(this,Z,AA).call(this,s);break;case de.HIGHLIGHT_THICKNESS:_(this,Z,EA).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[de.HIGHLIGHT_DEFAULT_COLOR,ge._defaultColor],[de.HIGHLIGHT_THICKNESS,ge._defaultThickness]]}get propertiesToUpdate(){return[[de.HIGHLIGHT_COLOR,this.color||ge._defaultColor],[de.HIGHLIGHT_THICKNESS,l(this,Hs)||ge._defaultThickness],[de.HIGHLIGHT_FREE,l(this,bt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(y(this,yc,new Mp({editor:this})),t.addColorPicker(l(this,yc))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(_(this,Z,xu).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,_(this,Z,xu).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){_(this,Z,Ny).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(_(this,Z,pa).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?_(this,Z,Ny).call(this):t&&(_(this,Z,pa).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,a,o;const{drawLayer:s}=this.parent;let i;l(this,bt)?(t=(t-this.rotation+360)%360,i=_(r=ge,Ks,sl).call(r,l(this,zs).box,t)):i=_(a=ge,Ks,sl).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(l(this,As),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(l(this,Mt),{bbox:_(o=ge,Ks,sl).call(o,l(this,as).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();l(this,xc)&&(t.setAttribute("aria-label",l(this,xc)),t.setAttribute("role","mark")),l(this,bt)?t.classList.add("free"):this.div.addEventListener("keydown",_(this,Z,NA).bind(this),{signal:this._uiManager._signal});const s=y(this,mo,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,po);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),Pp(this,l(this,mo),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:_(this,Z,Yf).call(this,!0);break;case 1:case 3:_(this,Z,Yf).call(this,!1);break}}select(){var t;super.select(),l(this,Mt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),l(this,Mt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{selected:!1}}),l(this,bt)||_(this,Z,Yf).call(this,!1))}get _mustFixPosition(){return!l(this,bt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(l(this,As),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(l(this,Mt),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:a}){const{x:o,y:c,width:d,height:h}=i.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),m=g=>{f.abort(),_(this,Ks,PA).call(this,t,g)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",Ps,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Tn,{signal:p}),i.addEventListener("pointermove",_(this,Ks,jA).bind(this,t),{signal:p}),this._freeHighlight=new _y({x:r,y:a},[o,c,d,h],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var b,A,x,v;let r=null;if(t instanceof iA){const{data:{quadPoints:S,rect:E,rotation:C,id:N,color:k,opacity:T,popupRef:I},parent:{page:{pageNumber:R}}}=t;r=t={annotationType:ee.HIGHLIGHT,color:Array.from(k),opacity:T,quadPoints:S,boxes:null,pageIndex:R-1,rect:E.slice(0),rotation:C,id:N,deleted:!1,popupRef:I}}else if(t instanceof Zv){const{data:{inkLists:S,rect:E,rotation:C,id:N,color:k,borderStyle:{rawWidth:T},popupRef:I},parent:{page:{pageNumber:R}}}=t;r=t={annotationType:ee.HIGHLIGHT,color:Array.from(k),thickness:T,inkLists:S,boxes:null,pageIndex:R-1,rect:E.slice(0),rotation:C,id:N,deleted:!1,popupRef:I}}const{color:a,quadPoints:o,inkLists:c,opacity:d}=t,h=await super.deserialize(t,s,i);h.color=W.makeHexColor(...a),y(h,Mi,d||1),c&&y(h,Hs,t.thickness),h.annotationElementId=t.id||null,h._initialData=r;const[f,p]=h.pageDimensions,[m,g]=h.pageTranslation;if(o){const S=y(h,Li,[]);for(let E=0;E<o.length;E+=8)S.push({x:(o[E]-m)/f,y:1-(o[E+1]-g)/p,width:(o[E+2]-o[E])/f,height:(o[E+1]-o[E+5])/p});_(b=h,Z,ky).call(b),_(A=h,Z,pa).call(A),h.rotate(h.rotation)}else if(c){y(h,bt,!0);const S=c[0],E={x:S[0]-m,y:p-(S[1]-g)},C=new _y(E,[0,0,f,p],1,l(h,Hs)/2,!0,.001);for(let T=0,I=S.length;T<I;T+=2)E.x=S[T]-m,E.y=p-(S[T+1]-g),C.add(E);const{id:N,clipPathId:k}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);_(x=h,Z,Kf).call(x,{highlightOutlines:C.getOutlines(),highlightId:N,clipPathId:k}),_(v=h,Z,pa).call(v)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=Be._colorManager.convert(this.color),r={annotationType:ee.HIGHLIGHT,color:i,opacity:l(this,Mi),thickness:l(this,Hs),quadPoints:_(this,Z,CA).call(this),outlines:_(this,Z,TA).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:_(this,Z,xu).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!_(this,Z,RA).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};gc=new WeakMap,Sh=new WeakMap,Li=new WeakMap,po=new WeakMap,yc=new WeakMap,as=new WeakMap,Ah=new WeakMap,Eh=new WeakMap,mo=new WeakMap,zs=new WeakMap,As=new WeakMap,bt=new WeakMap,vc=new WeakMap,Mi=new WeakMap,Mt=new WeakMap,xc=new WeakMap,Hs=new WeakMap,kh=new WeakMap,Z=new WeakSet,ky=function(){const t=new by(l(this,Li),.001);y(this,zs,t.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,zs).box;const s=new by(l(this,Li),.0025,.001,this._uiManager.direction==="ltr");y(this,as,s.getOutlines());const{lastPoint:i}=l(this,as);y(this,vc,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Kf=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var f,p;if(y(this,zs,t),y(this,as,t.getNewOutline(l(this,Hs)/2+1.5,.0025)),s>=0)y(this,As,s),y(this,po,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),y(this,Mt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,as).box,path:{d:l(this,as).toSVGPath()}},!0));else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,As),{bbox:_(f=ge,Ks,sl).call(f,l(this,zs).box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Mt),{bbox:_(p=ge,Ks,sl).call(p,l(this,as).box,m),path:{d:l(this,as).toSVGPath()}})}const[a,o,c,d]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=c,this.height=d;break;case 90:{const[m,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=c*g/m,this.height=d*m/g;break}case 180:this.x=1-a,this.y=1-o,this.width=c,this.height=d;break;case 270:{const[m,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=c*g/m,this.height=d*m/g;break}}const{lastPoint:h}=l(this,as);y(this,vc,[(h[0]-a)/c,(h[1]-o)/d])},AA=function(t){const s=(a,o)=>{var c,d;this.color=a,y(this,Mi,o),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,As),{root:{fill:a,"fill-opacity":o}}),(d=l(this,yc))==null||d.updateColor(a)},i=this.color,r=l(this,Mi);this.addCommands({cmd:s.bind(this,t,ge._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},EA=function(t){const s=l(this,Hs),i=r=>{y(this,Hs,r),_(this,Z,kA).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},kA=function(t){if(!l(this,bt))return;_(this,Z,Kf).call(this,{highlightOutlines:l(this,zs).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},Ny=function(){l(this,As)===null||!this.parent||(this.parent.drawLayer.remove(l(this,As)),y(this,As,null),this.parent.drawLayer.remove(l(this,Mt)),y(this,Mt,null))},pa=function(t=this.parent){l(this,As)===null&&({id:Ut(this,As)._,clipPathId:Ut(this,po)._}=t.drawLayer.draw({bbox:l(this,zs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,Mi)},rootClass:{highlight:!0,free:l(this,bt)},path:{d:l(this,zs).toSVGPath()}},!1,!0),y(this,Mt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,bt)},bbox:l(this,as).box,path:{d:l(this,as).toSVGPath()}},l(this,bt))),l(this,mo)&&(l(this,mo).style.clipPath=l(this,po)))},Ks=new WeakSet,sl=function([t,s,i,r],a){switch(a){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},NA=function(t){ge._keyboardManager.exec(this,t)},Yf=function(t){if(!l(this,gc))return;const s=window.getSelection();t?s.setPosition(l(this,gc),l(this,Sh)):s.setPosition(l(this,Ah),l(this,Eh))},xu=function(){return l(this,bt)?this.rotation:0},CA=function(){if(l(this,bt))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,a=l(this,Li),o=new Float32Array(a.length*8);let c=0;for(const{x:d,y:h,width:f,height:p}of a){const m=d*t+i,g=(1-h)*s+r;o[c]=o[c+4]=m,o[c+1]=o[c+3]=g,o[c+2]=o[c+6]=m+f*t,o[c+5]=o[c+7]=g-p*s,c+=8}return o},TA=function(t){return l(this,zs).serialize(t,_(this,Z,xu).call(this))},jA=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},PA=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},RA=function(t){const{color:s}=this._initialData;return t.color.some((i,r)=>i!==s[r])},w(ge,Ks),K(ge,"_defaultColor",null),K(ge,"_defaultOpacity",1),K(ge,"_defaultThickness",12),K(ge,"_type","highlight"),K(ge,"_editorType",ee.HIGHLIGHT),K(ge,"_freeHighlightId",-1),K(ge,"_freeHighlight",null),K(ge,"_freeHighlightClipId","");let Dp=ge;var go;class Z2{constructor(){w(this,go,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){l(this,go)[e]=t}toSVGProperties(){const e=l(this,go);return y(this,go,Object.create(null)),{root:e}}reset(){y(this,go,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Ae("Not implemented")}}go=new WeakMap;var Es,bc,ft,yo,vo,Pr,Rr,Ir,xo,fe,Ty,jy,Py,bu,IA,Qf,wu,nl;const H=class H extends Be{constructor(t){super(t);w(this,fe);w(this,Es,null);w(this,bc);K(this,"_drawId",null);y(this,bc,t.mustBeCommitted||!1),t.drawOutlines&&(_(this,fe,Ty).call(this,t),_(this,fe,bu).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(s))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){Ae("Not implemented")}static get typesMap(){Ae("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(l(H,ft).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,a=r[s],o=c=>{var h;r.updateProperty(s,c);const d=l(this,Es).updateProperty(s,c);d&&_(this,fe,wu).call(this,d),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,H._mergeSVGProperties(l(this,Es).getPathResizingSVGProperties(_(this,fe,Qf).call(this)),{bbox:_(this,fe,nl).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,H._mergeSVGProperties(l(this,Es).getPathResizedSVGProperties(_(this,fe,Qf).call(this)),{bbox:_(this,fe,nl).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:_(this,fe,nl).call(this,t,s)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,H._mergeSVGProperties(l(this,Es).getPathTranslatedSVGProperties(_(this,fe,Qf).call(this),this.parentDimensions),{bbox:_(this,fe,nl).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,bc)&&(y(this,bc,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){_(this,fe,Py).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(_(this,fe,bu).call(this),_(this,fe,wu).call(this,l(this,Es).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),_(this,fe,Py).call(this)):t&&(this._uiManager.addShouldRescale(this),_(this,fe,bu).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,H._mergeSVGProperties({bbox:_(this,fe,nl).call(this)},l(this,Es).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&_(this,fe,wu).call(this,l(this,Es).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const s=document.createElement("div");t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,s,i,r,a){Ae("Not implemented")}static startDrawing(t,s,i,r){var A;const{target:a,offsetX:o,offsetY:c,pointerId:d,pointerType:h}=r;if(l(H,Rr)&&l(H,Rr)!==h)return;const{viewport:{rotation:f}}=t,{width:p,height:m}=a.getBoundingClientRect(),g=y(H,yo,new AbortController),b=t.combinedSignal(g);if(l(H,Pr)||y(H,Pr,d),l(H,Rr)??y(H,Rr,h),window.addEventListener("pointerup",x=>{var v;l(H,Pr)===x.pointerId?this._endDraw(x):(v=l(H,Ir))==null||v.delete(x.pointerId)},{signal:b}),window.addEventListener("pointercancel",x=>{var v;l(H,Pr)===x.pointerId?this._currentParent.endDrawingSession():(v=l(H,Ir))==null||v.delete(x.pointerId)},{signal:b}),window.addEventListener("pointerdown",x=>{l(H,Rr)===x.pointerType&&((l(H,Ir)||y(H,Ir,new Set)).add(x.pointerId),l(H,ft).isCancellable()&&(l(H,ft).removeLastElement(),l(H,ft).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Tn,{signal:b}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),a.addEventListener("touchmove",x=>{x.timeStamp===l(H,xo)&&Ps(x)},{signal:b}),t.toggleDrawing(),(A=s._editorUndoBar)==null||A.hide(),l(H,ft)){t.drawLayer.updateProperties(this._currentDrawId,l(H,ft).startNew(o,c,p,m,f));return}s.updateUIForDefaultProperties(this),y(H,ft,this.createDrawerInstance(o,c,p,m,f)),y(H,vo,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(l(H,vo).toSVGProperties(),l(H,ft).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(y(H,xo,-1),!l(H,ft))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(l(H,Pr)===r){if(((a=l(H,Ir))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(H,ft).add(s,i)),y(H,xo,t.timeStamp),Ps(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,y(H,ft,null),y(H,vo,null),y(H,Rr,null),y(H,xo,NaN)),l(H,yo)&&(l(H,yo).abort(),y(H,yo,null),y(H,Pr,NaN),y(H,Ir,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),t&&s.drawLayer.updateProperties(this._currentDrawId,l(H,ft).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=l(H,ft),r=this._currentDrawId,a=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:de.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(de.DRAW_STEP),!l(H,ft).isEmpty()){const{pageDimensions:[i,r],scale:a}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(H,ft).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:l(H,vo),mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,a,o){Ae("Not implemented")}static async deserialize(t,s,i){var f,p;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}=s.viewport,d=this.deserializeDraw(o,c,r,a,this._INNER_MARGIN,t),h=await super.deserialize(t,s,i);return h.createDrawingOptions(t),_(f=h,fe,Ty).call(f,{drawOutlines:d}),_(p=h,fe,bu).call(p),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[s,i]=this.pageTranslation,[r,a]=this.pageDimensions;return l(this,Es).serialize([s,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Es=new WeakMap,bc=new WeakMap,ft=new WeakMap,yo=new WeakMap,vo=new WeakMap,Pr=new WeakMap,Rr=new WeakMap,Ir=new WeakMap,xo=new WeakMap,fe=new WeakSet,Ty=function({drawOutlines:t,drawId:s,drawingOptions:i}){y(this,Es,t),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=_(this,fe,jy).call(this,t,this.parent),_(this,fe,wu).call(this,t.box)},jy=function(t,s){const{id:i}=s.drawLayer.draw(H._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},Py=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},bu=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=_(this,fe,jy).call(this,l(this,Es),t)}},IA=function([t,s,i,r]){const{parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[s,1-t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},Qf=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[1-s,t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},wu=function(t){if([this.x,this.y,this.width,this.height]=_(this,fe,IA).call(this,t),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},nl=function(){const{x:t,y:s,width:i,height:r,rotation:a,parentRotation:o,parentDimensions:[c,d]}=this;switch((a*4+o)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(c/d),r*(d/c),i*(c/d)];case 5:return[1-s,t,i*(c/d),r*(d/c)];case 6:return[1-t-r*(d/c),1-s,r*(d/c),i*(c/d)];case 7:return[s-i*(c/d),1-t-r*(d/c),i*(c/d),r*(d/c)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(d/c),s,r*(d/c),i*(c/d)];case 13:return[1-s-i*(c/d),t-r*(d/c),i*(c/d),r*(d/c)];case 14:return[1-t,1-s-i*(c/d),r*(d/c),i*(c/d)];case 15:return[s,1-t,i*(c/d),r*(d/c)];default:return[t,s,i,r]}},K(H,"_currentDrawId",-1),K(H,"_currentParent",null),w(H,ft,null),w(H,yo,null),w(H,vo,null),w(H,Pr,NaN),w(H,Rr,null),w(H,Ir,null),w(H,xo,NaN),K(H,"_INNER_MARGIN",3);let Cy=H;var Kn,pt,mt,bo,wc,Wt,wt,Vs,wo,_o,So,_c,Jf;class eP{constructor(e,t,s,i,r,a){w(this,_c);w(this,Kn,new Float64Array(6));w(this,pt);w(this,mt);w(this,bo);w(this,wc);w(this,Wt);w(this,wt,"");w(this,Vs,0);w(this,wo,new Op);w(this,_o);w(this,So);y(this,_o,s),y(this,So,i),y(this,bo,r),y(this,wc,a),[e,t]=_(this,_c,Jf).call(this,e,t);const o=y(this,pt,[NaN,NaN,NaN,NaN,e,t]);y(this,Wt,[e,t]),y(this,mt,[{line:o,points:l(this,Wt)}]),l(this,Kn).set(o,0)}updateProperty(e,t){e==="stroke-width"&&y(this,wc,t)}isEmpty(){return!l(this,mt)||l(this,mt).length===0}isCancellable(){return l(this,Wt).length<=10}add(e,t){[e,t]=_(this,_c,Jf).call(this,e,t);const[s,i,r,a]=l(this,Kn).subarray(2,6),o=e-r,c=t-a;return Math.hypot(l(this,_o)*o,l(this,So)*c)<=2?null:(l(this,Wt).push(e,t),isNaN(s)?(l(this,Kn).set([r,a,e,t],2),l(this,pt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(l(this,Kn)[0])&&l(this,pt).splice(6,6),l(this,Kn).set([s,i,r,a,e,t],0),l(this,pt).push(...B.createBezierPoints(s,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(l(this,Wt).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){y(this,_o,s),y(this,So,i),y(this,bo,r),[e,t]=_(this,_c,Jf).call(this,e,t);const a=y(this,pt,[NaN,NaN,NaN,NaN,e,t]);y(this,Wt,[e,t]);const o=l(this,mt).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),l(this,mt).push({line:a,points:l(this,Wt)}),l(this,Kn).set(a,0),y(this,Vs,0),this.toSVGPath(),null}getLastElement(){return l(this,mt).at(-1)}setLastElement(e){return l(this,mt)?(l(this,mt).push(e),y(this,pt,e.line),y(this,Wt,e.points),y(this,Vs,0),{path:{d:this.toSVGPath()}}):l(this,wo).setLastElement(e)}removeLastElement(){if(!l(this,mt))return l(this,wo).removeLastElement();l(this,mt).pop(),y(this,wt,"");for(let e=0,t=l(this,mt).length;e<t;e++){const{line:s,points:i}=l(this,mt)[e];y(this,pt,s),y(this,Wt,i),y(this,Vs,0),this.toSVGPath()}return{path:{d:l(this,wt)}}}toSVGPath(){const e=B.svgRound(l(this,pt)[4]),t=B.svgRound(l(this,pt)[5]);if(l(this,Wt).length===2)return y(this,wt,`${l(this,wt)} M ${e} ${t} Z`),l(this,wt);if(l(this,Wt).length<=6){const i=l(this,wt).lastIndexOf("M");y(this,wt,`${l(this,wt).slice(0,i)} M ${e} ${t}`),y(this,Vs,6)}if(l(this,Wt).length===4){const i=B.svgRound(l(this,pt)[10]),r=B.svgRound(l(this,pt)[11]);return y(this,wt,`${l(this,wt)} L ${i} ${r}`),y(this,Vs,12),l(this,wt)}const s=[];l(this,Vs)===0&&(s.push(`M ${e} ${t}`),y(this,Vs,6));for(let i=l(this,Vs),r=l(this,pt).length;i<r;i+=6){const[a,o,c,d,h,f]=l(this,pt).slice(i,i+6).map(B.svgRound);s.push(`C${a} ${o} ${c} ${d} ${h} ${f}`)}return y(this,wt,l(this,wt)+s.join(" ")),y(this,Vs,l(this,pt).length),l(this,wt)}getOutlines(e,t,s,i){const r=l(this,mt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,wo).build(l(this,mt),e,t,s,l(this,bo),l(this,wc),i),y(this,Kn,null),y(this,pt,null),y(this,mt,null),y(this,wt,null),l(this,wo)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Kn=new WeakMap,pt=new WeakMap,mt=new WeakMap,bo=new WeakMap,wc=new WeakMap,Wt=new WeakMap,wt=new WeakMap,Vs=new WeakMap,wo=new WeakMap,_o=new WeakMap,So=new WeakMap,_c=new WeakSet,Jf=function(e,t){return B._normalizePoint(e,t,l(this,_o),l(this,So),l(this,bo))};var qt,Nh,Ch,ks,Yn,Qn,Sc,Ac,Ec,At,ci,LA,MA,DA;const ix=class ix extends B{constructor(){super(...arguments);w(this,At);w(this,qt);w(this,Nh,0);w(this,Ch);w(this,ks);w(this,Yn);w(this,Qn);w(this,Sc);w(this,Ac);w(this,Ec)}build(t,s,i,r,a,o,c){y(this,Yn,s),y(this,Qn,i),y(this,Sc,r),y(this,Ac,a),y(this,Ec,o),y(this,Ch,c??0),y(this,ks,t),_(this,At,MA).call(this)}setLastElement(t){return l(this,ks).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,ks).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of l(this,ks)){if(t.push(`M${B.svgRound(s[4])} ${B.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12){t.push(`L${B.svgRound(s[10])} ${B.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[a,o,c,d,h,f]=s.subarray(i,i+6).map(B.svgRound);t.push(`C${a} ${o} ${c} ${d} ${h} ${f}`)}}return t.join("")}serialize([t,s,i,r],a){const o=[],c=[],[d,h,f,p]=_(this,At,LA).call(this);let m,g,b,A,x,v,S,E,C;switch(l(this,Ac)){case 0:C=B._rescale,m=t,g=s+r,b=i,A=-r,x=t+d*i,v=s+(1-h-p)*r,S=t+(d+f)*i,E=s+(1-h)*r;break;case 90:C=B._rescaleAndSwap,m=t,g=s,b=i,A=r,x=t+h*i,v=s+d*r,S=t+(h+p)*i,E=s+(d+f)*r;break;case 180:C=B._rescale,m=t+i,g=s,b=-i,A=r,x=t+(1-d-f)*i,v=s+h*r,S=t+(1-d)*i,E=s+(h+p)*r;break;case 270:C=B._rescaleAndSwap,m=t+i,g=s+r,b=-i,A=-r,x=t+(1-h-p)*i,v=s+(1-d-f)*r,S=t+(1-h)*i,E=s+(1-d)*r;break}for(const{line:N,points:k}of l(this,ks))o.push(C(N,m,g,b,A,a?new Array(N.length):null)),c.push(C(k,m,g,b,A,a?new Array(k.length):null));return{lines:o,points:c,rect:[x,v,S,E]}}static deserialize(t,s,i,r,a,{paths:{lines:o,points:c},rotation:d,thickness:h}){const f=[];let p,m,g,b,A;switch(d){case 0:A=B._rescale,p=-t/i,m=s/r+1,g=1/i,b=-1/r;break;case 90:A=B._rescaleAndSwap,p=-s/r,m=-t/i,g=1/r,b=1/i;break;case 180:A=B._rescale,p=t/i+1,m=-s/r,g=-1/i,b=1/r;break;case 270:A=B._rescaleAndSwap,p=s/r+1,m=t/i+1,g=-1/r,b=-1/i;break}if(!o){o=[];for(const v of c){const S=v.length;if(S===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1]]));continue}if(S===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1],NaN,NaN,NaN,NaN,v[2],v[3]]));continue}const E=new Float32Array(3*(S-2));o.push(E);let[C,N,k,T]=v.subarray(0,4);E.set([NaN,NaN,NaN,NaN,C,N],0);for(let I=4;I<S;I+=2){const R=v[I],z=v[I+1];E.set(B.createBezierPoints(C,N,k,T,R,z),(I-2)*3),[C,N,k,T]=[k,T,R,z]}}}for(let v=0,S=o.length;v<S;v++)f.push({line:A(o[v].map(E=>E??NaN),p,m,g,b),points:A(c[v].map(E=>E??NaN),p,m,g,b)});const x=new ix;return x.build(f,i,r,1,d,h,a),x}get box(){return l(this,qt)}updateProperty(t,s){return t==="stroke-width"?_(this,At,DA).call(this,s):null}updateParentDimensions([t,s],i){const[r,a]=_(this,At,ci).call(this);y(this,Yn,t),y(this,Qn,s),y(this,Sc,i);const[o,c]=_(this,At,ci).call(this),d=o-r,h=c-a,f=l(this,qt);return f[0]-=d,f[1]-=h,f[2]+=2*d,f[3]+=2*h,f}updateRotation(t){return y(this,Nh,t),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,qt).map(B.svgRound).join(" ")}get defaultProperties(){const[t,s]=l(this,qt);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${B.svgRound(t)} ${B.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=l(this,qt);let i=0,r=0,a=0,o=0,c=0,d=0;switch(l(this,Nh)){case 90:r=s/t,a=-t/s,c=t;break;case 180:i=-1,o=-1,c=t,d=s;break;case 270:r=-s/t,a=t/s,d=s;break;default:return""}return`matrix(${i} ${r} ${a} ${o} ${B.svgRound(c)} ${B.svgRound(d)})`}getPathResizingSVGProperties([t,s,i,r]){const[a,o]=_(this,At,ci).call(this),[c,d,h,f]=l(this,qt);if(Math.abs(h-a)<=B.PRECISION||Math.abs(f-o)<=B.PRECISION){const A=t+i/2-(c+h/2),x=s+r/2-(d+f/2);return{path:{"transform-origin":`${B.svgRound(t)} ${B.svgRound(s)}`,transform:`${this.rotationTransform} translate(${A} ${x})`}}}const p=(i-2*a)/(h-2*a),m=(r-2*o)/(f-2*o),g=h/i,b=f/r;return{path:{"transform-origin":`${B.svgRound(c)} ${B.svgRound(d)}`,transform:`${this.rotationTransform} scale(${g} ${b}) translate(${B.svgRound(a)} ${B.svgRound(o)}) scale(${p} ${m}) translate(${B.svgRound(-a)} ${B.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[a,o]=_(this,At,ci).call(this),c=l(this,qt),[d,h,f,p]=c;if(c[0]=t,c[1]=s,c[2]=i,c[3]=r,Math.abs(f-a)<=B.PRECISION||Math.abs(p-o)<=B.PRECISION){const x=t+i/2-(d+f/2),v=s+r/2-(h+p/2);for(const{line:S,points:E}of l(this,ks))B._translate(S,x,v,S),B._translate(E,x,v,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${B.svgRound(t)} ${B.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*a)/(f-2*a),g=(r-2*o)/(p-2*o),b=-m*(d+a)+t+a,A=-g*(h+o)+s+o;if(m!==1||g!==1||b!==0||A!==0)for(const{line:x,points:v}of l(this,ks))B._rescale(x,b,A,m,g,x),B._rescale(v,b,A,m,g,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${B.svgRound(t)} ${B.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,a]=i,o=l(this,qt),c=t-o[0],d=s-o[1];if(l(this,Yn)===r&&l(this,Qn)===a)for(const{line:h,points:f}of l(this,ks))B._translate(h,c,d,h),B._translate(f,c,d,f);else{const h=l(this,Yn)/r,f=l(this,Qn)/a;y(this,Yn,r),y(this,Qn,a);for(const{line:p,points:m}of l(this,ks))B._rescale(p,c,d,h,f,p),B._rescale(m,c,d,h,f,m);o[2]*=h,o[3]*=f}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${B.svgRound(t)} ${B.svgRound(s)}`}}}get defaultSVGProperties(){const t=l(this,qt);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${B.svgRound(t[0])} ${B.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};qt=new WeakMap,Nh=new WeakMap,Ch=new WeakMap,ks=new WeakMap,Yn=new WeakMap,Qn=new WeakMap,Sc=new WeakMap,Ac=new WeakMap,Ec=new WeakMap,At=new WeakSet,ci=function(t=l(this,Ec)){const s=l(this,Ch)+t/2*l(this,Sc);return l(this,Ac)%180===0?[s/l(this,Yn),s/l(this,Qn)]:[s/l(this,Qn),s/l(this,Yn)]},LA=function(){const[t,s,i,r]=l(this,qt),[a,o]=_(this,At,ci).call(this,0);return[t+a,s+o,i-2*a,r-2*o]},MA=function(){const t=y(this,qt,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,ks)){if(r.length<=12){for(let c=4,d=r.length;c<d;c+=6){const[h,f]=r.subarray(c,c+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],f),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],f)}continue}let a=r[4],o=r[5];for(let c=6,d=r.length;c<d;c+=6){const[h,f,p,m,g,b]=r.subarray(c,c+6);W.bezierBoundingBox(a,o,h,f,p,m,g,b,t),a=g,o=b}}const[s,i]=_(this,At,ci).call(this);t[0]=Math.min(1,Math.max(0,t[0]-s)),t[1]=Math.min(1,Math.max(0,t[1]-i)),t[2]=Math.min(1,Math.max(0,t[2]+s)),t[3]=Math.min(1,Math.max(0,t[3]+i)),t[2]-=t[0],t[3]-=t[1]},DA=function(t){const[s,i]=_(this,At,ci).call(this);y(this,Ec,t);const[r,a]=_(this,At,ci).call(this),[o,c]=[r-s,a-i],d=l(this,qt);return d[0]-=o,d[1]-=c,d[2]+=2*o,d[3]+=2*c,d};let Op=ix;var kc;const rx=class rx extends Z2{constructor(t){super();w(this,kc);y(this,kc,t),super.updateProperties({fill:"none",stroke:Be._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,s){t==="stroke-width"&&(s??(s=this["stroke-width"]),s*=l(this,kc).realScale),super.updateSVGProperty(t,s)}clone(){const t=new rx(l(this,kc));return t.updateAll(this),t}};kc=new WeakMap;let Ry=rx;var tm,OA;const yl=class yl extends Cy{constructor(t){super({...t,name:"inkEditor"});w(this,tm);this._willKeepAspectRatio=!0}static initialize(t,s){Be.initialize(t,s),this._defaultDrawingOptions=new Ry(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return re(this,"typesMap",new Map([[de.INK_THICKNESS,"stroke-width"],[de.INK_COLOR,"stroke"],[de.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,a){return new eP(t,s,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,a,o){return Op.deserialize(t,s,i,r,a,o)}static async deserialize(t,s,i){let r=null;if(t instanceof Zv){const{data:{inkLists:o,rect:c,rotation:d,id:h,color:f,opacity:p,borderStyle:{rawWidth:m},popupRef:g},parent:{page:{pageNumber:b}}}=t;r=t={annotationType:ee.INK,color:Array.from(f),thickness:m,opacity:p,paths:{points:o},boxes:null,pageIndex:b-1,rect:c.slice(0),rotation:d,id:h,deleted:!1,popupRef:g}}const a=await super.deserialize(t,s,i);return a.annotationElementId=t.id||null,a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=yl.getDefaultDrawingOptions({stroke:W.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":c}}=this,d={annotationType:ee.INK,color:Be._colorManager.convert(a),opacity:o,thickness:c,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?d:this.annotationElementId&&!_(this,tm,OA).call(this,d)?null:(d.id=this.annotationElementId,d)}renderAnnotationElement(t){const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};tm=new WeakSet,OA=function(t){const{color:s,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,c)=>o!==s[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a},K(yl,"_type","ink"),K(yl,"_editorType",ee.INK),K(yl,"_defaultDrawingOptions",null);let Iy=yl;var Fe,_t,Lr,Di,Mr,Nc,Jn,Zn,Ns,Cc,pe,_u,Su,Zf,My,ep,Dy,tp,FA;const Ou=class Ou extends Be{constructor(t){super({...t,name:"stampEditor"});w(this,pe);w(this,Fe,null);w(this,_t,null);w(this,Lr,null);w(this,Di,null);w(this,Mr,null);w(this,Nc,"");w(this,Jn,null);w(this,Zn,null);w(this,Ns,!1);w(this,Cc,!1);y(this,Di,t.bitmapUrl),y(this,Mr,t.bitmapFile)}static initialize(t,s){Be.initialize(t,s)}static get supportedTypes(){return re(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return re(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(ee.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const d=c.output;return await this.setGuessedAltText(d),s&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}remove(){var t;l(this,_t)&&(y(this,Fe,null),this._uiManager.imageManager.deleteId(l(this,_t)),(t=l(this,Jn))==null||t.remove(),y(this,Jn,null),l(this,Zn)&&(clearTimeout(l(this,Zn)),y(this,Zn,null))),super.remove()}rebuild(){if(!this.parent){l(this,_t)&&_(this,pe,Zf).call(this);return}super.rebuild(),this.div!==null&&(l(this,_t)&&l(this,Jn)===null&&_(this,pe,Zf).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(l(this,Lr)||l(this,Fe)||l(this,Di)||l(this,Mr)||l(this,_t))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),l(this,Fe)?_(this,pe,My).call(this):_(this,pe,Zf).call(this),this.width&&!this.annotationElementId){const[i,r]=this.parentDimensions;this.setAt(t*i,s*r,this.width*i,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,Zn)!==null&&clearTimeout(l(this,Zn)),y(this,Zn,setTimeout(()=>{y(this,Zn,null),_(this,pe,Dy).call(this)},200))}copyCanvas(t,s,i=!1){var m;t||(t=224);const{width:r,height:a}=l(this,Fe),o=new R0;let c=l(this,Fe),d=r,h=a,f=null;if(s){if(r>s||a>s){const T=Math.min(s/r,s/a);d=Math.floor(r*T),h=Math.floor(a*T)}f=document.createElement("canvas");const g=f.width=Math.ceil(d*o.sx),b=f.height=Math.ceil(h*o.sy);l(this,Ns)||(c=_(this,pe,ep).call(this,g,b));const A=f.getContext("2d");A.filter=this._uiManager.hcmFilter;let x="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":(m=window.matchMedia)!=null&&m.call(window,"(prefers-color-scheme: dark)").matches&&(x="#8f8f9d",v="#42414d");const S=15,E=S*o.sx,C=S*o.sy,N=new OffscreenCanvas(E*2,C*2),k=N.getContext("2d");k.fillStyle=x,k.fillRect(0,0,E*2,C*2),k.fillStyle=v,k.fillRect(0,0,E,C),k.fillRect(E,C,E,C),A.fillStyle=A.createPattern(N,"repeat"),A.fillRect(0,0,g,b),A.drawImage(c,0,0,c.width,c.height,0,0,g,b)}let p=null;if(i){let g,b;if(o.symmetric&&c.width<t&&c.height<t)g=c.width,b=c.height;else if(c=l(this,Fe),r>t||a>t){const v=Math.min(t/r,t/a);g=Math.floor(r*v),b=Math.floor(a*v),l(this,Ns)||(c=_(this,pe,ep).call(this,g,b))}const x=new OffscreenCanvas(g,b).getContext("2d",{willReadFrequently:!0});x.drawImage(c,0,0,c.width,c.height,0,0,g,b),p={width:g,height:b,data:x.getImageData(0,0,g,b).data}}return{canvas:f,width:d,height:h,imageData:p}}getImageForAltText(){return l(this,Jn)}static async deserialize(t,s,i){var b;let r=null;if(t instanceof rA){const{data:{rect:A,rotation:x,id:v,structParent:S,popupRef:E},container:C,parent:{page:{pageNumber:N}}}=t,k=C.querySelector("canvas"),T=i.imageManager.getFromCanvas(C.id,k);k.remove();const I=((b=await s._structTree.getAriaAttributes(`${Wv}${v}`))==null?void 0:b.get("aria-label"))||"";r=t={annotationType:ee.STAMP,bitmapId:T.id,bitmap:T.bitmap,pageIndex:N-1,rect:A.slice(0),rotation:x,id:v,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:S,popupRef:E}}const a=await super.deserialize(t,s,i),{rect:o,bitmap:c,bitmapUrl:d,bitmapId:h,isSvg:f,accessibilityData:p}=t;h&&i.imageManager.isValidId(h)?(y(a,_t,h),c&&y(a,Fe,c)):y(a,Di,d),y(a,Ns,f);const[m,g]=a.pageDimensions;return a.width=(o[2]-o[0])/m,a.height=(o[3]-o[1])/g,a.annotationElementId=t.id||null,p&&(a.altTextData=p),a._initialData=r,y(a,Cc,!!r),a}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:ee.STAMP,bitmapId:l(this,_t),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,Ns),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=_(this,pe,tp).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=_(this,pe,FA).call(this,i);if(c.isSame)return null;c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const o=l(this,Ns)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(l(this,_t)))s.stamps.set(l(this,_t),{area:o,serialized:i}),i.bitmap=_(this,pe,tp).call(this,!1);else if(l(this,Ns)){const c=s.stamps.get(l(this,_t));o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=_(this,pe,tp).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Fe=new WeakMap,_t=new WeakMap,Lr=new WeakMap,Di=new WeakMap,Mr=new WeakMap,Nc=new WeakMap,Jn=new WeakMap,Zn=new WeakMap,Ns=new WeakMap,Cc=new WeakMap,pe=new WeakSet,_u=function(t,s=!1){if(!t){this.remove();return}y(this,Fe,t.bitmap),s||(y(this,_t,t.id),y(this,Ns,t.isSvg)),t.file&&y(this,Nc,t.file.name),_(this,pe,My).call(this)},Su=function(){if(y(this,Lr,null),this._uiManager.enableWaiting(!1),!!l(this,Jn)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Fe)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Fe)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Zf=function(){if(l(this,_t)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,_t)).then(i=>_(this,pe,_u).call(this,i,!0)).finally(()=>_(this,pe,Su).call(this));return}if(l(this,Di)){const i=l(this,Di);y(this,Di,null),this._uiManager.enableWaiting(!0),y(this,Lr,this._uiManager.imageManager.getFromUrl(i).then(r=>_(this,pe,_u).call(this,r)).finally(()=>_(this,pe,Su).call(this)));return}if(l(this,Mr)){const i=l(this,Mr);y(this,Mr,null),this._uiManager.enableWaiting(!0),y(this,Lr,this._uiManager.imageManager.getFromFile(i).then(r=>_(this,pe,_u).call(this,r)).finally(()=>_(this,pe,Su).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Ou.supportedTypesStr;const s=this._uiManager._signal;y(this,Lr,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),_(this,pe,_u).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>_(this,pe,Su).call(this))),t.click()},My=function(){var f;const{div:t}=this;let{width:s,height:i}=l(this,Fe);const[r,a]=this.pageDimensions,o=.75;if(this.width)s=this.width*r,i=this.height*a;else if(s>o*r||i>o*a){const p=Math.min(o*r/s,o*a/i);s*=p,i*=p}const[c,d]=this.parentDimensions;this.setDims(s*c/r,i*d/a),this._uiManager.enableWaiting(!1);const h=y(this,Jn,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=s/r,this.height=i/a,(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),_(this,pe,Dy).call(this),l(this,Cc)||(this.parent.addUndoableEditor(this),y(this,Cc,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,Nc)&&h.setAttribute("aria-label",l(this,Nc))},ep=function(t,s){const{width:i,height:r}=l(this,Fe);let a=i,o=r,c=l(this,Fe);for(;a>2*t||o>2*s;){const d=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(c,0,0,d,h,0,0,a,o),c=f.transferToImageBitmap()}return c},Dy=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,a=new R0,o=Math.ceil(i*t*a.sx),c=Math.ceil(r*s*a.sy),d=l(this,Jn);if(!d||d.width===o&&d.height===c)return;d.width=o,d.height=c;const h=l(this,Ns)?l(this,Fe):_(this,pe,ep).call(this,o,c),f=d.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(h,0,0,h.width,h.height,0,0,o,c)},tp=function(t){if(t){if(l(this,Ns)){const r=this._uiManager.imageManager.getSvgUrl(l(this,_t));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,Fe),s.getContext("2d").drawImage(l(this,Fe),0,0),s.toDataURL()}if(l(this,Ns)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*ea.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*ea.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(l(this,Fe),0,0,l(this,Fe).width,l(this,Fe).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(l(this,Fe))},FA=function(t){var o;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},K(Ou,"_type","stamp"),K(Ou,"_editorType",ee.STAMP);let Ly=Ou;var Ao,Tc,ei,Dr,Oi,Ws,Or,jc,Eo,bn,Fi,Dt,$i,V,Fr,Le,$A,Mn,Fy,$y,sp;const on=class on{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:c,viewport:d,l10n:h}){w(this,Le);w(this,Ao);w(this,Tc,!1);w(this,ei,null);w(this,Dr,null);w(this,Oi,null);w(this,Ws,new Map);w(this,Or,!1);w(this,jc,!1);w(this,Eo,!1);w(this,bn,null);w(this,Fi,null);w(this,Dt,null);w(this,$i,null);w(this,V);const f=[...l(on,Fr).values()];if(!on._initialized){on._initialized=!0;for(const p of f)p.initialize(h,e)}e.registerEditorTypes(f),y(this,V,e),this.pageIndex=t,this.div=s,y(this,Ao,r),y(this,ei,a),this.viewport=d,y(this,Dt,c),this.drawLayer=o,this._structTree=i,l(this,V).addLayer(this)}get isEmpty(){return l(this,Ws).size===0}get isInvisible(){return this.isEmpty&&l(this,V).getMode()===ee.NONE}updateToolbar(e){l(this,V).updateToolbar(e)}updateMode(e=l(this,V).getMode()){switch(_(this,Le,sp).call(this),e){case ee.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ee.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ee.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of l(on,Fr).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=l(this,Dt))==null?void 0:t.div)}setEditingState(e){l(this,V).setEditingState(e)}addCommands(e){l(this,V).addCommands(e)}cleanUndoStack(e){l(this,V).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=l(this,ei))==null||t.div.classList.toggle("disabled",!e)}async enable(){y(this,Eo,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of l(this,Ws).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(l(this,V).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!l(this,ei)){y(this,Eo,!1);return}const t=l(this,ei).getEditableAnnotations();for(const s of t){if(s.hide(),l(this,V).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}y(this,Eo,!1)}disable(){var i;y(this,jc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of l(this,Ws).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(l(this,ei)){const r=l(this,ei).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(l(this,V).isDeletedAnnotationElement(o))continue;let c=t.get(o);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=e.get(o),c&&(l(this,V).addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}_(this,Le,sp).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of l(on,Fr).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),y(this,jc,!1)}getEditableAnnotation(e){var t;return((t=l(this,ei))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){l(this,V).getActive()!==e&&l(this,V).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=l(this,Dt))!=null&&e.div&&!l(this,$i)){y(this,$i,new AbortController);const t=l(this,V).combinedSignal(l(this,$i));l(this,Dt).div.addEventListener("pointerdown",_(this,Le,$A).bind(this),{signal:t}),l(this,Dt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=l(this,Dt))!=null&&e.div&&l(this,$i)&&(l(this,$i).abort(),y(this,$i,null),l(this,Dt).div.classList.remove("highlighting"))}enableClick(){if(l(this,Dr))return;y(this,Dr,new AbortController);const e=l(this,V).combinedSignal(l(this,Dr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=l(this,Dr))==null||e.abort(),y(this,Dr,null)}attach(e){l(this,Ws).set(e.id,e);const{annotationElementId:t}=e;t&&l(this,V).isDeletedAnnotationElement(t)&&l(this,V).removeDeletedAnnotationElement(e)}detach(e){var t;l(this,Ws).delete(e.id),(t=l(this,Ao))==null||t.removePointerInTextLayer(e.contentDiv),!l(this,jc)&&e.annotationElementId&&l(this,V).addDeletedAnnotationElement(e)}remove(e){this.detach(e),l(this,V).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(l(this,V).addDeletedAnnotationElement(e.annotationElementId),Be.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),l(this,V).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!l(this,Eo)),l(this,V).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!l(this,Oi)&&(e._focusEventsAllowed=!1,y(this,Oi,setTimeout(()=>{y(this,Oi,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:l(this,V)._signal}),t.focus())},0))),e._structTreeParentId=(s=l(this,Ao))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return l(this,V).getId()}combinedSignal(e){return l(this,V).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=l(this,Le,Mn))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){l(this,V).updateToolbar(e),l(this,V).updateMode(e);const{offsetX:s,offsetY:i}=_(this,Le,$y).call(this),r=this.getNextId(),a=_(this,Le,Fy).call(this,{parent:this,id:r,x:s,y:i,uiManager:l(this,V),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=l(on,Fr).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,l(this,V)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=_(this,Le,Fy).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:l(this,V),isCentered:t,...s});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(_(this,Le,$y).call(this),!0)}setSelected(e){l(this,V).setSelected(e)}toggleSelected(e){l(this,V).toggleSelected(e)}unselect(e){l(this,V).unselect(e)}pointerup(e){var s;const{isMac:t}=Yt.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&l(this,Or)&&(y(this,Or,!1),!((s=l(this,Le,Mn))!=null&&s.isDrawer&&l(this,Le,Mn).supportMultipleDrawings))){if(!l(this,Tc)){y(this,Tc,!0);return}if(l(this,V).getMode()===ee.STAMP){l(this,V).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var i;if(l(this,V).getMode()===ee.HIGHLIGHT&&this.enableTextSelection(),l(this,Or)){y(this,Or,!1);return}const{isMac:t}=Yt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(y(this,Or,!0),(i=l(this,Le,Mn))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=l(this,V).getActive();y(this,Tc,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus(),l(this,bn)){l(this,Le,Mn).startDrawing(this,l(this,V),!1,e);return}l(this,V).setCurrentDrawingSession(this),y(this,bn,new AbortController);const t=l(this,V).combinedSignal(l(this,bn));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(y(this,Fi,null),this.commitOrRemove())},{signal:t}),l(this,Le,Mn).startDrawing(this,l(this,V),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&y(this,Fi,t);return}l(this,Fi)&&setTimeout(()=>{var t;(t=l(this,Fi))==null||t.focus(),y(this,Fi,null)},0)}endDrawingSession(e=!1){return l(this,bn)?(l(this,V).setCurrentDrawingSession(null),l(this,bn).abort(),y(this,bn,null),y(this,Fi,null),l(this,Le,Mn).endDrawing(e)):null}findNewParent(e,t,s){const i=l(this,V).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return l(this,bn)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,bn)&&l(this,Le,Mn).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=l(this,V).getActive())==null?void 0:e.parent)===this&&(l(this,V).commitOrRemove(),l(this,V).setActiveEditor(null)),l(this,Oi)&&(clearTimeout(l(this,Oi)),y(this,Oi,null));for(const s of l(this,Ws).values())(t=l(this,Ao))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,Ws).clear(),l(this,V).removeLayer(this)}render({viewport:e}){this.viewport=e,Lo(this.div,e);for(const t of l(this,V).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){l(this,V).commitOrRemove(),_(this,Le,sp).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Lo(this.div,{rotation:s}),t!==s)for(const i of l(this,Ws).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return l(this,V).viewParameters.realScale}};Ao=new WeakMap,Tc=new WeakMap,ei=new WeakMap,Dr=new WeakMap,Oi=new WeakMap,Ws=new WeakMap,Or=new WeakMap,jc=new WeakMap,Eo=new WeakMap,bn=new WeakMap,Fi=new WeakMap,Dt=new WeakMap,$i=new WeakMap,V=new WeakMap,Fr=new WeakMap,Le=new WeakSet,$A=function(e){l(this,V).unselectAll();const{target:t}=e;if(t===l(this,Dt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&l(this,Dt).div.contains(t)){const{isMac:s}=Yt.platform;if(e.button!==0||e.ctrlKey&&s)return;l(this,V).showAllEditors("highlight",!0,!0),l(this,Dt).div.classList.add("free"),this.toggleDrawing(),Dp.startHighlighting(this,l(this,V).direction==="ltr",{target:l(this,Dt).div,x:e.x,y:e.y}),l(this,Dt).div.addEventListener("pointerup",()=>{l(this,Dt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,V)._signal}),e.preventDefault()}},Mn=function(){return l(on,Fr).get(l(this,V).getMode())},Fy=function(e){const t=l(this,Le,Mn);return t?new t.prototype.constructor(e):null},$y=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+i),d=(r+o)/2-e,h=(a+c)/2-t,[f,p]=this.viewport.rotation%180===0?[d,h]:[h,d];return{offsetX:f,offsetY:p}},sp=function(){for(const e of l(this,Ws).values())e.isEmpty()&&e.remove()},K(on,"_initialized",!1),w(on,Fr,new Map([vy,Iy,Ly,Dp].map(e=>[e._editorType,e])));let Oy=on;var wn,Th,Gt,ko,sm,BA,ii,Uy,UA,zy;const Rt=class Rt{constructor({pageIndex:e}){w(this,ii);w(this,wn,null);w(this,Th,0);w(this,Gt,new Map);w(this,ko,new Map);this.pageIndex=e}setParent(e){if(!l(this,wn)){y(this,wn,e);return}if(l(this,wn)!==e){if(l(this,Gt).size>0)for(const t of l(this,Gt).values())t.remove(),e.append(t);y(this,wn,e)}}static get _svgFactory(){return re(this,"_svgFactory",new Jv)}draw(e,t=!1,s=!1){const i=Ut(this,Th)._++,r=_(this,ii,Uy).call(this),a=Rt._svgFactory.createElement("defs");r.append(a);const o=Rt._svgFactory.createElement("path");a.append(o);const c=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke"),t&&l(this,ko).set(i,o);const d=s?_(this,ii,UA).call(this,a,c):null,h=Rt._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(r,e),l(this,Gt).set(i,r),{id:i,clipPathId:`url(#${d})`}}drawOutline(e,t){const s=Ut(this,Th)._++,i=_(this,ii,Uy).call(this),r=Rt._svgFactory.createElement("defs");i.append(r);const a=Rt._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const f=Rt._svgFactory.createElement("mask");r.append(f),c=`mask_p${this.pageIndex}_${s}`,f.setAttribute("id",c),f.setAttribute("maskUnits","objectBoundingBox");const p=Rt._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const m=Rt._svgFactory.createElement("use");f.append(m),m.setAttribute("href",`#${o}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const d=Rt._svgFactory.createElement("use");i.append(d),d.setAttribute("href",`#${o}`),c&&d.setAttribute("mask",`url(#${c})`);const h=d.cloneNode();return i.append(h),d.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(i,e),l(this,Gt).set(s,i),s}finalizeDraw(e,t){l(this,ko).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:i,rootClass:r,path:a}=t,o=typeof e=="number"?l(this,Gt).get(e):e;if(o){if(s&&_(this,ii,zy).call(this,o,s),i&&_(c=Rt,sm,BA).call(c,o,i),r){const{classList:d}=o;for(const[h,f]of Object.entries(r))d.toggle(h,f)}if(a){const h=o.firstChild.firstChild;_(this,ii,zy).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const s=l(this,Gt).get(e);s&&(l(t,wn).append(s),l(this,Gt).delete(e),l(t,Gt).set(e,s))}remove(e){l(this,ko).delete(e),l(this,wn)!==null&&(l(this,Gt).get(e).remove(),l(this,Gt).delete(e))}destroy(){y(this,wn,null);for(const e of l(this,Gt).values())e.remove();l(this,Gt).clear(),l(this,ko).clear()}};wn=new WeakMap,Th=new WeakMap,Gt=new WeakMap,ko=new WeakMap,sm=new WeakSet,BA=function(e,[t,s,i,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*r}%`},ii=new WeakSet,Uy=function(){const e=Rt._svgFactory.create(1,1,!0);return l(this,wn).append(e),e.setAttribute("aria-hidden",!0),e},UA=function(e,t){const s=Rt._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=Rt._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},zy=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},w(Rt,sm);let By=Rt;globalThis.pdfjsTestingUtils={HighlightOutliner:by};Q.AbortException;Q.AnnotationEditorLayer;Q.AnnotationEditorParamsType;Q.AnnotationEditorType;Q.AnnotationEditorUIManager;Q.AnnotationLayer;Q.AnnotationMode;Q.ColorPicker;Q.DOMSVGFactory;Q.DrawLayer;Q.FeatureTest;var tP=Q.GlobalWorkerOptions;Q.ImageKind;Q.InvalidPDFException;Q.MissingPDFException;Q.OPS;Q.OutputScale;Q.PDFDataRangeTransport;Q.PDFDateString;Q.PDFWorker;Q.PasswordResponses;Q.PermissionFlag;Q.PixelsPerInch;Q.RenderingCancelledException;Q.TextLayer;Q.TouchManager;Q.UnexpectedResponseException;Q.Util;Q.VerbosityLevel;Q.XfaLayer;Q.build;Q.createValidAbsoluteUrl;Q.fetchData;var sP=Q.getDocument;Q.getFilenameFromUrl;Q.getPdfFilenameFromUrl;Q.getXfaPageViewport;Q.isDataScheme;Q.isPdfFile;Q.noContextMenu;Q.normalizeUnicode;Q.setLayerDimensions;Q.shadow;Q.stopEvent;Q.version;const nP="/assets/pdf.worker.min-yatZIOMy.mjs";tP.workerSrc=nP;const iP=async n=>{try{const e=await n.arrayBuffer(),t=await sP({data:e}).promise;let s="";for(let r=1;r<=t.numPages;r++){const c=(await(await t.getPage(r)).getTextContent()).items.map(d=>d.str).join(" ");s+=c+" "}return rP(s)}catch(e){throw console.error("PDF extraction error:",e),new Error("Failed to extract data from PDF")}},rP=n=>{const e=n.replace(/\s+/g," ").trim(),t={businessName:[/business\s+dba\s+name[:\s]+([^\n\r]+)/i,/(?:business\s+name|company\s+name|legal\s+name)[:\s]+([^\n\r]+)/i,/(?:dba|doing\s+business\s+as)[:\s]+([^\n\r]+)/i],ownerName:[/(?:^|\s)name[:\s]+([^\n\r]+)/i,/(?:owner\s+name|principal\s+name|applicant\s+name)[:\s]+([^\n\r]+)/i,/(?:first\s+name\s+last\s+name|full\s+name)[:\s]+([^\n\r]+)/i],email:[/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g,/(?:email|e-mail)[:\s]+([^\s\n\r]+)/i],phone:[/(?:phone|telephone|cell|mobile)[:\s]*(\(?[0-9]{3}\)?[-.\s]?[0-9]{3}[-.\s]?[0-9]{4})/i,/(\(?[0-9]{3}\)?[-.\s]?[0-9]{3}[-.\s]?[0-9]{4})/g],address:[/address\s+cty\s+state\s+zip[:\s]+([^\n\r]+(?:\s+[^\n\r]+)*)/i,/(?:business\s+address|address)[:\s]+([^\n\r]+(?:\s+[^\n\r]+)*)/i,/(?:street|address\s+line)[:\s]+([^\n\r]+)/i],ein:[/federal\s+tax\s+id\s*#[:\s]*(\d{2}-?\d{7})/i,/(?:federal\s+tax\s+id|tax\s+id\s*#)[:\s]*(\d{2}-?\d{7})/i,/(?:ein|tax\s+id|federal\s+id)[:\s]*(\d{2}-?\d{7})/i,/(\d{2}-\d{7})/g],businessType:[/(?:business\s+type|entity\s+type|legal\s+structure)[:\s]+([^,\n]+)/i,/(?:llc|corporation|partnership|sole\s+proprietorship|s-corp|c-corp)/i],industry:[/(?:industry|business\s+type|nature\s+of\s+business)[:\s]+([^,\n]+)/i,/(?:retail|restaurant|healthcare|construction|professional\s+services|transportation|manufacturing|technology|real\s+estate)/i],yearsInBusiness:[/(?:years\s+in\s+business|time\s+in\s+business)[:\s]*(\d+(?:\.\d+)?)/i,/(?:established|started)[:\s]*(\d{4})/i],numberOfEmployees:[/(?:number\s+of\s+employees|employees|staff\s+size)[:\s]*(\d+)/i,/(\d+)\s+employees/i],annualRevenue:[/(?:annual\s+revenue|yearly\s+revenue|annual\s+sales)[:\s]*\$?([0-9,]+)/i,/(?:gross\s+revenue)[:\s]*\$?([0-9,]+)/i],averageMonthlyRevenue:[/(?:monthly\s+revenue|average\s+monthly\s+sales)[:\s]*\$?([0-9,]+)/i,/(?:monthly\s+gross)[:\s]*\$?([0-9,]+)/i],averageMonthlyDeposits:[/(?:monthly\s+deposits|average\s+monthly\s+deposits)[:\s]*\$?([0-9,]+)/i,/(?:bank\s+deposits)[:\s]*\$?([0-9,]+)/i],existingDebt:[/(?:existing\s+debt|current\s+debt|outstanding\s+debt)[:\s]*\$?([0-9,]+)/i,/(?:debt\s+balance)[:\s]*\$?([0-9,]+)/i],creditScore:[/(?:credit\s+score|fico\s+score|personal\s+credit)[:\s]*(\d{3})/i,/(?:score)[:\s]*(\d{3})/i],requestedAmount:[/amount\s+requested[:\s]*\$?([0-9,]+)/i,/(?:requested\s+amount|loan\s+amount|funding\s+amount)[:\s]*\$?([0-9,]+)/i,/(?:amount\s+needed|capital\s+needed)[:\s]*\$?([0-9,]+)/i]},s={businessName:"",ownerName:"",email:"",phone:"",address:"",ein:"",businessType:"",industry:"",yearsInBusiness:"",numberOfEmployees:"",annualRevenue:"",averageMonthlyRevenue:"",averageMonthlyDeposits:"",existingDebt:"",creditScore:"",requestedAmount:""};if(Object.keys(t).forEach(i=>{const r=t[i];for(const a of r){const o=e.match(a);if(o&&o[1]){let c=o[1].trim().replace(/\s+/g," ");(i.includes("Revenue")||i.includes("Amount")||i.includes("Debt")||i.includes("Deposits"))&&(c=c.replace(/[,$]/g,"")),i==="phone"&&(c=c.replace(/[^\d]/g,""),c.length===10&&(c=`(${c.slice(0,3)}) ${c.slice(3,6)}-${c.slice(6)}`)),i==="ein"&&c.length===9&&(c=`${c.slice(0,2)}-${c.slice(2)}`),i==="address"&&(c=c.replace(/\s+/g," ").trim()),s[i]=c;break}}}),console.log("PDF Extraction Results:",s),!s.businessType&&e.toLowerCase().includes("llc")&&(s.businessType="LLC"),!s.yearsInBusiness&&s.businessName){const i=new Date().getFullYear(),r=e.match(/(?:established|started|founded)[:\s]*(\d{4})/i);r&&(s.yearsInBusiness=(i-parseInt(r[1])).toString())}if(!s.averageMonthlyRevenue&&s.annualRevenue){const i=parseInt(s.annualRevenue.replace(/[,$]/g,""));isNaN(i)||(s.averageMonthlyRevenue=Math.round(i/12).toString())}return s},aP=({onSubmit:n})=>{const[e,t]=G.useState("upload"),[s,i]=G.useState(!1),[r,a]=G.useState(null),[o,c]=G.useState({businessName:"",ownerName:"",email:"",phone:"",address:"",ein:"",businessType:"",industry:"",yearsInBusiness:"",numberOfEmployees:"",annualRevenue:"",averageMonthlyRevenue:"",averageMonthlyDeposits:"",existingDebt:"",creditScore:"",requestedAmount:"",documents:[]}),[d,h]=G.useState([]),[f,p]=G.useState({}),[m,g]=G.useState(null),b=["Retail","Restaurant","Healthcare","Construction","Professional Services","Transportation","Manufacturing","Technology","Real Estate","Other"],A=["Sole Proprietorship","Partnership","LLC","Corporation","S-Corporation"],x=async k=>{i(!0);try{const T=await iP(k);a(T),c(T),t("form")}catch(T){console.error("Error extracting data from PDF:",T),alert("Error extracting data from PDF. Please fill the form manually."),t("form")}finally{i(!1)}},v=async k=>{var I;const T=(I=k.target.files)==null?void 0:I[0];T&&(g(T),await x(T))},S=()=>{const k={};return o.businessName||(k.businessName="Business name is required"),o.ownerName||(k.ownerName="Owner name is required"),o.email||(k.email="Email is required"),o.phone||(k.phone="Phone is required"),(!o.requestedAmount||Number(o.requestedAmount)<1e4)&&(k.requestedAmount="Requested amount must be at least $10,000"),(!o.averageMonthlyRevenue||Number(o.averageMonthlyRevenue)<1e4)&&(k.averageMonthlyRevenue="Monthly revenue must be at least $10,000"),(!o.creditScore||Number(o.creditScore)<300||Number(o.creditScore)>850)&&(k.creditScore="Credit score must be between 300-850"),p(k),Object.keys(k).length===0},E=k=>{if(k.preventDefault(),!S())return;(async()=>{try{const I={business_name:o.businessName,owner_name:o.ownerName,email:o.email,phone:o.phone,address:o.address,ein:o.ein,business_type:o.businessType,industry:o.industry,years_in_business:Number(o.yearsInBusiness),number_of_employees:Number(o.numberOfEmployees),annual_revenue:Number(o.annualRevenue),monthly_revenue:Number(o.averageMonthlyRevenue),monthly_deposits:Number(o.averageMonthlyDeposits),existing_debt:Number(o.existingDebt),credit_score:Number(o.creditScore),requested_amount:Number(o.requestedAmount),status:"submitted",documents:d},R=await XT(I),z={id:R.id,businessName:R.business_name,monthlyRevenue:R.monthly_revenue,timeInBusiness:R.years_in_business,creditScore:R.credit_score,industry:R.industry,requestedAmount:R.requested_amount,status:R.status,contactInfo:{ownerName:R.owner_name,email:R.email,phone:R.phone||"",address:R.address||""},businessInfo:{ein:R.ein||"",businessType:R.business_type||"",yearsInBusiness:R.years_in_business,numberOfEmployees:R.number_of_employees},financialInfo:{annualRevenue:R.annual_revenue,averageMonthlyRevenue:R.monthly_revenue,averageMonthlyDeposits:R.monthly_deposits,existingDebt:R.existing_debt},documents:R.documents};n(z)}catch(I){console.error("Error saving application:",I),alert("Error saving application. Please try again.")}})()},C=k=>{const T=k.target.files;if(T){const I=Array.from(T).map(R=>R.name);h(R=>[...R,...I])}},N=k=>{h(T=>T.filter(I=>I!==k))};return e==="upload"?u.jsxs("div",{className:"bg-white rounded-xl shadow-lg",children:[u.jsxs("div",{className:"px-8 py-6 border-b border-gray-200",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Upload Application Document"}),u.jsx("p",{className:"text-gray-600 mt-1",children:"Upload your completed MCA application form to auto-populate the submission"})]}),u.jsxs("div",{className:"p-8",children:[s?u.jsxs("div",{className:"text-center py-12",children:[u.jsx(y1,{className:"w-12 h-12 text-blue-600 mx-auto mb-4 animate-spin"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Processing Your Document"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"We're extracting information from your application document..."}),u.jsxs("div",{className:"max-w-md mx-auto",children:[u.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse",style:{width:"60%"}})}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This usually takes 30-60 seconds"})]})]}):u.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-12",children:u.jsxs("div",{className:"text-center",children:[u.jsx(wa,{className:"w-16 h-16 text-gray-400 mx-auto mb-6"}),u.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Your Application Document"}),u.jsx("p",{className:"text-gray-600 mb-6",children:"Supported formats: PDF, DOC, DOCX. We'll automatically extract your business information."}),u.jsxs("div",{className:"text-sm text-gray-600",children:[u.jsxs("label",{htmlFor:"document-upload",className:"relative cursor-pointer bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500 transition-colors",children:[u.jsx("span",{children:"Choose Application File"}),u.jsx("input",{id:"document-upload",name:"document-upload",type:"file",className:"sr-only",accept:".pdf,.doc,.docx",onChange:v})]}),u.jsx("p",{className:"mt-4 text-xs text-gray-500",children:"Maximum file size: 10MB"})]})]})}),u.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:u.jsx("button",{onClick:()=>t("form"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Skip and fill form manually "})})]})]}):u.jsxs("div",{className:"bg-white rounded-xl shadow-lg",children:[u.jsxs("div",{className:"px-8 py-6 border-b border-gray-200",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Merchant Cash Advance Application"}),u.jsx("p",{className:"text-gray-600 mt-1",children:r?"Review and confirm the extracted information":"Please fill out all required information to get matched with qualified lenders"})]}),r&&u.jsxs("div",{className:"flex items-center text-green-600",children:[u.jsx(kN,{className:"w-5 h-5 mr-2"}),u.jsx("span",{className:"text-sm font-medium",children:"Data extracted from document"})]})]}),m&&u.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(wa,{className:"w-4 h-4 text-blue-600 mr-2"}),u.jsxs("span",{className:"text-sm text-blue-800 font-medium",children:["Source Document: ",m.name]}),u.jsx("button",{onClick:()=>{t("upload"),g(null),a(null),c({businessName:"",ownerName:"",email:"",phone:"",address:"",ein:"",businessType:"",industry:"",yearsInBusiness:"",numberOfEmployees:"",annualRevenue:"",averageMonthlyRevenue:"",averageMonthlyDeposits:"",existingDebt:"",creditScore:"",requestedAmount:"",documents:[]})},className:"ml-auto text-blue-600 hover:text-blue-800 text-sm",children:"Upload Different Document"})]})})]}),u.jsxs("form",{onSubmit:E,className:"p-8 space-y-8",children:[r&&u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(us,{className:"w-5 h-5 text-green-600 mr-2"}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-green-800",children:"Information Successfully Extracted"}),u.jsx("p",{className:"text-sm text-green-700 mt-1",children:"We've automatically filled in your application details. Please review and make any necessary corrections below."})]})]})}),u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(Ur,{className:"w-5 h-5 mr-2 text-blue-600"}),"Business Information"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Name *"}),u.jsx("input",{type:"text",value:o.businessName,onChange:k=>c(T=>({...T,businessName:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.businessName?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"Enter your business name"}),f.businessName&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.businessName})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EIN"}),u.jsx("input",{type:"text",value:o.ein,onChange:k=>c(T=>({...T,ein:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"XX-XXXXXXX"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Type"}),u.jsxs("select",{value:o.businessType,onChange:k=>c(T=>({...T,businessType:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,children:[u.jsx("option",{value:"",children:"Select business type"}),A.map(k=>u.jsx("option",{value:k,children:k},k))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Industry"}),u.jsxs("select",{value:o.industry,onChange:k=>c(T=>({...T,industry:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,children:[u.jsx("option",{value:"",children:"Select industry"}),b.map(k=>u.jsx("option",{value:k,children:k},k))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Years in Business"}),u.jsx("input",{type:"number",value:o.yearsInBusiness,onChange:k=>c(T=>({...T,yearsInBusiness:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Employees"}),u.jsx("input",{type:"number",value:o.numberOfEmployees,onChange:k=>c(T=>({...T,numberOfEmployees:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"})]})]})]}),u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(jN,{className:"w-5 h-5 mr-2 text-blue-600"}),"Contact Information"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Owner Name *"}),u.jsx("input",{type:"text",value:o.ownerName,onChange:k=>c(T=>({...T,ownerName:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.ownerName?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"Enter owner's full name"}),f.ownerName&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.ownerName})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),u.jsx("input",{type:"email",value:o.email,onChange:k=>c(T=>({...T,email:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.email?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"Enter email address"}),f.email&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.email})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),u.jsx("input",{type:"tel",value:o.phone,onChange:k=>c(T=>({...T,phone:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.phone?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"(555) 123-4567"}),f.phone&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.phone})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Address"}),u.jsx("input",{type:"text",value:o.address,onChange:k=>c(T=>({...T,address:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"Enter business address"})]})]})]}),u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(m1,{className:"w-5 h-5 mr-2 text-blue-600"}),"Financial Information"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Annual Revenue"}),u.jsx("input",{type:"number",value:o.annualRevenue,onChange:k=>c(T=>({...T,annualRevenue:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Average Monthly Revenue *"}),u.jsx("input",{type:"number",value:o.averageMonthlyRevenue,onChange:k=>c(T=>({...T,averageMonthlyRevenue:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.averageMonthlyRevenue?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"}),f.averageMonthlyRevenue&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.averageMonthlyRevenue})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Average Monthly Deposits"}),u.jsx("input",{type:"number",value:o.averageMonthlyDeposits,onChange:k=>c(T=>({...T,averageMonthlyDeposits:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Existing Debt"}),u.jsx("input",{type:"number",value:o.existingDebt,onChange:k=>c(T=>({...T,existingDebt:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Credit Score *"}),u.jsx("input",{type:"number",value:o.creditScore,onChange:k=>c(T=>({...T,creditScore:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.creditScore?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"300-850",min:"300",max:"850"}),f.creditScore&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.creditScore})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Requested Amount *"}),u.jsx("input",{type:"number",value:o.requestedAmount,onChange:k=>c(T=>({...T,requestedAmount:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.requestedAmount?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"10000",min:"10000"}),f.requestedAmount&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.requestedAmount})]})]})]}),u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(yb,{className:"w-5 h-5 mr-2 text-blue-600"}),"Additional Documents"]}),u.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx(yb,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),u.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Upload additional supporting documents (bank statements, tax returns, etc.)"}),u.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500 transition-colors",children:[u.jsx("span",{children:"Choose Files"}),u.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",multiple:!0,onChange:C})]})]}),d.length>0&&u.jsxs("div",{className:"mt-4",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Uploaded Files:"}),u.jsx("div",{className:"space-y-2",children:d.map((k,T)=>u.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(wa,{className:"w-4 h-4 text-gray-500 mr-2"}),u.jsx("span",{className:"text-sm text-gray-700",children:k})]}),u.jsx("button",{type:"button",onClick:()=>N(k),className:"text-red-500 hover:text-red-700 text-sm",children:"Remove"})]},T))})]})]})]}),u.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:u.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-8 py-3 rounded-lg font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Submit Application"})})]})]})},oP=({application:n,onLenderSelect:e,onBack:t})=>{const[s,i]=G.useState([]),[r,a]=G.useState([]),[o,c]=G.useState(!0);G.useEffect(()=>{(async()=>{if(n)try{c(!0);const m=await Hv()||[],g={id:"",business_name:n.businessName||"",owner_name:n.ownerName||"",email:n.email||"",phone:n.phone||null,address:n.address||null,ein:n.ein||null,business_type:n.businessType||null,industry:n.industry||null,years_in_business:n.yearsInBusiness||0,number_of_employees:n.numberOfEmployees||0,annual_revenue:n.annualRevenue||0,monthly_revenue:n.monthlyRevenue||0,monthly_deposits:n.monthlyDeposits||0,existing_debt:n.existingDebt||0,credit_score:n.creditScore||0,requested_amount:n.requestedAmount||0,status:n.status||"draft",documents:n.documents||[],created_at:new Date().toISOString(),updated_at:new Date().toISOString(),user_id:null},b=await tj(m,g);i(b)}catch(p){console.error("Error loading lenders:",p)}finally{c(!1)}})()},[n]);const d=f=>{a(p=>p.includes(f)?p.filter(m=>m!==f):[...p,f])},h=()=>{e(r)};return o?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Finding qualified lenders..."})]})}):n?u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Qualified Lenders"}),u.jsxs("p",{className:"text-gray-600 mb-6",children:["We found ",s.length," lenders that match your business profile"]}),u.jsx("div",{className:"bg-blue-50 rounded-xl p-6 mb-8",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:["$",(n.requestedAmount||0).toLocaleString()]}),u.jsx("div",{className:"text-sm text-blue-600",children:"Requested Amount"})]}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:["$",(n.monthlyRevenue||0).toLocaleString()]}),u.jsx("div",{className:"text-sm text-blue-600",children:"Monthly Revenue"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-blue-900",children:n.creditScore||0}),u.jsx("div",{className:"text-sm text-blue-600",children:"Credit Score"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-blue-900",children:n.industry||"N/A"}),u.jsx("div",{className:"text-sm text-blue-600",children:"Industry"})]})]})})]}),u.jsx("div",{className:"grid gap-6",children:s.map(f=>u.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-6 border-2 transition-all cursor-pointer ${r.includes(f.id)?"border-emerald-500 bg-emerald-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>d(f.id),children:[u.jsxs("div",{className:"flex items-start justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-lg flex items-center justify-center mr-4",children:u.jsx(Ur,{className:"w-8 h-8 text-emerald-600"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-bold text-gray-900",children:f.name}),u.jsxs("div",{className:"flex items-center mt-1",children:[u.jsx(Np,{className:"w-4 h-4 text-yellow-400 fill-current mr-1"}),u.jsx("span",{className:"text-sm font-medium",children:f.rating}),u.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:[f.approval_rate,"% approval rate"]})]})]})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"text-lg font-bold text-emerald-600",children:"95% Match"}),u.jsx("div",{className:"text-sm text-gray-500",children:"Qualification Score"})]}),u.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${r.includes(f.id)?"bg-emerald-500 border-emerald-500":"border-gray-300"}`,children:r.includes(f.id)&&u.jsx(us,{className:"w-4 h-4 text-white"})})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[u.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[u.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Amount Range"}),u.jsxs("div",{className:"text-sm font-bold text-blue-900",children:["$",f.min_amount.toLocaleString()," - $",f.max_amount.toLocaleString()]})]}),u.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[u.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Factor Rate"}),u.jsx("div",{className:"text-sm font-bold text-green-900",children:f.factor_rate})]}),u.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[u.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Payback Term"}),u.jsx("div",{className:"text-sm font-bold text-purple-900",children:f.payback_term})]}),u.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[u.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Approval Time"}),u.jsx("div",{className:"text-sm font-bold text-orange-900",children:f.approval_time})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Key Features"}),u.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.features.slice(0,4).map((p,m)=>u.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm",children:p},m)),f.features.length>4&&u.jsxs("span",{className:"text-sm text-gray-500",children:["+",f.features.length-4," more"]})]})]}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(us,{className:"w-4 h-4 text-green-500 mr-2"}),u.jsx("span",{className:"text-gray-600",children:"Amount: "})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx(us,{className:"w-4 h-4 text-green-500 mr-2"}),u.jsx("span",{className:"text-gray-600",children:"Credit: "})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx(us,{className:"w-4 h-4 text-green-500 mr-2"}),u.jsx("span",{className:"text-gray-600",children:"Revenue: "})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx(us,{className:"w-4 h-4 text-green-500 mr-2"}),u.jsx("span",{className:"text-gray-600",children:"Industry: "})]})]})]},f.id))}),u.jsxs("div",{className:"flex justify-between pt-8 border-t border-gray-200",children:[u.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Back to Application"}),u.jsxs("button",{onClick:h,disabled:r.length===0,className:`flex items-center px-8 py-3 rounded-lg font-medium transition-colors ${r.length>0?"bg-emerald-600 text-white hover:bg-emerald-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:["Continue with ",r.length," Lender",r.length!==1?"s":"",u.jsx(AN,{className:"w-5 h-5 ml-2"})]})]})]}):u.jsx("div",{className:"text-center py-12",children:u.jsx("p",{className:"text-gray-500",children:"No application data available"})})},lP=({application:n,selectedLenderIds:e,onBack:t,onSubmit:s})=>{const[i,r]=G.useState(!1),[a,o]=G.useState(()=>{var T,I;const N=localStorage.getItem("mcaPortalSmtpSettings"),k={smtpHost:"",smtpPort:"",smtpUser:"",smtpPassword:"",fromEmail:((T=n==null?void 0:n.contactInfo)==null?void 0:T.email)||""};if(N)try{const R=JSON.parse(N);return{...R,fromEmail:((I=n==null?void 0:n.contactInfo)==null?void 0:I.email)||R.fromEmail}}catch(R){return console.error("Error parsing saved SMTP settings:",R),k}return k}),[c,d]=G.useState(!1),[h,f]=G.useState(!1),[p,m]=G.useState(!1),[g,b]=G.useState(null),[A,x]=G.useState([]);Gy.useEffect(()=>{(async()=>{try{const k=await Hv();x(k)}catch(k){console.error("Error loading lenders:",k)}})()},[]);const v=A.filter(N=>e.includes(N.id)),S=N=>{if(!n)return"";const k=localStorage.getItem("mcaPortalEmailTemplate"),T=`Subject: Merchant Cash Advance Application - {{businessName}}

Dear {{lenderName}} Team,

I hope this email finds you well. I am writing to submit a merchant cash advance application for your review and consideration.

BUSINESS INFORMATION:
 Business Name: {{businessName}}
 Owner: {{ownerName}}
 Industry: {{industry}}
 Years in Business: {{yearsInBusiness}}
 Business Type: {{businessType}}
 EIN: {{ein}}

FINANCIAL DETAILS:
 Requested Amount: ${{requestedAmount}}
 Monthly Revenue: ${{monthlyRevenue}}
 Annual Revenue: ${{annualRevenue}}
 Credit Score: {{creditScore}}
 Existing Debt: ${{existingDebt}}

CONTACT INFORMATION:
 Email: {{email}}
 Phone: {{phone}}
 Address: {{address}}

I have attached the following documents for your review:
 Business bank statements (last 6 months)
 Tax returns
 Completed application form
 Voided business check

Based on your underwriting guidelines, I believe this application aligns well with your lending criteria:
 Amount Range: ${{lenderMinAmount}} - ${{lenderMaxAmount}}
 Factor Rate: {{lenderFactorRate}}
 Payback Term: {{lenderPaybackTerm}}
 Approval Time: {{lenderApprovalTime}}

I would appreciate the opportunity to discuss this application further and answer any questions you may have. Please let me know if you need any additional information or documentation.

Thank you for your time and consideration. I look forward to hearing from you soon.

Best regards,
{{ownerName}}
{{businessName}}
{{email}}
{{phone}}

---
This application was submitted through MCAPortal Pro
Application ID: {{applicationId}}`;return(k||T).replace(/\{\{businessName\}\}/g,n.businessName).replace(/\{\{ownerName\}\}/g,n.contactInfo.ownerName).replace(/\{\{industry\}\}/g,n.industry).replace(/\{\{yearsInBusiness\}\}/g,n.timeInBusiness.toString()).replace(/\{\{businessType\}\}/g,n.businessInfo.businessType).replace(/\{\{ein\}\}/g,n.businessInfo.ein).replace(/\{\{requestedAmount\}\}/g,n.requestedAmount.toLocaleString()).replace(/\{\{monthlyRevenue\}\}/g,n.monthlyRevenue.toLocaleString()).replace(/\{\{annualRevenue\}\}/g,n.financialInfo.annualRevenue.toLocaleString()).replace(/\{\{creditScore\}\}/g,n.creditScore.toString()).replace(/\{\{existingDebt\}\}/g,n.financialInfo.existingDebt.toLocaleString()).replace(/\{\{email\}\}/g,n.contactInfo.email).replace(/\{\{phone\}\}/g,n.contactInfo.phone).replace(/\{\{address\}\}/g,n.contactInfo.address).replace(/\{\{lenderName\}\}/g,N.name).replace(/\{\{lenderMinAmount\}\}/g,N.min_amount.toLocaleString()).replace(/\{\{lenderMaxAmount\}\}/g,N.max_amount.toLocaleString()).replace(/\{\{lenderFactorRate\}\}/g,N.factor_rate).replace(/\{\{lenderPaybackTerm\}\}/g,N.payback_term).replace(/\{\{lenderApprovalTime\}\}/g,N.approval_time).replace(/\{\{applicationId\}\}/g,n.id)},E=N=>{try{const k={smtpHost:N.smtpHost,smtpPort:N.smtpPort,smtpUser:N.smtpUser,smtpPassword:"",fromEmail:N.fromEmail};localStorage.setItem("mcaPortalSmtpSettings",JSON.stringify(k))}catch(k){console.error("Error saving SMTP settings:",k)}},C=async()=>{var N;f(!0),E(a);try{n&&await H1(n.id,e),console.log(`Sending application from: ${(N=n==null?void 0:n.contactInfo)==null?void 0:N.email}`),console.log(`Selected lenders: ${v.length}`),console.log(`SMTP Settings configured: ${a.smtpHost?"Yes":"No"}`),await new Promise(k=>setTimeout(k,3e3)),m(!0),s()}catch(k){console.error("Error submitting application:",k),alert("Error submitting application. Please try again.")}finally{f(!1)}};return n?p?u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-8",children:u.jsxs("div",{className:"text-center",children:[u.jsx(us,{className:"w-16 h-16 text-green-600 mx-auto mb-6"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Application Submitted Successfully!"}),u.jsxs("p",{className:"text-gray-600 mb-6",children:["Your application and business bank statements have been sent to ",v.length," selected lender",v.length>1?"s":"",". You should receive responses within 24-48 hours at ",n.contactInfo.email,"."]}),u.jsxs("div",{className:"bg-green-50 rounded-lg p-6 mb-6",children:[u.jsx("h3",{className:"text-lg font-medium text-green-800 mb-3",children:"Submitted to:"}),u.jsx("div",{className:"space-y-2",children:v.map(N=>u.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("img",{src:"https://images.pexels.com/photos/259027/pexels-photo-259027.jpeg?auto=compress&cs=tinysrgb&w=100&h=100",alt:N.name,className:"w-12 h-12 rounded-lg mr-4"}),u.jsx("span",{className:"font-medium text-green-900",children:N.name})]}),u.jsx("span",{className:"text-sm text-green-600",children:" Sent"})]},N.id))})]}),u.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Submit Another Application"})]})}):u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("button",{onClick:t,className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[u.jsx(SN,{className:"w-5 h-5 mr-2"}),"Back to Lender Selection"]}),u.jsxs("div",{className:"text-sm text-gray-500",children:["Application ID: ",n.id]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Submission Summary"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[u.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Business"}),u.jsx("div",{className:"text-lg font-bold text-blue-900",children:n.businessName}),u.jsx("div",{className:"text-sm text-blue-700",children:n.industry})]}),u.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[u.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Requested Amount"}),u.jsxs("div",{className:"text-lg font-bold text-green-900",children:["$",n.requestedAmount.toLocaleString()]})]}),u.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[u.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Monthly Revenue"}),u.jsxs("div",{className:"text-lg font-bold text-purple-900",children:["$",n.monthlyRevenue.toLocaleString()]})]}),u.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[u.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Credit Score"}),u.jsx("div",{className:"text-lg font-bold text-orange-900",children:n.creditScore})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Selected Lenders (",v.length,")"]}),u.jsx("div",{className:"space-y-3",children:v.map(N=>u.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("img",{src:"https://images.pexels.com/photos/259027/pexels-photo-259027.jpeg?auto=compress&cs=tinysrgb&w=100&h=100",alt:N.name,className:"w-12 h-12 rounded-lg mr-4"}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900",children:N.name}),u.jsxs("p",{className:"text-sm text-gray-600",children:[N.factor_rate,"  ",N.payback_term,"  ",N.approval_time]})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:"text-sm font-medium text-green-600",children:"95% Match"}),u.jsx("button",{onClick:()=>{b(N),r(!0)},className:"text-blue-600 hover:text-blue-800 text-sm flex items-center",children:"Preview Email"})]})]},N.id))})]}),u.jsx("div",{className:"bg-blue-50 rounded-lg p-4 mb-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-blue-900",children:"Email Configuration"}),u.jsxs("p",{className:"text-sm text-blue-700",children:["Emails will be sent from: ",u.jsx("span",{className:"font-medium",children:n.contactInfo.email})]}),u.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["SMTP Status: ",a.smtpHost?"Configured ":"Not configured - using default settings",a.smtpHost&&u.jsx("span",{className:"block text-xs text-blue-500 mt-1",children:"Settings saved for future submissions"})]})]}),u.jsxs("button",{onClick:()=>d(!0),className:"flex items-center text-blue-600 hover:text-blue-800 text-sm",children:[u.jsx(v1,{className:"w-4 h-4 mr-1"}),"Configure SMTP"]})]})}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Documents to be Included:"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[u.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[u.jsx(wa,{className:"w-4 h-4 mr-2 text-blue-600"}),"Application Form"]}),u.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[u.jsx(wa,{className:"w-4 h-4 mr-2 text-green-600"}),"Bank Statements (6 months)"]}),u.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[u.jsx(wa,{className:"w-4 h-4 mr-2 text-purple-600"}),"Tax Returns"]}),u.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[u.jsx(wa,{className:"w-4 h-4 mr-2 text-orange-600"}),"Voided Check"]})]})]}),u.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:u.jsx("button",{onClick:C,disabled:h,className:`flex items-center px-8 py-3 rounded-lg font-medium transition-colors ${h?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:h?u.jsxs(u.Fragment,{children:[u.jsx(y1,{className:"w-5 h-5 mr-2 animate-spin"}),"Sending Applications..."]}):u.jsxs(u.Fragment,{children:[u.jsx(TN,{className:"w-5 h-5 mr-2"}),"Send to ",v.length," Lender",v.length>1?"s":""]})})})]}),c&&u.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[u.jsxs("div",{className:"p-6 border-b border-gray-200",children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Email Settings"}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure your SMTP settings for sending applications"})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Host"}),u.jsx("input",{type:"text",value:a.smtpHost,onChange:N=>o(k=>({...k,smtpHost:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"smtp.gmail.com"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Port"}),u.jsx("input",{type:"text",value:a.smtpPort,onChange:N=>o(k=>({...k,smtpPort:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"587"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),u.jsx("input",{type:"text",value:a.smtpUser,onChange:N=>o(k=>({...k,smtpUser:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"your-email@gmail.com"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),u.jsx("input",{type:"password",value:a.smtpPassword,onChange:N=>o(k=>({...k,smtpPassword:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"your-app-password"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Email"}),u.jsx("input",{type:"email",value:n.contactInfo.email,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",disabled:!0}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Using your application email address"})]})]}),u.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[u.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),u.jsx("button",{onClick:()=>{E(a),d(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save Settings"})]})]})}),i&&g&&u.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Email Preview - ",g.name]}),u.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[u.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[u.jsx("strong",{children:"From:"})," ",n.contactInfo.email]}),u.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[u.jsx("strong",{children:"To:"})," ",g.name," (contact email would be used)"]})]}),u.jsx("div",{className:"bg-white border rounded-lg p-6",children:u.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-800 font-mono",children:S(g)})})]}),u.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end",children:u.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Close Preview"})})]})})]}):u.jsx("div",{className:"text-center py-12",children:u.jsx("p",{className:"text-gray-500",children:"No application data available"})})},cP=()=>{const[n,e]=G.useState("application"),[t,s]=G.useState(null),[i,r]=G.useState([]),a=h=>{s(h),e("matches")},o=(h,f)=>{r(h),e("recap")},c=()=>{e("matches")},d=()=>{console.log("Final submission completed")};return u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Submissions Portal"}),u.jsx("p",{className:"text-gray-600",children:"Submit your merchant cash advance application and get matched with qualified lenders"})]}),u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:`flex items-center ${n==="application"?"text-blue-600":t?"text-green-600":"text-gray-400"}`,children:[u.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${t?"bg-green-100 text-green-600":n==="application"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:t?u.jsx(us,{className:"w-5 h-5"}):"1"}),u.jsx("span",{className:"ml-2 text-sm font-medium",children:"Document Upload & Application"})]}),u.jsx("div",{className:`flex-1 h-1 mx-4 ${t?"bg-green-200":"bg-gray-200"}`}),u.jsxs("div",{className:`flex items-center ${n==="matches"?"text-blue-600":i.length>0?"text-green-600":"text-gray-400"}`,children:[u.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${i.length>0?"bg-green-100 text-green-600":n==="matches"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:i.length>0?u.jsx(us,{className:"w-5 h-5"}):"2"}),u.jsx("span",{className:"ml-2 text-sm font-medium",children:"Lender Matches"})]}),u.jsx("div",{className:`flex-1 h-1 mx-4 ${i.length>0?"bg-green-200":"bg-gray-200"}`}),u.jsxs("div",{className:`flex items-center ${n==="recap"?"text-blue-600":"text-gray-400"}`,children:[u.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${n==="recap"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:"3"}),u.jsx("span",{className:"ml-2 text-sm font-medium",children:"Submission Recap"})]})]})}),n==="application"?u.jsx(aP,{onSubmit:a}):n==="matches"?u.jsx(oP,{application:t,onBack:()=>e("application"),onLenderSelect:o,isAdmin:!1}):u.jsx(lP,{application:t,selectedLenderIds:i,onBack:c,onSubmit:d})]})},uP=()=>{const[n,e]=G.useState("applications"),[t,s]=G.useState(!1),[i,r]=G.useState(null),[a,o]=G.useState(null),[c,d]=G.useState(!1),[h,f]=G.useState(!1),[p,m]=G.useState(!1),[g,b]=G.useState(()=>localStorage.getItem("mcaPortalEmailTemplate")||`Subject: Merchant Cash Advance Application - {{businessName}}

Dear {{lenderName}} Team,

I hope this email finds you well. I am writing to submit a merchant cash advance application for your review and consideration.

BUSINESS INFORMATION:
 Business Name: {{businessName}}
 Owner: {{ownerName}}
 Industry: {{industry}}
 Years in Business: {{yearsInBusiness}}
 Business Type: {{businessType}}
 EIN: {{ein}}

FINANCIAL DETAILS:
 Requested Amount: \${{requestedAmount}}
 Monthly Revenue: \${{monthlyRevenue}}
 Annual Revenue: \${{annualRevenue}}
 Credit Score: {{creditScore}}
 Existing Debt: \${{existingDebt}}

CONTACT INFORMATION:
 Email: {{email}}
 Phone: {{phone}}
 Address: {{address}}

I have attached the following documents for your review:
 Business bank statements (last 6 months)
 Tax returns
 Completed application form
 Voided business check

Based on your underwriting guidelines, I believe this application aligns well with your lending criteria:
 Amount Range: \${{lenderMinAmount}} - \${{lenderMaxAmount}}
 Factor Rate: {{lenderFactorRate}}
 Payback Term: {{lenderPaybackTerm}}
 Approval Time: {{lenderApprovalTime}}

I would appreciate the opportunity to discuss this application further and answer any questions you may have. Please let me know if you need any additional information or documentation.

Thank you for your time and consideration. I look forward to hearing from you soon.

Best regards,
{{ownerName}}
{{businessName}}
{{email}}
{{phone}}

---
This application was submitted through MCAPortal Pro
Application ID: {{applicationId}}`.replace(/\{\{requestedAmount\}\}/g,"{{requested_amount}}")),[A,x]=G.useState(null),[v,S]=G.useState([]),[E,C]=G.useState([]),[N,k]=G.useState(!0),[T,I]=G.useState(null),[R,z]=G.useState(!1),[ce,ye]=G.useState([]);G.useState(null);const[ue,qe]=G.useState(!1),[L,F]=G.useState({name:"",contactEmail:"",phone:"",status:"active",rating:4,minAmount:1e4,maxAmount:5e5,minCreditScore:550,maxCreditScore:850,minTimeInBusiness:1,minMonthlyRevenue:15e3,industries:[],factorRate:"1.1 - 1.4",paybackTerm:"3-18 months",approvalTime:"24 hours",features:[]}),D=["All Industries","Retail","Restaurant","Healthcare","Professional Services","Technology","Construction","Transportation","Manufacturing","Real Estate","Automotive","Education","Entertainment","Agriculture","Finance"],q=["No collateral required","Same day funding","Flexible payments","Competitive rates","Larger amounts","Industry expertise","Instant approval","Bad credit OK","Fast funding","Best rates","Large amounts","Premium service","Merchant-focused","Flexible terms"];Gy.useEffect(()=>{(async()=>{try{k(!0);const[P,He]=await Promise.all([Hv(),z1()]),ms=await Promise.all(He.map(async nn=>{const Im=await C0(nn.id);return{...nn,matchedLenders:Im.length}}));S(P),C(ms)}catch(P){console.error("Error loading data:",P)}finally{k(!1)}})()},[]);const X=async j=>{try{const P=await C0(j);ye(P)}catch(P){console.error("Error loading application submissions:",P)}};if(N)return u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading admin data..."})]})});const se=j=>{switch(j){case"active":case"matched":case"funded":return"bg-green-100 text-green-800";case"inactive":case"declined":return"bg-red-100 text-red-800";case"pending":case"under-review":return"bg-yellow-100 text-yellow-800";case"submitted":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},ae=j=>{(async()=>{try{await ZT(j),S(He=>He.filter(ms=>ms.id!==j))}catch(He){console.error("Error deleting lender:",He),alert("Error deleting lender. Please try again.")}})()},Se=j=>{F({name:j.name,contactEmail:j.contact_email,phone:j.phone||"",status:j.status,rating:j.rating,minAmount:j.min_amount,maxAmount:j.max_amount,minCreditScore:j.min_credit_score,maxCreditScore:j.max_credit_score,minTimeInBusiness:j.min_time_in_business,minMonthlyRevenue:j.min_monthly_revenue,industries:j.industries,factorRate:j.factor_rate,paybackTerm:j.payback_term,approvalTime:j.approval_time,features:j.features}),r(j),s(!0)},Nt=()=>{F({name:"",contactEmail:"",phone:"",status:"active",rating:4,minAmount:1e4,maxAmount:5e5,minCreditScore:550,maxCreditScore:850,minTimeInBusiness:1,minMonthlyRevenue:15e3,industries:[],factorRate:"1.1 - 1.4",paybackTerm:"3-18 months",approvalTime:"24 hours",features:[]}),r(null),s(!0)},sn=j=>{F(P=>({...P,industries:P.industries.includes(j)?P.industries.filter(He=>He!==j):[...P.industries,j]}))},Pe=j=>{F(P=>({...P,features:P.features.includes(j)?P.features.filter(He=>He!==j):[...P.features,j]}))},me=()=>{(async()=>{try{const P={name:L.name,contact_email:L.contactEmail,phone:L.phone,status:L.status,rating:L.rating,total_applications:0,approval_rate:0,min_amount:L.minAmount,max_amount:L.maxAmount,min_credit_score:L.minCreditScore,max_credit_score:L.maxCreditScore,min_time_in_business:L.minTimeInBusiness,min_monthly_revenue:L.minMonthlyRevenue,industries:L.industries,factor_rate:L.factorRate,payback_term:L.paybackTerm,approval_time:L.approvalTime,features:L.features};if(i){const He=await JT(i.id,P);S(ms=>ms.map(nn=>nn.id===i.id?He:nn))}else{const He=await QT(P);S(ms=>[...ms,He])}s(!1),r(null)}catch(P){console.error("Error saving lender:",P),alert("Error saving lender. Please try again.")}})()},ri=j=>{confirm("Are you sure you want to delete this application? This action cannot be undone.")&&(async()=>{try{await YT(j),C(He=>He.filter(ms=>ms.id!==j))}catch(He){console.error("Error deleting application:",He),alert("Error deleting application. Please try again.")}})()},Uh=j=>{x(j),f(!0)},Rm=j=>{I({...j}),z(!0),X(j.id)},zA=async j=>{if(j.preventDefault(),!!T)try{const{matchedLenders:P,lenderSubmissions:He,...ms}=T,nn=await KT(T.id,ms);C(Im=>Im.map(zh=>zh.id===T.id?{...nn,matchedLenders:T.matchedLenders||zh.matchedLenders,lenderSubmissions:T.lenderSubmissions||zh.lenderSubmissions}:zh)),z(!1),I(null)}catch(P){console.error("Error updating application:",P),alert("Error updating application")}},zo=async(j,P)=>{try{const He=await ej(j.id,P);ye(ms=>ms.map(nn=>nn.id===j.id?{...nn,...He}:nn))}catch(He){console.error("Error updating submission:",He),alert("Error updating submission")}},HA=async j=>{if(T)try{await H1(T.id,[j]),X(T.id),qe(!1)}catch(P){console.error("Error adding lender submission:",P),alert("Error adding lender submission")}};return u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Portal"}),u.jsx("p",{className:"text-gray-600",children:"Manage applications, lenders, and underwriting guidelines"})]}),u.jsx("div",{className:"border-b border-gray-200 mb-8",children:u.jsxs("nav",{className:"flex space-x-8",children:[u.jsxs("button",{onClick:()=>e("applications"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="applications"?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[u.jsx(PN,{className:"w-5 h-5 inline mr-2"}),"Applications"]}),u.jsxs("button",{onClick:()=>e("lenders"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="lenders"?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[u.jsx(Ur,{className:"w-5 h-5 inline mr-2"}),"Lenders"]}),u.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center",children:[u.jsx(NN,{className:"w-4 h-4 mr-2"}),"Email Template"]}),u.jsxs("button",{onClick:()=>e("settings"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="settings"?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[u.jsx(v1,{className:"w-5 h-5 inline mr-2"}),"Settings"]})]})}),n==="applications"&&u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Applications"}),u.jsx("div",{className:"flex space-x-2",children:u.jsxs("select",{className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",children:[u.jsx("option",{children:"All Statuses"}),u.jsx("option",{children:"Submitted"}),u.jsx("option",{children:"Under Review"}),u.jsx("option",{children:"Matched"}),u.jsx("option",{children:"Funded"}),u.jsx("option",{children:"Declined"})]})})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Application"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue/Credit"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Matches"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(j=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.business_name}),u.jsx("div",{className:"text-sm text-gray-500",children:j.owner_name}),u.jsx("div",{className:"text-xs text-gray-400",children:j.id})]})}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[u.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["$",j.requested_amount.toLocaleString()]}),u.jsx("div",{className:"text-sm text-gray-500",children:j.industry})]}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[u.jsxs("div",{className:"text-sm text-gray-900",children:["$",j.monthly_revenue.toLocaleString(),"/mo"]}),u.jsxs("div",{className:"text-sm text-gray-500",children:["Credit: ",j.credit_score]})]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${se(j.status)}`,children:j.status})}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[j.matchedLenders," lenders"]}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[u.jsx("button",{onClick:()=>Uh(j),className:"text-emerald-600 hover:text-emerald-900 mr-3",children:u.jsx(g1,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>Rm(j),className:"text-blue-600 hover:text-blue-900 mr-3",children:u.jsx(m0,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>ri(j.id),className:"text-red-600 hover:text-red-900",children:u.jsx(gb,{className:"w-4 h-4"})})]})]},j.id))})]})})]}),n==="lenders"&&u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Lender Management"}),u.jsxs("button",{onClick:()=>{Nt()},className:"bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition-colors flex items-center",children:[u.jsx(lg,{className:"w-4 h-4 mr-2"}),"Add Lender"]})]}),u.jsx("div",{className:"grid gap-6",children:v.map(j=>u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[u.jsxs("div",{className:"flex items-start justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-lg flex items-center justify-center mr-4",children:u.jsx(Ur,{className:"w-6 h-6 text-emerald-600"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-bold text-gray-900",children:j.name}),u.jsx("p",{className:"text-gray-600",children:j.contact_email}),u.jsx("p",{className:"text-gray-500 text-sm",children:j.phone})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${se(j.status)}`,children:j.status}),u.jsxs("div",{className:"flex items-center",children:[u.jsx(Np,{className:"w-4 h-4 text-yellow-400 fill-current mr-1"}),u.jsx("span",{className:"text-sm font-medium",children:j.rating})]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[u.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[u.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Applications"}),u.jsx("div",{className:"text-lg font-bold text-blue-900",children:j.total_applications})]}),u.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[u.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Approval Rate"}),u.jsxs("div",{className:"text-lg font-bold text-green-900",children:[j.approval_rate,"%"]})]}),u.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[u.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Amount Range"}),u.jsxs("div",{className:"text-sm font-bold text-purple-900",children:["$",j.min_amount.toLocaleString()," - $",j.max_amount.toLocaleString()]})]}),u.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[u.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Factor Rate"}),u.jsx("div",{className:"text-sm font-bold text-orange-900",children:j.factor_rate})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Underwriting Guidelines"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Min Credit Score:"}),u.jsx("span",{className:"ml-1 font-medium",children:j.min_credit_score})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Min Time in Business:"}),u.jsxs("span",{className:"ml-1 font-medium",children:[j.min_time_in_business," years"]})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Min Monthly Revenue:"}),u.jsxs("span",{className:"ml-1 font-medium",children:["$",j.min_monthly_revenue.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Approval Time:"}),u.jsx("span",{className:"ml-1 font-medium",children:j.approval_time})]})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("span",{className:"text-sm text-gray-500",children:"Industries: "}),u.jsx("span",{className:"text-sm font-medium",children:j.industries.join(", ")})]}),u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsxs("button",{onClick:()=>Se(j),className:"px-4 py-2 text-blue-600 border border-blue-300 rounded-lg hover:bg-blue-50 transition-colors flex items-center",children:[u.jsx(m0,{className:"w-4 h-4 mr-1"}),"Edit"]}),u.jsxs("button",{onClick:()=>ae(j.id),className:"px-4 py-2 text-red-600 border border-red-300 rounded-lg hover:bg-red-50 transition-colors flex items-center",children:[u.jsx(gb,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]},j.id))})]}),n==="settings"&&u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"System Settings"}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"General Settings"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Application Amount"}),u.jsx("input",{type:"number",defaultValue:"10000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Application Amount"}),u.jsx("input",{type:"number",defaultValue:"2000000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Notification Settings"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",defaultChecked:!0,className:"mr-3"}),u.jsx("label",{className:"text-sm text-gray-700",children:"Email notifications for new applications"})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",defaultChecked:!0,className:"mr-3"}),u.jsx("label",{className:"text-sm text-gray-700",children:"Email notifications for lender matches"})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",className:"mr-3"}),u.jsx("label",{className:"text-sm text-gray-700",children:"SMS notifications for urgent matters"})]})]})]})]}),u.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:u.jsx("button",{className:"bg-emerald-600 text-white px-6 py-2 rounded-lg hover:bg-emerald-700 transition-colors",children:"Save Settings"})})]})]}),t&&u.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsx("h3",{className:"text-lg font-medium text-gray-900",children:i?"Edit Lender":"Add New Lender"})}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lender Name *"}),u.jsx("input",{type:"text",value:L.name,onChange:j=>F(P=>({...P,name:j.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"Enter lender name"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email *"}),u.jsx("input",{type:"email",value:L.contactEmail,onChange:j=>F(P=>({...P,contactEmail:j.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"contact@lender.com"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:L.phone,onChange:j=>F(P=>({...P,phone:j.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"(555) 123-4567"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),u.jsxs("select",{value:L.status,onChange:j=>F(P=>({...P,status:j.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",children:[u.jsx("option",{value:"active",children:"Active"}),u.jsx("option",{value:"inactive",children:"Inactive"}),u.jsx("option",{value:"pending",children:"Pending"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),u.jsx("input",{type:"number",min:"1",max:"5",step:"0.1",value:L.rating,onChange:j=>F(P=>({...P,rating:parseFloat(j.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Underwriting Guidelines"}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Funding Range"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Amount ($)"}),u.jsx("input",{type:"number",value:L.minAmount,onChange:j=>F(P=>({...P,minAmount:parseInt(j.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Amount ($)"}),u.jsx("input",{type:"number",value:L.maxAmount,onChange:j=>F(P=>({...P,maxAmount:parseInt(j.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Credit Score Requirements"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Credit Score"}),u.jsx("input",{type:"number",min:"300",max:"850",value:L.minCreditScore,onChange:j=>F(P=>({...P,minCreditScore:parseInt(j.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Credit Score"}),u.jsx("input",{type:"number",min:"300",max:"850",value:L.maxCreditScore,onChange:j=>F(P=>({...P,maxCreditScore:parseInt(j.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Business Requirements"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Time in Business (years)"}),u.jsx("input",{type:"number",min:"0",step:"0.5",value:L.minTimeInBusiness,onChange:j=>F(P=>({...P,minTimeInBusiness:parseFloat(j.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Monthly Revenue ($)"}),u.jsx("input",{type:"number",value:L.minMonthlyRevenue,onChange:j=>F(P=>({...P,minMonthlyRevenue:parseInt(j.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Terms & Processing"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Factor Rate"}),u.jsx("input",{type:"text",value:L.factorRate,onChange:j=>F(P=>({...P,factorRate:j.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"1.1 - 1.4"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payback Term"}),u.jsx("input",{type:"text",value:L.paybackTerm,onChange:j=>F(P=>({...P,paybackTerm:j.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"3-18 months"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Approval Time"}),u.jsx("input",{type:"text",value:L.approvalTime,onChange:j=>F(P=>({...P,approvalTime:j.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"24 hours"})]})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Accepted Industries"}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:D.map(j=>u.jsxs("label",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",checked:L.industries.includes(j),onChange:()=>sn(j),className:"mr-2 text-emerald-600 focus:ring-emerald-500"}),u.jsx("span",{className:"text-sm text-gray-700",children:j})]},j))})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Key Features"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:q.map(j=>u.jsxs("label",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",checked:L.features.includes(j),onChange:()=>Pe(j),className:"mr-2 text-emerald-600 focus:ring-emerald-500"}),u.jsx("span",{className:"text-sm text-gray-700",children:j})]},j))})]})]})]}),u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),u.jsx("button",{onClick:me,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700",children:i?"Update Lender":"Add Lender"})]})]})]})}),c&&a&&u.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-lg flex items-center justify-center mr-4",children:u.jsx(Ur,{className:"w-8 h-8 text-emerald-600"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:a.name}),u.jsxs("div",{className:"flex items-center mt-1",children:[u.jsx(Np,{className:"w-5 h-5 text-yellow-400 fill-current mr-1"}),u.jsx("span",{className:"text-lg font-medium",children:a.rating}),u.jsx("span",{className:`ml-4 px-3 py-1 rounded-full text-sm font-medium ${se(a.status)}`,children:a.status})]})]})]}),u.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]})}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact Information"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.contact_email})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.phone})]})]})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Metrics"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[u.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Applications"}),u.jsx("div",{className:"text-2xl font-bold text-blue-900",children:a.total_applications})]}),u.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[u.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Approval Rate"}),u.jsxs("div",{className:"text-2xl font-bold text-green-900",children:[a.approval_rate,"%"]})]}),u.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[u.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Rating"}),u.jsxs("div",{className:"text-2xl font-bold text-yellow-900",children:[a.rating,"/5.0"]})]})]})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Underwriting Guidelines"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[u.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:"Funding Range"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Minimum Amount:"}),u.jsxs("span",{className:"text-sm font-medium",children:["$",a.min_amount.toLocaleString()]})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Maximum Amount:"}),u.jsxs("span",{className:"text-sm font-medium",children:["$",a.max_amount.toLocaleString()]})]})]})]}),u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[u.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:"Credit Requirements"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Minimum Credit Score:"}),u.jsx("span",{className:"text-sm font-medium",children:a.min_credit_score})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Maximum Credit Score:"}),u.jsx("span",{className:"text-sm font-medium",children:a.max_credit_score})]})]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[u.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:"Business Requirements"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Min Time in Business:"}),u.jsxs("span",{className:"text-sm font-medium",children:[a.min_time_in_business," years"]})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Min Monthly Revenue:"}),u.jsxs("span",{className:"text-sm font-medium",children:["$",a.min_monthly_revenue.toLocaleString()]})]})]})]}),u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[u.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:"Terms & Processing"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Factor Rate:"}),u.jsx("span",{className:"text-sm font-medium",children:a.factor_rate})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Payback Term:"}),u.jsx("span",{className:"text-sm font-medium",children:a.payback_term})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Approval Time:"}),u.jsx("span",{className:"text-sm font-medium",children:a.approval_time})]})]})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:"Accepted Industries"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:a.industries.map((j,P)=>u.jsx("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:j},P))})]}),u.jsxs("div",{children:[u.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:"Key Features"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:a.features.map((j,P)=>u.jsxs("div",{className:"flex items-center",children:[u.jsx(us,{className:"w-4 h-4 text-green-500 mr-2"}),u.jsx("span",{className:"text-sm text-gray-700",children:j})]},P))})]})]}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[u.jsx("button",{onClick:()=>d(!1),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"}),u.jsx("button",{onClick:()=>{d(!1),Se(a)},className:"px-6 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:"Edit Lender"})]})]})]})}),h&&A&&u.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:A.business_name}),u.jsxs("div",{className:"flex items-center mt-1",children:[u.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${se(A.status)}`,children:A.status}),u.jsxs("span",{className:"ml-4 text-sm text-gray-500",children:["Application ID: ",A.id]})]})]}),u.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]})}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Business Information"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Business Name"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.business_name})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Industry"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.industry})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Business Type"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.business_type||"N/A"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"EIN"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.ein||"N/A"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Years in Business"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.years_in_business})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Number of Employees"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.number_of_employees})]})]})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact Information"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Owner Name"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.owner_name})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.email})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.phone||"N/A"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.address||"N/A"})]})]})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Financial Information"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Requested Amount"}),u.jsxs("p",{className:"mt-1 text-sm text-gray-900 font-semibold",children:["$",A.requested_amount.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Monthly Revenue"}),u.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:["$",A.monthly_revenue.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Annual Revenue"}),u.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:["$",A.annual_revenue.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Monthly Deposits"}),u.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:["$",A.monthly_deposits.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Existing Debt"}),u.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:["$",A.existing_debt.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Credit Score"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:A.credit_score})]})]})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Application Status"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Status"}),u.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-sm font-medium ${se(A.status)}`,children:A.status})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Matched Lenders"}),u.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[A.matchedLenders," lenders"]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(A.created_at).toLocaleDateString()})]})]})]}),A.documents&&A.documents.length>0&&u.jsxs("div",{className:"mb-8",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Documents"}),u.jsx("div",{className:"space-y-2",children:A.documents.map((j,P)=>u.jsxs("div",{className:"flex items-center bg-gray-50 p-3 rounded",children:[u.jsx(us,{className:"w-4 h-4 text-green-500 mr-2"}),u.jsx("span",{className:"text-sm text-gray-700",children:j})]},P))})]}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[u.jsx("button",{onClick:()=>f(!1),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"}),u.jsx("button",{onClick:()=>ri(A.id),className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete Application"})]})]})]})}),R&&T&&u.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full mx-4 max-h-[95vh] overflow-y-auto",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("h3",{className:"text-xl font-medium text-gray-900",children:["Edit Application - ",T.business_name]}),u.jsx("button",{onClick:()=>{z(!1),I(null)},className:"text-gray-400 hover:text-gray-600",children:u.jsx(g0,{className:"w-6 h-6"})})]})}),u.jsx("div",{className:"p-6",children:u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Application Details"}),u.jsxs("form",{onSubmit:zA,className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Name"}),u.jsx("input",{type:"text",value:T.business_name,onChange:j=>I(P=>P?{...P,business_name:j.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Name"}),u.jsx("input",{type:"text",value:T.owner_name,onChange:j=>I(P=>P?{...P,owner_name:j.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),u.jsx("input",{type:"email",value:T.email,onChange:j=>I(P=>P?{...P,email:j.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),u.jsx("input",{type:"tel",value:T.phone||"",onChange:j=>I(P=>P?{...P,phone:j.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Industry"}),u.jsxs("select",{value:T.industry||"",onChange:j=>I(P=>P?{...P,industry:j.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"Select Industry"}),u.jsx("option",{value:"Retail",children:"Retail"}),u.jsx("option",{value:"Restaurant",children:"Restaurant"}),u.jsx("option",{value:"Healthcare",children:"Healthcare"}),u.jsx("option",{value:"Construction",children:"Construction"}),u.jsx("option",{value:"Professional Services",children:"Professional Services"}),u.jsx("option",{value:"Transportation",children:"Transportation"}),u.jsx("option",{value:"Manufacturing",children:"Manufacturing"}),u.jsx("option",{value:"Technology",children:"Technology"}),u.jsx("option",{value:"Real Estate",children:"Real Estate"}),u.jsx("option",{value:"Other",children:"Other"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),u.jsxs("select",{value:T.status,onChange:j=>I(P=>P?{...P,status:j.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"draft",children:"Draft"}),u.jsx("option",{value:"submitted",children:"Submitted"}),u.jsx("option",{value:"under-review",children:"Under Review"}),u.jsx("option",{value:"approved",children:"Approved"}),u.jsx("option",{value:"matched",children:"Matched"}),u.jsx("option",{value:"funded",children:"Funded"}),u.jsx("option",{value:"declined",children:"Declined"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Requested Amount"}),u.jsx("input",{type:"number",value:T.requested_amount,onChange:j=>I(P=>P?{...P,requested_amount:Number(j.target.value)}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monthly Revenue"}),u.jsx("input",{type:"number",value:T.monthly_revenue,onChange:j=>I(P=>P?{...P,monthly_revenue:Number(j.target.value)}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit Score"}),u.jsx("input",{type:"number",value:T.credit_score,onChange:j=>I(P=>P?{...P,credit_score:Number(j.target.value)}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"300",max:"850"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Years in Business"}),u.jsx("input",{type:"number",value:T.years_in_business,onChange:j=>I(P=>P?{...P,years_in_business:Number(j.target.value)}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"})]})]}),u.jsx("div",{className:"flex justify-end pt-4",children:u.jsxs("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 flex items-center",children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Lender Submissions"}),u.jsxs("button",{onClick:()=>qe(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center text-sm",children:[u.jsx(lg,{className:"w-4 h-4 mr-1"}),"Add Lender"]})]}),u.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[ce.map(j=>u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsxs("div",{children:[u.jsx("h5",{className:"font-medium text-gray-900",children:j.lender.name}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Created: ",new Date(j.created_at).toLocaleDateString()]})]}),u.jsxs("select",{value:j.status,onChange:P=>zo(j,{status:P.target.value}),className:`px-3 py-1 rounded-full text-xs font-medium border-0 ${j.status==="approved"?"bg-green-100 text-green-800":j.status==="declined"?"bg-red-100 text-red-800":j.status==="funded"?"bg-blue-100 text-blue-800":j.status==="counter-offer"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:[u.jsx("option",{value:"pending",children:"Pending"}),u.jsx("option",{value:"approved",children:"Approved"}),u.jsx("option",{value:"declined",children:"Declined"}),u.jsx("option",{value:"counter-offer",children:"Counter Offer"}),u.jsx("option",{value:"funded",children:"Funded"})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Offered Amount"}),u.jsx("input",{type:"number",value:j.offered_amount||"",onChange:P=>zo(j,{offered_amount:Number(P.target.value)||null}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Amount"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Factor Rate"}),u.jsx("input",{type:"text",value:j.factor_rate||"",onChange:P=>zo(j,{factor_rate:P.target.value||null}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"1.2"})]})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Terms"}),u.jsx("input",{type:"text",value:j.terms||"",onChange:P=>zo(j,{terms:P.target.value||null}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"12 months"})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Response"}),u.jsx("textarea",{value:j.response||"",onChange:P=>zo(j,{response:P.target.value||null}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",rows:2,placeholder:"Lender response..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),u.jsx("textarea",{value:j.notes||"",onChange:P=>zo(j,{notes:P.target.value||null}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",rows:2,placeholder:"Internal notes..."})]})]},j.id)),ce.length===0&&u.jsxs("div",{className:"text-center py-8 text-gray-500",children:[u.jsx(Ur,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),u.jsx("p",{children:"No lender submissions yet"}),u.jsx("p",{className:"text-sm",children:'Click "Add Lender" to create submissions'})]})]})]})]})})]})}),ue&&u.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add Lender Submission"}),u.jsx("button",{onClick:()=>qe(!1),className:"text-gray-400 hover:text-gray-600",children:u.jsx(g0,{className:"w-5 h-5"})})]})}),u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:v.filter(j=>!ce.some(P=>P.lender_id===j.id)).map(j=>u.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>HA(j.id),children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900",children:j.name}),u.jsxs("p",{className:"text-sm text-gray-500",children:["$",j.min_amount.toLocaleString()," - $",j.max_amount.toLocaleString()]})]}),u.jsx(lg,{className:"w-5 h-5 text-green-600"})]},j.id))}),v.filter(j=>!ce.some(P=>P.lender_id===j.id)).length===0&&u.jsx("div",{className:"text-center py-8 text-gray-500",children:u.jsx("p",{children:"All available lenders have been added"})})]})]})}),p&&u.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Email Template Settings"}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Customize the email template sent to lenders"})]}),u.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Available Variables"}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-sm",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("p",{className:"font-medium text-gray-700",children:"Business Info:"}),u.jsx("p",{className:"text-gray-600",children:"{{businessName}}"}),u.jsx("p",{className:"text-gray-600",children:"{{ownerName}}"}),u.jsx("p",{className:"text-gray-600",children:"{{industry}}"}),u.jsx("p",{className:"text-gray-600",children:"{{businessType}}"}),u.jsx("p",{className:"text-gray-600",children:"{{ein}}"}),u.jsx("p",{className:"text-gray-600",children:"{{yearsInBusiness}}"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("p",{className:"font-medium text-gray-700",children:"Financial Info:"}),u.jsx("p",{className:"text-gray-600",children:"{{requested_amount}}"}),u.jsx("p",{className:"text-gray-600",children:"{{monthlyRevenue}}"}),u.jsx("p",{className:"text-gray-600",children:"{{annualRevenue}}"}),u.jsx("p",{className:"text-gray-600",children:"{{creditScore}}"}),u.jsx("p",{className:"text-gray-600",children:"{{existingDebt}}"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("p",{className:"font-medium text-gray-700",children:"Contact & Lender:"}),u.jsx("p",{className:"text-gray-600",children:"{{email}}"}),u.jsx("p",{className:"text-gray-600",children:"{{phone}}"}),u.jsx("p",{className:"text-gray-600",children:"{{address}}"}),u.jsx("p",{className:"text-gray-600",children:"{{lenderName}}"}),u.jsx("p",{className:"text-gray-600",children:"{{lenderMinAmount}}"}),u.jsx("p",{className:"text-gray-600",children:"{{lenderMaxAmount}}"}),u.jsx("p",{className:"text-gray-600",children:"{{lenderFactorRate}}"}),u.jsx("p",{className:"text-gray-600",children:"{{lenderPaybackTerm}}"}),u.jsx("p",{className:"text-gray-600",children:"{{lenderApprovalTime}}"}),u.jsx("p",{className:"text-gray-600",children:"{{applicationId}}"})]})]})})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Template"}),u.jsx("textarea",{value:g,onChange:j=>b(j.target.value),className:"w-full h-96 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono text-sm",placeholder:"Enter your email template..."}),u.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Use the variables above to dynamically insert application and lender data"})]}),u.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6",children:[u.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Preview"}),u.jsx("div",{className:"bg-white border rounded p-3 max-h-40 overflow-y-auto",children:u.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap",children:g.replace(/\{\{businessName\}\}/g,"Sample Business LLC").replace(/\{\{ownerName\}\}/g,"John Smith").replace(/\{\{industry\}\}/g,"Technology").replace(/\{\{businessType\}\}/g,"LLC").replace(/\{\{ein\}\}/g,"12-3456789").replace(/\{\{yearsInBusiness\}\}/g,"3").replace(/\{\{requestedAmount\}\}/g,"150,000").replace(/\{\{monthlyRevenue\}\}/g,"50,000").replace(/\{\{annualRevenue\}\}/g,"600,000").replace(/\{\{creditScore\}\}/g,"720").replace(/\{\{existingDebt\}\}/g,"25,000").replace(/\{\{email\}\}/g,"john@samplebusiness.com").replace(/\{\{phone\}\}/g,"(555) 123-4567").replace(/\{\{address\}\}/g,"123 Business St, City, ST 12345").replace(/\{\{lenderName\}\}/g,"Sample Lender").replace(/\{\{lenderMinAmount\}\}/g,"50,000").replace(/\{\{lenderMaxAmount\}\}/g,"500,000").replace(/\{\{lenderFactorRate\}\}/g,"1.2 - 1.4").replace(/\{\{lenderPaybackTerm\}\}/g,"6-18 months").replace(/\{\{lenderApprovalTime\}\}/g,"24 hours").replace(/\{\{applicationId\}\}/g,"APP-12345")})})]})]}),u.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[u.jsx("button",{onClick:()=>{const j=`Subject: Merchant Cash Advance Application - {{businessName}}

Dear {{lenderName}} Team,

I hope this email finds you well. I am writing to submit a merchant cash advance application for your review and consideration.

BUSINESS INFORMATION:
 Business Name: {{businessName}}
 Owner: {{ownerName}}
 Industry: {{industry}}
 Years in Business: {{yearsInBusiness}}
 Business Type: {{businessType}}
 EIN: {{ein}}

FINANCIAL DETAILS:
 Requested Amount: ${{requestedAmount}}
 Monthly Revenue: ${{monthlyRevenue}}
 Annual Revenue: ${{annualRevenue}}
 Credit Score: {{creditScore}}
 Existing Debt: ${{existingDebt}}

CONTACT INFORMATION:
 Email: {{email}}
 Phone: {{phone}}
 Address: {{address}}

I have attached the following documents for your review:
 Business bank statements (last 6 months)
 Tax returns
 Completed application form
 Voided business check

Based on your underwriting guidelines, I believe this application aligns well with your lending criteria:
 Amount Range: ${{lenderMinAmount}} - ${{lenderMaxAmount}}
 Factor Rate: {{lenderFactorRate}}
 Payback Term: {{lenderPaybackTerm}}
 Approval Time: {{lenderApprovalTime}}

I would appreciate the opportunity to discuss this application further and answer any questions you may have. Please let me know if you need any additional information or documentation.

Thank you for your time and consideration. I look forward to hearing from you soon.

Best regards,
{{ownerName}}
{{businessName}}
{{email}}
{{phone}}

---
This application was submitted through MCAPortal Pro
Application ID: {{applicationId}}`;b(j)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Reset to Default"}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{onClick:()=>{localStorage.setItem("mcaPortalEmailTemplate",g),m(!1),alert("Email template saved successfully!")},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Save Template"})]})]})]})})]})},dP=()=>{const[n,e]=G.useState(""),[t,s]=G.useState("all"),[i,r]=G.useState(null),[a,o]=G.useState(!1),[c,d]=G.useState([]),[h,f]=G.useState(!0);Gy.useEffect(()=>{(async()=>{try{f(!0);const S=await z1(),E=await Promise.all(S.map(async C=>{const N=await C0(C.id);return{...C,matchedLenders:N.length,lenderSubmissions:N}}));d(E)}catch(S){console.error("Error loading applications:",S)}finally{f(!1)}})()},[]);const p=v=>{switch(v){case"funded":return"bg-green-100 text-green-800";case"approved":return"bg-blue-100 text-blue-800";case"counter-offer":return"bg-yellow-100 text-yellow-800";case"pending":return"bg-gray-100 text-gray-800";case"declined":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},m=v=>{switch(v){case"funded":return"bg-blue-100 text-blue-800";case"approved":return"bg-green-100 text-green-800";case"submitted":return"bg-yellow-100 text-yellow-800";case"under-review":return"bg-purple-100 text-purple-800";case"declined":return"bg-red-100 text-red-800";case"draft":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},g=v=>{switch(v){case"funded":return u.jsx(Np,{className:"w-4 h-4"});case"approved":return u.jsx(us,{className:"w-4 h-4"});case"submitted":return u.jsx(og,{className:"w-4 h-4"});case"under-review":return u.jsx(_N,{className:"w-4 h-4"});case"declined":return u.jsx(g0,{className:"w-4 h-4"});default:return u.jsx(og,{className:"w-4 h-4"})}},b=c.filter(v=>{const S=v.business_name.toLowerCase().includes(n.toLowerCase())||v.owner_name.toLowerCase().includes(n.toLowerCase())||v.id.toLowerCase().includes(n.toLowerCase()),E=t==="all"||v.status===t;return S&&E}),A={all:c.length,submitted:c.filter(v=>v.status==="submitted").length,approved:c.filter(v=>v.status==="approved").length,declined:c.filter(v=>v.status==="declined").length},x=v=>{r(v),o(!0)};return u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[h&&u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading applications..."})]})}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"All Deals"}),u.jsx("p",{className:"text-gray-600",children:"View and manage all merchant cash advance submissions"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:u.jsx(Ur,{className:"w-6 h-6 text-blue-600"})}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Deals"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.length})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:u.jsx(us,{className:"w-6 h-6 text-green-600"})}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Approved"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.approved})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:u.jsx(og,{className:"w-6 h-6 text-yellow-600"})}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Submitted"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.submitted})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:u.jsx(m1,{className:"w-6 h-6 text-purple-600"})}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Volume"}),u.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",c.reduce((v,S)=>v+S.requested_amount,0).toLocaleString()]})]})]})})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(CN,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search deals...",value:n,onChange:v=>e(v.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),u.jsxs("select",{value:t,onChange:v=>s(v.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[u.jsxs("option",{value:"all",children:["All Status (",A.all,")"]}),u.jsxs("option",{value:"submitted",children:["Submitted (",A.submitted,")"]}),u.jsxs("option",{value:"approved",children:["Approved (",A.approved,")"]}),u.jsxs("option",{value:"approved",children:["Approved (",A.approved,")"]}),u.jsxs("option",{value:"declined",children:["Declined (",A.declined,")"]})]})]}),u.jsx("div",{className:"flex items-center space-x-2",children:u.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center",children:[u.jsx(EN,{className:"w-4 h-4 mr-2"}),"Export"]})})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deal Info"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Financial"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activity"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(v=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.business_name}),u.jsx("div",{className:"text-sm text-gray-500",children:v.id}),u.jsxs("div",{className:"flex items-center mt-1",children:[u.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${m(v.status)}`,children:v.status}),u.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"website"})]})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.owner_name}),u.jsx("div",{className:"text-sm text-gray-500",children:v.email}),u.jsx("div",{className:"text-sm text-gray-500",children:v.phone||"N/A"})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{children:[u.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["$",v.requested_amount.toLocaleString()]}),u.jsxs("div",{className:"text-sm text-gray-500",children:["$",v.monthly_revenue.toLocaleString(),"/mo"]}),u.jsxs("div",{className:"text-sm text-gray-500",children:["Credit: ",v.credit_score," | ",v.years_in_business,"y"]})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{className:"flex flex-col space-y-2",children:[u.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m(v.status)}`,children:[g(v.status),u.jsx("span",{className:"ml-1",children:v.status.replace("-"," ")})]}),v.lenderSubmissions.length>0&&u.jsxs("span",{className:"text-xs text-gray-500",children:[v.lenderSubmissions.length," lender",v.lenderSubmissions.length>1?"s":""]})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{children:[u.jsxs("div",{className:"text-sm text-gray-900",children:["Submitted: ",new Date(v.created_at).toLocaleDateString()]}),u.jsxs("div",{className:"text-sm text-gray-500",children:["Last: ",new Date(v.updated_at).toLocaleDateString()]})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("button",{onClick:()=>x(v),className:"text-purple-600 hover:text-purple-900",children:u.jsx(g1,{className:"w-4 h-4"})}),u.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:u.jsx(m0,{className:"w-4 h-4"})})]})})]},v.id))})]})})}),a&&i&&u.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Deal Details - ",i.business_name]}),u.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Business Information"}),u.jsxs("div",{className:"space-y-2 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Business Name:"})," ",u.jsx("span",{className:"font-medium",children:i.business_name})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Industry:"})," ",u.jsx("span",{className:"font-medium",children:i.industry})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Time in Business:"})," ",u.jsxs("span",{className:"font-medium",children:[i.years_in_business," years"]})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Monthly Revenue:"})," ",u.jsxs("span",{className:"font-medium",children:["$",i.monthly_revenue.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Credit Score:"})," ",u.jsx("span",{className:"font-medium",children:i.credit_score})]})]})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Contact Information"}),u.jsxs("div",{className:"space-y-2 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Owner:"})," ",u.jsx("span",{className:"font-medium",children:i.owner_name})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Email:"})," ",u.jsx("span",{className:"font-medium",children:i.email})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Phone:"})," ",u.jsx("span",{className:"font-medium",children:i.phone||"N/A"})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:"Source:"})," ",u.jsx("span",{className:"font-medium",children:"website"})]})]})]})]}),u.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[u.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:["Lender Submissions (",i.lenderSubmissions.length,")"]}),u.jsx("div",{className:"space-y-4",children:i.lenderSubmissions.map((v,S)=>u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsxs("div",{children:[u.jsx("h5",{className:"font-medium text-gray-900",children:v.lender.name}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Submitted: ",new Date(v.created_at).toLocaleDateString(),v.response_date&&u.jsxs("span",{children:["  Responded: ",new Date(v.response_date).toLocaleDateString()]})]})]}),u.jsx("span",{className:`inline-flex px-2.5 py-0.5 rounded-full text-xs font-medium ${p(v.status)}`,children:v.status})]}),v.response&&u.jsx("div",{className:"mb-3",children:u.jsxs("p",{className:"text-sm text-gray-700",children:[u.jsx("span",{className:"font-medium",children:"Response:"})," ",v.response]})}),(v.offered_amount||v.factor_rate||v.terms)&&u.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[v.offered_amount&&u.jsxs("div",{children:[u.jsx("span",{className:"text-xs text-gray-500",children:"Offered Amount"}),u.jsxs("p",{className:"font-medium text-sm",children:["$",v.offered_amount.toLocaleString()]})]}),v.factor_rate&&u.jsxs("div",{children:[u.jsx("span",{className:"text-xs text-gray-500",children:"Factor Rate"}),u.jsx("p",{className:"font-medium text-sm",children:v.factor_rate})]}),v.terms&&u.jsxs("div",{children:[u.jsx("span",{className:"text-xs text-gray-500",children:"Terms"}),u.jsx("p",{className:"font-medium text-sm",children:v.terms})]})]}),v.notes&&u.jsxs("div",{className:"text-xs text-gray-600 bg-white p-2 rounded border",children:[u.jsx("span",{className:"font-medium",children:"Notes:"})," ",v.notes]})]},S))})]}),u.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"}),u.jsx("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Edit Deal"})]})})]})]})})]})};function hP(){const[n,e]=G.useState("submissions");return u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white shadow-sm border-b",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center py-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ur,{className:"h-8 w-8 text-blue-600"}),u.jsx("span",{className:"text-2xl font-bold text-gray-900",children:"MCAPortal Pro"})]}),u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("button",{onClick:()=>e("submissions"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="submissions"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Submissions Portal"}),u.jsx("button",{onClick:()=>e("deals"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="deals"?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Deals"}),u.jsx("button",{onClick:()=>e("admin"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="admin"?"bg-emerald-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Admin Portal"})]})]})})}),n==="submissions"&&u.jsx(cP,{}),n==="deals"&&u.jsx(dP,{}),n==="admin"&&u.jsx(uP,{})]})}p1(document.getElementById("root")).render(u.jsx(G.StrictMode,{children:u.jsx(hP,{})}));
