var $A=Object.defineProperty;var sx=n=>{throw TypeError(n)};var BA=(n,e,t)=>e in n?$A(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var K=(n,e,t)=>BA(n,typeof e!="symbol"?e+"":e,t),Tm=(n,e,t)=>e.has(n)||sx("Cannot "+t);var l=(n,e,t)=>(Tm(n,e,"read from private field"),t?t.call(n):e.get(n)),w=(n,e,t)=>e.has(n)?sx("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),y=(n,e,t,s)=>(Tm(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),_=(n,e,t)=>(Tm(n,e,"access private method"),t);var Ut=(n,e,t,s)=>({set _(i){y(n,e,i,t)},get _(){return l(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();var tn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function UA(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function zA(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var i=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:function(){return n[s]}})}),t}var Jb={exports:{}},em={},Zb={exports:{}},ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Th=Symbol.for("react.element"),HA=Symbol.for("react.portal"),VA=Symbol.for("react.fragment"),WA=Symbol.for("react.strict_mode"),qA=Symbol.for("react.profiler"),GA=Symbol.for("react.provider"),XA=Symbol.for("react.context"),KA=Symbol.for("react.forward_ref"),YA=Symbol.for("react.suspense"),QA=Symbol.for("react.memo"),JA=Symbol.for("react.lazy"),nx=Symbol.iterator;function ZA(n){return n===null||typeof n!="object"?null:(n=nx&&n[nx]||n["@@iterator"],typeof n=="function"?n:null)}var ew={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tw=Object.assign,sw={};function Fc(n,e,t){this.props=n,this.context=e,this.refs=sw,this.updater=t||ew}Fc.prototype.isReactComponent={};Fc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Fc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function nw(){}nw.prototype=Fc.prototype;function Fy(n,e,t){this.props=n,this.context=e,this.refs=sw,this.updater=t||ew}var $y=Fy.prototype=new nw;$y.constructor=Fy;tw($y,Fc.prototype);$y.isPureReactComponent=!0;var ix=Array.isArray,iw=Object.prototype.hasOwnProperty,By={current:null},rw={key:!0,ref:!0,__self:!0,__source:!0};function aw(n,e,t){var s,i={},r=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(r=""+e.key),e)iw.call(e,s)&&!rw.hasOwnProperty(s)&&(i[s]=e[s]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];i.children=c}if(n&&n.defaultProps)for(s in o=n.defaultProps,o)i[s]===void 0&&(i[s]=o[s]);return{$$typeof:Th,type:n,key:r,ref:a,props:i,_owner:By.current}}function eE(n,e){return{$$typeof:Th,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Uy(n){return typeof n=="object"&&n!==null&&n.$$typeof===Th}function tE(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var rx=/\/+/g;function jm(n,e){return typeof n=="object"&&n!==null&&n.key!=null?tE(""+n.key):e.toString(36)}function ff(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case Th:case HA:a=!0}}if(a)return a=n,i=i(a),n=s===""?"."+jm(a,0):s,ix(i)?(t="",n!=null&&(t=n.replace(rx,"$&/")+"/"),ff(i,e,t,"",function(u){return u})):i!=null&&(Uy(i)&&(i=eE(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(rx,"$&/")+"/")+n)),e.push(i)),1;if(a=0,s=s===""?".":s+":",ix(n))for(var o=0;o<n.length;o++){r=n[o];var c=s+jm(r,o);a+=ff(r,e,t,c,i)}else if(c=ZA(n),typeof c=="function")for(n=c.call(n),o=0;!(r=n.next()).done;)r=r.value,c=s+jm(r,o++),a+=ff(r,e,t,c,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Uh(n,e,t){if(n==null)return n;var s=[],i=0;return ff(n,s,"","",function(r){return e.call(t,r,i++)}),s}function sE(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Zt={current:null},pf={transition:null},nE={ReactCurrentDispatcher:Zt,ReactCurrentBatchConfig:pf,ReactCurrentOwner:By};function ow(){throw Error("act(...) is not supported in production builds of React.")}ce.Children={map:Uh,forEach:function(n,e,t){Uh(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Uh(n,function(){e++}),e},toArray:function(n){return Uh(n,function(e){return e})||[]},only:function(n){if(!Uy(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ce.Component=Fc;ce.Fragment=VA;ce.Profiler=qA;ce.PureComponent=Fy;ce.StrictMode=WA;ce.Suspense=YA;ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nE;ce.act=ow;ce.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=tw({},n.props),i=n.key,r=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,a=By.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(c in e)iw.call(e,c)&&!rw.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:Th,type:n.type,key:i,ref:r,props:s,_owner:a}};ce.createContext=function(n){return n={$$typeof:XA,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:GA,_context:n},n.Consumer=n};ce.createElement=aw;ce.createFactory=function(n){var e=aw.bind(null,n);return e.type=n,e};ce.createRef=function(){return{current:null}};ce.forwardRef=function(n){return{$$typeof:KA,render:n}};ce.isValidElement=Uy;ce.lazy=function(n){return{$$typeof:JA,_payload:{_status:-1,_result:n},_init:sE}};ce.memo=function(n,e){return{$$typeof:QA,type:n,compare:e===void 0?null:e}};ce.startTransition=function(n){var e=pf.transition;pf.transition={};try{n()}finally{pf.transition=e}};ce.unstable_act=ow;ce.useCallback=function(n,e){return Zt.current.useCallback(n,e)};ce.useContext=function(n){return Zt.current.useContext(n)};ce.useDebugValue=function(){};ce.useDeferredValue=function(n){return Zt.current.useDeferredValue(n)};ce.useEffect=function(n,e){return Zt.current.useEffect(n,e)};ce.useId=function(){return Zt.current.useId()};ce.useImperativeHandle=function(n,e,t){return Zt.current.useImperativeHandle(n,e,t)};ce.useInsertionEffect=function(n,e){return Zt.current.useInsertionEffect(n,e)};ce.useLayoutEffect=function(n,e){return Zt.current.useLayoutEffect(n,e)};ce.useMemo=function(n,e){return Zt.current.useMemo(n,e)};ce.useReducer=function(n,e,t){return Zt.current.useReducer(n,e,t)};ce.useRef=function(n){return Zt.current.useRef(n)};ce.useState=function(n){return Zt.current.useState(n)};ce.useSyncExternalStore=function(n,e,t){return Zt.current.useSyncExternalStore(n,e,t)};ce.useTransition=function(){return Zt.current.useTransition()};ce.version="18.3.1";Zb.exports=ce;var Q=Zb.exports;const zy=UA(Q);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iE=Q,rE=Symbol.for("react.element"),aE=Symbol.for("react.fragment"),oE=Object.prototype.hasOwnProperty,lE=iE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cE={key:!0,ref:!0,__self:!0,__source:!0};function lw(n,e,t){var s,i={},r=null,a=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)oE.call(e,s)&&!cE.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:rE,type:n,key:r,ref:a,props:i,_owner:lE.current}}em.Fragment=aE;em.jsx=lw;em.jsxs=lw;Jb.exports=em;var d=Jb.exports,cw={exports:{}},Fs={},uw={exports:{}},dw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(M,G){var X=M.length;M.push(G);e:for(;0<X;){var ue=X-1>>>1,oe=M[ue];if(0<i(oe,G))M[ue]=G,M[X]=oe,X=ue;else break e}}function t(M){return M.length===0?null:M[0]}function s(M){if(M.length===0)return null;var G=M[0],X=M.pop();if(X!==G){M[0]=X;e:for(var ue=0,oe=M.length,Ae=oe>>>1;ue<Ae;){var Nt=2*(ue+1)-1,rn=M[Nt],Pe=Nt+1,me=M[Pe];if(0>i(rn,X))Pe<oe&&0>i(me,rn)?(M[ue]=me,M[Pe]=X,ue=Pe):(M[ue]=rn,M[Nt]=X,ue=Nt);else if(Pe<oe&&0>i(me,X))M[ue]=me,M[Pe]=X,ue=Pe;else break e}}return G}function i(M,G){var X=M.sortIndex-G.sortIndex;return X!==0?X:M.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],u=[],h=1,f=null,p=3,m=!1,g=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(M){for(var G=t(u);G!==null;){if(G.callback===null)s(u);else if(G.startTime<=M)s(u),G.sortIndex=G.expirationTime,e(c,G);else break;G=t(u)}}function A(M){if(b=!1,S(M),!g)if(t(c)!==null)g=!0,O(C);else{var G=t(u);G!==null&&q(A,G.startTime-M)}}function C(M,G){g=!1,b&&(b=!1,x(j),j=-1),m=!0;var X=p;try{for(S(G),f=t(c);f!==null&&(!(f.expirationTime>G)||M&&!U());){var ue=f.callback;if(typeof ue=="function"){f.callback=null,p=f.priorityLevel;var oe=ue(f.expirationTime<=G);G=n.unstable_now(),typeof oe=="function"?f.callback=oe:f===t(c)&&s(c),S(G)}else s(c);f=t(c)}if(f!==null)var Ae=!0;else{var Nt=t(u);Nt!==null&&q(A,Nt.startTime-G),Ae=!1}return Ae}finally{f=null,p=X,m=!1}}var N=!1,k=null,j=-1,I=5,R=-1;function U(){return!(n.unstable_now()-R<I)}function H(){if(k!==null){var M=n.unstable_now();R=M;var G=!0;try{G=k(!0,M)}finally{G?J():(N=!1,k=null)}}else N=!1}var J;if(typeof v=="function")J=function(){v(H)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,et=de.port2;de.port1.onmessage=H,J=function(){et.postMessage(null)}}else J=function(){E(H,0)};function O(M){k=M,N||(N=!0,J())}function q(M,G){j=E(function(){M(n.unstable_now())},G)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(M){M.callback=null},n.unstable_continueExecution=function(){g||m||(g=!0,O(C))},n.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<M?Math.floor(1e3/M):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(M){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var X=p;p=G;try{return M()}finally{p=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(M,G){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var X=p;p=M;try{return G()}finally{p=X}},n.unstable_scheduleCallback=function(M,G,X){var ue=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ue+X:ue):X=ue,M){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=X+oe,M={id:h++,callback:G,priorityLevel:M,startTime:X,expirationTime:oe,sortIndex:-1},X>ue?(M.sortIndex=X,e(u,M),t(c)===null&&M===t(u)&&(b?(x(j),j=-1):b=!0,q(A,X-ue))):(M.sortIndex=oe,e(c,M),g||m||(g=!0,O(C))),M},n.unstable_shouldYield=U,n.unstable_wrapCallback=function(M){var G=p;return function(){var X=p;p=G;try{return M.apply(this,arguments)}finally{p=X}}}})(dw);uw.exports=dw;var uE=uw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dE=Q,Os=uE;function L(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hw=new Set,Ou={};function Fo(n,e){jc(n,e),jc(n+"Capture",e)}function jc(n,e){for(Ou[n]=e,n=0;n<e.length;n++)hw.add(e[n])}var qi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vg=Object.prototype.hasOwnProperty,hE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ax={},ox={};function fE(n){return vg.call(ox,n)?!0:vg.call(ax,n)?!1:hE.test(n)?ox[n]=!0:(ax[n]=!0,!1)}function pE(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function mE(n,e,t,s){if(e===null||typeof e>"u"||pE(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function es(n,e,t,s,i,r,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=a}var kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){kt[n]=new es(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];kt[e]=new es(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){kt[n]=new es(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){kt[n]=new es(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){kt[n]=new es(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){kt[n]=new es(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){kt[n]=new es(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){kt[n]=new es(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){kt[n]=new es(n,5,!1,n.toLowerCase(),null,!1,!1)});var Hy=/[\-:]([a-z])/g;function Vy(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Hy,Vy);kt[e]=new es(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Hy,Vy);kt[e]=new es(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Hy,Vy);kt[e]=new es(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){kt[n]=new es(n,1,!1,n.toLowerCase(),null,!1,!1)});kt.xlinkHref=new es("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){kt[n]=new es(n,1,!1,n.toLowerCase(),null,!0,!0)});function Wy(n,e,t,s){var i=kt.hasOwnProperty(e)?kt[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(mE(e,t,i,s)&&(t=null),s||i===null?fE(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var Ji=dE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zh=Symbol.for("react.element"),nl=Symbol.for("react.portal"),il=Symbol.for("react.fragment"),qy=Symbol.for("react.strict_mode"),xg=Symbol.for("react.profiler"),fw=Symbol.for("react.provider"),pw=Symbol.for("react.context"),Gy=Symbol.for("react.forward_ref"),bg=Symbol.for("react.suspense"),wg=Symbol.for("react.suspense_list"),Xy=Symbol.for("react.memo"),nr=Symbol.for("react.lazy"),mw=Symbol.for("react.offscreen"),lx=Symbol.iterator;function Hc(n){return n===null||typeof n!="object"?null:(n=lx&&n[lx]||n["@@iterator"],typeof n=="function"?n:null)}var He=Object.assign,Pm;function su(n){if(Pm===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Pm=e&&e[1]||""}return`
`+Pm+n}var Rm=!1;function Im(n,e){if(!n||Rm)return"";Rm=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),a=i.length-1,o=r.length-1;1<=a&&0<=o&&i[a]!==r[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==r[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==r[o]){var c=`
`+i[a].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=a&&0<=o);break}}}finally{Rm=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?su(n):""}function gE(n){switch(n.tag){case 5:return su(n.type);case 16:return su("Lazy");case 13:return su("Suspense");case 19:return su("SuspenseList");case 0:case 2:case 15:return n=Im(n.type,!1),n;case 11:return n=Im(n.type.render,!1),n;case 1:return n=Im(n.type,!0),n;default:return""}}function _g(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case il:return"Fragment";case nl:return"Portal";case xg:return"Profiler";case qy:return"StrictMode";case bg:return"Suspense";case wg:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case pw:return(n.displayName||"Context")+".Consumer";case fw:return(n._context.displayName||"Context")+".Provider";case Gy:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Xy:return e=n.displayName||null,e!==null?e:_g(n.type)||"Memo";case nr:e=n._payload,n=n._init;try{return _g(n(e))}catch{}}return null}function yE(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _g(e);case 8:return e===qy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Yr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function gw(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function vE(n){var e=gw(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){s=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Hh(n){n._valueTracker||(n._valueTracker=vE(n))}function yw(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=gw(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function tp(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Sg(n,e){var t=e.checked;return He({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function cx(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=Yr(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vw(n,e){e=e.checked,e!=null&&Wy(n,"checked",e,!1)}function Ag(n,e){vw(n,e);var t=Yr(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Eg(n,e.type,t):e.hasOwnProperty("defaultValue")&&Eg(n,e.type,Yr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function ux(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Eg(n,e,t){(e!=="number"||tp(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var nu=Array.isArray;function yl(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+Yr(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function kg(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return He({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function dx(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(L(92));if(nu(t)){if(1<t.length)throw Error(L(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Yr(t)}}function xw(n,e){var t=Yr(e.value),s=Yr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function hx(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function bw(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ng(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?bw(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Vh,ww=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Vh=Vh||document.createElement("div"),Vh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Vh.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Fu(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Su={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xE=["Webkit","ms","Moz","O"];Object.keys(Su).forEach(function(n){xE.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Su[e]=Su[n]})});function _w(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Su.hasOwnProperty(n)&&Su[n]?(""+e).trim():e+"px"}function Sw(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=_w(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var bE=He({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Cg(n,e){if(e){if(bE[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function Tg(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jg=null;function Ky(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Pg=null,vl=null,xl=null;function fx(n){if(n=Rh(n)){if(typeof Pg!="function")throw Error(L(280));var e=n.stateNode;e&&(e=rm(e),Pg(n.stateNode,n.type,e))}}function Aw(n){vl?xl?xl.push(n):xl=[n]:vl=n}function Ew(){if(vl){var n=vl,e=xl;if(xl=vl=null,fx(n),e)for(n=0;n<e.length;n++)fx(e[n])}}function kw(n,e){return n(e)}function Nw(){}var Lm=!1;function Cw(n,e,t){if(Lm)return n(e,t);Lm=!0;try{return kw(n,e,t)}finally{Lm=!1,(vl!==null||xl!==null)&&(Nw(),Ew())}}function $u(n,e){var t=n.stateNode;if(t===null)return null;var s=rm(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(L(231,e,typeof t));return t}var Rg=!1;if(qi)try{var Vc={};Object.defineProperty(Vc,"passive",{get:function(){Rg=!0}}),window.addEventListener("test",Vc,Vc),window.removeEventListener("test",Vc,Vc)}catch{Rg=!1}function wE(n,e,t,s,i,r,a,o,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var Au=!1,sp=null,np=!1,Ig=null,_E={onError:function(n){Au=!0,sp=n}};function SE(n,e,t,s,i,r,a,o,c){Au=!1,sp=null,wE.apply(_E,arguments)}function AE(n,e,t,s,i,r,a,o,c){if(SE.apply(this,arguments),Au){if(Au){var u=sp;Au=!1,sp=null}else throw Error(L(198));np||(np=!0,Ig=u)}}function $o(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Tw(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function px(n){if($o(n)!==n)throw Error(L(188))}function EE(n){var e=n.alternate;if(!e){if(e=$o(n),e===null)throw Error(L(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return px(i),n;if(r===s)return px(i),e;r=r.sibling}throw Error(L(188))}if(t.return!==s.return)t=i,s=r;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,s=r;break}if(o===s){a=!0,s=i,t=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===t){a=!0,t=r,s=i;break}if(o===s){a=!0,s=r,t=i;break}o=o.sibling}if(!a)throw Error(L(189))}}if(t.alternate!==s)throw Error(L(190))}if(t.tag!==3)throw Error(L(188));return t.stateNode.current===t?n:e}function jw(n){return n=EE(n),n!==null?Pw(n):null}function Pw(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Pw(n);if(e!==null)return e;n=n.sibling}return null}var Rw=Os.unstable_scheduleCallback,mx=Os.unstable_cancelCallback,kE=Os.unstable_shouldYield,NE=Os.unstable_requestPaint,Xe=Os.unstable_now,CE=Os.unstable_getCurrentPriorityLevel,Yy=Os.unstable_ImmediatePriority,Iw=Os.unstable_UserBlockingPriority,ip=Os.unstable_NormalPriority,TE=Os.unstable_LowPriority,Lw=Os.unstable_IdlePriority,tm=null,ni=null;function jE(n){if(ni&&typeof ni.onCommitFiberRoot=="function")try{ni.onCommitFiberRoot(tm,n,void 0,(n.current.flags&128)===128)}catch{}}var Nn=Math.clz32?Math.clz32:IE,PE=Math.log,RE=Math.LN2;function IE(n){return n>>>=0,n===0?32:31-(PE(n)/RE|0)|0}var Wh=64,qh=4194304;function iu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function rp(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?s=iu(o):(r&=a,r!==0&&(s=iu(r)))}else a=t&~i,a!==0?s=iu(a):r!==0&&(s=iu(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-Nn(e),i=1<<t,s|=n[t],e&=~i;return s}function LE(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ME(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var a=31-Nn(r),o=1<<a,c=i[a];c===-1?(!(o&t)||o&s)&&(i[a]=LE(o,e)):c<=e&&(n.expiredLanes|=o),r&=~o}}function Lg(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Mw(){var n=Wh;return Wh<<=1,!(Wh&4194240)&&(Wh=64),n}function Mm(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function jh(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Nn(e),n[e]=t}function DE(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Nn(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function Qy(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-Nn(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var be=0;function Dw(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Ow,Jy,Fw,$w,Bw,Mg=!1,Gh=[],Ur=null,zr=null,Hr=null,Bu=new Map,Uu=new Map,rr=[],OE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gx(n,e){switch(n){case"focusin":case"focusout":Ur=null;break;case"dragenter":case"dragleave":zr=null;break;case"mouseover":case"mouseout":Hr=null;break;case"pointerover":case"pointerout":Bu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uu.delete(e.pointerId)}}function Wc(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=Rh(e),e!==null&&Jy(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function FE(n,e,t,s,i){switch(e){case"focusin":return Ur=Wc(Ur,n,e,t,s,i),!0;case"dragenter":return zr=Wc(zr,n,e,t,s,i),!0;case"mouseover":return Hr=Wc(Hr,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return Bu.set(r,Wc(Bu.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,Uu.set(r,Wc(Uu.get(r)||null,n,e,t,s,i)),!0}return!1}function Uw(n){var e=ya(n.target);if(e!==null){var t=$o(e);if(t!==null){if(e=t.tag,e===13){if(e=Tw(t),e!==null){n.blockedOn=e,Bw(n.priority,function(){Fw(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function mf(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Dg(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);jg=s,t.target.dispatchEvent(s),jg=null}else return e=Rh(t),e!==null&&Jy(e),n.blockedOn=t,!1;e.shift()}return!0}function yx(n,e,t){mf(n)&&t.delete(e)}function $E(){Mg=!1,Ur!==null&&mf(Ur)&&(Ur=null),zr!==null&&mf(zr)&&(zr=null),Hr!==null&&mf(Hr)&&(Hr=null),Bu.forEach(yx),Uu.forEach(yx)}function qc(n,e){n.blockedOn===e&&(n.blockedOn=null,Mg||(Mg=!0,Os.unstable_scheduleCallback(Os.unstable_NormalPriority,$E)))}function zu(n){function e(i){return qc(i,n)}if(0<Gh.length){qc(Gh[0],n);for(var t=1;t<Gh.length;t++){var s=Gh[t];s.blockedOn===n&&(s.blockedOn=null)}}for(Ur!==null&&qc(Ur,n),zr!==null&&qc(zr,n),Hr!==null&&qc(Hr,n),Bu.forEach(e),Uu.forEach(e),t=0;t<rr.length;t++)s=rr[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<rr.length&&(t=rr[0],t.blockedOn===null);)Uw(t),t.blockedOn===null&&rr.shift()}var bl=Ji.ReactCurrentBatchConfig,ap=!0;function BE(n,e,t,s){var i=be,r=bl.transition;bl.transition=null;try{be=1,Zy(n,e,t,s)}finally{be=i,bl.transition=r}}function UE(n,e,t,s){var i=be,r=bl.transition;bl.transition=null;try{be=4,Zy(n,e,t,s)}finally{be=i,bl.transition=r}}function Zy(n,e,t,s){if(ap){var i=Dg(n,e,t,s);if(i===null)Wm(n,e,s,op,t),gx(n,s);else if(FE(i,n,e,t,s))s.stopPropagation();else if(gx(n,s),e&4&&-1<OE.indexOf(n)){for(;i!==null;){var r=Rh(i);if(r!==null&&Ow(r),r=Dg(n,e,t,s),r===null&&Wm(n,e,s,op,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else Wm(n,e,s,null,t)}}var op=null;function Dg(n,e,t,s){if(op=null,n=Ky(s),n=ya(n),n!==null)if(e=$o(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Tw(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return op=n,null}function zw(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(CE()){case Yy:return 1;case Iw:return 4;case ip:case TE:return 16;case Lw:return 536870912;default:return 16}default:return 16}}var $r=null,ev=null,gf=null;function Hw(){if(gf)return gf;var n,e=ev,t=e.length,s,i="value"in $r?$r.value:$r.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(s=1;s<=a&&e[t-s]===i[r-s];s++);return gf=i.slice(n,1<s?1-s:void 0)}function yf(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Xh(){return!0}function vx(){return!1}function $s(n){function e(t,s,i,r,a){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Xh:vx,this.isPropagationStopped=vx,this}return He(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Xh)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Xh)},persist:function(){},isPersistent:Xh}),e}var $c={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tv=$s($c),Ph=He({},$c,{view:0,detail:0}),zE=$s(Ph),Dm,Om,Gc,sm=He({},Ph,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sv,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Gc&&(Gc&&n.type==="mousemove"?(Dm=n.screenX-Gc.screenX,Om=n.screenY-Gc.screenY):Om=Dm=0,Gc=n),Dm)},movementY:function(n){return"movementY"in n?n.movementY:Om}}),xx=$s(sm),HE=He({},sm,{dataTransfer:0}),VE=$s(HE),WE=He({},Ph,{relatedTarget:0}),Fm=$s(WE),qE=He({},$c,{animationName:0,elapsedTime:0,pseudoElement:0}),GE=$s(qE),XE=He({},$c,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),KE=$s(XE),YE=He({},$c,{data:0}),bx=$s(YE),QE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ek(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=ZE[n])?!!e[n]:!1}function sv(){return ek}var tk=He({},Ph,{key:function(n){if(n.key){var e=QE[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=yf(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?JE[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sv,charCode:function(n){return n.type==="keypress"?yf(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?yf(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),sk=$s(tk),nk=He({},sm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wx=$s(nk),ik=He({},Ph,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sv}),rk=$s(ik),ak=He({},$c,{propertyName:0,elapsedTime:0,pseudoElement:0}),ok=$s(ak),lk=He({},sm,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ck=$s(lk),uk=[9,13,27,32],nv=qi&&"CompositionEvent"in window,Eu=null;qi&&"documentMode"in document&&(Eu=document.documentMode);var dk=qi&&"TextEvent"in window&&!Eu,Vw=qi&&(!nv||Eu&&8<Eu&&11>=Eu),_x=" ",Sx=!1;function Ww(n,e){switch(n){case"keyup":return uk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qw(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var rl=!1;function hk(n,e){switch(n){case"compositionend":return qw(e);case"keypress":return e.which!==32?null:(Sx=!0,_x);case"textInput":return n=e.data,n===_x&&Sx?null:n;default:return null}}function fk(n,e){if(rl)return n==="compositionend"||!nv&&Ww(n,e)?(n=Hw(),gf=ev=$r=null,rl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Vw&&e.locale!=="ko"?null:e.data;default:return null}}var pk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ax(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!pk[n.type]:e==="textarea"}function Gw(n,e,t,s){Aw(s),e=lp(e,"onChange"),0<e.length&&(t=new tv("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var ku=null,Hu=null;function mk(n){i_(n,0)}function nm(n){var e=ll(n);if(yw(e))return n}function gk(n,e){if(n==="change")return e}var Xw=!1;if(qi){var $m;if(qi){var Bm="oninput"in document;if(!Bm){var Ex=document.createElement("div");Ex.setAttribute("oninput","return;"),Bm=typeof Ex.oninput=="function"}$m=Bm}else $m=!1;Xw=$m&&(!document.documentMode||9<document.documentMode)}function kx(){ku&&(ku.detachEvent("onpropertychange",Kw),Hu=ku=null)}function Kw(n){if(n.propertyName==="value"&&nm(Hu)){var e=[];Gw(e,Hu,n,Ky(n)),Cw(mk,e)}}function yk(n,e,t){n==="focusin"?(kx(),ku=e,Hu=t,ku.attachEvent("onpropertychange",Kw)):n==="focusout"&&kx()}function vk(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return nm(Hu)}function xk(n,e){if(n==="click")return nm(e)}function bk(n,e){if(n==="input"||n==="change")return nm(e)}function wk(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Tn=typeof Object.is=="function"?Object.is:wk;function Vu(n,e){if(Tn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!vg.call(e,i)||!Tn(n[i],e[i]))return!1}return!0}function Nx(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Cx(n,e){var t=Nx(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Nx(t)}}function Yw(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Yw(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Qw(){for(var n=window,e=tp();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=tp(n.document)}return e}function iv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function _k(n){var e=Qw(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Yw(t.ownerDocument.documentElement,t)){if(s!==null&&iv(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=Cx(t,r);var a=Cx(t,s);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Sk=qi&&"documentMode"in document&&11>=document.documentMode,al=null,Og=null,Nu=null,Fg=!1;function Tx(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Fg||al==null||al!==tp(s)||(s=al,"selectionStart"in s&&iv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Nu&&Vu(Nu,s)||(Nu=s,s=lp(Og,"onSelect"),0<s.length&&(e=new tv("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=al)))}function Kh(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var ol={animationend:Kh("Animation","AnimationEnd"),animationiteration:Kh("Animation","AnimationIteration"),animationstart:Kh("Animation","AnimationStart"),transitionend:Kh("Transition","TransitionEnd")},Um={},Jw={};qi&&(Jw=document.createElement("div").style,"AnimationEvent"in window||(delete ol.animationend.animation,delete ol.animationiteration.animation,delete ol.animationstart.animation),"TransitionEvent"in window||delete ol.transitionend.transition);function im(n){if(Um[n])return Um[n];if(!ol[n])return n;var e=ol[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Jw)return Um[n]=e[t];return n}var Zw=im("animationend"),e_=im("animationiteration"),t_=im("animationstart"),s_=im("transitionend"),n_=new Map,jx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ta(n,e){n_.set(n,e),Fo(e,[n])}for(var zm=0;zm<jx.length;zm++){var Hm=jx[zm],Ak=Hm.toLowerCase(),Ek=Hm[0].toUpperCase()+Hm.slice(1);ta(Ak,"on"+Ek)}ta(Zw,"onAnimationEnd");ta(e_,"onAnimationIteration");ta(t_,"onAnimationStart");ta("dblclick","onDoubleClick");ta("focusin","onFocus");ta("focusout","onBlur");ta(s_,"onTransitionEnd");jc("onMouseEnter",["mouseout","mouseover"]);jc("onMouseLeave",["mouseout","mouseover"]);jc("onPointerEnter",["pointerout","pointerover"]);jc("onPointerLeave",["pointerout","pointerover"]);Fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ru="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kk=new Set("cancel close invalid load scroll toggle".split(" ").concat(ru));function Px(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,AE(s,e,void 0,n),n.currentTarget=null}function i_(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==r&&i.isPropagationStopped())break e;Px(i,o,u),r=c}else for(a=0;a<s.length;a++){if(o=s[a],c=o.instance,u=o.currentTarget,o=o.listener,c!==r&&i.isPropagationStopped())break e;Px(i,o,u),r=c}}}if(np)throw n=Ig,np=!1,Ig=null,n}function Ce(n,e){var t=e[Hg];t===void 0&&(t=e[Hg]=new Set);var s=n+"__bubble";t.has(s)||(r_(e,n,2,!1),t.add(s))}function Vm(n,e,t){var s=0;e&&(s|=4),r_(t,n,s,e)}var Yh="_reactListening"+Math.random().toString(36).slice(2);function Wu(n){if(!n[Yh]){n[Yh]=!0,hw.forEach(function(t){t!=="selectionchange"&&(kk.has(t)||Vm(t,!1,n),Vm(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Yh]||(e[Yh]=!0,Vm("selectionchange",!1,e))}}function r_(n,e,t,s){switch(zw(e)){case 1:var i=BE;break;case 4:i=UE;break;default:i=Zy}t=i.bind(null,e,t,n),i=void 0,!Rg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Wm(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;o!==null;){if(a=ya(o),a===null)return;if(c=a.tag,c===5||c===6){s=r=a;continue e}o=o.parentNode}}s=s.return}Cw(function(){var u=r,h=Ky(t),f=[];e:{var p=n_.get(n);if(p!==void 0){var m=tv,g=n;switch(n){case"keypress":if(yf(t)===0)break e;case"keydown":case"keyup":m=sk;break;case"focusin":g="focus",m=Fm;break;case"focusout":g="blur",m=Fm;break;case"beforeblur":case"afterblur":m=Fm;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=xx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=VE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=rk;break;case Zw:case e_:case t_:m=GE;break;case s_:m=ok;break;case"scroll":m=zE;break;case"wheel":m=ck;break;case"copy":case"cut":case"paste":m=KE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=wx}var b=(e&4)!==0,E=!b&&n==="scroll",x=b?p!==null?p+"Capture":null:p;b=[];for(var v=u,S;v!==null;){S=v;var A=S.stateNode;if(S.tag===5&&A!==null&&(S=A,x!==null&&(A=$u(v,x),A!=null&&b.push(qu(v,A,S)))),E)break;v=v.return}0<b.length&&(p=new m(p,g,null,t,h),f.push({event:p,listeners:b}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==jg&&(g=t.relatedTarget||t.fromElement)&&(ya(g)||g[Gi]))break e;if((m||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,m?(g=t.relatedTarget||t.toElement,m=u,g=g?ya(g):null,g!==null&&(E=$o(g),g!==E||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(b=xx,A="onMouseLeave",x="onMouseEnter",v="mouse",(n==="pointerout"||n==="pointerover")&&(b=wx,A="onPointerLeave",x="onPointerEnter",v="pointer"),E=m==null?p:ll(m),S=g==null?p:ll(g),p=new b(A,v+"leave",m,t,h),p.target=E,p.relatedTarget=S,A=null,ya(h)===u&&(b=new b(x,v+"enter",g,t,h),b.target=S,b.relatedTarget=E,A=b),E=A,m&&g)t:{for(b=m,x=g,v=0,S=b;S;S=zo(S))v++;for(S=0,A=x;A;A=zo(A))S++;for(;0<v-S;)b=zo(b),v--;for(;0<S-v;)x=zo(x),S--;for(;v--;){if(b===x||x!==null&&b===x.alternate)break t;b=zo(b),x=zo(x)}b=null}else b=null;m!==null&&Rx(f,p,m,b,!1),g!==null&&E!==null&&Rx(f,E,g,b,!0)}}e:{if(p=u?ll(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var C=gk;else if(Ax(p))if(Xw)C=bk;else{C=vk;var N=yk}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=xk);if(C&&(C=C(n,u))){Gw(f,C,t,h);break e}N&&N(n,p,u),n==="focusout"&&(N=p._wrapperState)&&N.controlled&&p.type==="number"&&Eg(p,"number",p.value)}switch(N=u?ll(u):window,n){case"focusin":(Ax(N)||N.contentEditable==="true")&&(al=N,Og=u,Nu=null);break;case"focusout":Nu=Og=al=null;break;case"mousedown":Fg=!0;break;case"contextmenu":case"mouseup":case"dragend":Fg=!1,Tx(f,t,h);break;case"selectionchange":if(Sk)break;case"keydown":case"keyup":Tx(f,t,h)}var k;if(nv)e:{switch(n){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else rl?Ww(n,t)&&(j="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(j="onCompositionStart");j&&(Vw&&t.locale!=="ko"&&(rl||j!=="onCompositionStart"?j==="onCompositionEnd"&&rl&&(k=Hw()):($r=h,ev="value"in $r?$r.value:$r.textContent,rl=!0)),N=lp(u,j),0<N.length&&(j=new bx(j,n,null,t,h),f.push({event:j,listeners:N}),k?j.data=k:(k=qw(t),k!==null&&(j.data=k)))),(k=dk?hk(n,t):fk(n,t))&&(u=lp(u,"onBeforeInput"),0<u.length&&(h=new bx("onBeforeInput","beforeinput",null,t,h),f.push({event:h,listeners:u}),h.data=k))}i_(f,e)})}function qu(n,e,t){return{instance:n,listener:e,currentTarget:t}}function lp(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=$u(n,t),r!=null&&s.unshift(qu(n,r,i)),r=$u(n,e),r!=null&&s.push(qu(n,r,i))),n=n.return}return s}function zo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Rx(n,e,t,s,i){for(var r=e._reactName,a=[];t!==null&&t!==s;){var o=t,c=o.alternate,u=o.stateNode;if(c!==null&&c===s)break;o.tag===5&&u!==null&&(o=u,i?(c=$u(t,r),c!=null&&a.unshift(qu(t,c,o))):i||(c=$u(t,r),c!=null&&a.push(qu(t,c,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var Nk=/\r\n?/g,Ck=/\u0000|\uFFFD/g;function Ix(n){return(typeof n=="string"?n:""+n).replace(Nk,`
`).replace(Ck,"")}function Qh(n,e,t){if(e=Ix(e),Ix(n)!==e&&t)throw Error(L(425))}function cp(){}var $g=null,Bg=null;function Ug(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var zg=typeof setTimeout=="function"?setTimeout:void 0,Tk=typeof clearTimeout=="function"?clearTimeout:void 0,Lx=typeof Promise=="function"?Promise:void 0,jk=typeof queueMicrotask=="function"?queueMicrotask:typeof Lx<"u"?function(n){return Lx.resolve(null).then(n).catch(Pk)}:zg;function Pk(n){setTimeout(function(){throw n})}function qm(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),zu(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);zu(e)}function Vr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function Mx(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Bc=Math.random().toString(36).slice(2),si="__reactFiber$"+Bc,Gu="__reactProps$"+Bc,Gi="__reactContainer$"+Bc,Hg="__reactEvents$"+Bc,Rk="__reactListeners$"+Bc,Ik="__reactHandles$"+Bc;function ya(n){var e=n[si];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Gi]||t[si]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Mx(n);n!==null;){if(t=n[si])return t;n=Mx(n)}return e}n=t,t=n.parentNode}return null}function Rh(n){return n=n[si]||n[Gi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ll(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(L(33))}function rm(n){return n[Gu]||null}var Vg=[],cl=-1;function sa(n){return{current:n}}function je(n){0>cl||(n.current=Vg[cl],Vg[cl]=null,cl--)}function Ne(n,e){cl++,Vg[cl]=n.current,n.current=e}var Qr={},Bt=sa(Qr),ds=sa(!1),To=Qr;function Pc(n,e){var t=n.type.contextTypes;if(!t)return Qr;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function hs(n){return n=n.childContextTypes,n!=null}function up(){je(ds),je(Bt)}function Dx(n,e,t){if(Bt.current!==Qr)throw Error(L(168));Ne(Bt,e),Ne(ds,t)}function a_(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(L(108,yE(n)||"Unknown",i));return He({},t,s)}function dp(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Qr,To=Bt.current,Ne(Bt,n),Ne(ds,ds.current),!0}function Ox(n,e,t){var s=n.stateNode;if(!s)throw Error(L(169));t?(n=a_(n,e,To),s.__reactInternalMemoizedMergedChildContext=n,je(ds),je(Bt),Ne(Bt,n)):je(ds),Ne(ds,t)}var pi=null,am=!1,Gm=!1;function o_(n){pi===null?pi=[n]:pi.push(n)}function Lk(n){am=!0,o_(n)}function na(){if(!Gm&&pi!==null){Gm=!0;var n=0,e=be;try{var t=pi;for(be=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}pi=null,am=!1}catch(i){throw pi!==null&&(pi=pi.slice(n+1)),Rw(Yy,na),i}finally{be=e,Gm=!1}}return null}var ul=[],dl=0,hp=null,fp=0,Xs=[],Ks=0,jo=null,Ui=1,zi="";function la(n,e){ul[dl++]=fp,ul[dl++]=hp,hp=n,fp=e}function l_(n,e,t){Xs[Ks++]=Ui,Xs[Ks++]=zi,Xs[Ks++]=jo,jo=n;var s=Ui;n=zi;var i=32-Nn(s)-1;s&=~(1<<i),t+=1;var r=32-Nn(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Ui=1<<32-Nn(e)+i|t<<i|s,zi=r+n}else Ui=1<<r|t<<i|s,zi=n}function rv(n){n.return!==null&&(la(n,1),l_(n,1,0))}function av(n){for(;n===hp;)hp=ul[--dl],ul[dl]=null,fp=ul[--dl],ul[dl]=null;for(;n===jo;)jo=Xs[--Ks],Xs[Ks]=null,zi=Xs[--Ks],Xs[Ks]=null,Ui=Xs[--Ks],Xs[Ks]=null}var Ms=null,Ls=null,Me=!1,En=null;function c_(n,e){var t=Js(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Fx(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ms=n,Ls=Vr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ms=n,Ls=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=jo!==null?{id:Ui,overflow:zi}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Js(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ms=n,Ls=null,!0):!1;default:return!1}}function Wg(n){return(n.mode&1)!==0&&(n.flags&128)===0}function qg(n){if(Me){var e=Ls;if(e){var t=e;if(!Fx(n,e)){if(Wg(n))throw Error(L(418));e=Vr(t.nextSibling);var s=Ms;e&&Fx(n,e)?c_(s,t):(n.flags=n.flags&-4097|2,Me=!1,Ms=n)}}else{if(Wg(n))throw Error(L(418));n.flags=n.flags&-4097|2,Me=!1,Ms=n}}}function $x(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ms=n}function Jh(n){if(n!==Ms)return!1;if(!Me)return $x(n),Me=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Ug(n.type,n.memoizedProps)),e&&(e=Ls)){if(Wg(n))throw u_(),Error(L(418));for(;e;)c_(n,e),e=Vr(e.nextSibling)}if($x(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(L(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Ls=Vr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Ls=null}}else Ls=Ms?Vr(n.stateNode.nextSibling):null;return!0}function u_(){for(var n=Ls;n;)n=Vr(n.nextSibling)}function Rc(){Ls=Ms=null,Me=!1}function ov(n){En===null?En=[n]:En.push(n)}var Mk=Ji.ReactCurrentBatchConfig;function Xc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(L(309));var s=t.stateNode}if(!s)throw Error(L(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(a){var o=i.refs;a===null?delete o[r]:o[r]=a},e._stringRef=r,e)}if(typeof n!="string")throw Error(L(284));if(!t._owner)throw Error(L(290,n))}return n}function Zh(n,e){throw n=Object.prototype.toString.call(e),Error(L(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Bx(n){var e=n._init;return e(n._payload)}function d_(n){function e(x,v){if(n){var S=x.deletions;S===null?(x.deletions=[v],x.flags|=16):S.push(v)}}function t(x,v){if(!n)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function s(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function i(x,v){return x=Xr(x,v),x.index=0,x.sibling=null,x}function r(x,v,S){return x.index=S,n?(S=x.alternate,S!==null?(S=S.index,S<v?(x.flags|=2,v):S):(x.flags|=2,v)):(x.flags|=1048576,v)}function a(x){return n&&x.alternate===null&&(x.flags|=2),x}function o(x,v,S,A){return v===null||v.tag!==6?(v=eg(S,x.mode,A),v.return=x,v):(v=i(v,S),v.return=x,v)}function c(x,v,S,A){var C=S.type;return C===il?h(x,v,S.props.children,A,S.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===nr&&Bx(C)===v.type)?(A=i(v,S.props),A.ref=Xc(x,v,S),A.return=x,A):(A=Af(S.type,S.key,S.props,null,x.mode,A),A.ref=Xc(x,v,S),A.return=x,A)}function u(x,v,S,A){return v===null||v.tag!==4||v.stateNode.containerInfo!==S.containerInfo||v.stateNode.implementation!==S.implementation?(v=tg(S,x.mode,A),v.return=x,v):(v=i(v,S.children||[]),v.return=x,v)}function h(x,v,S,A,C){return v===null||v.tag!==7?(v=No(S,x.mode,A,C),v.return=x,v):(v=i(v,S),v.return=x,v)}function f(x,v,S){if(typeof v=="string"&&v!==""||typeof v=="number")return v=eg(""+v,x.mode,S),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case zh:return S=Af(v.type,v.key,v.props,null,x.mode,S),S.ref=Xc(x,null,v),S.return=x,S;case nl:return v=tg(v,x.mode,S),v.return=x,v;case nr:var A=v._init;return f(x,A(v._payload),S)}if(nu(v)||Hc(v))return v=No(v,x.mode,S,null),v.return=x,v;Zh(x,v)}return null}function p(x,v,S,A){var C=v!==null?v.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return C!==null?null:o(x,v,""+S,A);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case zh:return S.key===C?c(x,v,S,A):null;case nl:return S.key===C?u(x,v,S,A):null;case nr:return C=S._init,p(x,v,C(S._payload),A)}if(nu(S)||Hc(S))return C!==null?null:h(x,v,S,A,null);Zh(x,S)}return null}function m(x,v,S,A,C){if(typeof A=="string"&&A!==""||typeof A=="number")return x=x.get(S)||null,o(v,x,""+A,C);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case zh:return x=x.get(A.key===null?S:A.key)||null,c(v,x,A,C);case nl:return x=x.get(A.key===null?S:A.key)||null,u(v,x,A,C);case nr:var N=A._init;return m(x,v,S,N(A._payload),C)}if(nu(A)||Hc(A))return x=x.get(S)||null,h(v,x,A,C,null);Zh(v,A)}return null}function g(x,v,S,A){for(var C=null,N=null,k=v,j=v=0,I=null;k!==null&&j<S.length;j++){k.index>j?(I=k,k=null):I=k.sibling;var R=p(x,k,S[j],A);if(R===null){k===null&&(k=I);break}n&&k&&R.alternate===null&&e(x,k),v=r(R,v,j),N===null?C=R:N.sibling=R,N=R,k=I}if(j===S.length)return t(x,k),Me&&la(x,j),C;if(k===null){for(;j<S.length;j++)k=f(x,S[j],A),k!==null&&(v=r(k,v,j),N===null?C=k:N.sibling=k,N=k);return Me&&la(x,j),C}for(k=s(x,k);j<S.length;j++)I=m(k,x,j,S[j],A),I!==null&&(n&&I.alternate!==null&&k.delete(I.key===null?j:I.key),v=r(I,v,j),N===null?C=I:N.sibling=I,N=I);return n&&k.forEach(function(U){return e(x,U)}),Me&&la(x,j),C}function b(x,v,S,A){var C=Hc(S);if(typeof C!="function")throw Error(L(150));if(S=C.call(S),S==null)throw Error(L(151));for(var N=C=null,k=v,j=v=0,I=null,R=S.next();k!==null&&!R.done;j++,R=S.next()){k.index>j?(I=k,k=null):I=k.sibling;var U=p(x,k,R.value,A);if(U===null){k===null&&(k=I);break}n&&k&&U.alternate===null&&e(x,k),v=r(U,v,j),N===null?C=U:N.sibling=U,N=U,k=I}if(R.done)return t(x,k),Me&&la(x,j),C;if(k===null){for(;!R.done;j++,R=S.next())R=f(x,R.value,A),R!==null&&(v=r(R,v,j),N===null?C=R:N.sibling=R,N=R);return Me&&la(x,j),C}for(k=s(x,k);!R.done;j++,R=S.next())R=m(k,x,j,R.value,A),R!==null&&(n&&R.alternate!==null&&k.delete(R.key===null?j:R.key),v=r(R,v,j),N===null?C=R:N.sibling=R,N=R);return n&&k.forEach(function(H){return e(x,H)}),Me&&la(x,j),C}function E(x,v,S,A){if(typeof S=="object"&&S!==null&&S.type===il&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case zh:e:{for(var C=S.key,N=v;N!==null;){if(N.key===C){if(C=S.type,C===il){if(N.tag===7){t(x,N.sibling),v=i(N,S.props.children),v.return=x,x=v;break e}}else if(N.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===nr&&Bx(C)===N.type){t(x,N.sibling),v=i(N,S.props),v.ref=Xc(x,N,S),v.return=x,x=v;break e}t(x,N);break}else e(x,N);N=N.sibling}S.type===il?(v=No(S.props.children,x.mode,A,S.key),v.return=x,x=v):(A=Af(S.type,S.key,S.props,null,x.mode,A),A.ref=Xc(x,v,S),A.return=x,x=A)}return a(x);case nl:e:{for(N=S.key;v!==null;){if(v.key===N)if(v.tag===4&&v.stateNode.containerInfo===S.containerInfo&&v.stateNode.implementation===S.implementation){t(x,v.sibling),v=i(v,S.children||[]),v.return=x,x=v;break e}else{t(x,v);break}else e(x,v);v=v.sibling}v=tg(S,x.mode,A),v.return=x,x=v}return a(x);case nr:return N=S._init,E(x,v,N(S._payload),A)}if(nu(S))return g(x,v,S,A);if(Hc(S))return b(x,v,S,A);Zh(x,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,v!==null&&v.tag===6?(t(x,v.sibling),v=i(v,S),v.return=x,x=v):(t(x,v),v=eg(S,x.mode,A),v.return=x,x=v),a(x)):t(x,v)}return E}var Ic=d_(!0),h_=d_(!1),pp=sa(null),mp=null,hl=null,lv=null;function cv(){lv=hl=mp=null}function uv(n){var e=pp.current;je(pp),n._currentValue=e}function Gg(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function wl(n,e){mp=n,lv=hl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(us=!0),n.firstContext=null)}function sn(n){var e=n._currentValue;if(lv!==n)if(n={context:n,memoizedValue:e,next:null},hl===null){if(mp===null)throw Error(L(308));hl=n,mp.dependencies={lanes:0,firstContext:n}}else hl=hl.next=n;return e}var va=null;function dv(n){va===null?va=[n]:va.push(n)}function f_(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,dv(e)):(t.next=i.next,i.next=t),e.interleaved=t,Xi(n,s)}function Xi(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var ir=!1;function hv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function p_(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Hi(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Wr(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,fe&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,Xi(n,t)}return i=s.interleaved,i===null?(e.next=e,dv(s)):(e.next=i.next,i.next=e),s.interleaved=e,Xi(n,t)}function vf(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,Qy(n,t)}}function Ux(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function gp(n,e,t,s){var i=n.updateQueue;ir=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,u=c.next;c.next=null,a===null?r=u:a.next=u,a=c;var h=n.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=c))}if(r!==null){var f=i.baseState;a=0,h=u=c=null,o=r;do{var p=o.lane,m=o.eventTime;if((s&p)===p){h!==null&&(h=h.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=n,b=o;switch(p=e,m=t,b.tag){case 1:if(g=b.payload,typeof g=="function"){f=g.call(m,f,p);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=b.payload,p=typeof g=="function"?g.call(m,f,p):g,p==null)break e;f=He({},f,p);break e;case 2:ir=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(u=h=m,c=f):h=h.next=m,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(h===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);Ro|=a,n.lanes=a,n.memoizedState=f}}function zx(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(L(191,i));i.call(s)}}}var Ih={},ii=sa(Ih),Xu=sa(Ih),Ku=sa(Ih);function xa(n){if(n===Ih)throw Error(L(174));return n}function fv(n,e){switch(Ne(Ku,e),Ne(Xu,n),Ne(ii,Ih),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ng(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Ng(e,n)}je(ii),Ne(ii,e)}function Lc(){je(ii),je(Xu),je(Ku)}function m_(n){xa(Ku.current);var e=xa(ii.current),t=Ng(e,n.type);e!==t&&(Ne(Xu,n),Ne(ii,t))}function pv(n){Xu.current===n&&(je(ii),je(Xu))}var Be=sa(0);function yp(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Xm=[];function mv(){for(var n=0;n<Xm.length;n++)Xm[n]._workInProgressVersionPrimary=null;Xm.length=0}var xf=Ji.ReactCurrentDispatcher,Km=Ji.ReactCurrentBatchConfig,Po=0,ze=null,ot=null,gt=null,vp=!1,Cu=!1,Yu=0,Dk=0;function Ct(){throw Error(L(321))}function gv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Tn(n[t],e[t]))return!1;return!0}function yv(n,e,t,s,i,r){if(Po=r,ze=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xf.current=n===null||n.memoizedState===null?Bk:Uk,n=t(s,i),Cu){r=0;do{if(Cu=!1,Yu=0,25<=r)throw Error(L(301));r+=1,gt=ot=null,e.updateQueue=null,xf.current=zk,n=t(s,i)}while(Cu)}if(xf.current=xp,e=ot!==null&&ot.next!==null,Po=0,gt=ot=ze=null,vp=!1,e)throw Error(L(300));return n}function vv(){var n=Yu!==0;return Yu=0,n}function On(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?ze.memoizedState=gt=n:gt=gt.next=n,gt}function nn(){if(ot===null){var n=ze.alternate;n=n!==null?n.memoizedState:null}else n=ot.next;var e=gt===null?ze.memoizedState:gt.next;if(e!==null)gt=e,ot=n;else{if(n===null)throw Error(L(310));ot=n,n={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},gt===null?ze.memoizedState=gt=n:gt=gt.next=n}return gt}function Qu(n,e){return typeof e=="function"?e(n):e}function Ym(n){var e=nn(),t=e.queue;if(t===null)throw Error(L(311));t.lastRenderedReducer=n;var s=ot,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var o=a=null,c=null,u=r;do{var h=u.lane;if((Po&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,a=s):c=c.next=f,ze.lanes|=h,Ro|=h}u=u.next}while(u!==null&&u!==r);c===null?a=s:c.next=o,Tn(s,e.memoizedState)||(us=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,ze.lanes|=r,Ro|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Qm(n){var e=nn(),t=e.queue;if(t===null)throw Error(L(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do r=n(r,a.action),a=a.next;while(a!==i);Tn(r,e.memoizedState)||(us=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function g_(){}function y_(n,e){var t=ze,s=nn(),i=e(),r=!Tn(s.memoizedState,i);if(r&&(s.memoizedState=i,us=!0),s=s.queue,xv(b_.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||gt!==null&&gt.memoizedState.tag&1){if(t.flags|=2048,Ju(9,x_.bind(null,t,s,i,e),void 0,null),yt===null)throw Error(L(349));Po&30||v_(t,e,i)}return i}function v_(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function x_(n,e,t,s){e.value=t,e.getSnapshot=s,w_(e)&&__(n)}function b_(n,e,t){return t(function(){w_(e)&&__(n)})}function w_(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Tn(n,t)}catch{return!0}}function __(n){var e=Xi(n,1);e!==null&&Cn(e,n,1,-1)}function Hx(n){var e=On();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qu,lastRenderedState:n},e.queue=n,n=n.dispatch=$k.bind(null,ze,n),[e.memoizedState,n]}function Ju(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function S_(){return nn().memoizedState}function bf(n,e,t,s){var i=On();ze.flags|=n,i.memoizedState=Ju(1|e,t,void 0,s===void 0?null:s)}function om(n,e,t,s){var i=nn();s=s===void 0?null:s;var r=void 0;if(ot!==null){var a=ot.memoizedState;if(r=a.destroy,s!==null&&gv(s,a.deps)){i.memoizedState=Ju(e,t,r,s);return}}ze.flags|=n,i.memoizedState=Ju(1|e,t,r,s)}function Vx(n,e){return bf(8390656,8,n,e)}function xv(n,e){return om(2048,8,n,e)}function A_(n,e){return om(4,2,n,e)}function E_(n,e){return om(4,4,n,e)}function k_(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function N_(n,e,t){return t=t!=null?t.concat([n]):null,om(4,4,k_.bind(null,e,n),t)}function bv(){}function C_(n,e){var t=nn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&gv(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function T_(n,e){var t=nn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&gv(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function j_(n,e,t){return Po&21?(Tn(t,e)||(t=Mw(),ze.lanes|=t,Ro|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,us=!0),n.memoizedState=t)}function Ok(n,e){var t=be;be=t!==0&&4>t?t:4,n(!0);var s=Km.transition;Km.transition={};try{n(!1),e()}finally{be=t,Km.transition=s}}function P_(){return nn().memoizedState}function Fk(n,e,t){var s=Gr(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},R_(n))I_(e,t);else if(t=f_(n,e,t,s),t!==null){var i=Kt();Cn(t,n,s,i),L_(t,e,s)}}function $k(n,e,t){var s=Gr(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(R_(n))I_(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,t);if(i.hasEagerState=!0,i.eagerState=o,Tn(o,a)){var c=e.interleaved;c===null?(i.next=i,dv(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=f_(n,e,i,s),t!==null&&(i=Kt(),Cn(t,n,s,i),L_(t,e,s))}}function R_(n){var e=n.alternate;return n===ze||e!==null&&e===ze}function I_(n,e){Cu=vp=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function L_(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,Qy(n,t)}}var xp={readContext:sn,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useInsertionEffect:Ct,useLayoutEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useMutableSource:Ct,useSyncExternalStore:Ct,useId:Ct,unstable_isNewReconciler:!1},Bk={readContext:sn,useCallback:function(n,e){return On().memoizedState=[n,e===void 0?null:e],n},useContext:sn,useEffect:Vx,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,bf(4194308,4,k_.bind(null,e,n),t)},useLayoutEffect:function(n,e){return bf(4194308,4,n,e)},useInsertionEffect:function(n,e){return bf(4,2,n,e)},useMemo:function(n,e){var t=On();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=On();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=Fk.bind(null,ze,n),[s.memoizedState,n]},useRef:function(n){var e=On();return n={current:n},e.memoizedState=n},useState:Hx,useDebugValue:bv,useDeferredValue:function(n){return On().memoizedState=n},useTransition:function(){var n=Hx(!1),e=n[0];return n=Ok.bind(null,n[1]),On().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=ze,i=On();if(Me){if(t===void 0)throw Error(L(407));t=t()}else{if(t=e(),yt===null)throw Error(L(349));Po&30||v_(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,Vx(b_.bind(null,s,r,n),[n]),s.flags|=2048,Ju(9,x_.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=On(),e=yt.identifierPrefix;if(Me){var t=zi,s=Ui;t=(s&~(1<<32-Nn(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=Yu++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Dk++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Uk={readContext:sn,useCallback:C_,useContext:sn,useEffect:xv,useImperativeHandle:N_,useInsertionEffect:A_,useLayoutEffect:E_,useMemo:T_,useReducer:Ym,useRef:S_,useState:function(){return Ym(Qu)},useDebugValue:bv,useDeferredValue:function(n){var e=nn();return j_(e,ot.memoizedState,n)},useTransition:function(){var n=Ym(Qu)[0],e=nn().memoizedState;return[n,e]},useMutableSource:g_,useSyncExternalStore:y_,useId:P_,unstable_isNewReconciler:!1},zk={readContext:sn,useCallback:C_,useContext:sn,useEffect:xv,useImperativeHandle:N_,useInsertionEffect:A_,useLayoutEffect:E_,useMemo:T_,useReducer:Qm,useRef:S_,useState:function(){return Qm(Qu)},useDebugValue:bv,useDeferredValue:function(n){var e=nn();return ot===null?e.memoizedState=n:j_(e,ot.memoizedState,n)},useTransition:function(){var n=Qm(Qu)[0],e=nn().memoizedState;return[n,e]},useMutableSource:g_,useSyncExternalStore:y_,useId:P_,unstable_isNewReconciler:!1};function cn(n,e){if(n&&n.defaultProps){e=He({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Xg(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:He({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var lm={isMounted:function(n){return(n=n._reactInternals)?$o(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=Kt(),i=Gr(n),r=Hi(s,i);r.payload=e,t!=null&&(r.callback=t),e=Wr(n,r,i),e!==null&&(Cn(e,n,i,s),vf(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=Kt(),i=Gr(n),r=Hi(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=Wr(n,r,i),e!==null&&(Cn(e,n,i,s),vf(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Kt(),s=Gr(n),i=Hi(t,s);i.tag=2,e!=null&&(i.callback=e),e=Wr(n,i,s),e!==null&&(Cn(e,n,s,t),vf(e,n,s))}};function Wx(n,e,t,s,i,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!Vu(t,s)||!Vu(i,r):!0}function M_(n,e,t){var s=!1,i=Qr,r=e.contextType;return typeof r=="object"&&r!==null?r=sn(r):(i=hs(e)?To:Bt.current,s=e.contextTypes,r=(s=s!=null)?Pc(n,i):Qr),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=lm,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function qx(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&lm.enqueueReplaceState(e,e.state,null)}function Kg(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},hv(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=sn(r):(r=hs(e)?To:Bt.current,i.context=Pc(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(Xg(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&lm.enqueueReplaceState(i,i.state,null),gp(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Mc(n,e){try{var t="",s=e;do t+=gE(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function Jm(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Yg(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Hk=typeof WeakMap=="function"?WeakMap:Map;function D_(n,e,t){t=Hi(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){wp||(wp=!0,a0=s),Yg(n,e)},t}function O_(n,e,t){t=Hi(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){Yg(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){Yg(n,e),typeof s!="function"&&(qr===null?qr=new Set([this]):qr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function Gx(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new Hk;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=nN.bind(null,n,e,t),e.then(n,n))}function Xx(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Kx(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Hi(-1,1),e.tag=2,Wr(t,e,1))),t.lanes|=1),n)}var Vk=Ji.ReactCurrentOwner,us=!1;function Xt(n,e,t,s){e.child=n===null?h_(e,null,t,s):Ic(e,n.child,t,s)}function Yx(n,e,t,s,i){t=t.render;var r=e.ref;return wl(e,i),s=yv(n,e,t,s,r,i),t=vv(),n!==null&&!us?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ki(n,e,i)):(Me&&t&&rv(e),e.flags|=1,Xt(n,e,s,i),e.child)}function Qx(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!Cv(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,F_(n,e,r,s,i)):(n=Af(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:Vu,t(a,s)&&n.ref===e.ref)return Ki(n,e,i)}return e.flags|=1,n=Xr(r,s),n.ref=e.ref,n.return=e,e.child=n}function F_(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Vu(r,s)&&n.ref===e.ref)if(us=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(us=!0);else return e.lanes=n.lanes,Ki(n,e,i)}return Qg(n,e,t,s,i)}function $_(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(pl,js),js|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ne(pl,js),js|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,Ne(pl,js),js|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,Ne(pl,js),js|=s;return Xt(n,e,i,t),e.child}function B_(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Qg(n,e,t,s,i){var r=hs(t)?To:Bt.current;return r=Pc(e,r),wl(e,i),t=yv(n,e,t,s,r,i),s=vv(),n!==null&&!us?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ki(n,e,i)):(Me&&s&&rv(e),e.flags|=1,Xt(n,e,t,i),e.child)}function Jx(n,e,t,s,i){if(hs(t)){var r=!0;dp(e)}else r=!1;if(wl(e,i),e.stateNode===null)wf(n,e),M_(e,t,s),Kg(e,t,s,i),s=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var c=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=sn(u):(u=hs(t)?To:Bt.current,u=Pc(e,u));var h=t.getDerivedStateFromProps,f=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==s||c!==u)&&qx(e,a,s,u),ir=!1;var p=e.memoizedState;a.state=p,gp(e,s,a,i),c=e.memoizedState,o!==s||p!==c||ds.current||ir?(typeof h=="function"&&(Xg(e,t,h,s),c=e.memoizedState),(o=ir||Wx(e,t,o,s,p,c,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),a.props=s,a.state=c,a.context=u,s=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,p_(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:cn(e.type,o),a.props=u,f=e.pendingProps,p=a.context,c=t.contextType,typeof c=="object"&&c!==null?c=sn(c):(c=hs(t)?To:Bt.current,c=Pc(e,c));var m=t.getDerivedStateFromProps;(h=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||p!==c)&&qx(e,a,s,c),ir=!1,p=e.memoizedState,a.state=p,gp(e,s,a,i);var g=e.memoizedState;o!==f||p!==g||ds.current||ir?(typeof m=="function"&&(Xg(e,t,m,s),g=e.memoizedState),(u=ir||Wx(e,t,u,s,p,g,c)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,g,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=g),a.props=s,a.state=g,a.context=c,s=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),s=!1)}return Jg(n,e,t,s,r,i)}function Jg(n,e,t,s,i,r){B_(n,e);var a=(e.flags&128)!==0;if(!s&&!a)return i&&Ox(e,t,!1),Ki(n,e,r);s=e.stateNode,Vk.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&a?(e.child=Ic(e,n.child,null,r),e.child=Ic(e,null,o,r)):Xt(n,e,o,r),e.memoizedState=s.state,i&&Ox(e,t,!0),e.child}function U_(n){var e=n.stateNode;e.pendingContext?Dx(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Dx(n,e.context,!1),fv(n,e.containerInfo)}function Zx(n,e,t,s,i){return Rc(),ov(i),e.flags|=256,Xt(n,e,t,s),e.child}var Zg={dehydrated:null,treeContext:null,retryLane:0};function e0(n){return{baseLanes:n,cachePool:null,transitions:null}}function z_(n,e,t){var s=e.pendingProps,i=Be.current,r=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Ne(Be,i&1),n===null)return qg(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,n=s.fallback,r?(s=e.mode,r=e.child,a={mode:"hidden",children:a},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=a):r=dm(a,s,0,null),n=No(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=e0(t),e.memoizedState=Zg,n):wv(e,a));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return Wk(n,e,a,s,o,i,t);if(r){r=s.fallback,a=e.mode,i=n.child,o=i.sibling;var c={mode:"hidden",children:s.children};return!(a&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Xr(i,c),s.subtreeFlags=i.subtreeFlags&14680064),o!==null?r=Xr(o,r):(r=No(r,a,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,a=n.child.memoizedState,a=a===null?e0(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},r.memoizedState=a,r.childLanes=n.childLanes&~t,e.memoizedState=Zg,s}return r=n.child,n=r.sibling,s=Xr(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function wv(n,e){return e=dm({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function ef(n,e,t,s){return s!==null&&ov(s),Ic(e,n.child,null,t),n=wv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Wk(n,e,t,s,i,r,a){if(t)return e.flags&256?(e.flags&=-257,s=Jm(Error(L(422))),ef(n,e,a,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=dm({mode:"visible",children:s.children},i,0,null),r=No(r,i,a,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&Ic(e,n.child,null,a),e.child.memoizedState=e0(a),e.memoizedState=Zg,r);if(!(e.mode&1))return ef(n,e,a,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var o=s.dgst;return s=o,r=Error(L(419)),s=Jm(r,s,void 0),ef(n,e,a,s)}if(o=(a&n.childLanes)!==0,us||o){if(s=yt,s!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|a)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,Xi(n,i),Cn(s,n,i,-1))}return Nv(),s=Jm(Error(L(421))),ef(n,e,a,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=iN.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,Ls=Vr(i.nextSibling),Ms=e,Me=!0,En=null,n!==null&&(Xs[Ks++]=Ui,Xs[Ks++]=zi,Xs[Ks++]=jo,Ui=n.id,zi=n.overflow,jo=e),e=wv(e,s.children),e.flags|=4096,e)}function eb(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),Gg(n.return,e,t)}function Zm(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function H_(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(Xt(n,e,s.children,t),s=Be.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&eb(n,t,e);else if(n.tag===19)eb(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Ne(Be,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&yp(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),Zm(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&yp(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}Zm(e,!0,t,null,r);break;case"together":Zm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wf(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ki(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Ro|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(L(153));if(e.child!==null){for(n=e.child,t=Xr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Xr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function qk(n,e,t){switch(e.tag){case 3:U_(e),Rc();break;case 5:m_(e);break;case 1:hs(e.type)&&dp(e);break;case 4:fv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;Ne(pp,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Ne(Be,Be.current&1),e.flags|=128,null):t&e.child.childLanes?z_(n,e,t):(Ne(Be,Be.current&1),n=Ki(n,e,t),n!==null?n.sibling:null);Ne(Be,Be.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return H_(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ne(Be,Be.current),s)break;return null;case 22:case 23:return e.lanes=0,$_(n,e,t)}return Ki(n,e,t)}var V_,t0,W_,q_;V_=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};t0=function(){};W_=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,xa(ii.current);var r=null;switch(t){case"input":i=Sg(n,i),s=Sg(n,s),r=[];break;case"select":i=He({},i,{value:void 0}),s=He({},s,{value:void 0}),r=[];break;case"textarea":i=kg(n,i),s=kg(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=cp)}Cg(t,s);var a;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ou.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var c=s[u];if(o=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(t||(t={}),t[a]=c[a])}else t||(r||(r=[]),r.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(r=r||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ou.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ce("scroll",n),r||o===c||(r=[])):(r=r||[]).push(u,c))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};q_=function(n,e,t,s){t!==s&&(e.flags|=4)};function Kc(n,e){if(!Me)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Tt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function Gk(n,e,t){var s=e.pendingProps;switch(av(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(e),null;case 1:return hs(e.type)&&up(),Tt(e),null;case 3:return s=e.stateNode,Lc(),je(ds),je(Bt),mv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(Jh(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,En!==null&&(c0(En),En=null))),t0(n,e),Tt(e),null;case 5:pv(e);var i=xa(Ku.current);if(t=e.type,n!==null&&e.stateNode!=null)W_(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(L(166));return Tt(e),null}if(n=xa(ii.current),Jh(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[si]=e,s[Gu]=r,n=(e.mode&1)!==0,t){case"dialog":Ce("cancel",s),Ce("close",s);break;case"iframe":case"object":case"embed":Ce("load",s);break;case"video":case"audio":for(i=0;i<ru.length;i++)Ce(ru[i],s);break;case"source":Ce("error",s);break;case"img":case"image":case"link":Ce("error",s),Ce("load",s);break;case"details":Ce("toggle",s);break;case"input":cx(s,r),Ce("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},Ce("invalid",s);break;case"textarea":dx(s,r),Ce("invalid",s)}Cg(t,r),i=null;for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];a==="children"?typeof o=="string"?s.textContent!==o&&(r.suppressHydrationWarning!==!0&&Qh(s.textContent,o,n),i=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&Qh(s.textContent,o,n),i=["children",""+o]):Ou.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ce("scroll",s)}switch(t){case"input":Hh(s),ux(s,r,!0);break;case"textarea":Hh(s),hx(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=cp)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=bw(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=a.createElement(t,{is:s.is}):(n=a.createElement(t),t==="select"&&(a=n,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):n=a.createElementNS(n,t),n[si]=e,n[Gu]=s,V_(n,e,!1,!1),e.stateNode=n;e:{switch(a=Tg(t,s),t){case"dialog":Ce("cancel",n),Ce("close",n),i=s;break;case"iframe":case"object":case"embed":Ce("load",n),i=s;break;case"video":case"audio":for(i=0;i<ru.length;i++)Ce(ru[i],n);i=s;break;case"source":Ce("error",n),i=s;break;case"img":case"image":case"link":Ce("error",n),Ce("load",n),i=s;break;case"details":Ce("toggle",n),i=s;break;case"input":cx(n,s),i=Sg(n,s),Ce("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=He({},s,{value:void 0}),Ce("invalid",n);break;case"textarea":dx(n,s),i=kg(n,s),Ce("invalid",n);break;default:i=s}Cg(t,i),o=i;for(r in o)if(o.hasOwnProperty(r)){var c=o[r];r==="style"?Sw(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ww(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&Fu(n,c):typeof c=="number"&&Fu(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Ou.hasOwnProperty(r)?c!=null&&r==="onScroll"&&Ce("scroll",n):c!=null&&Wy(n,r,c,a))}switch(t){case"input":Hh(n),ux(n,s,!1);break;case"textarea":Hh(n),hx(n);break;case"option":s.value!=null&&n.setAttribute("value",""+Yr(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?yl(n,!!s.multiple,r,!1):s.defaultValue!=null&&yl(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=cp)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Tt(e),null;case 6:if(n&&e.stateNode!=null)q_(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(L(166));if(t=xa(Ku.current),xa(ii.current),Jh(e)){if(s=e.stateNode,t=e.memoizedProps,s[si]=e,(r=s.nodeValue!==t)&&(n=Ms,n!==null))switch(n.tag){case 3:Qh(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Qh(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[si]=e,e.stateNode=s}return Tt(e),null;case 13:if(je(Be),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Me&&Ls!==null&&e.mode&1&&!(e.flags&128))u_(),Rc(),e.flags|=98560,r=!1;else if(r=Jh(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(L(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(L(317));r[si]=e}else Rc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Tt(e),r=!1}else En!==null&&(c0(En),En=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||Be.current&1?lt===0&&(lt=3):Nv())),e.updateQueue!==null&&(e.flags|=4),Tt(e),null);case 4:return Lc(),t0(n,e),n===null&&Wu(e.stateNode.containerInfo),Tt(e),null;case 10:return uv(e.type._context),Tt(e),null;case 17:return hs(e.type)&&up(),Tt(e),null;case 19:if(je(Be),r=e.memoizedState,r===null)return Tt(e),null;if(s=(e.flags&128)!==0,a=r.rendering,a===null)if(s)Kc(r,!1);else{if(lt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=yp(n),a!==null){for(e.flags|=128,Kc(r,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,a=r.alternate,a===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=a.childLanes,r.lanes=a.lanes,r.child=a.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=a.memoizedProps,r.memoizedState=a.memoizedState,r.updateQueue=a.updateQueue,r.type=a.type,n=a.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ne(Be,Be.current&1|2),e.child}n=n.sibling}r.tail!==null&&Xe()>Dc&&(e.flags|=128,s=!0,Kc(r,!1),e.lanes=4194304)}else{if(!s)if(n=yp(a),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Kc(r,!0),r.tail===null&&r.tailMode==="hidden"&&!a.alternate&&!Me)return Tt(e),null}else 2*Xe()-r.renderingStartTime>Dc&&t!==1073741824&&(e.flags|=128,s=!0,Kc(r,!1),e.lanes=4194304);r.isBackwards?(a.sibling=e.child,e.child=a):(t=r.last,t!==null?t.sibling=a:e.child=a,r.last=a)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Xe(),e.sibling=null,t=Be.current,Ne(Be,s?t&1|2:t&1),e):(Tt(e),null);case 22:case 23:return kv(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?js&1073741824&&(Tt(e),e.subtreeFlags&6&&(e.flags|=8192)):Tt(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function Xk(n,e){switch(av(e),e.tag){case 1:return hs(e.type)&&up(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Lc(),je(ds),je(Bt),mv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return pv(e),null;case 13:if(je(Be),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(L(340));Rc()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return je(Be),null;case 4:return Lc(),null;case 10:return uv(e.type._context),null;case 22:case 23:return kv(),null;case 24:return null;default:return null}}var tf=!1,Ft=!1,Kk=typeof WeakSet=="function"?WeakSet:Set,B=null;function fl(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){We(n,e,s)}else t.current=null}function s0(n,e,t){try{t()}catch(s){We(n,e,s)}}var tb=!1;function Yk(n,e){if($g=ap,n=Qw(),iv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,o=-1,c=-1,u=0,h=0,f=n,p=null;t:for(;;){for(var m;f!==t||i!==0&&f.nodeType!==3||(o=a+i),f!==r||s!==0&&f.nodeType!==3||(c=a+s),f.nodeType===3&&(a+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===n)break t;if(p===t&&++u===i&&(o=a),p===r&&++h===s&&(c=a),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}t=o===-1||c===-1?null:{start:o,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(Bg={focusedElem:n,selectionRange:t},ap=!1,B=e;B!==null;)if(e=B,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,B=n;else for(;B!==null;){e=B;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var b=g.memoizedProps,E=g.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?b:cn(e.type,b),E);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(A){We(e,e.return,A)}if(n=e.sibling,n!==null){n.return=e.return,B=n;break}B=e.return}return g=tb,tb=!1,g}function Tu(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&s0(e,t,r)}i=i.next}while(i!==s)}}function cm(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function n0(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function G_(n){var e=n.alternate;e!==null&&(n.alternate=null,G_(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[si],delete e[Gu],delete e[Hg],delete e[Rk],delete e[Ik])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function X_(n){return n.tag===5||n.tag===3||n.tag===4}function sb(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||X_(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function i0(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=cp));else if(s!==4&&(n=n.child,n!==null))for(i0(n,e,t),n=n.sibling;n!==null;)i0(n,e,t),n=n.sibling}function r0(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(r0(n,e,t),n=n.sibling;n!==null;)r0(n,e,t),n=n.sibling}var St=null,Sn=!1;function Zi(n,e,t){for(t=t.child;t!==null;)K_(n,e,t),t=t.sibling}function K_(n,e,t){if(ni&&typeof ni.onCommitFiberUnmount=="function")try{ni.onCommitFiberUnmount(tm,t)}catch{}switch(t.tag){case 5:Ft||fl(t,e);case 6:var s=St,i=Sn;St=null,Zi(n,e,t),St=s,Sn=i,St!==null&&(Sn?(n=St,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):St.removeChild(t.stateNode));break;case 18:St!==null&&(Sn?(n=St,t=t.stateNode,n.nodeType===8?qm(n.parentNode,t):n.nodeType===1&&qm(n,t),zu(n)):qm(St,t.stateNode));break;case 4:s=St,i=Sn,St=t.stateNode.containerInfo,Sn=!0,Zi(n,e,t),St=s,Sn=i;break;case 0:case 11:case 14:case 15:if(!Ft&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,a=r.destroy;r=r.tag,a!==void 0&&(r&2||r&4)&&s0(t,e,a),i=i.next}while(i!==s)}Zi(n,e,t);break;case 1:if(!Ft&&(fl(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(o){We(t,e,o)}Zi(n,e,t);break;case 21:Zi(n,e,t);break;case 22:t.mode&1?(Ft=(s=Ft)||t.memoizedState!==null,Zi(n,e,t),Ft=s):Zi(n,e,t);break;default:Zi(n,e,t)}}function nb(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Kk),e.forEach(function(s){var i=rN.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function an(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:St=o.stateNode,Sn=!1;break e;case 3:St=o.stateNode.containerInfo,Sn=!0;break e;case 4:St=o.stateNode.containerInfo,Sn=!0;break e}o=o.return}if(St===null)throw Error(L(160));K_(r,a,i),St=null,Sn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){We(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Y_(e,n),e=e.sibling}function Y_(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(an(e,n),In(n),s&4){try{Tu(3,n,n.return),cm(3,n)}catch(b){We(n,n.return,b)}try{Tu(5,n,n.return)}catch(b){We(n,n.return,b)}}break;case 1:an(e,n),In(n),s&512&&t!==null&&fl(t,t.return);break;case 5:if(an(e,n),In(n),s&512&&t!==null&&fl(t,t.return),n.flags&32){var i=n.stateNode;try{Fu(i,"")}catch(b){We(n,n.return,b)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,a=t!==null?t.memoizedProps:r,o=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&vw(i,r),Tg(o,a);var u=Tg(o,r);for(a=0;a<c.length;a+=2){var h=c[a],f=c[a+1];h==="style"?Sw(i,f):h==="dangerouslySetInnerHTML"?ww(i,f):h==="children"?Fu(i,f):Wy(i,h,f,u)}switch(o){case"input":Ag(i,r);break;case"textarea":xw(i,r);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var m=r.value;m!=null?yl(i,!!r.multiple,m,!1):p!==!!r.multiple&&(r.defaultValue!=null?yl(i,!!r.multiple,r.defaultValue,!0):yl(i,!!r.multiple,r.multiple?[]:"",!1))}i[Gu]=r}catch(b){We(n,n.return,b)}}break;case 6:if(an(e,n),In(n),s&4){if(n.stateNode===null)throw Error(L(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(b){We(n,n.return,b)}}break;case 3:if(an(e,n),In(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{zu(e.containerInfo)}catch(b){We(n,n.return,b)}break;case 4:an(e,n),In(n);break;case 13:an(e,n),In(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(Av=Xe())),s&4&&nb(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Ft=(u=Ft)||h,an(e,n),Ft=u):an(e,n),In(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(B=n,h=n.child;h!==null;){for(f=B=h;B!==null;){switch(p=B,m=p.child,p.tag){case 0:case 11:case 14:case 15:Tu(4,p,p.return);break;case 1:fl(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){s=p,t=p.return;try{e=s,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(b){We(s,t,b)}}break;case 5:fl(p,p.return);break;case 22:if(p.memoizedState!==null){rb(f);continue}}m!==null?(m.return=p,B=m):rb(f)}h=h.sibling}e:for(h=null,f=n;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=_w("display",a))}catch(b){We(n,n.return,b)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(b){We(n,n.return,b)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:an(e,n),In(n),s&4&&nb(n);break;case 21:break;default:an(e,n),In(n)}}function In(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(X_(t)){var s=t;break e}t=t.return}throw Error(L(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(Fu(i,""),s.flags&=-33);var r=sb(n);r0(n,r,i);break;case 3:case 4:var a=s.stateNode.containerInfo,o=sb(n);i0(n,o,a);break;default:throw Error(L(161))}}catch(c){We(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Qk(n,e,t){B=n,Q_(n)}function Q_(n,e,t){for(var s=(n.mode&1)!==0;B!==null;){var i=B,r=i.child;if(i.tag===22&&s){var a=i.memoizedState!==null||tf;if(!a){var o=i.alternate,c=o!==null&&o.memoizedState!==null||Ft;o=tf;var u=Ft;if(tf=a,(Ft=c)&&!u)for(B=i;B!==null;)a=B,c=a.child,a.tag===22&&a.memoizedState!==null?ab(i):c!==null?(c.return=a,B=c):ab(i);for(;r!==null;)B=r,Q_(r),r=r.sibling;B=i,tf=o,Ft=u}ib(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,B=r):ib(n)}}function ib(n){for(;B!==null;){var e=B;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ft||cm(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Ft)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:cn(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&zx(e,r,s);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}zx(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&zu(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}Ft||e.flags&512&&n0(e)}catch(p){We(e,e.return,p)}}if(e===n){B=null;break}if(t=e.sibling,t!==null){t.return=e.return,B=t;break}B=e.return}}function rb(n){for(;B!==null;){var e=B;if(e===n){B=null;break}var t=e.sibling;if(t!==null){t.return=e.return,B=t;break}B=e.return}}function ab(n){for(;B!==null;){var e=B;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{cm(4,e)}catch(c){We(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){We(e,i,c)}}var r=e.return;try{n0(e)}catch(c){We(e,r,c)}break;case 5:var a=e.return;try{n0(e)}catch(c){We(e,a,c)}}}catch(c){We(e,e.return,c)}if(e===n){B=null;break}var o=e.sibling;if(o!==null){o.return=e.return,B=o;break}B=e.return}}var Jk=Math.ceil,bp=Ji.ReactCurrentDispatcher,_v=Ji.ReactCurrentOwner,Zs=Ji.ReactCurrentBatchConfig,fe=0,yt=null,Qe=null,Et=0,js=0,pl=sa(0),lt=0,Zu=null,Ro=0,um=0,Sv=0,ju=null,ls=null,Av=0,Dc=1/0,ui=null,wp=!1,a0=null,qr=null,sf=!1,Br=null,_p=0,Pu=0,o0=null,_f=-1,Sf=0;function Kt(){return fe&6?Xe():_f!==-1?_f:_f=Xe()}function Gr(n){return n.mode&1?fe&2&&Et!==0?Et&-Et:Mk.transition!==null?(Sf===0&&(Sf=Mw()),Sf):(n=be,n!==0||(n=window.event,n=n===void 0?16:zw(n.type)),n):1}function Cn(n,e,t,s){if(50<Pu)throw Pu=0,o0=null,Error(L(185));jh(n,t,s),(!(fe&2)||n!==yt)&&(n===yt&&(!(fe&2)&&(um|=t),lt===4&&ar(n,Et)),fs(n,s),t===1&&fe===0&&!(e.mode&1)&&(Dc=Xe()+500,am&&na()))}function fs(n,e){var t=n.callbackNode;ME(n,e);var s=rp(n,n===yt?Et:0);if(s===0)t!==null&&mx(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&mx(t),e===1)n.tag===0?Lk(ob.bind(null,n)):o_(ob.bind(null,n)),jk(function(){!(fe&6)&&na()}),t=null;else{switch(Dw(s)){case 1:t=Yy;break;case 4:t=Iw;break;case 16:t=ip;break;case 536870912:t=Lw;break;default:t=ip}t=r1(t,J_.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function J_(n,e){if(_f=-1,Sf=0,fe&6)throw Error(L(327));var t=n.callbackNode;if(_l()&&n.callbackNode!==t)return null;var s=rp(n,n===yt?Et:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=Sp(n,s);else{e=s;var i=fe;fe|=2;var r=e1();(yt!==n||Et!==e)&&(ui=null,Dc=Xe()+500,ko(n,e));do try{tN();break}catch(o){Z_(n,o)}while(!0);cv(),bp.current=r,fe=i,Qe!==null?e=0:(yt=null,Et=0,e=lt)}if(e!==0){if(e===2&&(i=Lg(n),i!==0&&(s=i,e=l0(n,i))),e===1)throw t=Zu,ko(n,0),ar(n,s),fs(n,Xe()),t;if(e===6)ar(n,s);else{if(i=n.current.alternate,!(s&30)&&!Zk(i)&&(e=Sp(n,s),e===2&&(r=Lg(n),r!==0&&(s=r,e=l0(n,r))),e===1))throw t=Zu,ko(n,0),ar(n,s),fs(n,Xe()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(L(345));case 2:ca(n,ls,ui);break;case 3:if(ar(n,s),(s&130023424)===s&&(e=Av+500-Xe(),10<e)){if(rp(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){Kt(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=zg(ca.bind(null,n,ls,ui),e);break}ca(n,ls,ui);break;case 4:if(ar(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var a=31-Nn(s);r=1<<a,a=e[a],a>i&&(i=a),s&=~r}if(s=i,s=Xe()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Jk(s/1960))-s,10<s){n.timeoutHandle=zg(ca.bind(null,n,ls,ui),s);break}ca(n,ls,ui);break;case 5:ca(n,ls,ui);break;default:throw Error(L(329))}}}return fs(n,Xe()),n.callbackNode===t?J_.bind(null,n):null}function l0(n,e){var t=ju;return n.current.memoizedState.isDehydrated&&(ko(n,e).flags|=256),n=Sp(n,e),n!==2&&(e=ls,ls=t,e!==null&&c0(e)),n}function c0(n){ls===null?ls=n:ls.push.apply(ls,n)}function Zk(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!Tn(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ar(n,e){for(e&=~Sv,e&=~um,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Nn(e),s=1<<t;n[t]=-1,e&=~s}}function ob(n){if(fe&6)throw Error(L(327));_l();var e=rp(n,0);if(!(e&1))return fs(n,Xe()),null;var t=Sp(n,e);if(n.tag!==0&&t===2){var s=Lg(n);s!==0&&(e=s,t=l0(n,s))}if(t===1)throw t=Zu,ko(n,0),ar(n,e),fs(n,Xe()),t;if(t===6)throw Error(L(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ca(n,ls,ui),fs(n,Xe()),null}function Ev(n,e){var t=fe;fe|=1;try{return n(e)}finally{fe=t,fe===0&&(Dc=Xe()+500,am&&na())}}function Io(n){Br!==null&&Br.tag===0&&!(fe&6)&&_l();var e=fe;fe|=1;var t=Zs.transition,s=be;try{if(Zs.transition=null,be=1,n)return n()}finally{be=s,Zs.transition=t,fe=e,!(fe&6)&&na()}}function kv(){js=pl.current,je(pl)}function ko(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Tk(t)),Qe!==null)for(t=Qe.return;t!==null;){var s=t;switch(av(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&up();break;case 3:Lc(),je(ds),je(Bt),mv();break;case 5:pv(s);break;case 4:Lc();break;case 13:je(Be);break;case 19:je(Be);break;case 10:uv(s.type._context);break;case 22:case 23:kv()}t=t.return}if(yt=n,Qe=n=Xr(n.current,null),Et=js=e,lt=0,Zu=null,Sv=um=Ro=0,ls=ju=null,va!==null){for(e=0;e<va.length;e++)if(t=va[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var a=r.next;r.next=i,s.next=a}t.pending=s}va=null}return n}function Z_(n,e){do{var t=Qe;try{if(cv(),xf.current=xp,vp){for(var s=ze.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}vp=!1}if(Po=0,gt=ot=ze=null,Cu=!1,Yu=0,_v.current=null,t===null||t.return===null){lt=1,Zu=e,Qe=null;break}e:{var r=n,a=t.return,o=t,c=e;if(e=Et,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=o,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=Xx(a);if(m!==null){m.flags&=-257,Kx(m,a,o,r,e),m.mode&1&&Gx(r,u,e),e=m,c=u;var g=e.updateQueue;if(g===null){var b=new Set;b.add(c),e.updateQueue=b}else g.add(c);break e}else{if(!(e&1)){Gx(r,u,e),Nv();break e}c=Error(L(426))}}else if(Me&&o.mode&1){var E=Xx(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),Kx(E,a,o,r,e),ov(Mc(c,o));break e}}r=c=Mc(c,o),lt!==4&&(lt=2),ju===null?ju=[r]:ju.push(r),r=a;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var x=D_(r,c,e);Ux(r,x);break e;case 1:o=c;var v=r.type,S=r.stateNode;if(!(r.flags&128)&&(typeof v.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(qr===null||!qr.has(S)))){r.flags|=65536,e&=-e,r.lanes|=e;var A=O_(r,o,e);Ux(r,A);break e}}r=r.return}while(r!==null)}s1(t)}catch(C){e=C,Qe===t&&t!==null&&(Qe=t=t.return);continue}break}while(!0)}function e1(){var n=bp.current;return bp.current=xp,n===null?xp:n}function Nv(){(lt===0||lt===3||lt===2)&&(lt=4),yt===null||!(Ro&268435455)&&!(um&268435455)||ar(yt,Et)}function Sp(n,e){var t=fe;fe|=2;var s=e1();(yt!==n||Et!==e)&&(ui=null,ko(n,e));do try{eN();break}catch(i){Z_(n,i)}while(!0);if(cv(),fe=t,bp.current=s,Qe!==null)throw Error(L(261));return yt=null,Et=0,lt}function eN(){for(;Qe!==null;)t1(Qe)}function tN(){for(;Qe!==null&&!kE();)t1(Qe)}function t1(n){var e=i1(n.alternate,n,js);n.memoizedProps=n.pendingProps,e===null?s1(n):Qe=e,_v.current=null}function s1(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Xk(t,e),t!==null){t.flags&=32767,Qe=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{lt=6,Qe=null;return}}else if(t=Gk(t,e,js),t!==null){Qe=t;return}if(e=e.sibling,e!==null){Qe=e;return}Qe=e=n}while(e!==null);lt===0&&(lt=5)}function ca(n,e,t){var s=be,i=Zs.transition;try{Zs.transition=null,be=1,sN(n,e,t,s)}finally{Zs.transition=i,be=s}return null}function sN(n,e,t,s){do _l();while(Br!==null);if(fe&6)throw Error(L(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(L(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(DE(n,r),n===yt&&(Qe=yt=null,Et=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||sf||(sf=!0,r1(ip,function(){return _l(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Zs.transition,Zs.transition=null;var a=be;be=1;var o=fe;fe|=4,_v.current=null,Yk(n,t),Y_(t,n),_k(Bg),ap=!!$g,Bg=$g=null,n.current=t,Qk(t),NE(),fe=o,be=a,Zs.transition=r}else n.current=t;if(sf&&(sf=!1,Br=n,_p=i),r=n.pendingLanes,r===0&&(qr=null),jE(t.stateNode),fs(n,Xe()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(wp)throw wp=!1,n=a0,a0=null,n;return _p&1&&n.tag!==0&&_l(),r=n.pendingLanes,r&1?n===o0?Pu++:(Pu=0,o0=n):Pu=0,na(),null}function _l(){if(Br!==null){var n=Dw(_p),e=Zs.transition,t=be;try{if(Zs.transition=null,be=16>n?16:n,Br===null)var s=!1;else{if(n=Br,Br=null,_p=0,fe&6)throw Error(L(331));var i=fe;for(fe|=4,B=n.current;B!==null;){var r=B,a=r.child;if(B.flags&16){var o=r.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(B=u;B!==null;){var h=B;switch(h.tag){case 0:case 11:case 15:Tu(8,h,r)}var f=h.child;if(f!==null)f.return=h,B=f;else for(;B!==null;){h=B;var p=h.sibling,m=h.return;if(G_(h),h===u){B=null;break}if(p!==null){p.return=m,B=p;break}B=m}}}var g=r.alternate;if(g!==null){var b=g.child;if(b!==null){g.child=null;do{var E=b.sibling;b.sibling=null,b=E}while(b!==null)}}B=r}}if(r.subtreeFlags&2064&&a!==null)a.return=r,B=a;else e:for(;B!==null;){if(r=B,r.flags&2048)switch(r.tag){case 0:case 11:case 15:Tu(9,r,r.return)}var x=r.sibling;if(x!==null){x.return=r.return,B=x;break e}B=r.return}}var v=n.current;for(B=v;B!==null;){a=B;var S=a.child;if(a.subtreeFlags&2064&&S!==null)S.return=a,B=S;else e:for(a=v;B!==null;){if(o=B,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:cm(9,o)}}catch(C){We(o,o.return,C)}if(o===a){B=null;break e}var A=o.sibling;if(A!==null){A.return=o.return,B=A;break e}B=o.return}}if(fe=i,na(),ni&&typeof ni.onPostCommitFiberRoot=="function")try{ni.onPostCommitFiberRoot(tm,n)}catch{}s=!0}return s}finally{be=t,Zs.transition=e}}return!1}function lb(n,e,t){e=Mc(t,e),e=D_(n,e,1),n=Wr(n,e,1),e=Kt(),n!==null&&(jh(n,1,e),fs(n,e))}function We(n,e,t){if(n.tag===3)lb(n,n,t);else for(;e!==null;){if(e.tag===3){lb(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(qr===null||!qr.has(s))){n=Mc(t,n),n=O_(e,n,1),e=Wr(e,n,1),n=Kt(),e!==null&&(jh(e,1,n),fs(e,n));break}}e=e.return}}function nN(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=Kt(),n.pingedLanes|=n.suspendedLanes&t,yt===n&&(Et&t)===t&&(lt===4||lt===3&&(Et&130023424)===Et&&500>Xe()-Av?ko(n,0):Sv|=t),fs(n,e)}function n1(n,e){e===0&&(n.mode&1?(e=qh,qh<<=1,!(qh&130023424)&&(qh=4194304)):e=1);var t=Kt();n=Xi(n,e),n!==null&&(jh(n,e,t),fs(n,t))}function iN(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),n1(n,t)}function rN(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(L(314))}s!==null&&s.delete(e),n1(n,t)}var i1;i1=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||ds.current)us=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return us=!1,qk(n,e,t);us=!!(n.flags&131072)}else us=!1,Me&&e.flags&1048576&&l_(e,fp,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;wf(n,e),n=e.pendingProps;var i=Pc(e,Bt.current);wl(e,t),i=yv(null,e,s,n,i,t);var r=vv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hs(s)?(r=!0,dp(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,hv(e),i.updater=lm,e.stateNode=i,i._reactInternals=e,Kg(e,s,n,t),e=Jg(null,e,s,!0,r,t)):(e.tag=0,Me&&r&&rv(e),Xt(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(wf(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=oN(s),n=cn(s,n),i){case 0:e=Qg(null,e,s,n,t);break e;case 1:e=Jx(null,e,s,n,t);break e;case 11:e=Yx(null,e,s,n,t);break e;case 14:e=Qx(null,e,s,cn(s.type,n),t);break e}throw Error(L(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:cn(s,i),Qg(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:cn(s,i),Jx(n,e,s,i,t);case 3:e:{if(U_(e),n===null)throw Error(L(387));s=e.pendingProps,r=e.memoizedState,i=r.element,p_(n,e),gp(e,s,null,t);var a=e.memoizedState;if(s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=Mc(Error(L(423)),e),e=Zx(n,e,s,t,i);break e}else if(s!==i){i=Mc(Error(L(424)),e),e=Zx(n,e,s,t,i);break e}else for(Ls=Vr(e.stateNode.containerInfo.firstChild),Ms=e,Me=!0,En=null,t=h_(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Rc(),s===i){e=Ki(n,e,t);break e}Xt(n,e,s,t)}e=e.child}return e;case 5:return m_(e),n===null&&qg(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,a=i.children,Ug(s,i)?a=null:r!==null&&Ug(s,r)&&(e.flags|=32),B_(n,e),Xt(n,e,a,t),e.child;case 6:return n===null&&qg(e),null;case 13:return z_(n,e,t);case 4:return fv(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=Ic(e,null,s,t):Xt(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:cn(s,i),Yx(n,e,s,i,t);case 7:return Xt(n,e,e.pendingProps,t),e.child;case 8:return Xt(n,e,e.pendingProps.children,t),e.child;case 12:return Xt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,a=i.value,Ne(pp,s._currentValue),s._currentValue=a,r!==null)if(Tn(r.value,a)){if(r.children===i.children&&!ds.current){e=Ki(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var o=r.dependencies;if(o!==null){a=r.child;for(var c=o.firstContext;c!==null;){if(c.context===s){if(r.tag===1){c=Hi(-1,t&-t),c.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),Gg(r.return,t,e),o.lanes|=t;break}c=c.next}}else if(r.tag===10)a=r.type===e.type?null:r.child;else if(r.tag===18){if(a=r.return,a===null)throw Error(L(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),Gg(a,t,e),a=r.sibling}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===e){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}Xt(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,wl(e,t),i=sn(i),s=s(i),e.flags|=1,Xt(n,e,s,t),e.child;case 14:return s=e.type,i=cn(s,e.pendingProps),i=cn(s.type,i),Qx(n,e,s,i,t);case 15:return F_(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:cn(s,i),wf(n,e),e.tag=1,hs(s)?(n=!0,dp(e)):n=!1,wl(e,t),M_(e,s,i),Kg(e,s,i,t),Jg(null,e,s,!0,n,t);case 19:return H_(n,e,t);case 22:return $_(n,e,t)}throw Error(L(156,e.tag))};function r1(n,e){return Rw(n,e)}function aN(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Js(n,e,t,s){return new aN(n,e,t,s)}function Cv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function oN(n){if(typeof n=="function")return Cv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Gy)return 11;if(n===Xy)return 14}return 2}function Xr(n,e){var t=n.alternate;return t===null?(t=Js(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Af(n,e,t,s,i,r){var a=2;if(s=n,typeof n=="function")Cv(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case il:return No(t.children,i,r,e);case qy:a=8,i|=8;break;case xg:return n=Js(12,t,e,i|2),n.elementType=xg,n.lanes=r,n;case bg:return n=Js(13,t,e,i),n.elementType=bg,n.lanes=r,n;case wg:return n=Js(19,t,e,i),n.elementType=wg,n.lanes=r,n;case mw:return dm(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case fw:a=10;break e;case pw:a=9;break e;case Gy:a=11;break e;case Xy:a=14;break e;case nr:a=16,s=null;break e}throw Error(L(130,n==null?n:typeof n,""))}return e=Js(a,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function No(n,e,t,s){return n=Js(7,n,s,e),n.lanes=t,n}function dm(n,e,t,s){return n=Js(22,n,s,e),n.elementType=mw,n.lanes=t,n.stateNode={isHidden:!1},n}function eg(n,e,t){return n=Js(6,n,null,e),n.lanes=t,n}function tg(n,e,t){return e=Js(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function lN(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mm(0),this.expirationTimes=Mm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mm(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Tv(n,e,t,s,i,r,a,o,c){return n=new lN(n,e,t,o,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Js(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},hv(r),n}function cN(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nl,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function a1(n){if(!n)return Qr;n=n._reactInternals;e:{if($o(n)!==n||n.tag!==1)throw Error(L(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(hs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(n.tag===1){var t=n.type;if(hs(t))return a_(n,t,e)}return e}function o1(n,e,t,s,i,r,a,o,c){return n=Tv(t,s,!0,n,i,r,a,o,c),n.context=a1(null),t=n.current,s=Kt(),i=Gr(t),r=Hi(s,i),r.callback=e??null,Wr(t,r,i),n.current.lanes=i,jh(n,i,s),fs(n,s),n}function hm(n,e,t,s){var i=e.current,r=Kt(),a=Gr(i);return t=a1(t),e.context===null?e.context=t:e.pendingContext=t,e=Hi(r,a),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=Wr(i,e,a),n!==null&&(Cn(n,i,a,r),vf(n,i,a)),a}function Ap(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function cb(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function jv(n,e){cb(n,e),(n=n.alternate)&&cb(n,e)}function uN(){return null}var l1=typeof reportError=="function"?reportError:function(n){console.error(n)};function Pv(n){this._internalRoot=n}fm.prototype.render=Pv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(L(409));hm(n,e,null,null)};fm.prototype.unmount=Pv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Io(function(){hm(null,n,null,null)}),e[Gi]=null}};function fm(n){this._internalRoot=n}fm.prototype.unstable_scheduleHydration=function(n){if(n){var e=$w();n={blockedOn:null,target:n,priority:e};for(var t=0;t<rr.length&&e!==0&&e<rr[t].priority;t++);rr.splice(t,0,n),t===0&&Uw(n)}};function Rv(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function pm(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ub(){}function dN(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=Ap(a);r.call(u)}}var a=o1(e,s,n,0,null,!1,!1,"",ub);return n._reactRootContainer=a,n[Gi]=a.current,Wu(n.nodeType===8?n.parentNode:n),Io(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var o=s;s=function(){var u=Ap(c);o.call(u)}}var c=Tv(n,0,!1,null,null,!1,!1,"",ub);return n._reactRootContainer=c,n[Gi]=c.current,Wu(n.nodeType===8?n.parentNode:n),Io(function(){hm(e,c,t,s)}),c}function mm(n,e,t,s,i){var r=t._reactRootContainer;if(r){var a=r;if(typeof i=="function"){var o=i;i=function(){var c=Ap(a);o.call(c)}}hm(e,a,n,i)}else a=dN(t,e,n,i,s);return Ap(a)}Ow=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=iu(e.pendingLanes);t!==0&&(Qy(e,t|1),fs(e,Xe()),!(fe&6)&&(Dc=Xe()+500,na()))}break;case 13:Io(function(){var s=Xi(n,1);if(s!==null){var i=Kt();Cn(s,n,1,i)}}),jv(n,1)}};Jy=function(n){if(n.tag===13){var e=Xi(n,134217728);if(e!==null){var t=Kt();Cn(e,n,134217728,t)}jv(n,134217728)}};Fw=function(n){if(n.tag===13){var e=Gr(n),t=Xi(n,e);if(t!==null){var s=Kt();Cn(t,n,e,s)}jv(n,e)}};$w=function(){return be};Bw=function(n,e){var t=be;try{return be=n,e()}finally{be=t}};Pg=function(n,e,t){switch(e){case"input":if(Ag(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=rm(s);if(!i)throw Error(L(90));yw(s),Ag(s,i)}}}break;case"textarea":xw(n,t);break;case"select":e=t.value,e!=null&&yl(n,!!t.multiple,e,!1)}};kw=Ev;Nw=Io;var hN={usingClientEntryPoint:!1,Events:[Rh,ll,rm,Aw,Ew,Ev]},Yc={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fN={bundleType:Yc.bundleType,version:Yc.version,rendererPackageName:Yc.rendererPackageName,rendererConfig:Yc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ji.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=jw(n),n===null?null:n.stateNode},findFiberByHostInstance:Yc.findFiberByHostInstance||uN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nf.isDisabled&&nf.supportsFiber)try{tm=nf.inject(fN),ni=nf}catch{}}Fs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hN;Fs.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rv(e))throw Error(L(200));return cN(n,e,null,t)};Fs.createRoot=function(n,e){if(!Rv(n))throw Error(L(299));var t=!1,s="",i=l1;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Tv(n,1,!1,null,null,t,!1,s,i),n[Gi]=e.current,Wu(n.nodeType===8?n.parentNode:n),new Pv(e)};Fs.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(L(188)):(n=Object.keys(n).join(","),Error(L(268,n)));return n=jw(e),n=n===null?null:n.stateNode,n};Fs.flushSync=function(n){return Io(n)};Fs.hydrate=function(n,e,t){if(!pm(e))throw Error(L(200));return mm(null,n,e,!0,t)};Fs.hydrateRoot=function(n,e,t){if(!Rv(n))throw Error(L(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",a=l1;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=o1(e,null,n,1,t??null,i,!1,r,a),n[Gi]=e.current,Wu(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new fm(e)};Fs.render=function(n,e,t){if(!pm(e))throw Error(L(200));return mm(null,n,e,!1,t)};Fs.unmountComponentAtNode=function(n){if(!pm(n))throw Error(L(40));return n._reactRootContainer?(Io(function(){mm(null,null,n,!1,function(){n._reactRootContainer=null,n[Gi]=null})}),!0):!1};Fs.unstable_batchedUpdates=Ev;Fs.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!pm(t))throw Error(L(200));if(n==null||n._reactInternals===void 0)throw Error(L(38));return mm(n,e,t,!1,s)};Fs.version="18.3.1-next-f1338f8080-20240426";function c1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c1)}catch(n){console.error(n)}}c1(),cw.exports=Fs;var pN=cw.exports,u1,db=pN;u1=db.createRoot,db.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var mN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),De=(n,e)=>{const t=Q.forwardRef(({color:s="currentColor",size:i=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:o="",children:c,...u},h)=>Q.createElement("svg",{ref:h,...mN,width:i,height:i,stroke:s,strokeWidth:a?Number(r)*24/Number(i):r,className:["lucide",`lucide-${gN(n)}`,o].join(" "),...u},[...e.map(([f,p])=>Q.createElement(f,p)),...Array.isArray(c)?c:[c]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=De("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=De("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=De("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=De("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=De("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=De("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d1=De("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=De("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h1=De("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=De("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=De("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f1=De("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=De("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=De("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=De("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=De("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p1=De("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=De("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=De("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=De("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=De("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=De("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=De("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=De("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),NN="modulepreload",CN=function(n){return"/"+n},pb={},Lh=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(t.map(c=>{if(c=CN(c),c in pb)return;pb[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":NN,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return e().catch(r)})},TN=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Lh(async()=>{const{default:s}=await Promise.resolve().then(()=>Uc);return{default:s}},[]).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Lv extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class jN extends Lv{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class mb extends Lv{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class gb extends Lv{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var h0;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(h0||(h0={}));var PN=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{u(s.next(h))}catch(f){a(f)}}function c(h){try{u(s.throw(h))}catch(f){a(f)}}function u(h){h.done?r(h.value):i(h.value).then(o,c)}u((s=s.apply(n,e||[])).next())})};class RN{constructor(e,{headers:t={},customFetch:s,region:i=h0.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=TN(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return PN(this,void 0,void 0,function*(){try{const{headers:i,method:r,body:a}=t;let o={},{region:c}=t;c||(c=this.region);const u=new URL(`${this.url}/${e}`);c&&c!=="any"&&(o["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let h;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",h=a):typeof a=="string"?(o["Content-Type"]="text/plain",h=a):typeof FormData<"u"&&a instanceof FormData?h=a:(o["Content-Type"]="application/json",h=JSON.stringify(a)));const f=yield this.fetch(u.toString(),{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:h}).catch(b=>{throw new jN(b)}),p=f.headers.get("x-relay-error");if(p&&p==="true")throw new mb(f);if(!f.ok)throw new gb(f);let m=((s=f.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),g;return m==="application/json"?g=yield f.json():m==="application/octet-stream"?g=yield f.blob():m==="text/event-stream"?g=f:m==="multipart/form-data"?g=yield f.formData():g=yield f.text(),{data:g,error:null,response:f}}catch(i){return{data:null,error:i,response:i instanceof gb||i instanceof mb?i.context:void 0}}})}}var cs={},Mv={},gm={},Mh={},ym={},vm={},IN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Oc=IN();const LN=Oc.fetch,m1=Oc.fetch.bind(Oc),g1=Oc.Headers,MN=Oc.Request,DN=Oc.Response,Uc=Object.freeze(Object.defineProperty({__proto__:null,Headers:g1,Request:MN,Response:DN,default:m1,fetch:LN},Symbol.toStringTag,{value:"Module"})),ON=zA(Uc);var xm={};Object.defineProperty(xm,"__esModule",{value:!0});let FN=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};xm.default=FN;var y1=tn&&tn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(vm,"__esModule",{value:!0});const $N=y1(ON),BN=y1(xm);let UN=class{constructor(e){var t,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(s=e.isMaybeSingle)!==null&&s!==void 0?s:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=$N.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let i=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async r=>{var a,o,c,u;let h=null,f=null,p=null,m=r.status,g=r.statusText;if(r.ok){if(this.method!=="HEAD"){const v=await r.text();v===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?f=v:f=JSON.parse(v))}const E=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),x=(c=r.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");E&&x&&x.length>1&&(p=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(h={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,p=null,m=406,g="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const E=await r.text();try{h=JSON.parse(E),Array.isArray(h)&&r.status===404&&(f=[],h=null,m=200,g="OK")}catch{r.status===404&&E===""?(m=204,g="No Content"):h={message:E}}if(h&&this.isMaybeSingle&&(!((u=h==null?void 0:h.details)===null||u===void 0)&&u.includes("0 rows"))&&(h=null,m=200,g="OK"),h&&this.shouldThrowOnError)throw new BN.default(h)}return{error:h,data:f,count:p,status:m,statusText:g}});return this.shouldThrowOnError||(i=i.catch(r=>{var a,o,c;return{error:{message:`${(a=r==null?void 0:r.name)!==null&&a!==void 0?a:"FetchError"}: ${r==null?void 0:r.message}`,details:`${(o=r==null?void 0:r.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=r==null?void 0:r.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};vm.default=UN;var zN=tn&&tn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ym,"__esModule",{value:!0});const HN=zN(vm);let VN=class extends HN.default{select(e){let t=!1;const s=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:i,referencedTable:r=i}={}){const a=r?`${r}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:i=s}={}){const r=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:i=!1,wal:r=!1,format:a="text"}={}){var o;const c=[e?"analyze":null,t?"verbose":null,s?"settings":null,i?"buffers":null,r?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${u}"; options=${c};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};ym.default=VN;var WN=tn&&tn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Mh,"__esModule",{value:!0});const qN=WN(ym);let GN=class extends qN.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:i}={}){let r="";i==="plain"?r="pl":i==="phrase"?r="ph":i==="websearch"&&(r="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${r}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const i=s?`${s}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Mh.default=GN;var XN=tn&&tn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(gm,"__esModule",{value:!0});const Qc=XN(Mh);let KN=class{constructor(e,{headers:t={},schema:s,fetch:i}){this.url=e,this.headers=new Headers(t),this.schema=s,this.fetch=i}select(e,{head:t=!1,count:s}={}){const i=t?"HEAD":"GET";let r=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!r?"":(o==='"'&&(r=!r),o)).join("");return this.url.searchParams.set("select",a),s&&this.headers.append("Prefer",`count=${s}`),new Qc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:s=!0}={}){var i;const r="POST";if(t&&this.headers.append("Prefer",`count=${t}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(a.length>0){const o=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Qc.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:i,defaultToNull:r=!0}={}){var a;const o="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),i&&this.headers.append("Prefer",`count=${i}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new Qc.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var s;const i="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Qc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:e}={}){var t;const s="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Qc.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};gm.default=KN;var v1=tn&&tn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Mv,"__esModule",{value:!0});const YN=v1(gm),QN=v1(Mh);let JN=class x1{constructor(e,{headers:t={},schema:s,fetch:i}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new YN.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new x1(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:i=!1,count:r}={}){var a;let o;const c=new URL(`${this.url}/rpc/${e}`);let u;s||i?(o=s?"HEAD":"GET",Object.entries(t).filter(([f,p])=>p!==void 0).map(([f,p])=>[f,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([f,p])=>{c.searchParams.append(f,p)})):(o="POST",u=t);const h=new Headers(this.headers);return r&&h.set("Prefer",`count=${r}`),new QN.default({method:o,url:c,headers:h,schema:this.schemaName,body:u,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};Mv.default=JN;var zc=tn&&tn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cs,"__esModule",{value:!0});cs.PostgrestError=cs.PostgrestBuilder=cs.PostgrestTransformBuilder=cs.PostgrestFilterBuilder=cs.PostgrestQueryBuilder=cs.PostgrestClient=void 0;const b1=zc(Mv);cs.PostgrestClient=b1.default;const w1=zc(gm);cs.PostgrestQueryBuilder=w1.default;const _1=zc(Mh);cs.PostgrestFilterBuilder=_1.default;const S1=zc(ym);cs.PostgrestTransformBuilder=S1.default;const A1=zc(vm);cs.PostgrestBuilder=A1.default;const E1=zc(xm);cs.PostgrestError=E1.default;var ZN=cs.default={PostgrestClient:b1.default,PostgrestQueryBuilder:w1.default,PostgrestFilterBuilder:_1.default,PostgrestTransformBuilder:S1.default,PostgrestBuilder:A1.default,PostgrestError:E1.default};const{PostgrestClient:eC,PostgrestQueryBuilder:pP,PostgrestFilterBuilder:mP,PostgrestTransformBuilder:gP,PostgrestBuilder:yP,PostgrestError:vP}=ZN;class tC{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const sC="2.15.1",nC=`realtime-js/${sC}`,iC="1.0.0",f0=1e4,rC=1e3,aC=100;var Ru;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Ru||(Ru={}));var st;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(st||(st={}));var An;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(An||(An={}));var p0;(function(n){n.websocket="websocket"})(p0||(p0={}));var pa;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(pa||(pa={}));class oC{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const i=t.getUint8(1),r=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+i));a=a+i;const c=s.decode(e.slice(a,a+r));a=a+r;const u=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:c,payload:u}}}class k1{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ee;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ee||(Ee={}));const yb=(n,e,t={})=>{var s;const i=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((r,a)=>(r[a]=lC(a,n,e,i),r),{})},lC=(n,e,t,s)=>{const i=e.find(o=>o.name===n),r=i==null?void 0:i.type,a=t[n];return r&&!s.includes(r)?N1(r,a):m0(a)},N1=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return hC(e,t)}switch(n){case Ee.bool:return cC(e);case Ee.float4:case Ee.float8:case Ee.int2:case Ee.int4:case Ee.int8:case Ee.numeric:case Ee.oid:return uC(e);case Ee.json:case Ee.jsonb:return dC(e);case Ee.timestamp:return fC(e);case Ee.abstime:case Ee.date:case Ee.daterange:case Ee.int4range:case Ee.int8range:case Ee.money:case Ee.reltime:case Ee.text:case Ee.time:case Ee.timestamptz:case Ee.timetz:case Ee.tsrange:case Ee.tstzrange:return m0(e);default:return m0(e)}},m0=n=>n,cC=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},uC=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},dC=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},hC=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let r;const a=n.slice(1,t);try{r=JSON.parse("["+a+"]")}catch{r=a?a.split(","):[]}return r.map(o=>N1(e,o))}return n},fC=n=>typeof n=="string"?n.replace(" ","T"):n,C1=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class ig{constructor(e,t,s={},i=f0){this.channel=e,this.event=t,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var vb;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(vb||(vb={}));class Iu{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:r,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Iu.syncState(this.state,i,r,a),this.pendingDiffs.forEach(c=>{this.state=Iu.syncDiff(this.state,c,r,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},i=>{const{onJoin:r,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Iu.syncDiff(this.state,i,r,a),o())}),this.onJoin((i,r,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:r,newPresences:a})}),this.onLeave((i,r,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:r,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,i){const r=this.cloneDeep(e),a=this.transformState(t),o={},c={};return this.map(r,(u,h)=>{a[u]||(c[u]=h)}),this.map(a,(u,h)=>{const f=r[u];if(f){const p=h.map(E=>E.presence_ref),m=f.map(E=>E.presence_ref),g=h.filter(E=>m.indexOf(E.presence_ref)<0),b=f.filter(E=>p.indexOf(E.presence_ref)<0);g.length>0&&(o[u]=g),b.length>0&&(c[u]=b)}else o[u]=h}),this.syncDiff(r,{joins:o,leaves:c},s,i)}static syncDiff(e,t,s,i){const{joins:r,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(r,(o,c)=>{var u;const h=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(c),h.length>0){const f=e[o].map(m=>m.presence_ref),p=h.filter(m=>f.indexOf(m.presence_ref)<0);e[o].unshift(...p)}s(o,h,c)}),this.map(a,(o,c)=>{let u=e[o];if(!u)return;const h=c.map(f=>f.presence_ref);u=u.filter(f=>h.indexOf(f.presence_ref)<0),e[o]=u,i(o,u,c),u.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const i=e[s];return"metas"in i?t[s]=i.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):t[s]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var xb;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(xb||(xb={}));var Lu;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Lu||(Lu={}));var di;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(di||(di={}));class Dv{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=st.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ig(this,An.join,this.params,this.timeout),this.rejoinTimer=new k1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=st.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=st.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this._on(An.reply,{},(i,r)=>{this._trigger(this._replyEventName(r),i)}),this.presence=new Iu(this),this.broadcastEndpointURL=C1(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==st.closed){const{config:{broadcast:r,presence:a,private:o}}=this.params,c=(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[Lu.PRESENCE]&&this.bindings[Lu.PRESENCE].length>0,h={},f={broadcast:r,presence:Object.assign(Object.assign({},a),{enabled:u}),postgres_changes:c,private:o};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(di.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(di.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:p})=>{var m;if(this.socket.setAuth(),p===void 0){e==null||e(di.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,b=(m=g==null?void 0:g.length)!==null&&m!==void 0?m:0,E=[];for(let x=0;x<b;x++){const v=g[x],{filter:{event:S,schema:A,table:C,filter:N}}=v,k=p&&p[x];if(k&&k.event===S&&k.schema===A&&k.table===C&&k.filter===N)E.push(Object.assign(Object.assign({},v),{id:k.id}));else{this.unsubscribe(),this.state=st.errored,e==null||e(di.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e(di.SUBSCRIBED);return}}).receive("error",p=>{this.state=st.errored,e==null||e(di.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(di.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===st.joined&&e===Lu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,i;if(!this._canPush()&&e.type==="broadcast"){const{event:r,payload:a}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var a,o,c;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&r("ok"),u.receive("ok",()=>r("ok")),u.receive("error",()=>r("error")),u.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=st.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(An.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(i=>{s=new ig(this,An.leave,{},e),s.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=st.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const i=new AbortController,r=setTimeout(()=>i.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(r),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ig(this,e,t,s);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>aC){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var i,r;const a=e.toLocaleLowerCase(),{close:o,error:c,leave:u,join:h}=An;if(s&&[o,c,u,h].indexOf(a)>=0&&s!==this._joinRef())return;let p=this._onMessage(a,t,s);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(m=>{var g,b,E;return((g=m.filter)===null||g===void 0?void 0:g.event)==="*"||((E=(b=m.filter)===null||b===void 0?void 0:b.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===a}).map(m=>m.callback(p,s)):(r=this.bindings[a])===null||r===void 0||r.filter(m=>{var g,b,E,x,v,S;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const A=m.id,C=(g=m.filter)===null||g===void 0?void 0:g.event;return A&&((b=t.ids)===null||b===void 0?void 0:b.includes(A))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((E=t.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const A=(v=(x=m==null?void 0:m.filter)===null||x===void 0?void 0:x.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return A==="*"||A===((S=t==null?void 0:t.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof p=="object"&&"ids"in p){const g=p.data,{schema:b,table:E,commit_timestamp:x,type:v,errors:S}=g;p=Object.assign(Object.assign({},{schema:b,table:E,commit_timestamp:x,eventType:v,new:{},old:{},errors:S}),this._getPayloadRecords(g))}m.callback(p,s)})}_isClosed(){return this.state===st.closed}_isJoined(){return this.state===st.joined}_isJoining(){return this.state===st.joining}_isLeaving(){return this.state===st.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const i=e.toLocaleLowerCase(),r={type:i,filter:t,callback:s};return this.bindings[i]?this.bindings[i].push(r):this.bindings[i]=[r],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(i=>{var r;return!(((r=i.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===s&&Dv.isEqual(i.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(An.close,{},e)}_onError(e){this._on(An.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=st.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=yb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=yb(e.columns,e.old_record)),t}}const bb=()=>{},rf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},pC=[1e3,2e3,5e3,1e4],mC=1e4,gC=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class yC{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=f0,this.transport=null,this.heartbeatIntervalMs=rf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=bb,this.ref=0,this.reconnectTimer=null,this.logger=bb,this.conn=null,this.sendBuffer=[],this.serializer=new oC,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let r;return i?r=i:typeof fetch>"u"?r=(...a)=>Lh(async()=>{const{default:o}=await Promise.resolve().then(()=>Uc);return{default:o}},void 0).then(({default:o})=>o(...a)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):r=fetch,(...a)=>r(...a)},!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${p0.websocket}`,this.httpEndpoint=C1(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=tC.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:iC}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ru.connecting:return pa.Connecting;case Ru.open:return pa.Open;case Ru.closing:return pa.Closing;default:return pa.Closed}}isConnected(){return this.connectionState()===pa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,i=this.getChannels().find(r=>r.topic===s);if(i)return i;{const r=new Dv(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:s,payload:i,ref:r}=e,a=()=>{this.encode(e,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${t} ${s} (${r})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(rC,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},rf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:i,payload:r,ref:a}=t,o=a?`(${a})`:"",c=r.status||"";this.log("receive",`${c} ${s} ${i} ${o}`.trim(),r),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(i,r,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(An.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${s}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([gC],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const i={access_token:t,version:nC};t&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(An.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new k1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},rf.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,i,r,a,o,c,u;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:f0,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:rf.HEARTBEAT_INTERVAL,this.worker=(r=e==null?void 0:e.worker)!==null&&r!==void 0?r:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(o=e==null?void 0:e.reconnectAfterMs)!==null&&o!==void 0?o:h=>pC[h-1]||mC,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(h,f)=>f(JSON.stringify(h)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Ov extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function at(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class vC extends Ov{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class g0 extends Ov{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var xC=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{u(s.next(h))}catch(f){a(f)}}function c(h){try{u(s.throw(h))}catch(f){a(f)}}function u(h){h.done?r(h.value):i(h.value).then(o,c)}u((s=s.apply(n,e||[])).next())})};const T1=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Lh(async()=>{const{default:s}=await Promise.resolve().then(()=>Uc);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},bC=()=>xC(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Lh(()=>Promise.resolve().then(()=>Uc),void 0)).Response:Response}),y0=n=>{if(Array.isArray(n))return n.map(t=>y0(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,s])=>{const i=t.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));e[i]=y0(s)}),e},wC=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Bo=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{u(s.next(h))}catch(f){a(f)}}function c(h){try{u(s.throw(h))}catch(f){a(f)}}function u(h){h.done?r(h.value):i(h.value).then(o,c)}u((s=s.apply(n,e||[])).next())})};const rg=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),_C=(n,e,t)=>Bo(void 0,void 0,void 0,function*(){const s=yield bC();n instanceof s&&!(t!=null&&t.noResolveJson)?n.json().then(i=>{const r=n.status||500,a=(i==null?void 0:i.statusCode)||r+"";e(new vC(rg(i),r,a))}).catch(i=>{e(new g0(rg(i),i))}):e(new g0(rg(n),n))}),SC=(n,e,t,s)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!s?i:(wC(s)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(s)):i.body=s,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),t))};function Dh(n,e,t,s,i,r){return Bo(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,SC(e,s,i,r)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>_C(c,o,s))})})}function Ep(n,e,t,s){return Bo(this,void 0,void 0,function*(){return Dh(n,"GET",e,t,s)})}function Fn(n,e,t,s,i){return Bo(this,void 0,void 0,function*(){return Dh(n,"POST",e,s,i,t)})}function v0(n,e,t,s,i){return Bo(this,void 0,void 0,function*(){return Dh(n,"PUT",e,s,i,t)})}function AC(n,e,t,s){return Bo(this,void 0,void 0,function*(){return Dh(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function j1(n,e,t,s,i){return Bo(this,void 0,void 0,function*(){return Dh(n,"DELETE",e,s,i,t)})}var zt=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{u(s.next(h))}catch(f){a(f)}}function c(h){try{u(s.throw(h))}catch(f){a(f)}}function u(h){h.done?r(h.value):i(h.value).then(o,c)}u((s=s.apply(n,e||[])).next())})};const EC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},wb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class kC{constructor(e,t={},s,i){this.url=e,this.headers=t,this.bucketId=s,this.fetch=T1(i)}uploadOrUpdate(e,t,s,i){return zt(this,void 0,void 0,function*(){try{let r;const a=Object.assign(Object.assign({},wb),i);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&s instanceof Blob?(r=new FormData,r.append("cacheControl",a.cacheControl),c&&r.append("metadata",this.encodeMetadata(c)),r.append("",s)):typeof FormData<"u"&&s instanceof FormData?(r=s,r.append("cacheControl",a.cacheControl),c&&r.append("metadata",this.encodeMetadata(c))):(r=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const u=this._removeEmptyFolders(t),h=this._getFinalPath(u),f=yield(e=="PUT"?v0:Fn)(this.fetch,`${this.url}/object/${h}`,r,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(r){if(at(r))return{data:null,error:r};throw r}})}upload(e,t,s){return zt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,i){return zt(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(e),a=this._getFinalPath(r),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let c;const u=Object.assign({upsert:wb.upsert},i),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType);const f=yield v0(this.fetch,o.toString(),c,{headers:h});return{data:{path:r,fullPath:f.Key},error:null}}catch(c){if(at(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return zt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const r=yield Fn(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),a=new URL(this.url+r.url),o=a.searchParams.get("token");if(!o)throw new Ov("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}update(e,t,s){return zt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return zt(this,void 0,void 0,function*(){try{return{data:yield Fn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}copy(e,t,s){return zt(this,void 0,void 0,function*(){try{return{data:{path:(yield Fn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,s){return zt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),r=yield Fn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${a}`)},{data:r,error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,s){return zt(this,void 0,void 0,function*(){try{const i=yield Fn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),r=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${r}`):null})),error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}download(e,t){return zt(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=r?`?${r}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Ep(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(at(o))return{data:null,error:o};throw o}})}info(e){return zt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Ep(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:y0(s),error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}exists(e){return zt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield AC(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(at(s)&&s instanceof g0){const i=s.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),i=[],r=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";r!==""&&i.push(r);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&i.push(c);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${u}`)}}}remove(e){return zt(this,void 0,void 0,function*(){try{return{data:yield j1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(at(t))return{data:null,error:t};throw t}})}list(e,t,s){return zt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},EC),t),{prefix:e||""});return{data:yield Fn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}listV2(e,t){return zt(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield Fn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const NC="2.11.0",CC={"X-Client-Info":`storage-js/${NC}`};var Ho=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{u(s.next(h))}catch(f){a(f)}}function c(h){try{u(s.throw(h))}catch(f){a(f)}}function u(h){h.done?r(h.value):i(h.value).then(o,c)}u((s=s.apply(n,e||[])).next())})};class TC{constructor(e,t={},s,i){const r=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href,this.headers=Object.assign(Object.assign({},CC),t),this.fetch=T1(s)}listBuckets(){return Ho(this,void 0,void 0,function*(){try{return{data:yield Ep(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(at(e))return{data:null,error:e};throw e}})}getBucket(e){return Ho(this,void 0,void 0,function*(){try{return{data:yield Ep(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(at(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ho(this,void 0,void 0,function*(){try{return{data:yield Fn(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Ho(this,void 0,void 0,function*(){try{return{data:yield v0(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ho(this,void 0,void 0,function*(){try{return{data:yield Fn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(at(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ho(this,void 0,void 0,function*(){try{return{data:yield j1(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(at(t))return{data:null,error:t};throw t}})}}class jC extends TC{constructor(e,t={},s,i){super(e,t,s,i)}from(e){return new kC(this.url,this.headers,e,this.fetch)}}const PC="2.56.0";let au="";typeof Deno<"u"?au="deno":typeof document<"u"?au="web":typeof navigator<"u"&&navigator.product==="ReactNative"?au="react-native":au="node";const RC={"X-Client-Info":`supabase-js-${au}/${PC}`},IC={headers:RC},LC={schema:"public"},MC={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DC={};var OC=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{u(s.next(h))}catch(f){a(f)}}function c(h){try{u(s.throw(h))}catch(f){a(f)}}function u(h){h.done?r(h.value):i(h.value).then(o,c)}u((s=s.apply(n,e||[])).next())})};const FC=n=>{let e;return n?e=n:typeof fetch>"u"?e=m1:e=fetch,(...t)=>e(...t)},$C=()=>typeof Headers>"u"?g1:Headers,BC=(n,e,t)=>{const s=FC(t),i=$C();return(r,a)=>OC(void 0,void 0,void 0,function*(){var o;const c=(o=yield e())!==null&&o!==void 0?o:n;let u=new i(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(r,Object.assign(Object.assign({},a),{headers:u}))})};var UC=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{u(s.next(h))}catch(f){a(f)}}function c(h){try{u(s.throw(h))}catch(f){a(f)}}function u(h){h.done?r(h.value):i(h.value).then(o,c)}u((s=s.apply(n,e||[])).next())})};function zC(n){return n.endsWith("/")?n:n+"/"}function HC(n,e){var t,s;const{db:i,auth:r,realtime:a,global:o}=n,{db:c,auth:u,realtime:h,global:f}=e,p={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},u),r),realtime:Object.assign(Object.assign({},h),a),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(t=f==null?void 0:f.headers)!==null&&t!==void 0?t:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>UC(this,void 0,void 0,function*(){return""})};return n.accessToken?p.accessToken=n.accessToken:delete p.accessToken,p}const P1="2.71.1",Xo=30*1e3,x0=3,ag=x0*Xo,VC="http://localhost:9999",WC="supabase.auth.token",qC={"X-Client-Info":`gotrue-js/${P1}`},b0="X-Supabase-Api-Version",R1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},GC=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,XC=10*60*1e3;class Fv extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function ee(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class KC extends Fv{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function YC(n){return ee(n)&&n.name==="AuthApiError"}class I1 extends Fv{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ia extends Fv{constructor(e,t,s,i){super(e,s,i),this.name=t,this.status=s}}class tr extends ia{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function QC(n){return ee(n)&&n.name==="AuthSessionMissingError"}class af extends ia{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class of extends ia{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class lf extends ia{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function JC(n){return ee(n)&&n.name==="AuthImplicitGrantRedirectError"}class _b extends ia{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class w0 extends ia{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function og(n){return ee(n)&&n.name==="AuthRetryableFetchError"}class Sb extends ia{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class _0 extends ia{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const kp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ab=` 	
\r=`.split(""),ZC=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Ab.length;e+=1)n[Ab[e].charCodeAt(0)]=-2;for(let e=0;e<kp.length;e+=1)n[kp[e].charCodeAt(0)]=e;return n})();function Eb(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(kp[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(kp[s]),e.queuedBits-=6}}function L1(n,e,t){const s=ZC[n];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function kb(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},r=a=>{sT(a,s,t)};for(let a=0;a<n.length;a+=1)L1(n.charCodeAt(a),i,r);return e.join("")}function eT(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function tT(n,e){for(let t=0;t<n.length;t+=1){let s=n.charCodeAt(t);if(s>55295&&s<=56319){const i=(s-55296)*1024&65535;s=(n.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}eT(s,e)}}function sT(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let s=1;s<6;s+=1)if(!(n>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function nT(n){const e=[],t={queue:0,queuedBits:0},s=i=>{e.push(i)};for(let i=0;i<n.length;i+=1)L1(n.charCodeAt(i),t,s);return new Uint8Array(e)}function iT(n){const e=[];return tT(n,t=>e.push(t)),new Uint8Array(e)}function rT(n){const e=[],t={queue:0,queuedBits:0},s=i=>{e.push(i)};return n.forEach(i=>Eb(i,t,s)),Eb(null,t,s),e.join("")}function aT(n){return Math.round(Date.now()/1e3)+n}function oT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const on=()=>typeof window<"u"&&typeof document<"u",aa={tested:!1,writable:!1},M1=()=>{if(!on())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(aa.tested)return aa.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),aa.tested=!0,aa.writable=!0}catch{aa.tested=!0,aa.writable=!1}return aa.writable};function lT(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,r)=>{e[r]=i})}catch{}return t.searchParams.forEach((s,i)=>{e[i]=s}),e}const D1=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Lh(async()=>{const{default:s}=await Promise.resolve().then(()=>Uc);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},cT=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Ko=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},oa=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},er=async(n,e)=>{await n.removeItem(e)};class bm{constructor(){this.promise=new bm.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}bm.promiseConstructor=Promise;function lg(n){const e=n.split(".");if(e.length!==3)throw new _0("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!GC.test(e[s]))throw new _0("JWT not in base64url format");return{header:JSON.parse(kb(e[0])),payload:JSON.parse(kb(e[1])),signature:nT(e[2]),raw:{header:e[0],payload:e[1]}}}async function uT(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function dT(n,e){return new Promise((s,i)=>{(async()=>{for(let r=0;r<1/0;r++)try{const a=await n(r);if(!e(r,null,a)){s(a);return}}catch(a){if(!e(r,a)){i(a);return}}})()})}function hT(n){return("0"+n.toString(16)).substr(-2)}function fT(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let i="";for(let r=0;r<56;r++)i+=t.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(e),Array.from(e,hT).join("")}async function pT(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(s);return Array.from(i).map(r=>String.fromCharCode(r)).join("")}async function mT(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await pT(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Vo(n,e,t=!1){const s=fT();let i=s;t&&(i+="/PASSWORD_RECOVERY"),await Ko(n,`${e}-code-verifier`,i);const r=await mT(s);return[r,s===r?"plain":"s256"]}const gT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function yT(n){const e=n.headers.get(b0);if(!e||!e.match(gT))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function vT(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function xT(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const bT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Wo(n){if(!bT.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function cg(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Nb(n){return JSON.parse(JSON.stringify(n))}var wT=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};const ua=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),_T=[502,503,504];async function Cb(n){var e;if(!cT(n))throw new w0(ua(n),0);if(_T.includes(n.status))throw new w0(ua(n),n.status);let t;try{t=await n.json()}catch(r){throw new I1(ua(r),r)}let s;const i=yT(n);if(i&&i.getTime()>=R1["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new Sb(ua(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new tr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0))throw new Sb(ua(t),n.status,t.weak_password.reasons);throw new KC(ua(t),n.status||500,s)}const ST=(n,e,t,s)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),t))};async function le(n,e,t,s){var i;const r=Object.assign({},s==null?void 0:s.headers);r[b0]||(r[b0]=R1["2024-01-01"].name),s!=null&&s.jwt&&(r.Authorization=`Bearer ${s.jwt}`);const a=(i=s==null?void 0:s.query)!==null&&i!==void 0?i:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await AT(n,e,t+o,{headers:r,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function AT(n,e,t,s,i,r){const a=ST(e,s,i,r);let o;try{o=await n(t,Object.assign({},a))}catch(c){throw console.error(c),new w0(ua(c),0)}if(o.ok||await Cb(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(c){await Cb(c)}}function ai(n){var e;let t=null;CT(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=aT(n.expires_in)));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function Tb(n){const e=ai(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=n.weak_password),e}function or(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function ET(n){return{data:n,error:null}}function kT(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:r}=n,a=wT(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:r},c=Object.assign({},a);return{data:{properties:o,user:c},error:null}}function NT(n){return n}function CT(n){return n.access_token&&n.refresh_token&&n.expires_in}const ug=["global","local","others"];var TT=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};class jT{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=D1(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=ug[0]){if(ug.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ug.join(", ")}`);try{return await le(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ee(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await le(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:or})}catch(s){if(ee(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=TT(e,["options"]),i=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(i.new_email=s==null?void 0:s.newEmail,delete i.newEmail),await le(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:kT,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ee(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await le(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:or})}catch(t){if(ee(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,i,r,a,o,c;try{const u={nextPage:null,lastPage:0,total:0},h=await le(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(r=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&r!==void 0?r:""},xform:NT});if(h.error)throw h.error;const f=await h.json(),p=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(c=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(g=>{const b=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(g.split(";")[1].split("=")[1]);u[`${E}Page`]=b}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(ee(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Wo(e);try{return await le(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:or})}catch(t){if(ee(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Wo(e);try{return await le(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:or})}catch(s){if(ee(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Wo(e);try{return await le(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:or})}catch(s){if(ee(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Wo(e.userId);try{const{data:t,error:s}=await le(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:s}}catch(t){if(ee(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Wo(e.userId),Wo(e.id);try{return{data:await le(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ee(t))return{data:null,error:t};throw t}}}function jb(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function PT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const qo={debug:!!(globalThis&&M1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class O1 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class RT extends O1{}async function IT(n,e,t){qo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),qo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){qo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,i.name);try{return await t()}finally{qo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,i.name)}}else{if(e===0)throw qo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new RT(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(qo.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}PT();const LT={url:VC,storageKey:WC,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:qC,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Pb(n,e,t){return await t()}const Go={};class ed{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ed.nextInstanceID,ed.nextInstanceID+=1,this.instanceID>0&&on()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},LT),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new jT({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=D1(i.fetch),this.lock=i.lock||Pb,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:on()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=IT:this.lock=Pb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:M1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=jb(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=jb(this.memoryStorage)),on()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Go[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Go[this.storageKey]=Object.assign(Object.assign({},Go[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Go[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Go[this.storageKey]=Object.assign(Object.assign({},Go[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${P1}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=lT(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),on()&&this.detectSessionInUrl&&s!=="none"){const{data:i,error:r}=await this._getSessionFromURL(t,s);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),JC(r)){const c=(e=r.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:r}}return await this._removeSession(),{error:r}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ee(t)?{error:t}:{error:new I1("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,i;try{const r=await le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:ai}),{data:a,error:o}=r;if(o||!a)return{data:{user:null,session:null},error:o};const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(r){if(ee(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var t,s,i;try{let r;if("email"in e){const{email:h,password:f,options:p}=e;let m=null,g=null;this.flowType==="pkce"&&([m,g]=await Vo(this.storage,this.storageKey)),r=await le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:h,password:f,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:m,code_challenge_method:g},xform:ai})}else if("phone"in e){const{phone:h,password:f,options:p}=e;r=await le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:f,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:ai})}else throw new of("You must provide either an email or phone number and a password");const{data:a,error:o}=r;if(o||!a)return{data:{user:null,session:null},error:o};const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(r){if(ee(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:a,options:o}=e;t=await le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Tb})}else if("phone"in e){const{phone:r,password:a,options:o}=e;t=await le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Tb})}else throw new of("You must provide either an email or phone number and a password");const{data:s,error:i}=t;return i?{data:{user:null,session:null},error:i}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new af}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(t){if(ee(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,i,r;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(r=e.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,i,r,a,o,c,u,h,f,p,m;let g,b;if("message"in e)g=e.message,b=e.signature;else{const{chain:E,wallet:x,statement:v,options:S}=e;let A;if(on())if(typeof x=="object")A=x;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))A=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(S!=null&&S.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=x}const C=new URL((t=S==null?void 0:S.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in A&&A.signIn){const N=await A.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S==null?void 0:S.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),v?{statement:v}:null));let k;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")k=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)k=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)g=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),b=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in A)||typeof A.signMessage!="function"||!("publicKey"in A)||typeof A!="object"||!A.publicKey||!("toBase58"in A.publicKey)||typeof A.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${C.host} wants you to sign in with your Solana account:`,A.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(i=(s=S==null?void 0:S.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((r=S==null?void 0:S.signInWithSolana)===null||r===void 0)&&r.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((a=S==null?void 0:S.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((o=S==null?void 0:S.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((c=S==null?void 0:S.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((u=S==null?void 0:S.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((f=(h=S==null?void 0:S.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||f===void 0)&&f.length?["Resources",...S.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const N=await A.signMessage(new TextEncoder().encode(g),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=N}}try{const{data:E,error:x}=await le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:rT(b)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:ai});if(x)throw x;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new af}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:x})}catch(E){if(ee(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(e){const t=await oa(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(t??"").split("/");try{const{data:r,error:a}=await le(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ai});if(await er(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!r||!r.session||!r.user?{data:{user:null,session:null,redirectType:null},error:new af}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign(Object.assign({},r),{redirectType:i??null}),error:a})}catch(r){if(ee(r))return{data:{user:null,session:null,redirectType:null},error:r};throw r}}async signInWithIdToken(e){try{const{options:t,provider:s,token:i,access_token:r,nonce:a}=e,o=await le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:r,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ai}),{data:c,error:u}=o;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new af}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(t){if(ee(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,i,r,a;try{if("email"in e){const{email:o,options:c}=e;let u=null,h=null;this.flowType==="pkce"&&([u,h]=await Vo(this.storage,this.storageKey));const{error:f}=await le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:h},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:o,options:c}=e,{data:u,error:h}=await le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:h}}throw new of("You must provide either an email or phone number.")}catch(o){if(ee(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let i,r;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,r=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await le(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:i,xform:ai});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,u=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(ee(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,s,i;try{let r=null,a=null;return this.flowType==="pkce"&&([r,a]=await Vo(this.storage,this.storageKey)),await le(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:a}),headers:this.headers,xform:ET})}catch(r){if(ee(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new tr;const{error:i}=await le(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(ee(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:i,options:r}=e,{error:a}=await le(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},redirectTo:r==null?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:i,options:r}=e,{data:a,error:o}=await le(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new of("You must provide either an email or phone number and a type")}catch(t){if(ee(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await oa(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<ag:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const a=await oa(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=cg()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,h)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,h))})}return{data:{session:e},error:null}}const{session:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:or}):await this._useSession(async t=>{var s,i,r;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new tr}:await le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0,xform:or})})}catch(t){if(ee(t))return QC(t)&&(await this._removeSession(),await er(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:i,error:r}=s;if(r)throw r;if(!i.session)throw new tr;const a=i.session;let o=null,c=null;this.flowType==="pkce"&&e.email!=null&&([o,c]=await Vo(this.storage,this.storageKey));const{data:u,error:h}=await le(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:c}),jwt:a.access_token,xform:or});if(h)throw h;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(ee(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new tr;const t=Date.now()/1e3;let s=t,i=!0,r=null;const{payload:a}=lg(e.access_token);if(a.exp&&(s=a.exp,i=s<=t),i){const{session:o,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};r=o}else{const{data:o,error:c}=await this._getUser(e.access_token);if(c)throw c;r={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(t){if(ee(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new tr;const{session:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ee(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!on())throw new lf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new lf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new _b("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new lf("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new _b("No code detected.");const{data:v,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:r,refresh_token:a,expires_in:o,expires_at:c,token_type:u}=e;if(!r||!o||!a||!u)throw new lf("No session defined in URL");const h=Math.round(Date.now()/1e3),f=parseInt(o);let p=h+f;c&&(p=parseInt(c));const m=p-h;m*1e3<=Xo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const g=p-f;h-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,p,h):h-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,p,h);const{data:b,error:E}=await this._getUser(r);if(E)throw E;const x={provider_token:s,provider_refresh_token:i,access_token:r,expires_in:f,expires_at:p,refresh_token:a,token_type:u,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(s){if(ee(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await oa(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:i,error:r}=t;if(r)return{error:r};const a=(s=i.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(YC(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await er(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=oT(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,i;try{const{data:{session:r},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(r){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e,t={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await Vo(this.storage,this.storageKey,!0));try{return await le(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(ee(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ee(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:i}=await this._useSession(async r=>{var a,o,c,u,h;const{data:f,error:p}=r;if(p)throw p;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await le(this.fetch,"GET",m,{headers:this.headers,jwt:(h=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&h!==void 0?h:void 0})});if(i)throw i;return on()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(ee(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,i;const{data:r,error:a}=t;if(a)throw a;return await le(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(ee(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await dT(async i=>(i>0&&await uT(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await le(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ai})),(i,r)=>{const a=200*Math.pow(2,i);return r&&og(r)&&Date.now()+a-s<Xo})}catch(s){if(this._debug(t,"error",s),ee(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),on()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const i=await oa(this.storage,this.storageKey);if(i&&this.userStorage){let a=await oa(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Ko(this.userStorage,this.storageKey+"-user",a)),i.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:cg()}else if(i&&!i.user&&!i.user){const a=await oa(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await er(this.storage,this.storageKey+"-user"),await Ko(this.storage,this.storageKey,i)):i.user=cg()}if(this._debug(s,"session from storage",i),!this._isValidSession(i)){this._debug(s,"session is not valid"),i!==null&&await this._removeSession();return}const r=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<ag;if(this._debug(s,`session has${r?"":" not"} expired with margin of ${ag}s`),r){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),og(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(s,"error",i),console.error(i);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new tr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new bm;const{data:r,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!r.session)throw new tr;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const o={session:r.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(r){if(this._debug(i,"error",r),ee(r)){const a={session:null,error:r};return og(r)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(r),r}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,s=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(c){r.push(c)}});if(await Promise.all(a),r.length>0){for(let o=0;o<r.length;o+=1)console.error(r[o]);throw r[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await Ko(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const r=Nb(i);await Ko(this.storage,this.storageKey,r)}else{const i=Nb(t);await Ko(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await er(this.storage,this.storageKey),await er(this.storage,this.storageKey+"-code-verifier"),await er(this.storage,this.storageKey+"-user"),this.userStorage&&await er(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&on()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-e)/Xo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Xo}ms, refresh threshold is ${x0} ticks`),i<=x0&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof O1)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!on()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const i=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[r,a]=await Vo(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(s!=null&&s.queryParams){const r=new URLSearchParams(s.queryParams);i.push(r.toString())}return s!=null&&s.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:i,error:r}=t;return r?{data:null,error:r}:await le(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(ee(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,i;const{data:r,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await le(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(ee(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:r}=t;if(r)return{data:null,error:r};const{data:a,error:o}=await le(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(ee(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:r}=t;return r?{data:null,error:r}:await le(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(ee(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],i=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),r=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:i,phone:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:i},error:r}=e;if(r)return{data:null,error:r};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=lg(i.access_token);let o=null;a.aal&&(o=a.aal);let c=o;((s=(t=i.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const h=a.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(o=>o.kid===e);if(s)return s;const i=Date.now();if(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+XC>i)return s;const{data:r,error:a}=await le(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!r.keys||r.keys.length===0||(this.jwks=r,this.jwks_cached_at=i,s=r.keys.find(o=>o.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:m,error:g}=await this.getSession();if(g||!m.session)return{data:null,error:g};s=m.session.access_token}const{header:i,payload:r,signature:a,raw:{header:o,payload:c}}=lg(s);t!=null&&t.allowExpired||vT(r.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!u){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:r,header:i,signature:a},error:null}}const h=xT(i.alg),f=await crypto.subtle.importKey("jwk",u,h,!0,["verify"]);if(!await crypto.subtle.verify(h,f,a,iT(`${o}.${c}`)))throw new _0("Invalid JWT signature");return{data:{claims:r,header:i,signature:a},error:null}}catch(s){if(ee(s))return{data:null,error:s};throw s}}}ed.nextInstanceID=0;const MT=ed;class DT extends MT{constructor(e){super(e)}}var OT=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{u(s.next(h))}catch(f){a(f)}}function c(h){try{u(s.throw(h))}catch(f){a(f)}}function u(h){h.done?r(h.value):i(h.value).then(o,c)}u((s=s.apply(n,e||[])).next())})};class FT{constructor(e,t,s){var i,r,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=zC(e),c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,h={db:LC,realtime:DC,auth:Object.assign(Object.assign({},MC),{storageKey:u}),global:IC},f=HC(s??{},h);this.storageKey=(i=f.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(r=f.global.headers)!==null&&r!==void 0?r:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=BC(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new eC(new URL("rest/v1",c).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new jC(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new RN(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return OT(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:i,storageKey:r,flowType:a,lock:o,debug:c},u,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new DT({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:r,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:i,flowType:a,lock:o,debug:c,fetch:h,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new yC(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const $T=(n,e,t)=>new FT(n,e,t);function BT(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}BT()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const UT="https://lkwrmqpmgkwyvykjqvel.supabase.co",zT="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxrd3JtcXBtZ2t3eXZ5a2pxdmVsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxNTE2NTUsImV4cCI6MjA3MTcyNzY1NX0.Q7XUj3hTLz0XdfnhsrrhrG9EetC7a_5F98nufecKx4Q",Rn=$T(UT,zT),HT=async n=>{const{data:e,error:t}=await Rn.from("applications").insert([n]).select().single();if(t)throw t;return e},F1=async()=>{const{data:n,error:e}=await Rn.from("applications").select("*").order("created_at",{ascending:!1});if(e)throw e;return n},VT=async(n,e)=>{const{data:t,error:s}=await Rn.from("applications").update({...e,updated_at:new Date().toISOString()}).eq("id",n).select().single();if(s)throw s;return t},WT=async n=>{const{error:e}=await Rn.from("applications").delete().eq("id",n);if(e)throw e},$v=async()=>{const{data:n,error:e}=await Rn.from("lenders").select("*").order("name");if(e)throw e;return n},qT=async n=>{const{data:e,error:t}=await Rn.from("lenders").insert([n]).select().single();if(t)throw t;return e},GT=async(n,e)=>{const{data:t,error:s}=await Rn.from("lenders").update({...e,updated_at:new Date().toISOString()}).eq("id",n).select().single();if(s)throw s;return t},XT=async n=>{const{error:e}=await Rn.from("lenders").delete().eq("id",n);if(e)throw e},$1=async(n,e)=>{const t=e.map(r=>({application_id:n,lender_id:r,status:"pending"})),{data:s,error:i}=await Rn.from("lender_submissions").insert(t).select();if(i)throw i;return s},S0=async n=>{const{data:e,error:t}=await Rn.from("lender_submissions").select(`
      *,
      lender:lenders(*)
    `).eq("application_id",n);if(t)throw t;return e},KT=async(n,e)=>{const{data:t,error:s}=await Rn.from("lender_submissions").update({...e,updated_at:new Date().toISOString()}).eq("id",n).select().single();if(s)throw s;return t},YT=(n,e)=>n.map(t=>{let s=!0,i=100;return(e.requested_amount<t.min_amount||e.requested_amount>t.max_amount)&&(s=!1,i-=30),(e.credit_score<t.min_credit_score||e.credit_score>t.max_credit_score)&&(s=!1,i-=25),e.years_in_business<t.min_time_in_business&&(s=!1,i-=20),e.monthly_revenue<t.min_monthly_revenue&&(s=!1,i-=15),!t.industries.includes("All Industries")&&!t.industries.includes(e.industry)&&(i-=10),parseFloat(t.factor_rate.split(" - ")[0])<1.15&&(i+=5),(t.approval_time.includes("24 hours")||t.approval_time.includes("2 hours"))&&(i+=3),{...t,qualified:s,matchScore:Math.max(0,i)}});var Mu={};Mu.d=(n,e)=>{for(var t in e)Mu.o(e,t)&&!Mu.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};Mu.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Z=globalThis.pdfjsLib={};Mu.d(Z,{AbortException:()=>Jr,AnnotationEditorLayer:()=>Ry,AnnotationEditorParamsType:()=>he,AnnotationEditorType:()=>se,AnnotationEditorUIManager:()=>Mo,AnnotationLayer:()=>W2,AnnotationMode:()=>lr,ColorPicker:()=>Rp,DOMSVGFactory:()=>Xv,DrawLayer:()=>My,FeatureTest:()=>Yt,GlobalWorkerOptions:()=>Bi,ImageKind:()=>Ef,InvalidPDFException:()=>E0,MissingPDFException:()=>td,OPS:()=>un,OutputScale:()=>N0,PDFDataRangeTransport:()=>US,PDFDateString:()=>Vv,PDFWorker:()=>Al,PasswordResponses:()=>ej,PermissionFlag:()=>ZT,PixelsPerInch:()=>Zr,RenderingCancelledException:()=>zv,TextLayer:()=>sd,TouchManager:()=>jp,UnexpectedResponseException:()=>Np,Util:()=>W,VerbosityLevel:()=>wm,XfaLayer:()=>HS,build:()=>E2,createValidAbsoluteUrl:()=>ij,fetchData:()=>Em,getDocument:()=>g2,getFilenameFromUrl:()=>fj,getPdfFilenameFromUrl:()=>pj,getXfaPageViewport:()=>mj,isDataScheme:()=>km,isPdfFile:()=>Hv,noContextMenu:()=>jn,normalizeUnicode:()=>uj,setLayerDimensions:()=>Lo,shadow:()=>ae,stopEvent:()=>Is,version:()=>A2});const $t=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),B1=[1,0,0,1,0,0],A0=[.001,0,0,.001,0,0],QT=1e7,dg=1.35,Ts={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},lr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},JT="pdfjs_internal_editor_",se={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},he={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},ZT={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},jt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ef={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},tt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Jc={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},wm={ERRORS:0,WARNINGS:1,INFOS:5},un={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},ej={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let _m=wm.WARNINGS;function tj(n){Number.isInteger(n)&&(_m=n)}function sj(){return _m}function Sm(n){_m>=wm.INFOS&&console.log(`Info: ${n}`)}function ne(n){_m>=wm.WARNINGS&&console.log(`Warning: ${n}`)}function Se(n){throw new Error(n)}function Je(n,e){n||Se(e)}function nj(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ij(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=cj(n)}catch{}}const s=e?new URL(n,e):new URL(n);if(nj(s))return s}catch{}return null}function ae(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const ra=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class Rb extends ra{constructor(e,t){super(e,"PasswordException"),this.code=t}}class hg extends ra{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class E0 extends ra{constructor(e){super(e,"InvalidPDFException")}}class td extends ra{constructor(e){super(e,"MissingPDFException")}}class Np extends ra{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class rj extends ra{constructor(e){super(e,"FormatError")}}class Jr extends ra{constructor(e){super(e,"AbortException")}}function U1(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Se("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),a=n.subarray(i,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function Am(n){typeof n!="string"&&Se("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function aj(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Bv(n){const e=Object.create(null);for(const[t,s]of n)e[t]=s;return e}function oj(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function lj(){try{return new Function(""),!0}catch{return!1}}class Yt{static get isLittleEndian(){return ae(this,"isLittleEndian",oj())}static get isEvalSupported(){return ae(this,"isEvalSupported",lj())}static get isOffscreenCanvasSupported(){return ae(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ae(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?ae(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):ae(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return ae(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const fg=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Vi,kf,k0;class W{static makeHexColor(e,t,s){return`#${fg[e]}${fg[t]}${fg[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const s=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[s,i]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s;return[i,r]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],r[0],a[0]),Math.min(s[1],i[1],r[1],a[1]),Math.max(s[0],i[0],r[0],a[0]),Math.max(s[1],i[1],r[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(s+a)/2,c=Math.sqrt((s+a)**2-4*(s*a-r*i))/2,u=o+c||1,h=o-c||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,i,a]}static bezierBoundingBox(e,t,s,i,r,a,o,c,u){return u?(u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,c)):u=[Math.min(e,o),Math.min(t,c),Math.max(e,o),Math.max(t,c)],_(this,Vi,k0).call(this,e,s,r,o,t,i,a,c,3*(-e+3*(s-r)+o),6*(e-2*s+r),3*(s-e),u),_(this,Vi,k0).call(this,e,s,r,o,t,i,a,c,3*(-t+3*(i-a)+c),6*(t-2*i+a),3*(i-t),u),u}}Vi=new WeakSet,kf=function(e,t,s,i,r,a,o,c,u,h){if(u<=0||u>=1)return;const f=1-u,p=u*u,m=p*u,g=f*(f*(f*e+3*u*t)+3*p*s)+m*i,b=f*(f*(f*r+3*u*a)+3*p*o)+m*c;h[0]=Math.min(h[0],g),h[1]=Math.min(h[1],b),h[2]=Math.max(h[2],g),h[3]=Math.max(h[3],b)},k0=function(e,t,s,i,r,a,o,c,u,h,f,p){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&_(this,Vi,kf).call(this,e,t,s,i,r,a,o,c,-f/h,p);return}const m=h**2-4*f*u;if(m<0)return;const g=Math.sqrt(m),b=2*u;_(this,Vi,kf).call(this,e,t,s,i,r,a,o,c,(-h+g)/b,p),_(this,Vi,kf).call(this,e,t,s,i,r,a,o,c,(-h-g)/b,p)},w(W,Vi);function cj(n){return decodeURIComponent(escape(n))}let pg=null,Ib=null;function uj(n){return pg||(pg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ib=new Map([["","t"]])),n.replaceAll(pg,(e,t,s)=>t?t.normalize("NFKC"):Ib.get(s))}function dj(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),U1(n)}const Uv="pdfjs_internal_id_";function hj(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(U1(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const oi="http://www.w3.org/2000/svg",ma=class ma{};K(ma,"CSS",96),K(ma,"PDF",72),K(ma,"PDF_TO_CSS_UNITS",ma.CSS/ma.PDF);let Zr=ma;async function Em(n,e="text"){if(ou(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Oh{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=a,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,f,p,m;switch(i%=360,i<0&&(i+=360),i){case 180:h=-1,f=0,p=0,m=1;break;case 90:h=0,f=1,p=1,m=0;break;case 270:h=0,f=-1,p=-1,m=0;break;case 0:h=1,f=0,p=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,m=-m);let g,b,E,x;h===0?(g=Math.abs(u-e[1])*s+r,b=Math.abs(c-e[0])*s+a,E=(e[3]-e[1])*s,x=(e[2]-e[0])*s):(g=Math.abs(c-e[0])*s+r,b=Math.abs(u-e[1])*s+a,E=(e[2]-e[0])*s,x=(e[3]-e[1])*s),this.transform=[h*s,f*s,p*s,m*s,g-h*s*c-p*s*u,b-f*s*c-m*s*u],this.width=E,this.height=x}get rawDims(){const{userUnit:e,viewBox:t}=this,s=t.map(i=>i*e);return ae(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new Oh({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){return W.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=W.applyTransform([e[0],e[1]],this.transform),s=W.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return W.applyInverseTransform([e,t],this.transform)}}class zv extends ra{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function km(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function Hv(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function fj(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function pj(n,e="document.pdf"){if(typeof n!="string")return e;if(km(n))return ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class Lb{constructor(){K(this,"started",Object.create(null));K(this,"times",[])}time(e){e in this.started&&ne(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ne(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function ou(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function jn(n){n.preventDefault()}function Is(n){n.preventDefault(),n.stopPropagation()}var id;class Vv{static toDateObject(e){if(!e||typeof e!="string")return null;l(this,id)||y(this,id,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=l(this,id).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,u==="-"?(a+=h,o+=f):u==="+"&&(a-=h,o-=f),new Date(Date.UTC(s,i,r,a,o,c))}}id=new WeakMap,w(Vv,id);function mj(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new Oh({viewBox:r,userUnit:1,scale:e,rotation:t})}function Wv(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ne(`Not a valid color format: "${n}"`),[0,0,0])}function gj(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Wv(s))}e.remove()}function Ie(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform();return[e,t,s,i,r,a]}function Ln(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform().invertSelf();return[e,t,s,i,r,a]}function Lo(n,e,t=!1,s=!0){if(e instanceof Oh){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=n,o=Yt.isCSSRoundSupported,c=`var(--scale-factor) * ${i}px`,u=`var(--scale-factor) * ${r}px`,h=o?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,f=o?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=h,a.height=f):(a.width=f,a.height=h)}s&&n.setAttribute("data-main-rotation",e.rotation)}class N0{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var cr,wa,dn,_a,rd,ad,Mp,z1,Qt,H1,V1,Nf,W1,T0;const hi=class hi{constructor(e){w(this,Qt);w(this,cr,null);w(this,wa,null);w(this,dn);w(this,_a,null);w(this,rd,null);y(this,dn,e),l(hi,ad)||y(hi,ad,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=y(this,cr,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=l(this,dn)._uiManager._signal;e.addEventListener("contextmenu",jn,{signal:t}),e.addEventListener("pointerdown",_(hi,Mp,z1),{signal:t});const s=y(this,_a,document.createElement("div"));s.className="buttons",e.append(s);const i=l(this,dn).toolbarPosition;if(i){const{style:r}=e,a=l(this,dn)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return _(this,Qt,W1).call(this),e}get div(){return l(this,cr)}hide(){var e;l(this,cr).classList.add("hidden"),(e=l(this,wa))==null||e.hideDropdown()}show(){var e;l(this,cr).classList.remove("hidden"),(e=l(this,rd))==null||e.shown()}async addAltText(e){const t=await e.render();_(this,Qt,Nf).call(this,t),l(this,_a).prepend(t,l(this,Qt,T0)),y(this,rd,e)}addColorPicker(e){y(this,wa,e);const t=e.renderButton();_(this,Qt,Nf).call(this,t),l(this,_a).prepend(t,l(this,Qt,T0))}remove(){var e;l(this,cr).remove(),(e=l(this,wa))==null||e.destroy(),y(this,wa,null)}};cr=new WeakMap,wa=new WeakMap,dn=new WeakMap,_a=new WeakMap,rd=new WeakMap,ad=new WeakMap,Mp=new WeakSet,z1=function(e){e.stopPropagation()},Qt=new WeakSet,H1=function(e){l(this,dn)._focusEventsAllowed=!1,Is(e)},V1=function(e){l(this,dn)._focusEventsAllowed=!0,Is(e)},Nf=function(e){const t=l(this,dn)._uiManager._signal;e.addEventListener("focusin",_(this,Qt,H1).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",_(this,Qt,V1).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",jn,{signal:t})},W1=function(){const{editorType:e,_uiManager:t}=l(this,dn),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",l(hi,ad)[e]),_(this,Qt,Nf).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),l(this,_a).append(s)},T0=function(){const e=document.createElement("div");return e.className="divider",e},w(hi,Mp),w(hi,ad,null);let C0=hi;var od,Sa,Aa,ea,q1,G1,X1;class yj{constructor(e){w(this,ea);w(this,od,null);w(this,Sa,null);w(this,Aa);y(this,Aa,e)}show(e,t,s){const[i,r]=_(this,ea,G1).call(this,t,s),{style:a}=l(this,Sa)||y(this,Sa,_(this,ea,q1).call(this));e.append(l(this,Sa)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,Sa).remove()}}od=new WeakMap,Sa=new WeakMap,Aa=new WeakMap,ea=new WeakSet,q1=function(){const e=y(this,Sa,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",jn,{signal:l(this,Aa)._signal});const t=y(this,od,document.createElement("div"));return t.className="buttons",e.append(t),_(this,ea,X1).call(this),e},G1=function(e,t){let s=0,i=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const o=r.x+(t?r.width:0);if(a>s){i=o,s=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,s]},X1=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=l(this,Aa)._signal;e.addEventListener("contextmenu",jn,{signal:s}),e.addEventListener("click",()=>{l(this,Aa).highlightSelection("floating_button")},{signal:s}),l(this,od).append(e)};function Cp(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var Dp;class vj{constructor(){w(this,Dp,0)}get id(){return`${JT}${Ut(this,Dp)._++}`}}Dp=new WeakMap;var El,ld,It,kl,Cf;const Yv=class Yv{constructor(){w(this,kl);w(this,El,dj());w(this,ld,0);w(this,It,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return ae(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return _(this,kl,Cf).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return _(this,kl,Cf).call(this,e,e)}async getFromBlob(e,t){const s=await t;return _(this,kl,Cf).call(this,e,s)}async getFromId(e){l(this,It)||y(this,It,new Map);const t=l(this,It).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){l(this,It)||y(this,It,new Map);let s=l(this,It).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${l(this,El)}_${Ut(this,ld)._++}`,refCounter:1,isSvg:!1},l(this,It).set(e,s),l(this,It).set(s.id,s),s}getSvgUrl(e){const t=l(this,It).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;l(this,It)||y(this,It,new Map);const t=l(this,It).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${l(this,El)}_`)}};El=new WeakMap,ld=new WeakMap,It=new WeakMap,kl=new WeakSet,Cf=async function(e,t){l(this,It)||y(this,It,new Map);let s=l(this,It).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,El)}_${Ut(this,ld)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await Em(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=Yv._isSVGFittingCanvas,a=new FileReader,o=new Image,c=new Promise((u,h)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,u()},a.onload=async()=>{const f=s.svgUrl=a.result;o.src=await r?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=h});a.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){ne(i),s=null}return l(this,It).set(e,s),s&&l(this,It).set(s.id,s),s};let j0=Yv;var qe,ur,cd,Fe;class xj{constructor(e=128){w(this,qe,[]);w(this,ur,!1);w(this,cd);w(this,Fe,-1);y(this,cd,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),l(this,ur))return;const c={cmd:e,undo:t,post:s,type:r};if(l(this,Fe)===-1){l(this,qe).length>0&&(l(this,qe).length=0),y(this,Fe,0),l(this,qe).push(c);return}if(a&&l(this,qe)[l(this,Fe)].type===r){o&&(c.undo=l(this,qe)[l(this,Fe)].undo),l(this,qe)[l(this,Fe)]=c;return}const u=l(this,Fe)+1;u===l(this,cd)?l(this,qe).splice(0,1):(y(this,Fe,u),u<l(this,qe).length&&l(this,qe).splice(u)),l(this,qe).push(c)}undo(){if(l(this,Fe)===-1)return;y(this,ur,!0);const{undo:e,post:t}=l(this,qe)[l(this,Fe)];e(),t==null||t(),y(this,ur,!1),y(this,Fe,l(this,Fe)-1)}redo(){if(l(this,Fe)<l(this,qe).length-1){y(this,Fe,l(this,Fe)+1),y(this,ur,!0);const{cmd:e,post:t}=l(this,qe)[l(this,Fe)];e(),t==null||t(),y(this,ur,!1)}}hasSomethingToUndo(){return l(this,Fe)!==-1}hasSomethingToRedo(){return l(this,Fe)<l(this,qe).length-1}cleanType(e){if(l(this,Fe)!==-1){for(let t=l(this,Fe);t>=0;t--)if(l(this,qe)[t].type!==e){l(this,qe).splice(t+1,l(this,Fe)-t),y(this,Fe,t);return}l(this,qe).length=0,y(this,Fe,-1)}}destroy(){y(this,qe,null)}}qe=new WeakMap,ur=new WeakMap,cd=new WeakMap,Fe=new WeakMap;var Op,K1;class Fh{constructor(e){w(this,Op);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Yt.platform;for(const[s,i,r={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(_(this,Op,K1).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(i.bind(e,...a,t)(),r||Is(t))}}Op=new WeakSet,K1=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Fp=class Fp{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return gj(e),ae(this,"_colors",e)}convert(e){const t=Wv(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,a)=>r===t[a]))return Fp._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?W.makeHexColor(...t):e}};K(Fp,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let P0=Fp;var Nl,ys,it,vt,Cl,mi,Tl,Us,dr,Ea,jl,ka,$n,hn,Na,ud,dd,Pl,hd,Bn,hr,Rl,fr,Un,$p,pr,fd,mr,Ca,pd,md,ut,ve,gi,Ta,gd,yd,gr,zn,yi,vd,zs,D,Tf,R0,Y1,Q1,jf,J1,Z1,eS,I0,tS,L0,M0,sS,Ht,li,nS,iS,D0,rS,lu,O0;const ml=class ml{constructor(e,t,s,i,r,a,o,c,u,h,f,p,m){w(this,D);w(this,Nl,new AbortController);w(this,ys,null);w(this,it,new Map);w(this,vt,new Map);w(this,Cl,null);w(this,mi,null);w(this,Tl,null);w(this,Us,new xj);w(this,dr,null);w(this,Ea,null);w(this,jl,0);w(this,ka,new Set);w(this,$n,null);w(this,hn,null);w(this,Na,new Set);K(this,"_editorUndoBar",null);w(this,ud,!1);w(this,dd,!1);w(this,Pl,!1);w(this,hd,null);w(this,Bn,null);w(this,hr,null);w(this,Rl,null);w(this,fr,!1);w(this,Un,null);w(this,$p,new vj);w(this,pr,!1);w(this,fd,!1);w(this,mr,null);w(this,Ca,null);w(this,pd,null);w(this,md,null);w(this,ut,se.NONE);w(this,ve,new Set);w(this,gi,null);w(this,Ta,null);w(this,gd,null);w(this,yd,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});w(this,gr,[0,0]);w(this,zn,null);w(this,yi,null);w(this,vd,null);w(this,zs,null);const g=this._signal=l(this,Nl).signal;y(this,yi,e),y(this,vd,t),y(this,Cl,s),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:g}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),i._on("setpreference",this.onSetPreference.bind(this),{signal:g}),i._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:g}),_(this,D,J1).call(this),_(this,D,sS).call(this),_(this,D,I0).call(this),y(this,mi,r.annotationStorage),y(this,hd,r.filterFactory),y(this,Ta,a),y(this,Rl,o||null),y(this,ud,c),y(this,dd,u),y(this,Pl,h),y(this,md,f||null),this.viewParameters={realScale:Zr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const e=ml.prototype,t=a=>l(a,yi).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:c}=o;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ae(this,"_keyboardManager",new Fh([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,yi).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,yi).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r;(e=l(this,zs))==null||e.resolve(),y(this,zs,null),(t=l(this,Nl))==null||t.abort(),y(this,Nl,null),this._signal=null;for(const a of l(this,vt).values())a.destroy();l(this,vt).clear(),l(this,it).clear(),l(this,Na).clear(),y(this,ys,null),l(this,ve).clear(),l(this,Us).destroy(),(s=l(this,Cl))==null||s.destroy(),(i=l(this,Un))==null||i.hide(),y(this,Un,null),l(this,Bn)&&(clearTimeout(l(this,Bn)),y(this,Bn,null)),l(this,zn)&&(clearTimeout(l(this,zn)),y(this,zn,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return l(this,md)}get useNewAltTextFlow(){return l(this,dd)}get useNewAltTextWhenAddingImage(){return l(this,Pl)}get hcmFilter(){return ae(this,"hcmFilter",l(this,Ta)?l(this,hd).addHCMFilter(l(this,Ta).foreground,l(this,Ta).background):"none")}get direction(){return ae(this,"direction",getComputedStyle(l(this,yi)).direction)}get highlightColors(){return ae(this,"highlightColors",l(this,Rl)?new Map(l(this,Rl).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return ae(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),y(this,Ea,e)}setMainHighlightColorPicker(e){y(this,pd,e)}editAltText(e,t=!1){var s;(s=l(this,Cl))==null||s.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":y(this,Pl,t);break}}onPageChanging({pageNumber:e}){y(this,jl,e-1)}focusMainContainer(){l(this,yi).focus()}findParent(e,t){for(const s of l(this,vt).values()){const{x:i,y:r,width:a,height:o}=s.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+o)return s}return null}disableUserSelect(e=!1){l(this,vd).classList.toggle("noUserSelect",e)}addShouldRescale(e){l(this,Na).add(e)}removeShouldRescale(e){l(this,Na).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Zr.PDF_TO_CSS_UNITS;for(const s of l(this,Na))s.onScaleChanging();(t=l(this,Ea))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a}=t,o=t.toString(),u=_(this,D,Tf).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;t.empty();const f=_(this,D,R0).call(this,u),p=l(this,ut)===se.NONE,m=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a,text:o}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(se.HIGHLIGHT,m);return}m()}addToAnnotationStorage(e){!e.isEmpty()&&l(this,mi)&&!l(this,mi).has(e.id)&&l(this,mi).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,l(this,fr)&&(y(this,fr,!1),_(this,D,jf).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of l(this,ve))if(t.div.contains(e)){y(this,Ca,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!l(this,Ca))return;const[e,t]=l(this,Ca);y(this,Ca,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){_(this,D,I0).call(this),_(this,D,L0).call(this)}removeEditListeners(){_(this,D,tS).call(this),_(this,D,M0).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of l(this,hn))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of l(this,hn))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=l(this,ys))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of l(this,ve)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of l(this,hn))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){ne(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const u=await i.deserialize(c);if(!u)return;r.push(u)}const a=()=>{for(const c of r)_(this,D,D0).call(this,c);_(this,D,O0).call(this,r)},o=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){ne(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,ut)!==se.NONE&&!this.isEditorHandlingKeyboard&&ml._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,fr)&&(y(this,fr,!1),_(this,D,jf).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(_(this,D,Z1).call(this),_(this,D,L0).call(this),_(this,D,Ht).call(this,{isEditing:l(this,ut)!==se.NONE,isEmpty:_(this,D,lu).call(this),hasSomethingToUndo:l(this,Us).hasSomethingToUndo(),hasSomethingToRedo:l(this,Us).hasSomethingToRedo(),hasSelectedEditor:!1})):(_(this,D,eS).call(this),_(this,D,M0).call(this),_(this,D,Ht).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!l(this,hn)){y(this,hn,e);for(const t of l(this,hn))_(this,D,li).call(this,t.defaultPropertiesToUpdate)}}getId(){return l(this,$p).id}get currentLayer(){return l(this,vt).get(l(this,jl))}getLayer(e){return l(this,vt).get(e)}get currentPageIndex(){return l(this,jl)}addLayer(e){l(this,vt).set(e.pageIndex,e),l(this,pr)?e.enable():e.disable()}removeLayer(e){l(this,vt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){var i;if(l(this,ut)!==e&&!(l(this,zs)&&(await l(this,zs).promise,!l(this,zs)))){if(y(this,zs,Promise.withResolvers()),y(this,ut,e),e===se.NONE){this.setEditingState(!1),_(this,D,iS).call(this),(i=this._editorUndoBar)==null||i.hide(),l(this,zs).resolve();return}this.setEditingState(!0),await _(this,D,nS).call(this),this.unselectAll();for(const r of l(this,vt).values())r.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),l(this,zs).resolve();return}for(const r of l(this,it).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();l(this,zs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==l(this,ut)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var s;if(l(this,hn)){switch(e){case he.CREATE:this.currentLayer.addNewEditor();return;case he.HIGHLIGHT_DEFAULT_COLOR:(s=l(this,pd))==null||s.updateColor(t);break;case he.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,gd)||y(this,gd,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of l(this,ve))i.updateParams(e,t);for(const i of l(this,hn))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const a of l(this,it).values())a.editorType===e&&a.show(t);(((r=l(this,gd))==null?void 0:r.get(he.HIGHLIGHT_SHOW_ALL))??!0)!==t&&_(this,D,li).call(this,[[he.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(l(this,fd)!==e){y(this,fd,e);for(const t of l(this,vt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of l(this,it).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return l(this,it).get(e)}addEditor(e){l(this,it).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(l(this,Bn)&&clearTimeout(l(this,Bn)),y(this,Bn,setTimeout(()=>{this.focusMainContainer(),y(this,Bn,null)},0))),l(this,it).delete(e.id),this.unselect(e),(!e.annotationElementId||!l(this,ka).has(e.annotationElementId))&&((t=l(this,mi))==null||t.remove(e.id))}addDeletedAnnotationElement(e){l(this,ka).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return l(this,ka).has(e)}removeDeletedAnnotationElement(e){l(this,ka).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){l(this,ys)!==e&&(y(this,ys,e),e&&_(this,D,li).call(this,e.propertiesToUpdate))}updateUI(e){l(this,D,rS)===e&&_(this,D,li).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){_(this,D,li).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(l(this,ve).has(e)){l(this,ve).delete(e),e.unselect(),_(this,D,Ht).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,ve).add(e),e.select(),_(this,D,li).call(this,e.propertiesToUpdate),_(this,D,Ht).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=l(this,Ea))==null||t.commitOrRemove();for(const s of l(this,ve))s!==e&&s.unselect();l(this,ve).clear(),l(this,ve).add(e),e.select(),_(this,D,li).call(this,e.propertiesToUpdate),_(this,D,Ht).call(this,{hasSelectedEditor:!0})}isSelected(e){return l(this,ve).has(e)}get firstSelectedEditor(){return l(this,ve).values().next().value}unselect(e){e.unselect(),l(this,ve).delete(e),_(this,D,Ht).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,ve).size!==0}get isEnterHandled(){return l(this,ve).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;l(this,Us).undo(),_(this,D,Ht).call(this,{hasSomethingToUndo:l(this,Us).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:_(this,D,lu).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){l(this,Us).redo(),_(this,D,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,Us).hasSomethingToRedo(),isEmpty:_(this,D,lu).call(this)})}addCommands(e){l(this,Us).add(e),_(this,D,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:_(this,D,lu).call(this)})}cleanUndoStack(e){l(this,Us).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...l(this,ve)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const a of t)_(this,D,D0).call(this,a)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=l(this,ys))==null||e.commitOrRemove()}hasSomethingToControl(){return l(this,ys)||this.hasSelection}selectAll(){for(const e of l(this,ve))e.commit();_(this,D,O0).call(this,l(this,it).values())}unselectAll(){var e;if(!(l(this,ys)&&(l(this,ys).commitOrRemove(),l(this,ut)!==se.NONE))&&!((e=l(this,Ea))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of l(this,ve))t.unselect();l(this,ve).clear(),_(this,D,Ht).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,gr)[0]+=e,l(this,gr)[1]+=t;const[i,r]=l(this,gr),a=[...l(this,ve)],o=1e3;l(this,zn)&&clearTimeout(l(this,zn)),y(this,zn,setTimeout(()=>{y(this,zn,null),l(this,gr)[0]=l(this,gr)[1]=0,this.addCommands({cmd:()=>{for(const c of a)l(this,it).has(c.id)&&c.translateInPage(i,r)},undo:()=>{for(const c of a)l(this,it).has(c.id)&&c.translateInPage(-i,-r)},mustExec:!1})},o));for(const c of a)c.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),y(this,$n,new Map);for(const e of l(this,ve))l(this,$n).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,$n))return!1;this.disableUserSelect(!1);const e=l(this,$n);y(this,$n,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},o]of e)o.newX=i,o.newY=r,o.newPageIndex=a,t||(t=i!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const s=(i,r,a,o)=>{if(l(this,it).has(i.id)){const c=l(this,vt).get(o);c?i._setParentAndPosition(c,r,a):(i.pageIndex=o,i.x=r,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:a,newPageIndex:o}]of e)s(i,r,a,o)},undo:()=>{for(const[i,{savedX:r,savedY:a,savedPageIndex:o}]of e)s(i,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(l(this,$n))for(const s of l(this,$n).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||l(this,ve).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return l(this,ys)===e}getActive(){return l(this,ys)}getMode(){return l(this,ut)}get imageManager(){return ae(this,"imageManager",new j0)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,h,f,p)=>({x:(h-i)/a,y:1-(u+f-s)/r,width:p/a,height:f/r});break;case"180":o=(u,h,f,p)=>({x:1-(u+f-s)/r,y:1-(h+p-i)/a,width:f/r,height:p/a});break;case"270":o=(u,h,f,p)=>({x:1-(h+p-i)/a,y:(u-s)/r,width:p/a,height:f/r});break;default:o=(u,h,f,p)=>({x:(u-s)/r,y:(h-i)/a,width:f/r,height:p/a});break}const c=[];for(let u=0,h=t.rangeCount;u<h;u++){const f=t.getRangeAt(u);if(!f.collapsed)for(const{x:p,y:m,width:g,height:b}of f.getClientRects())g===0||b===0||c.push(o(p,m,g,b))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(l(this,Tl)||y(this,Tl,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=l(this,Tl))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=l(this,Tl))==null?void 0:i.get(e.data.id);if(!t)return;const s=l(this,mi).getRawValue(t);s&&(l(this,ut)===se.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}};Nl=new WeakMap,ys=new WeakMap,it=new WeakMap,vt=new WeakMap,Cl=new WeakMap,mi=new WeakMap,Tl=new WeakMap,Us=new WeakMap,dr=new WeakMap,Ea=new WeakMap,jl=new WeakMap,ka=new WeakMap,$n=new WeakMap,hn=new WeakMap,Na=new WeakMap,ud=new WeakMap,dd=new WeakMap,Pl=new WeakMap,hd=new WeakMap,Bn=new WeakMap,hr=new WeakMap,Rl=new WeakMap,fr=new WeakMap,Un=new WeakMap,$p=new WeakMap,pr=new WeakMap,fd=new WeakMap,mr=new WeakMap,Ca=new WeakMap,pd=new WeakMap,md=new WeakMap,ut=new WeakMap,ve=new WeakMap,gi=new WeakMap,Ta=new WeakMap,gd=new WeakMap,yd=new WeakMap,gr=new WeakMap,zn=new WeakMap,yi=new WeakMap,vd=new WeakMap,zs=new WeakMap,D=new WeakSet,Tf=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},R0=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of l(this,vt).values())if(s.hasTextLayer(e))return s;return null},Y1=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=_(this,D,Tf).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(l(this,Un)||y(this,Un,new yj(this)),l(this,Un).show(s,i,this.direction==="ltr"))},Q1=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){l(this,gi)&&((r=l(this,Un))==null||r.hide(),y(this,gi,null),_(this,D,Ht).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===l(this,gi))return;const i=_(this,D,Tf).call(this,e).closest(".textLayer");if(!i){l(this,gi)&&((a=l(this,Un))==null||a.hide(),y(this,gi,null),_(this,D,Ht).call(this,{hasSelectedText:!1}));return}if((o=l(this,Un))==null||o.hide(),y(this,gi,t),_(this,D,Ht).call(this,{hasSelectedText:!0}),!(l(this,ut)!==se.HIGHLIGHT&&l(this,ut)!==se.NONE)&&(l(this,ut)===se.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),y(this,fr,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,ut)===se.HIGHLIGHT?_(this,D,R0).call(this,i):null;c==null||c.toggleDrawing();const u=new AbortController,h=this.combinedSignal(u),f=p=>{p.type==="pointerup"&&p.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),p.type==="pointerup"&&_(this,D,jf).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:h}),window.addEventListener("blur",f,{signal:h})}},jf=function(e=""){l(this,ut)===se.HIGHLIGHT?this.highlightSelection(e):l(this,ud)&&_(this,D,Y1).call(this)},J1=function(){document.addEventListener("selectionchange",_(this,D,Q1).bind(this),{signal:this._signal})},Z1=function(){if(l(this,hr))return;y(this,hr,new AbortController);const e=this.combinedSignal(l(this,hr));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},eS=function(){var e;(e=l(this,hr))==null||e.abort(),y(this,hr,null)},I0=function(){if(l(this,mr))return;y(this,mr,new AbortController);const e=this.combinedSignal(l(this,mr));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},tS=function(){var e;(e=l(this,mr))==null||e.abort(),y(this,mr,null)},L0=function(){if(l(this,dr))return;y(this,dr,new AbortController);const e=this.combinedSignal(l(this,dr));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},M0=function(){var e;(e=l(this,dr))==null||e.abort(),y(this,dr,null)},sS=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Ht=function(e){Object.entries(e).some(([s,i])=>l(this,yd)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,yd),e)}),l(this,ut)===se.HIGHLIGHT&&e.hasSelectedEditor===!1&&_(this,D,li).call(this,[[he.HIGHLIGHT_FREE,!0]]))},li=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},nS=async function(){if(!l(this,pr)){y(this,pr,!0);const e=[];for(const t of l(this,vt).values())e.push(t.enable());await Promise.all(e);for(const t of l(this,it).values())t.enable()}},iS=function(){if(this.unselectAll(),l(this,pr)){y(this,pr,!1);for(const e of l(this,vt).values())e.disable();for(const e of l(this,it).values())e.disable()}},D0=function(e){const t=l(this,vt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},rS=function(){let e=null;for(e of l(this,ve));return e},lu=function(){if(l(this,it).size===0)return!0;if(l(this,it).size===1)for(const e of l(this,it).values())return e.isEmpty();return!1},O0=function(e){for(const t of l(this,ve))t.unselect();l(this,ve).clear();for(const t of e)t.isEmpty()||(l(this,ve).add(t),t.select());_(this,D,Ht).call(this,{hasSelectedEditor:this.hasSelection})},K(ml,"TRANSLATE_SMALL",1),K(ml,"TRANSLATE_BIG",10);let Mo=ml;var dt,Hn,fn,Il,Vn,vs,Ll,Wn,is,vi,ja,qn,yr,kn,cu,Pf;const Vt=class Vt{constructor(e){w(this,kn);w(this,dt,null);w(this,Hn,!1);w(this,fn,null);w(this,Il,null);w(this,Vn,null);w(this,vs,null);w(this,Ll,!1);w(this,Wn,null);w(this,is,null);w(this,vi,null);w(this,ja,null);w(this,qn,!1);y(this,is,e),y(this,qn,e._uiManager.useNewAltTextFlow),l(Vt,yr)||y(Vt,yr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Vt._l10n??(Vt._l10n=e)}async render(){const e=y(this,fn,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=y(this,Il,document.createElement("span"));e.append(t),l(this,qn)?(e.classList.add("new"),e.setAttribute("data-l10n-id",l(Vt,yr).missing),t.setAttribute("data-l10n-id",l(Vt,yr)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,is)._uiManager._signal;e.addEventListener("contextmenu",jn,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),l(this,is)._uiManager.editAltText(l(this,is)),l(this,qn)&&l(this,is)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,kn,cu)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(y(this,Ll,!0),i(r))},{signal:s}),await _(this,kn,Pf).call(this),e}finish(){l(this,fn)&&(l(this,fn).focus({focusVisible:l(this,Ll)}),y(this,Ll,!1))}isEmpty(){return l(this,qn)?l(this,dt)===null:!l(this,dt)&&!l(this,Hn)}hasData(){return l(this,qn)?l(this,dt)!==null||!!l(this,vi):this.isEmpty()}get guessedText(){return l(this,vi)}async setGuessedText(e){l(this,dt)===null&&(y(this,vi,e),y(this,ja,await Vt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),_(this,kn,Pf).call(this))}toggleAltTextBadge(e=!1){var t;if(!l(this,qn)||l(this,dt)){(t=l(this,Wn))==null||t.remove(),y(this,Wn,null);return}if(!l(this,Wn)){const s=y(this,Wn,document.createElement("div"));s.className="noAltTextBadge",l(this,is).div.append(s)}l(this,Wn).classList.toggle("hidden",!e)}serialize(e){let t=l(this,dt);return!e&&l(this,vi)===t&&(t=l(this,ja)),{altText:t,decorative:l(this,Hn),guessedText:l(this,vi),textWithDisclaimer:l(this,ja)}}get data(){return{altText:l(this,dt),decorative:l(this,Hn)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(y(this,vi,s),y(this,ja,i)),!(l(this,dt)===e&&l(this,Hn)===t)&&(r||(y(this,dt,e),y(this,Hn,t)),_(this,kn,Pf).call(this))}toggle(e=!1){l(this,fn)&&(!e&&l(this,vs)&&(clearTimeout(l(this,vs)),y(this,vs,null)),l(this,fn).disabled=!e)}shown(){l(this,is)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,kn,cu)}})}destroy(){var e,t;(e=l(this,fn))==null||e.remove(),y(this,fn,null),y(this,Il,null),y(this,Vn,null),(t=l(this,Wn))==null||t.remove(),y(this,Wn,null)}};dt=new WeakMap,Hn=new WeakMap,fn=new WeakMap,Il=new WeakMap,Vn=new WeakMap,vs=new WeakMap,Ll=new WeakMap,Wn=new WeakMap,is=new WeakMap,vi=new WeakMap,ja=new WeakMap,qn=new WeakMap,yr=new WeakMap,kn=new WeakSet,cu=function(){return l(this,dt)&&"added"||l(this,dt)===null&&this.guessedText&&"review"||"missing"},Pf=async function(){var i,r,a;const e=l(this,fn);if(!e)return;if(l(this,qn)){if(e.classList.toggle("done",!!l(this,dt)),e.setAttribute("data-l10n-id",l(Vt,yr)[l(this,kn,cu)]),(i=l(this,Il))==null||i.setAttribute("data-l10n-id",l(Vt,yr)[`${l(this,kn,cu)}-label`]),!l(this,dt)){(r=l(this,Vn))==null||r.remove();return}}else{if(!l(this,dt)&&!l(this,Hn)){e.classList.remove("done"),(a=l(this,Vn))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=l(this,Vn);if(!t){y(this,Vn,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${l(this,is).id}`;const o=100,c=l(this,is)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,vs)),y(this,vs,null)},{once:!0}),e.addEventListener("mouseenter",()=>{y(this,vs,setTimeout(()=>{y(this,vs,null),l(this,Vn).classList.add("show"),l(this,is)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;l(this,vs)&&(clearTimeout(l(this,vs)),y(this,vs,null)),(u=l(this,Vn))==null||u.classList.remove("show")},{signal:c})}l(this,Hn)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=l(this,dt)),t.parentNode||e.append(t);const s=l(this,is).getImageForAltText();s==null||s.setAttribute("aria-describedby",t.id)},w(Vt,yr,null),K(Vt,"_l10n",null);let Tp=Vt;var xd,Pa,bd,wd,_d,Sd,Ad,Ml,xi,Ra,vr,Yi,aS,oS,F0;const Qv=class Qv{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){w(this,Yi);w(this,xd);w(this,Pa,!1);w(this,bd,null);w(this,wd);w(this,_d);w(this,Sd);w(this,Ad);w(this,Ml);w(this,xi,null);w(this,Ra);w(this,vr,null);y(this,xd,e),y(this,bd,s),y(this,wd,t),y(this,_d,i),y(this,Sd,r),y(this,Ad,a),y(this,Ra,new AbortController),y(this,Ml,AbortSignal.any([o,l(this,Ra).signal])),e.addEventListener("touchstart",_(this,Yi,aS).bind(this),{passive:!1,signal:l(this,Ml)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return ae(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=l(this,Ra))==null||e.abort(),y(this,Ra,null)}};xd=new WeakMap,Pa=new WeakMap,bd=new WeakMap,wd=new WeakMap,_d=new WeakMap,Sd=new WeakMap,Ad=new WeakMap,Ml=new WeakMap,xi=new WeakMap,Ra=new WeakMap,vr=new WeakMap,Yi=new WeakSet,aS=function(e){var i,r,a;if((i=l(this,wd))!=null&&i.call(this)||e.touches.length<2)return;if(!l(this,vr)){y(this,vr,new AbortController);const o=AbortSignal.any([l(this,Ml),l(this,vr).signal]),c=l(this,xd),u={signal:o,passive:!1};c.addEventListener("touchmove",_(this,Yi,oS).bind(this),u),c.addEventListener("touchend",_(this,Yi,F0).bind(this),u),c.addEventListener("touchcancel",_(this,Yi,F0).bind(this),u),(r=l(this,_d))==null||r.call(this)}if(Is(e),e.touches.length!==2||(a=l(this,bd))!=null&&a.call(this)){y(this,xi,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),y(this,xi,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},oS=function(e){var A;if(!l(this,xi)||e.touches.length!==2)return;let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:a,screenY:o}=s,c=l(this,xi),{touch0X:u,touch0Y:h,touch1X:f,touch1Y:p}=c,m=f-u,g=p-h,b=a-i,E=o-r,x=Math.hypot(b,E)||1,v=Math.hypot(m,g)||1;if(!l(this,Pa)&&Math.abs(v-x)<=Qv.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=a,c.touch1Y=o,e.preventDefault(),!l(this,Pa)){y(this,Pa,!0);return}const S=[(i+a)/2,(r+o)/2];(A=l(this,Sd))==null||A.call(this,S,v,x)},F0=function(e){var t;l(this,vr).abort(),y(this,vr,null),(t=l(this,Ad))==null||t.call(this),l(this,xi)&&(e.preventDefault(),y(this,xi,null),y(this,Pa,!1))};let jp=Qv;var Ia,pn,Te,Dl,xr,Ed,La,xt,Ma,bi,br,kd,Da,xs,Nd,Oa,wi,Gn,Ol,Fl,Hs,Fa,Cd,Bp,Y,$0,Td,B0,Rf,lS,cS,U0,If,z0,uS,dS,hS,H0,fS,V0,pS,mS,gS,W0,uu;const ie=class ie{constructor(e){w(this,Y);w(this,Ia,null);w(this,pn,null);w(this,Te,null);w(this,Dl,!1);w(this,xr,null);w(this,Ed,"");w(this,La,!1);w(this,xt,null);w(this,Ma,null);w(this,bi,null);w(this,br,null);w(this,kd,"");w(this,Da,!1);w(this,xs,null);w(this,Nd,!1);w(this,Oa,!1);w(this,wi,!1);w(this,Gn,null);w(this,Ol,0);w(this,Fl,0);w(this,Hs,null);w(this,Fa,null);K(this,"_editToolbar",null);K(this,"_initialOptions",Object.create(null));K(this,"_initialData",null);K(this,"_isVisible",!0);K(this,"_uiManager",null);K(this,"_focusEventsAllowed",!0);w(this,Cd,!1);w(this,Bp,ie._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,a];const[o,c]=this.parentDimensions;this.x=e.x/o,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ie.prototype._resizeWithKeyboard,t=Mo.TRANSLATE_SMALL,s=Mo.TRANSLATE_BIG;return ae(this,"_resizerKeyboardManager",new Fh([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],ie.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return ae(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new bj({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ie._l10n??(ie._l10n=e),ie._l10nResizer||(ie._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ie._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ie._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Se("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,Cd)}set _isDraggable(e){var t;y(this,Cd,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,Bp)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):_(this,Y,uu).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(l(this,Da)?y(this,Da,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,a]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/a,this.fixAndSetPosition()}translate(e,t){_(this,Y,$0).call(this,this.parentDimensions,e,t)}translateInPage(e,t){l(this,xs)||y(this,xs,[this.x,this.y,this.width,this.height]),_(this,Y,$0).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){l(this,xs)||y(this,xs,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[c,u]=this.getBaseTranslation();a+=c,o+=u;const{style:h}=s;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!l(this,xs)&&(l(this,xs)[0]!==this.x||l(this,xs)[1]!==this.y)}get _hasBeenResized(){return!!l(this,xs)&&(l(this,xs)[2]!==this.width||l(this,xs)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=ie,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:a,width:o,height:c}=this;if(o*=s,c*=i,r*=s,a*=i,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(s-o,r)),a=Math.max(0,Math.min(i-c,a));break;case 90:r=Math.max(0,Math.min(s-c,r)),a=Math.min(i,Math.max(o,a));break;case 180:r=Math.min(s,Math.max(o,r)),a=Math.min(i,Math.max(c,a));break;case 270:r=Math.min(s,Math.max(c,r)),a=Math.max(0,Math.min(i-o,a));break}this.x=r/=s,this.y=a/=i;const[u,h]=this.getBaseTranslation();r+=u,a+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return _(s=ie,Td,B0).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return _(s=ie,Td,B0).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,l(this,La)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),r=!l(this,La)&&t.endsWith("%");if(i&&r)return;const[a,o]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),!l(this,La)&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=l(this,Te))==null||e.finish()}async addEditToolbar(){return this._editToolbar||l(this,Oa)?this._editToolbar:(this._editToolbar=new C0(this),this.div.append(this._editToolbar.render()),l(this,Te)&&await this._editToolbar.addAltText(l(this,Te)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=l(this,Te))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,Te)||(Tp.initialize(ie._l10n),y(this,Te,new Tp(this)),l(this,Ia)&&(l(this,Te).data=l(this,Ia),y(this,Ia,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=l(this,Te))==null?void 0:e.data}set altTextData(e){l(this,Te)&&(l(this,Te).data=e)}get guessedAltText(){var e;return(e=l(this,Te))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=l(this,Te))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=l(this,Te))==null?void 0:t.serialize(e)}hasAltText(){return!!l(this,Te)&&!l(this,Te).isEmpty()}hasAltTextData(){var e;return((e=l(this,Te))==null?void 0:e.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=l(this,Dl)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),_(this,Y,V0).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),Cp(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,Fa)||y(this,Fa,new jp({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:_(this,Y,uS).bind(this),onPinching:_(this,Y,dS).bind(this),onPinchEnd:_(this,Y,hS).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(e){const{isMac:t}=Yt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(y(this,Da,!0),this._isDraggable){_(this,Y,fS).call(this,e);return}_(this,Y,H0).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,Gn)&&clearTimeout(l(this,Gn)),y(this,Gn,setTimeout(()=>{var e;y(this,Gn,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[o,c]=this.pageTranslation,u=e/i,h=t/i,f=this.x*r,p=this.y*a,m=this.width*r,g=this.height*a;switch(s){case 0:return[f+u+o,a-p-h-g+c,f+u+m+o,a-p-h+c];case 90:return[f+h+o,a-p+u+c,f+h+g+o,a-p+u+m+c];case 180:return[f-u-m+o,a-p+h+c,f-u+o,a-p+h+g+c];case 270:return[f-h-g+o,a-p-u-m+c,f-h+o,a-p-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,a]=e,o=r-s,c=a-i;switch(this.rotation){case 0:return[s,t-a,o,c];case 90:return[s,t-i,c,o];case 180:return[r,t-i,o,c];case 270:return[r,t-a,c,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){y(this,Oa,!0)}disableEditMode(){y(this,Oa,!1)}isInEditMode(){return l(this,Oa)}shouldGetKeyboardEvents(){return l(this,wi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&s>0}rebuild(){_(this,Y,V0).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Se("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,y(i,Ia,e.accessibilityData);const[r,a]=i.pageDimensions,[o,c,u,h]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/r,i.y=c/a,i.width=u/r,i.height=h/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=l(this,br))==null||e.abort(),y(this,br,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,Gn)&&(clearTimeout(l(this,Gn)),y(this,Gn,null)),_(this,Y,uu).call(this),this.removeEditToolbar(),l(this,Hs)){for(const s of l(this,Hs).values())clearTimeout(s);y(this,Hs,null)}this.parent=null,(t=l(this,Fa))==null||t.destroy(),y(this,Fa,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(_(this,Y,lS).call(this),l(this,xt).classList.remove("hidden"),Cp(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),y(this,bi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=l(this,xt).children;if(!l(this,pn)){y(this,pn,Array.from(t));const a=_(this,Y,pS).bind(this),o=_(this,Y,mS).bind(this),c=this._uiManager._signal;for(const u of l(this,pn)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:c}),u.addEventListener("blur",o,{signal:c}),u.addEventListener("focus",_(this,Y,gS).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",ie._l10nResizer[h])}}const s=l(this,pn)[0];let i=0;for(const a of t){if(a===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,pn).length/4);if(r!==i){if(r<i)for(let o=0;o<i-r;o++)l(this,xt).append(l(this,xt).firstChild);else if(r>i)for(let o=0;o<r-i;o++)l(this,xt).firstChild.before(l(this,xt).lastChild);let a=0;for(const o of t){const u=l(this,pn)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",ie._l10nResizer[u])}}_(this,Y,W0).call(this,0),y(this,wi,!0),l(this,xt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){l(this,wi)&&_(this,Y,z0).call(this,l(this,kd),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){_(this,Y,uu).call(this),this.div.focus()}select(){var e,t,s;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=l(this,Te))==null||s.toggleAltTextBadge(!1)}unselect(){var e,t,s,i,r;(e=l(this,xt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=l(this,Te))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return l(this,Nd)}set isEditing(e){y(this,Nd,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){y(this,La,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){l(this,Hs)||y(this,Hs,new Map);const{action:s}=e;let i=l(this,Hs).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),l(this,Hs).delete(s),l(this,Hs).size===0&&y(this,Hs,null)},ie._telemetryTimeout),l(this,Hs).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),y(this,Dl,!1)}disable(){this.div&&(this.div.tabIndex=-1),y(this,Dl,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Ia=new WeakMap,pn=new WeakMap,Te=new WeakMap,Dl=new WeakMap,xr=new WeakMap,Ed=new WeakMap,La=new WeakMap,xt=new WeakMap,Ma=new WeakMap,bi=new WeakMap,br=new WeakMap,kd=new WeakMap,Da=new WeakMap,xs=new WeakMap,Nd=new WeakMap,Oa=new WeakMap,wi=new WeakMap,Gn=new WeakMap,Ol=new WeakMap,Fl=new WeakMap,Hs=new WeakMap,Fa=new WeakMap,Cd=new WeakMap,Bp=new WeakMap,Y=new WeakSet,$0=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Td=new WeakSet,B0=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Rf=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},lS=function(){if(l(this,xt))return;y(this,xt,document.createElement("div")),l(this,xt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");l(this,xt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",_(this,Y,cS).bind(this,s),{signal:t}),i.addEventListener("contextmenu",jn,{signal:t}),i.tabIndex=-1}this.div.prepend(l(this,xt))},cS=function(e,t){var h;t.preventDefault();const{isMac:s}=Yt.platform;if(t.button!==0||t.ctrlKey&&s)return;(h=l(this,Te))==null||h.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,y(this,Ma,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",_(this,Y,z0).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Is,{passive:!1,signal:a}),window.addEventListener("contextmenu",jn,{signal:a}),y(this,bi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var f;r.abort(),this.parent.togglePointerEvents(!0),(f=l(this,Te))==null||f.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=c,_(this,Y,If).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},U0=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*s,a*i),this.fixAndSetPosition(),this._onResized()},If=function(){if(!l(this,bi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=l(this,bi);y(this,bi,null);const r=this.x,a=this.y,o=this.width,c=this.height;r===e&&a===t&&o===s&&c===i||this.addCommands({cmd:_(this,Y,U0).bind(this,r,a,o,c),undo:_(this,Y,U0).bind(this,e,t,s,i),mustExec:!0})},z0=function(e,t){const[s,i]=this.parentDimensions,r=this.x,a=this.y,o=this.width,c=this.height,u=ie.MIN_SIZE/s,h=ie.MIN_SIZE/i,f=_(this,Y,Rf).call(this,this.rotation),p=(O,q)=>[f[0]*O+f[2]*q,f[1]*O+f[3]*q],m=_(this,Y,Rf).call(this,360-this.rotation),g=(O,q)=>[m[0]*O+m[2]*q,m[1]*O+m[3]*q];let b,E,x=!1,v=!1;switch(e){case"topLeft":x=!0,b=(O,q)=>[0,0],E=(O,q)=>[O,q];break;case"topMiddle":b=(O,q)=>[O/2,0],E=(O,q)=>[O/2,q];break;case"topRight":x=!0,b=(O,q)=>[O,0],E=(O,q)=>[0,q];break;case"middleRight":v=!0,b=(O,q)=>[O,q/2],E=(O,q)=>[0,q/2];break;case"bottomRight":x=!0,b=(O,q)=>[O,q],E=(O,q)=>[0,0];break;case"bottomMiddle":b=(O,q)=>[O/2,q],E=(O,q)=>[O/2,0];break;case"bottomLeft":x=!0,b=(O,q)=>[0,q],E=(O,q)=>[O,0];break;case"middleLeft":v=!0,b=(O,q)=>[0,q/2],E=(O,q)=>[O,q/2];break}const S=b(o,c),A=E(o,c);let C=p(...A);const N=ie._round(r+C[0]),k=ie._round(a+C[1]);let j=1,I=1,R,U;if(t.fromKeyboard)({deltaX:R,deltaY:U}=t);else{const{screenX:O,screenY:q}=t,[M,G]=l(this,Ma);[R,U]=this.screenToPageTranslation(O-M,q-G),l(this,Ma)[0]=O,l(this,Ma)[1]=q}if([R,U]=g(R/s,U/i),x){const O=Math.hypot(o,c);j=I=Math.max(Math.min(Math.hypot(A[0]-S[0]-R,A[1]-S[1]-U)/O,1/o,1/c),u/o,h/c)}else v?j=Math.max(u,Math.min(1,Math.abs(A[0]-S[0]-R)))/o:I=Math.max(h,Math.min(1,Math.abs(A[1]-S[1]-U)))/c;const H=ie._round(o*j),J=ie._round(c*I);C=p(...E(H,J));const de=N-C[0],et=k-C[1];l(this,xs)||y(this,xs,[this.x,this.y,this.width,this.height]),this.width=H,this.height=J,this.x=de,this.y=et,this.setDims(s*H,i*J),this.fixAndSetPosition(),this._onResizing()},uS=function(){var e;y(this,bi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=l(this,Te))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},dS=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const a=_(this,Y,Rf).call(this,this.rotation),o=(N,k)=>[a[0]*N+a[2]*k,a[1]*N+a[3]*k],[c,u]=this.parentDimensions,h=this.x,f=this.y,p=this.width,m=this.height,g=ie.MIN_SIZE/c,b=ie.MIN_SIZE/u;r=Math.max(Math.min(r,1/p,1/m),g/p,b/m);const E=ie._round(p*r),x=ie._round(m*r);if(E===p&&x===m)return;l(this,xs)||y(this,xs,[h,f,p,m]);const v=o(p/2,m/2),S=ie._round(h+v[0]),A=ie._round(f+v[1]),C=o(E/2,x/2);this.x=S-C[0],this.y=A-C[1],this.width=E,this.height=x,this.setDims(c*E,u*x),this.fixAndSetPosition(),this._onResizing()},hS=function(){var e;(e=l(this,Te))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),_(this,Y,If).call(this)},H0=function(e){const{isMac:t}=Yt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},fS=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},o=u=>{i.abort(),y(this,xr,null),y(this,Da,!1),this._uiManager.endDragSession()||_(this,Y,H0).call(this,u),s&&this._onStopDragging()};t&&(y(this,Ol,e.clientX),y(this,Fl,e.clientY),y(this,xr,e.pointerId),y(this,Ed,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._onStartDragging());const{clientX:h,clientY:f,pointerId:p}=u;if(p!==l(this,xr)){Is(u);return}const[m,g]=this.screenToPageTranslation(h-l(this,Ol),f-l(this,Fl));y(this,Ol,h),y(this,Fl,f),this._uiManager.dragSelectedEditors(m,g)},a),window.addEventListener("touchmove",Is,a),window.addEventListener("pointerdown",u=>{u.pointerType===l(this,Ed)&&(l(this,Fa)||u.isPrimary)&&o(u),Is(u)},a));const c=u=>{if(!l(this,xr)||l(this,xr)===u.pointerId){o(u);return}Is(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},V0=function(){if(l(this,br)||!this.div)return;y(this,br,new AbortController);const e=this._uiManager.combinedSignal(l(this,br));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},pS=function(e){ie._resizerKeyboardManager.exec(this,e)},mS=function(e){var t;l(this,wi)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==l(this,xt)&&_(this,Y,uu).call(this)},gS=function(e){y(this,kd,l(this,wi)?e:"")},W0=function(e){if(l(this,pn))for(const t of l(this,pn))t.tabIndex=e},uu=function(){y(this,wi,!1),_(this,Y,W0).call(this,-1),_(this,Y,If).call(this)},w(ie,Td),K(ie,"_l10n",null),K(ie,"_l10nResizer",null),K(ie,"_borderLineWidth",-1),K(ie,"_colorManager",new P0),K(ie,"_zIndex",1),K(ie,"_telemetryTimeout",1e3);let Ue=ie;class bj extends Ue{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Mb=3285377520,Bs=4294901760,Mn=65535;class yS{constructor(e){this.h1=e?e&4294967295:Mb,this.h2=e?e&4294967295:Mb}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let b=0,E=e.length;b<E;b++){const x=e.charCodeAt(b);x<=255?t[s++]=x:(t[s++]=x>>>8,t[s++]=x&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,c=0,u=this.h1,h=this.h2;const f=3432918353,p=461845907,m=f&Mn,g=p&Mn;for(let b=0;b<i;b++)b&1?(o=a[b],o=o*f&Bs|o*m&Mn,o=o<<15|o>>>17,o=o*p&Bs|o*g&Mn,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(c=a[b],c=c*f&Bs|c*m&Mn,c=c<<15|c>>>17,c=c*p&Bs|c*g&Mn,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*f&Bs|o*m&Mn,o=o<<15|o>>>17,o=o*p&Bs|o*g&Mn,i&1?u^=o:h^=o}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Bs|e*36045&Mn,t=t*4283543511&Bs|((t<<16|e>>>16)*2950163797&Bs)>>>16,e^=t>>>1,e=e*444984403&Bs|e*60499&Mn,t=t*3301882366&Bs|((t<<16|e>>>16)*3120437893&Bs)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const q0=Object.freeze({map:null,hash:"",transfer:void 0});var $a,Ba,ht,Up,vS;class qv{constructor(){w(this,Up);w(this,$a,!1);w(this,Ba,null);w(this,ht,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=l(this,ht).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return l(this,ht).get(e)}remove(e){if(l(this,ht).delete(e),l(this,ht).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of l(this,ht).values())if(t instanceof Ue)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=l(this,ht).get(e);let i=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(i=!0,s[r]=a);else i=!0,l(this,ht).set(e,t);i&&_(this,Up,vS).call(this),t instanceof Ue&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return l(this,ht).has(e)}getAll(){return l(this,ht).size>0?Bv(l(this,ht)):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return l(this,ht).size}resetModified(){l(this,$a)&&(y(this,$a,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new xS(this)}get serializable(){if(l(this,ht).size===0)return q0;const e=new Map,t=new yS,s=[],i=Object.create(null);let r=!1;for(const[a,o]of l(this,ht)){const c=o instanceof Ue?o.serialize(!1,i):o;c&&(e.set(a,c),t.update(`${a}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:q0}get editorStats(){let e=null;const t=new Map;for(const s of l(this,ht).values()){if(!(s instanceof Ue))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[o,c]of Object.entries(i)){if(o==="type")continue;let u=a.get(o);u||(u=new Map,a.set(o,u));const h=u.get(c)??0;u.set(c,h+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){y(this,Ba,null)}get modifiedIds(){if(l(this,Ba))return l(this,Ba);const e=[];for(const t of l(this,ht).values())!(t instanceof Ue)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return y(this,Ba,{ids:new Set(e),hash:e.join(",")})}}$a=new WeakMap,Ba=new WeakMap,ht=new WeakMap,Up=new WeakSet,vS=function(){l(this,$a)||(y(this,$a,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var jd;class xS extends qv{constructor(t){super();w(this,jd);const{map:s,hash:i,transfer:r}=t.serializable,a=structuredClone(s,r?{transfer:r}:null);y(this,jd,{map:a,hash:i,transfer:r})}get print(){Se("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,jd)}get modifiedIds(){return ae(this,"modifiedIds",{ids:new Set,hash:""})}}jd=new WeakMap;var $l;class wj{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){w(this,$l,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),l(this,$l).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||l(this,$l).has(e.loadedName))){if(Je(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:r}=e,a=new FontFace(s,i,r);this.addNativeFontFace(a);try{await a.load(),l(this,$l).add(s),t==null||t(e)}catch{ne(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Se("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw ne(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ae(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return($t||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),ae(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Je(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ae(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(A,C){return A.charCodeAt(C)<<24|A.charCodeAt(C+1)<<16|A.charCodeAt(C+2)<<8|A.charCodeAt(C+3)&255}function i(A,C,N,k){const j=A.substring(0,C),I=A.substring(C+N);return j+k+I}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const c=o.getContext("2d");let u=0;function h(A,C){if(++u>30){ne("Load test font never loaded."),C();return}if(c.font="30px "+A,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(h.bind(null,A,C))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=i(p,976,f.length,f);const g=16,b=1482184792;let E=s(p,g);for(r=0,a=f.length-3;r<a;r+=4)E=E-b+s(f,r)|0;r<f.length&&(E=E-b+s(f+"XXX",r)|0),p=i(p,g,4,aj(E));const x=`url(data:font/opentype;base64,${btoa(p)});`,v=`@font-face {font-family:"${f}";src:${x}}`;this.insertRule(v);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const A of[e.loadedName,f]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=A,S.append(C)}this._document.body.append(S),h(f,()=>{S.remove(),t.complete()})}}$l=new WeakMap;class _j{constructor(e,{disableFontFace:t=!1,fontExtraProperties:s=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this.fontExtraProperties=s===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${hj(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(a){ne(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}}const cf={DATA:1,ERROR:2},Ye={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Db(){}function ss(n){if(n instanceof Jr||n instanceof E0||n instanceof td||n instanceof Rb||n instanceof Np||n instanceof hg)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Se('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Jr(n.message);case"InvalidPDFException":return new E0(n.message);case"MissingPDFException":return new td(n.message);case"PasswordException":return new Rb(n.message,n.code);case"UnexpectedResponseException":return new Np(n.message,n.status);case"UnknownErrorException":return new hg(n.message,n.details)}return new hg(n.message,n.toString())}var Bl,en,bS,wS,_S,Lf;class du{constructor(e,t,s){w(this,en);w(this,Bl,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",_(this,en,bS).bind(this),{signal:l(this,Bl).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,a=this.sourceName,o=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,c.postMessage({sourceName:a,targetName:o,stream:Ye.PULL,streamId:r,desiredSize:u.desiredSize}),h.promise},cancel:u=>{Je(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:o,stream:Ye.CANCEL,streamId:r,reason:ss(u)}),h.promise}},s)}destroy(){var e;(e=l(this,Bl))==null||e.abort(),y(this,Bl,null)}}Bl=new WeakMap,en=new WeakSet,bS=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){_(this,en,_S).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===cf.DATA)i.resolve(e.data);else if(e.callback===cf.ERROR)i.reject(ss(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:i,callback:cf.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:i,callback:cf.ERROR,callbackId:e.callbackId,reason:ss(a)})});return}if(e.streamId){_(this,en,wS).call(this,e);return}t(e.data)},wS=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],c={enqueue(u,h=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=h,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:Ye.ENQUEUE,streamId:t,chunk:u},f)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Ye.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){Je(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Ye.ERROR,streamId:t,reason:ss(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(o,e.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Ye.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Ye.START_COMPLETE,streamId:t,reason:ss(u)})})},_S=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Ye.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ss(e.reason));break;case Ye.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ss(e.reason));break;case Ye.PULL:if(!o){r.postMessage({sourceName:s,targetName:i,stream:Ye.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||Db).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Ye.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Ye.PULL_COMPLETE,streamId:t,reason:ss(u)})});break;case Ye.ENQUEUE:if(Je(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Ye.CLOSE:if(Je(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),_(this,en,Lf).call(this,a,t);break;case Ye.ERROR:Je(a,"error should have stream controller"),a.controller.error(ss(e.reason)),_(this,en,Lf).call(this,a,t);break;case Ye.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ss(e.reason)),_(this,en,Lf).call(this,a,t);break;case Ye.CANCEL:if(!o)break;const c=ss(e.reason);Promise.try(o.onCancel||Db,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Ye.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Ye.CANCEL_COMPLETE,streamId:t,reason:ss(u)})}),o.sinkCapability.reject(c),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Lf=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var Pd;class SS{constructor({enableHWA:e=!1}){w(this,Pd,!1);y(this,Pd,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,Pd)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Se("Abstract method `_createCanvas` called.")}}Pd=new WeakMap;class Sj extends SS{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class AS{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Se("Abstract method `_fetch` called.")}}class ES extends AS{async _fetch(e){const t=await Em(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Am(t)}}class kS{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var Ua,Ul,_i,Si,Lt,za,Ha,F,Pt,hu,Yo,Mf,Qo,NS,G0,Jo,fu,pu,X0,mu;class Aj extends kS{constructor({docId:t,ownerDocument:s=globalThis.document}){super();w(this,F);w(this,Ua);w(this,Ul);w(this,_i);w(this,Si);w(this,Lt);w(this,za);w(this,Ha,0);y(this,Si,t),y(this,Lt,s)}addFilter(t){if(!t)return"none";let s=l(this,F,Pt).get(t);if(s)return s;const[i,r,a]=_(this,F,Mf).call(this,t),o=t.length===1?i:`${i}${r}${a}`;if(s=l(this,F,Pt).get(o),s)return l(this,F,Pt).set(t,s),s;const c=`g_${l(this,Si)}_transfer_map_${Ut(this,Ha)._++}`,u=_(this,F,Qo).call(this,c);l(this,F,Pt).set(t,u),l(this,F,Pt).set(o,u);const h=_(this,F,Jo).call(this,c);return _(this,F,pu).call(this,i,r,a,h),u}addHCMFilter(t,s){var g;const i=`${t}-${s}`,r="base";let a=l(this,F,hu).get(r);if((a==null?void 0:a.key)===i||(a?((g=a.filter)==null||g.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},l(this,F,hu).set(r,a)),!t||!s))return a.url;const o=_(this,F,mu).call(this,t);t=W.makeHexColor(...o);const c=_(this,F,mu).call(this,s);if(s=W.makeHexColor(...c),l(this,F,Yo).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const u=new Array(256);for(let b=0;b<=255;b++){const E=b/255;u[b]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const h=u.join(","),f=`g_${l(this,Si)}_hcm_filter`,p=a.filter=_(this,F,Jo).call(this,f);_(this,F,pu).call(this,h,h,h,p),_(this,F,G0).call(this,p);const m=(b,E)=>{const x=o[b]/255,v=c[b]/255,S=new Array(E+1);for(let A=0;A<=E;A++)S[A]=x+A/E*(v-x);return S.join(",")};return _(this,F,pu).call(this,m(0,5),m(1,5),m(2,5),p),a.url=_(this,F,Qo).call(this,f),a.url}addAlphaFilter(t){let s=l(this,F,Pt).get(t);if(s)return s;const[i]=_(this,F,Mf).call(this,[t]),r=`alpha_${i}`;if(s=l(this,F,Pt).get(r),s)return l(this,F,Pt).set(t,s),s;const a=`g_${l(this,Si)}_alpha_map_${Ut(this,Ha)._++}`,o=_(this,F,Qo).call(this,a);l(this,F,Pt).set(t,o),l(this,F,Pt).set(r,o);const c=_(this,F,Jo).call(this,a);return _(this,F,X0).call(this,i,c),o}addLuminosityFilter(t){let s=l(this,F,Pt).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=_(this,F,Mf).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=l(this,F,Pt).get(r),s)return l(this,F,Pt).set(t,s),s;const a=`g_${l(this,Si)}_luminosity_map_${Ut(this,Ha)._++}`,o=_(this,F,Qo).call(this,a);l(this,F,Pt).set(t,o),l(this,F,Pt).set(r,o);const c=_(this,F,Jo).call(this,a);return _(this,F,NS).call(this,c),t&&_(this,F,X0).call(this,i,c),o}addHighlightHCMFilter(t,s,i,r,a){var v;const o=`${s}-${i}-${r}-${a}`;let c=l(this,F,hu).get(t);if((c==null?void 0:c.key)===o||(c?((v=c.filter)==null||v.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},l(this,F,hu).set(t,c)),!s||!i))return c.url;const[u,h]=[s,i].map(_(this,F,mu).bind(this));let f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[m,g]=[r,a].map(_(this,F,mu).bind(this));p<f&&([f,p,m,g]=[p,f,g,m]),l(this,F,Yo).style.color="";const b=(S,A,C)=>{const N=new Array(256),k=(p-f)/C,j=S/255,I=(A-S)/(255*C);let R=0;for(let U=0;U<=C;U++){const H=Math.round(f+U*k),J=j+U*I;for(let de=R;de<=H;de++)N[de]=J;R=H+1}for(let U=R;U<256;U++)N[U]=N[R-1];return N.join(",")},E=`g_${l(this,Si)}_hcm_${t}_filter`,x=c.filter=_(this,F,Jo).call(this,E);return _(this,F,G0).call(this,x),_(this,F,pu).call(this,b(m[0],g[0],5),b(m[1],g[1],5),b(m[2],g[2],5),x),c.url=_(this,F,Qo).call(this,E),c.url}destroy(t=!1){var s,i,r,a;t&&((s=l(this,za))!=null&&s.size)||((i=l(this,_i))==null||i.parentNode.parentNode.remove(),y(this,_i,null),(r=l(this,Ul))==null||r.clear(),y(this,Ul,null),(a=l(this,za))==null||a.clear(),y(this,za,null),y(this,Ha,0))}}Ua=new WeakMap,Ul=new WeakMap,_i=new WeakMap,Si=new WeakMap,Lt=new WeakMap,za=new WeakMap,Ha=new WeakMap,F=new WeakSet,Pt=function(){return l(this,Ul)||y(this,Ul,new Map)},hu=function(){return l(this,za)||y(this,za,new Map)},Yo=function(){if(!l(this,_i)){const t=l(this,Lt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=l(this,Lt).createElementNS(oi,"svg");i.setAttribute("width",0),i.setAttribute("height",0),y(this,_i,l(this,Lt).createElementNS(oi,"defs")),t.append(i),i.append(l(this,_i)),l(this,Lt).body.append(t)}return l(this,_i)},Mf=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let p=0;p<256;p++)h[p]=u[p]/255;const f=h.join(",");return[f,f,f]}const[s,i,r]=t,a=new Array(256),o=new Array(256),c=new Array(256);for(let u=0;u<256;u++)a[u]=s[u]/255,o[u]=i[u]/255,c[u]=r[u]/255;return[a.join(","),o.join(","),c.join(",")]},Qo=function(t){if(l(this,Ua)===void 0){y(this,Ua,"");const s=l(this,Lt).URL;s!==l(this,Lt).baseURI&&(km(s)?ne('#createUrl: ignore "data:"-URL for performance reasons.'):y(this,Ua,s.split("#",1)[0]))}return`url(${l(this,Ua)}#${t})`},NS=function(t){const s=l(this,Lt).createElementNS(oi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},G0=function(t){const s=l(this,Lt).createElementNS(oi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Jo=function(t){const s=l(this,Lt).createElementNS(oi,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),l(this,F,Yo).append(s),s},fu=function(t,s,i){const r=l(this,Lt).createElementNS(oi,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},pu=function(t,s,i,r){const a=l(this,Lt).createElementNS(oi,"feComponentTransfer");r.append(a),_(this,F,fu).call(this,a,"feFuncR",t),_(this,F,fu).call(this,a,"feFuncG",s),_(this,F,fu).call(this,a,"feFuncB",i)},X0=function(t,s){const i=l(this,Lt).createElementNS(oi,"feComponentTransfer");s.append(i),_(this,F,fu).call(this,i,"feFuncA",t)},mu=function(t){return l(this,F,Yo).style.color=t,Wv(getComputedStyle(l(this,F,Yo)).getPropertyValue("color"))};class CS{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Se("Abstract method `_fetch` called.")}}class TS extends CS{async _fetch(e){const t=await Em(e,"arraybuffer");return new Uint8Array(t)}}$t&&ne("Please use the `legacy` build in Node.js environments.");async function jS(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class Ej extends kS{}class kj extends SS{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class Nj extends AS{async _fetch(e){return jS(e)}}class Cj extends CS{async _fetch(e){return jS(e)}}const Ot={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function K0(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class Gv{getPattern(){Se("Abstract method `getPattern` called.")}}class Tj extends Gv{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Ot.STROKE||i===Ot.FILL){const a=t.current.getClippedPathBoundingBox(i,Ie(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),s=W.transform(s,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),K0(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(u.canvas,"no-repeat");const f=new DOMMatrix(s);r.setTransform(f)}else K0(e,this._bbox),r=this._createGradient(e);return r}}function mg(n,e,t,s,i,r,a,o){const c=e.coords,u=e.colors,h=n.data,f=n.width*4;let p;c[t+1]>c[s+1]&&(p=t,t=s,s=p,p=r,r=a,a=p),c[s+1]>c[i+1]&&(p=s,s=i,i=p,p=a,a=o,o=p),c[t+1]>c[s+1]&&(p=t,t=s,s=p,p=r,r=a,a=p);const m=(c[t]+e.offsetX)*e.scaleX,g=(c[t+1]+e.offsetY)*e.scaleY,b=(c[s]+e.offsetX)*e.scaleX,E=(c[s+1]+e.offsetY)*e.scaleY,x=(c[i]+e.offsetX)*e.scaleX,v=(c[i+1]+e.offsetY)*e.scaleY;if(g>=v)return;const S=u[r],A=u[r+1],C=u[r+2],N=u[a],k=u[a+1],j=u[a+2],I=u[o],R=u[o+1],U=u[o+2],H=Math.round(g),J=Math.round(v);let de,et,O,q,M,G,X,ue;for(let oe=H;oe<=J;oe++){if(oe<E){const me=oe<g?0:(g-oe)/(g-E);de=m-(m-b)*me,et=S-(S-N)*me,O=A-(A-k)*me,q=C-(C-j)*me}else{let me;oe>v?me=1:E===v?me=0:me=(E-oe)/(E-v),de=b-(b-x)*me,et=N-(N-I)*me,O=k-(k-R)*me,q=j-(j-U)*me}let Ae;oe<g?Ae=0:oe>v?Ae=1:Ae=(g-oe)/(g-v),M=m-(m-x)*Ae,G=S-(S-I)*Ae,X=A-(A-R)*Ae,ue=C-(C-U)*Ae;const Nt=Math.round(Math.min(de,M)),rn=Math.round(Math.max(de,M));let Pe=f*oe+Nt*4;for(let me=Nt;me<=rn;me++)Ae=(de-me)/(de-M),Ae<0?Ae=0:Ae>1&&(Ae=1),h[Pe++]=et-(et-G)*Ae|0,h[Pe++]=O-(O-X)*Ae|0,h[Pe++]=q-(q-ue)*Ae|0,h[Pe++]=255}}function jj(n,e,t){const s=e.coords,i=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,c=Math.floor(s.length/o)-1,u=o-1;for(r=0;r<c;r++){let h=r*o;for(let f=0;f<u;f++,h++)mg(n,t,s[h],s[h+1],s[h+o],i[h],i[h+1],i[h+o]),mg(n,t,s[h+o+1],s[h+1],s[h+o],i[h+o+1],i[h+1],i[h+o])}break;case"triangles":for(r=0,a=s.length;r<a;r+=3)mg(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class Pj extends Gv{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-c,f=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),m=u/f,g=h/p,b={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-c,scaleX:1/m,scaleY:1/g},E=f+2*2,x=p+2*2,v=s.getCanvas("mesh",E,x),S=v.context,A=S.createImageData(f,p);if(t){const N=A.data;for(let k=0,j=N.length;k<j;k+=4)N[k]=t[0],N[k+1]=t[1],N[k+2]=t[2],N[k+3]=255}for(const N of this._figures)jj(A,N,b);return S.putImageData(A,2,2),{canvas:v.canvas,offsetX:o-2*m,offsetY:c-2*g,scaleX:m,scaleY:g}}getPattern(e,t,s,i){K0(e,this._bbox);let r;if(i===Ot.SHADING)r=W.singularValueDecompose2dScale(Ie(e));else if(r=W.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=W.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,i===Ot.SHADING?null:this._background,t.cachedCanvases);return i!==Ot.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class Rj extends Gv{getPattern(){return"hotpink"}}function Ij(n){switch(n[0]){case"RadialAxial":return new Tj(n);case"Mesh":return new Pj(n);case"Dummy":return new Rj}throw new Error(`Unknown IR type: ${n[0]}`)}const Ob={COLORED:1,UNCOLORED:2},zp=class zp{constructor(e,t,s,i,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),Sm("TilingType: "+r);const h=t[0],f=t[1],p=t[2],m=t[3],g=p-h,b=m-f,E=W.singularValueDecompose2dScale(this.matrix),x=W.singularValueDecompose2dScale(this.baseTransform),v=E[0]*x[0],S=E[1]*x[1];let A=g,C=b,N=!1,k=!1;const j=Math.ceil(c*v),I=Math.ceil(u*S),R=Math.ceil(g*v),U=Math.ceil(b*S);j>=R?A=c:N=!0,I>=U?C=u:k=!0;const H=this.getSizeAndScale(A,this.ctx.canvas.width,v),J=this.getSizeAndScale(C,this.ctx.canvas.height,S),de=e.cachedCanvases.getCanvas("pattern",H.size,J.size),et=de.context,O=o.createCanvasGraphics(et);if(O.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(O,i,a),et.translate(-H.scale*h,-J.scale*f),O.transform(H.scale,0,0,J.scale,0,0),et.save(),this.clipBbox(O,h,f,p,m),O.baseTransform=Ie(O.ctx),O.executeOperatorList(s),O.endDrawing(),et.restore(),N||k){const q=de.canvas;N&&(A=c),k&&(C=u);const M=this.getSizeAndScale(A,this.ctx.canvas.width,v),G=this.getSizeAndScale(C,this.ctx.canvas.height,S),X=M.size,ue=G.size,oe=e.cachedCanvases.getCanvas("pattern-workaround",X,ue),Ae=oe.context,Nt=N?Math.floor(g/c):0,rn=k?Math.floor(b/u):0;for(let Pe=0;Pe<=Nt;Pe++)for(let me=0;me<=rn;me++)Ae.drawImage(q,X*Pe,ue*me,X,ue,0,0,X,ue);return{canvas:oe.canvas,scaleX:M.scale,scaleY:G.scale,offsetX:h,offsetY:f}}return{canvas:de.canvas,scaleX:H.scale,scaleY:J.scale,offsetX:h,offsetY:f}}getSizeAndScale(e,t,s){const i=Math.max(zp.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const a=i-t,o=r-s;e.ctx.rect(t,s,a,o),e.current.updateRectMinMax(Ie(e.ctx),[t,s,i,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case Ob.COLORED:const a=this.ctx;i.fillStyle=a.fillStyle,i.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case Ob.UNCOLORED:const o=W.makeHexColor(s[0],s[1],s[2]);i.fillStyle=o,i.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new rj(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,i){let r=s;i!==Ot.SHADING&&(r=W.transform(r,t.baseTransform),this.matrix&&(r=W.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const c=e.createPattern(a.canvas,"repeat");return c.setTransform(o),c}};K(zp,"MAX_PATTERN_SIZE",3e3);let Y0=zp;function Lj({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=Yt.isLittleEndian?4278190080:255,[c,u]=a?[r,o]:[o,r],h=s>>3,f=s&7,p=n.length;t=new Uint32Array(t.buffer);let m=0;for(let g=0;g<i;g++){for(const E=e+h;e<E;e++){const x=e<p?n[e]:255;t[m++]=x&128?u:c,t[m++]=x&64?u:c,t[m++]=x&32?u:c,t[m++]=x&16?u:c,t[m++]=x&8?u:c,t[m++]=x&4?u:c,t[m++]=x&2?u:c,t[m++]=x&1?u:c}if(f===0)continue;const b=e<p?n[e++]:255;for(let E=0;E<f;E++)t[m++]=b&1<<7-E?u:c}return{srcPos:e,destPos:m}}const Fb=16,$b=100,Mj=15,Bb=10,Ub=1e3,os=16;function Dj(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(s,i){e.translate(s,i),this.__originalTranslate(s,i)},n.scale=function(s,i){e.scale(s,i),this.__originalScale(s,i)},n.transform=function(s,i,r,a,o,c){e.transform(s,i,r,a,o,c),this.__originalTransform(s,i,r,a,o,c)},n.setTransform=function(s,i,r,a,o,c){e.setTransform(s,i,r,a,o,c),this.__originalSetTransform(s,i,r,a,o,c)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(s){e.rotate(s),this.__originalRotate(s)},n.clip=function(s){e.clip(s),this.__originalClip(s)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,a,o){e.bezierCurveTo(t,s,i,r,a,o),this.__originalBezierCurveTo(t,s,i,r,a,o)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Oj{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function uf(n,e,t,s,i,r,a,o,c,u){const[h,f,p,m,g,b]=Ie(n);if(f===0&&p===0){const v=a*h+g,S=Math.round(v),A=o*m+b,C=Math.round(A),N=(a+c)*h+g,k=Math.abs(Math.round(N)-S)||1,j=(o+u)*m+b,I=Math.abs(Math.round(j)-C)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(m),S,C),n.drawImage(e,t,s,i,r,0,0,k,I),n.setTransform(h,f,p,m,g,b),[k,I]}if(h===0&&m===0){const v=o*p+g,S=Math.round(v),A=a*f+b,C=Math.round(A),N=(o+u)*p+g,k=Math.abs(Math.round(N)-S)||1,j=(a+c)*f+b,I=Math.abs(Math.round(j)-C)||1;return n.setTransform(0,Math.sign(f),Math.sign(p),0,S,C),n.drawImage(e,t,s,i,r,0,0,I,k),n.setTransform(h,f,p,m,g,b),[I,k]}n.drawImage(e,t,s,i,r,a,o,c,u);const E=Math.hypot(h,f),x=Math.hypot(p,m);return[E*c,x*u]}function Fj(n){const{width:e,height:t}=n;if(e>Ub||t>Ub)return null;const s=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let a=new Uint8Array(r*(t+1)),o,c,u;const h=e+7&-8;let f=new Uint8Array(h*t),p=0;for(const x of n.data){let v=128;for(;v>0;)f[p++]=x&v?0:255,v>>=1}let m=0;for(p=0,f[p]!==0&&(a[0]=1,++m),c=1;c<e;c++)f[p]!==f[p+1]&&(a[c]=f[p]?2:1,++m),p++;for(f[p]!==0&&(a[c]=2,++m),o=1;o<t;o++){p=o*h,u=o*r,f[p-h]!==f[p]&&(a[u]=f[p]?1:8,++m);let x=(f[p]?4:0)+(f[p-h]?8:0);for(c=1;c<e;c++)x=(x>>2)+(f[p+1]?4:0)+(f[p-h+1]?8:0),i[x]&&(a[u+c]=i[x],++m),p++;if(f[p-h]!==f[p]&&(a[u+c]=f[p]?2:4,++m),m>s)return null}for(p=h*(t-1),u=o*r,f[p]!==0&&(a[u]=8,++m),c=1;c<e;c++)f[p]!==f[p+1]&&(a[u+c]=f[p]?4:8,++m),p++;if(f[p]!==0&&(a[u+c]=4,++m),m>s)return null;const g=new Int32Array([0,r,-1,0,-r,0,0,0,1]),b=new Path2D;for(o=0;m&&o<=t;o++){let x=o*r;const v=x+e;for(;x<v&&!a[x];)x++;if(x===v)continue;b.moveTo(x%r,o);const S=x;let A=a[x];do{const C=g[A];do x+=C;while(!a[x]);const N=a[x];N!==5&&N!==10?(A=N,a[x]=0):(A=N&51*A>>4,a[x]&=A>>2|A<<2),b.lineTo(x%r,x/r|0),a[x]||--m}while(S!==x);--o}return f=null,a=null,function(x){x.save(),x.scale(1/e,-1/t),x.translate(0,-t),x.fill(b),x.beginPath(),x.restore()}}class zb{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=B1,this.textMatrixScale=1,this.fontMatrix=A0,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=jt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=W.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=W.applyTransform(t,e),i=W.applyTransform(t.slice(2),e),r=W.applyTransform([t[0],t[3]],e),a=W.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],i[0],r[0],a[0]),this.minY=Math.min(this.minY,s[1],i[1],r[1],a[1]),this.maxX=Math.max(this.maxX,s[0],i[0],r[0],a[0]),this.maxY=Math.max(this.maxY,s[1],i[1],r[1],a[1])}updateScalingPathMinMax(e,t){W.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,r,a,o,c,u,h){const f=W.bezierBoundingBox(t,s,i,r,a,o,c,u,h);h||this.updateRectMinMax(e,f)}getPathBoundingBox(e=Ot.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Ot.STROKE){t||Se("Stroke bounding box must include transform.");const i=W.singularValueDecompose2dScale(t),r=i[0]*this.lineWidth/2,a=i[1]*this.lineWidth/2;s[0]-=r,s[1]-=a,s[2]+=r,s[3]+=a}return s}updateClipFromPath(){const e=W.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Ot.FILL,t=null){return W.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Hb(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%os,r=(t-i)/os,a=i===0?r:r+1,o=n.createImageData(s,os);let c=0,u;const h=e.data,f=o.data;let p,m,g,b;if(e.kind===Ef.GRAYSCALE_1BPP){const E=h.byteLength,x=new Uint32Array(f.buffer,0,f.byteLength>>2),v=x.length,S=s+7>>3,A=4294967295,C=Yt.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(g=p<r?os:i,u=0,m=0;m<g;m++){const N=E-c;let k=0;const j=N>S?s:N*8-7,I=j&-8;let R=0,U=0;for(;k<I;k+=8)U=h[c++],x[u++]=U&128?A:C,x[u++]=U&64?A:C,x[u++]=U&32?A:C,x[u++]=U&16?A:C,x[u++]=U&8?A:C,x[u++]=U&4?A:C,x[u++]=U&2?A:C,x[u++]=U&1?A:C;for(;k<j;k++)R===0&&(U=h[c++],R=128),x[u++]=U&R?A:C,R>>=1}for(;u<v;)x[u++]=0;n.putImageData(o,0,p*os)}}else if(e.kind===Ef.RGBA_32BPP){for(m=0,b=s*os*4,p=0;p<r;p++)f.set(h.subarray(c,c+b)),c+=b,n.putImageData(o,0,m),m+=os;p<a&&(b=s*i*4,f.set(h.subarray(c,c+b)),n.putImageData(o,0,m))}else if(e.kind===Ef.RGB_24BPP)for(g=os,b=s*g,p=0;p<a;p++){for(p>=r&&(g=i,b=s*g),u=0,m=b;m--;)f[u++]=h[c++],f[u++]=h[c++],f[u++]=h[c++],f[u++]=255;n.putImageData(o,0,p*os)}else throw new Error(`bad image kind: ${e.kind}`)}function Vb(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%os,r=(t-i)/os,a=i===0?r:r+1,o=n.createImageData(s,os);let c=0;const u=e.data,h=o.data;for(let f=0;f<a;f++){const p=f<r?os:i;({srcPos:c}=Lj({src:u,srcPos:c,dest:h,width:s,height:p,nonBlackColor:0})),n.putImageData(o,0,f*os)}}function Zc(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function df(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!$t){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function Wb(n,e){if(e)return!0;const t=W.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*Zr.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const $j=["butt","round","square"],Bj=["miter","round","bevel"],Uj={},qb={};var Pn,Q0,J0,Z0;const Jv=class Jv{constructor(e,t,s,i,r,{optionalContentConfig:a,markedContentStack:o=null},c,u){w(this,Pn);this.ctx=e,this.current=new zb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new Oj(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,s){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Ie(this.compositeCtx))}this.ctx.save(),df(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ie(this.ctx)}executeOperatorList(e,t,s,i){const r=e.argsArray,a=e.fnArray;let o=t||0;const c=r.length;if(c===o)return o;const u=c-o>Bb&&typeof s=="function",h=u?Date.now()+Mj:0;let f=0;const p=this.commonObjs,m=this.objs;let g;for(;;){if(i!==void 0&&o===i.nextBreakPoint)return i.breakIt(o,s),o;if(g=a[o],g!==un.dependency)this[g].apply(this,r[o]);else for(const b of r[o]){const E=b.startsWith("g_")?p:m;if(!E.has(b))return E.get(b,s),o}if(o++,o===c)return o;if(u&&++f>Bb){if(Date.now()>h)return s(),o;f=0}}}endDrawing(){_(this,Pn,Q0).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),_(this,Pn,J0).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,c=i,u="prescale1",h,f;for(;r>2&&o>1||a>2&&c>1;){let p=o,m=c;r>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/p),a>2&&c>1&&(m=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/m),h=this.cachedCanvases.getCanvas(u,p,m),f=h.context,f.clearRect(0,0,p,m),f.drawImage(e,0,0,o,c,0,0,p,m),e=h.canvas,o=p,c=m,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,r=this.current.fillColor,a=this.current.patternFill,o=Ie(t);let c,u,h,f;if((e.bitmap||e.data)&&e.count>1){const j=e.bitmap||e.data.buffer;u=JSON.stringify(a?o:[o.slice(0,4),r]),c=this._cachedBitmapsMap.get(j),c||(c=new Map,this._cachedBitmapsMap.set(j,c));const I=c.get(u);if(I&&!a){const R=Math.round(Math.min(o[0],o[2])+o[4]),U=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:I,offsetX:R,offsetY:U}}h=I}h||(f=this.cachedCanvases.getCanvas("maskCanvas",s,i),Vb(f.context,e));let p=W.transform(o,[1/s,0,0,-1/i,0,0]);p=W.transform(p,[1,0,0,1,0,-i]);const[m,g,b,E]=W.getAxialAlignedBoundingBox([0,0,s,i],p),x=Math.round(b-m)||1,v=Math.round(E-g)||1,S=this.cachedCanvases.getCanvas("fillCanvas",x,v),A=S.context,C=m,N=g;A.translate(-C,-N),A.transform(...p),h||(h=this._scaleImage(f.canvas,Ln(A)),h=h.img,c&&a&&c.set(u,h)),A.imageSmoothingEnabled=Wb(Ie(A),e.interpolate),uf(A,h,0,0,h.width,h.height,0,0,s,i),A.globalCompositeOperation="source-in";const k=W.transform(Ln(A),[1,0,0,1,-C,-N]);return A.fillStyle=a?r.getPattern(t,this,k,Ot.FILL):r,A.fillRect(0,0,s,i),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,S.canvas)),{canvas:S.canvas,offsetX:Math.round(C),offsetY:Math.round(N)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=$j[e]}setLineJoin(e){this.ctx.lineJoin=Bj[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const r=this.ctx;r.setTransform(...Ie(this.suspendedCtx)),Zc(this.suspendedCtx,r),Dj(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Zc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],a=i[1],o=i[2]-r,c=i[3]-a;o===0||c===0||(this.genericComposeSMask(t.context,s,o,c,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,a,o,c,u,h,f){let p=e.canvas,m=c-h,g=u-f;if(a){const E=W.makeHexColor(...a);if(m<0||g<0||m+s>p.width||g+i>p.height){const x=this.cachedCanvases.getCanvas("maskExtension",s,i),v=x.context;v.drawImage(p,-m,-g),v.globalCompositeOperation="destination-atop",v.fillStyle=E,v.fillRect(0,0,s,i),v.globalCompositeOperation="source-over",p=x.canvas,m=g=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(m,g,s,i),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=E,e.fillRect(m,g,s,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const b=new Path2D;b.rect(c,u,s,i),t.clip(b),t.globalCompositeOperation="destination-in",t.drawImage(p,m,g,s,i,c,u,s,i),t.restore()}save(){this.inSMaskMode?(Zc(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Zc(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,r,a){this.ctx.transform(e,t,s,i,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const i=this.ctx,r=this.current;let a=r.x,o=r.y,c,u;const h=Ie(i),f=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,p=f?s.slice(0):null;for(let m=0,g=0,b=e.length;m<b;m++)switch(e[m]|0){case un.rectangle:a=t[g++],o=t[g++];const E=t[g++],x=t[g++],v=a+E,S=o+x;i.moveTo(a,o),E===0||x===0?i.lineTo(v,S):(i.lineTo(v,o),i.lineTo(v,S),i.lineTo(a,S)),f||r.updateRectMinMax(h,[a,o,v,S]),i.closePath();break;case un.moveTo:a=t[g++],o=t[g++],i.moveTo(a,o),f||r.updatePathMinMax(h,a,o);break;case un.lineTo:a=t[g++],o=t[g++],i.lineTo(a,o),f||r.updatePathMinMax(h,a,o);break;case un.curveTo:c=a,u=o,a=t[g+4],o=t[g+5],i.bezierCurveTo(t[g],t[g+1],t[g+2],t[g+3],a,o),r.updateCurvePathMinMax(h,c,u,t[g],t[g+1],t[g+2],t[g+3],a,o,p),g+=6;break;case un.curveTo2:c=a,u=o,i.bezierCurveTo(a,o,t[g],t[g+1],t[g+2],t[g+3]),r.updateCurvePathMinMax(h,c,u,a,o,t[g],t[g+1],t[g+2],t[g+3],p),a=t[g+2],o=t[g+3],g+=4;break;case un.curveTo3:c=a,u=o,a=t[g+2],o=t[g+3],i.bezierCurveTo(t[g],t[g+1],a,o,a,o),r.updateCurvePathMinMax(h,c,u,t[g],t[g+1],a,o,a,o,p),g+=4;break;case un.closePath:i.closePath();break}f&&r.updateScalingPathMinMax(h,p),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(t.save(),t.strokeStyle=s.getPattern(t,this,Ln(t),Ot.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;let r=!1;i&&(t.save(),t.fillStyle=s.getPattern(t,this,Ln(t),Ot.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Uj}eoClip(){this.pendingClip=qb}beginText(){this.current.textMatrix=B1,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:c,path:u}of e)s.addPath(u,new DOMMatrix(r).preMultiplySelf(i).translate(a,o).scale(c,-c));t.clip(s),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||A0,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&ne("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",a=((h=s.systemFontInfo)==null?void 0:h.css)||`"${r}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const c=s.italic?"italic":"normal";let u=t;t<Fb?u=Fb:t>$b&&(u=$b),this.current.fontSizeScale=t/u,this.ctx.font=`${c} ${o} ${u}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,r,a){this.current.textMatrix=[e,t,s,i,r,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i,r){const a=this.ctx,o=this.current,c=o.font,u=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,f=u&jt.FILL_STROKE_MASK,p=!!(u&jt.ADD_TO_PATH_FLAG),m=o.patternFill&&!c.missingFile,g=o.patternStroke&&!c.missingFile;let b;if((c.disableFontFace||p||m||g)&&(b=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||m||g){if(a.save(),a.translate(t,s),a.scale(h,-h),f===jt.FILL||f===jt.FILL_STROKE)if(i){const E=a.getTransform();a.setTransform(...i),a.fill(_(this,Pn,Z0).call(this,b,E,i))}else a.fill(b);if(f===jt.STROKE||f===jt.FILL_STROKE)if(r){const E=a.getTransform();a.setTransform(...r),a.stroke(_(this,Pn,Z0).call(this,b,E,r))}else a.lineWidth/=h,a.stroke(b);a.restore()}else(f===jt.FILL||f===jt.FILL_STROKE)&&a.fillText(e,t,s),(f===jt.STROKE||f===jt.FILL_STROKE)&&a.strokeText(e,t,s);p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ie(a),x:t,y:s,fontSize:h,path:b})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return ae(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,c=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,f=e.length,p=s.vertical,m=p?1:-1,g=s.defaultVMetrics,b=i*t.fontMatrix[0],E=t.textRenderingMode===jt.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(h,-1):r.scale(h,1);let x,v;if(t.patternFill){r.save();const k=t.fillColor.getPattern(r,this,Ln(r),Ot.FILL);x=Ie(r),r.restore(),r.fillStyle=k}if(t.patternStroke){r.save();const k=t.strokeColor.getPattern(r,this,Ln(r),Ot.STROKE);v=Ie(r),r.restore(),r.strokeStyle=k}let S=t.lineWidth;const A=t.textMatrixScale;if(A===0||S===0){const k=t.textRenderingMode&jt.FILL_STROKE_MASK;(k===jt.STROKE||k===jt.FILL_STROKE)&&(S=this.getSinglePixelWidth())}else S/=A;if(a!==1&&(r.scale(a,a),S/=a),r.lineWidth=S,s.isInvalidPDFjsFont){const k=[];let j=0;for(const I of e)k.push(I.unicode),j+=I.width;r.fillText(k.join(""),0,0),t.x+=j*b*h,r.restore(),this.compose();return}let C=0,N;for(N=0;N<f;++N){const k=e[N];if(typeof k=="number"){C+=m*k*i/1e3;continue}let j=!1;const I=(k.isSpace?c:0)+o,R=k.fontChar,U=k.accent;let H,J,de=k.width;if(p){const O=k.vmetric||g,q=-(k.vmetric?O[1]:de*.5)*b,M=O[2]*b;de=O?-O[0]:de,H=q/a,J=(C+M)/a}else H=C/a,J=0;if(s.remeasure&&de>0){const O=r.measureText(R).width*1e3/i*a;if(de<O&&this.isFontSubpixelAAEnabled){const q=de/O;j=!0,r.save(),r.scale(q,1),H/=q}else de!==O&&(H+=(de-O)/2e3*i/a)}if(this.contentVisible&&(k.isInFont||s.missingFile)){if(E&&!U)r.fillText(R,H,J);else if(this.paintChar(R,H,J,x,v),U){const O=H+i*U.offset.x/a,q=J-i*U.offset.y/a;this.paintChar(U.fontChar,O,q,x,v)}}const et=p?de*b-I*u:de*b+I*u;C+=et,j&&r.restore()}p?t.y-=C:t.x+=C*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,a=s.fontDirection,o=i.vertical?1:-1,c=s.charSpacing,u=s.wordSpacing,h=s.textHScale*a,f=s.fontMatrix||A0,p=e.length,m=s.textRenderingMode===jt.INVISIBLE;let g,b,E,x;if(!(m||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(h,a),g=0;g<p;++g){if(b=e[g],typeof b=="number"){x=o*b*r/1e3,this.ctx.translate(x,0),s.x+=x*h;continue}const v=(b.isSpace?u:0)+c,S=i.charProcOperatorList[b.operatorListId];if(!S){ne(`Type3 character "${b.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=b,this.save(),t.scale(r,r),t.transform(...f),this.executeOperatorList(S),this.restore()),E=W.applyTransform([b.width,0],f)[0]*r+v,t.translate(E,0),s.x+=E*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,r,a){this.ctx.rect(s,i,r-s,a-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],i=this.baseTransform||Ie(this.ctx),r={createCanvasGraphics:a=>new Jv(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Y0(e,s,this.ctx,r,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=W.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=W.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=Ij(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Ln(t),Ot.SHADING);const i=Ln(t);if(i){const{width:r,height:a}=t.canvas,[o,c,u,h]=W.getAxialAlignedBoundingBox([0,0,r,a],i);this.ctx.fillRect(o,c,u-o,h-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Se("Should not call beginInlineImage")}beginImageData(){Se("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Ie(this.ctx),t)){const s=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],s,i),this.current.updateRectMinMax(Ie(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Sm("TODO: Support non-isolated groups."),e.knockout&&ne("Knockout groups not supported.");const s=Ie(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=W.getAxialAlignedBoundingBox(e.bbox,Ie(t));const r=[0,0,t.canvas.width,t.canvas.height];i=W.intersect(i,r)||[0,0,0,0];const a=Math.floor(i[0]),o=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-a,1),u=Math.max(Math.ceil(i[3])-o,1);this.current.startNewPathAndClipBox([0,0,c,u]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(h,c,u),p=f.context;p.translate(-a,-o),p.transform(...s),e.smask?this.smaskStack.push({canvas:f.canvas,context:p,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Zc(t,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Ie(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=W.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,i,r){if(_(this,Pn,Q0).call(this),df(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[c,u]=W.singularValueDecompose2dScale(Ie(this.ctx)),{viewportScale:h}=this,f=Math.ceil(a*this.outputScaleX*h),p=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:m,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(c,0,0,-u,0,o*u),df(this.ctx)}else df(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new zb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),_(this,Pn,J0).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=Fj(e)),i.compiled)){i.compiled(s);return}const r=this._createMaskCanvas(e),a=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const c=Ie(o);o.transform(t,s,i,r,0,0);const u=this._createMaskCanvas(e);o.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let h=0,f=a.length;h<f;h+=2){const p=W.transform(c,[t,s,i,r,a[h],a[h+1]]),[m,g]=W.applyTransform([0,0],p);o.drawImage(u.canvas,m,g)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:a,width:o,height:c,transform:u}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,c),f=h.context;f.save();const p=this.getObject(a,r);Vb(f,p),f.globalCompositeOperation="source-in",f.fillStyle=i?s.getPattern(f,this,Ln(t),Ot.FILL):s,f.fillRect(0,0,o,c),f.restore(),t.save(),t.transform(...u),t.scale(1,-1),uf(t,h.canvas,0,0,o,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){ne("Dependent image isn't ready yet");return}const a=r.width,o=r.height,c=[];for(let u=0,h=i.length;u<h;u+=2)c.push({transform:[t,0,0,s,i[u],i[u+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;if(this.save(),!$t){const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none")}i.scale(1/t,-1/s);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Hb(c,e),r=this.applyTransferMapsToCanvas(c)}const a=this._scaleImage(r,Ln(i));i.imageSmoothingEnabled=Wb(Ie(i),e.interpolate),uf(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const r=e.width,a=e.height,c=this.cachedCanvases.getCanvas("inlineImage",r,a).context;Hb(c,e),i=this.applyTransferMapsToCanvas(c)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),uf(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===qb?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ie(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let a,o;if(s===0&&i===0){const c=Math.abs(t),u=Math.abs(r);if(c===u)if(e===0)a=o=1/c;else{const h=c*e;a=o=h<1?1/h:1}else if(e===0)a=1/c,o=1/u;else{const h=c*e,f=u*e;a=h<1?1/h:1,o=f<1?1/f:1}}else{const c=Math.abs(t*r-s*i),u=Math.hypot(t,s),h=Math.hypot(i,r);if(e===0)a=h/c,o=u/c;else{const f=e*c;a=h>f?h/f:1,o=u>f?u/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[i,r]=this.getScaleForStroking();if(t.lineWidth=s||1,i===1&&r===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(i,r),a.length>0){const o=Math.max(i,r);t.setLineDash(a.map(c=>c/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Pn=new WeakSet,Q0=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},J0=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Z0=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let Sl=Jv;for(const n in un)Sl.prototype[n]!==void 0&&(Sl.prototype[un[n]]=Sl.prototype[n]);var Rd,Id;class Bi{static get workerPort(){return l(this,Rd)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");y(this,Rd,e)}static get workerSrc(){return l(this,Id)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");y(this,Id,e)}}Rd=new WeakMap,Id=new WeakMap,w(Bi,Rd,null),w(Bi,Id,"");var Va,Ld;class zj{constructor({parsedData:e,rawData:t}){w(this,Va);w(this,Ld);y(this,Va,e),y(this,Ld,t)}getRaw(){return l(this,Ld)}get(e){return l(this,Va).get(e)??null}getAll(){return Bv(l(this,Va))}has(e){return l(this,Va).has(e)}}Va=new WeakMap,Ld=new WeakMap;const Zo=Symbol("INTERNAL");var Md,Dd,Od,zl;class Hj{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){w(this,Md,!1);w(this,Dd,!1);w(this,Od,!1);w(this,zl,!0);y(this,Md,!!(e&Ts.DISPLAY)),y(this,Dd,!!(e&Ts.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(l(this,Od))return l(this,zl);if(!l(this,zl))return!1;const{print:e,view:t}=this.usage;return l(this,Md)?(t==null?void 0:t.viewState)!=="OFF":l(this,Dd)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Zo&&Se("Internal method `_setVisible` called."),y(this,Od,s),y(this,zl,t)}}Md=new WeakMap,Dd=new WeakMap,Od=new WeakMap,zl=new WeakMap;var wr,xe,Hl,Vl,Fd,ey;class Vj{constructor(e,t=Ts.DISPLAY){w(this,Fd);w(this,wr,null);w(this,xe,new Map);w(this,Hl,null);w(this,Vl,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,y(this,Vl,e.order);for(const s of e.groups)l(this,xe).set(s.id,new Hj(t,s));if(e.baseState==="OFF")for(const s of l(this,xe).values())s._setVisible(Zo,!1);for(const s of e.on)l(this,xe).get(s)._setVisible(Zo,!0);for(const s of e.off)l(this,xe).get(s)._setVisible(Zo,!1);y(this,Hl,this.getHash())}}isVisible(e){if(l(this,xe).size===0)return!0;if(!e)return Sm("Optional content group not defined."),!0;if(e.type==="OCG")return l(this,xe).has(e.id)?l(this,xe).get(e.id).visible:(ne(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return _(this,Fd,ey).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!l(this,xe).has(t))return ne(`Optional content group not found: ${t}`),!0;if(l(this,xe).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!l(this,xe).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!l(this,xe).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!l(this,xe).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!l(this,xe).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!l(this,xe).has(t))return ne(`Optional content group not found: ${t}`),!0;if(l(this,xe).get(t).visible)return!1}return!0}return ne(`Unknown optional content policy ${e.policy}.`),!0}return ne(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=l(this,xe).get(e);if(!i){ne(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((r=l(this,xe).get(o))==null||r._setVisible(Zo,!1,!0));i._setVisible(Zo,!!t,!0),y(this,wr,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=l(this,xe).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}y(this,wr,null)}get hasInitialVisibility(){return l(this,Hl)===null||this.getHash()===l(this,Hl)}getOrder(){return l(this,xe).size?l(this,Vl)?l(this,Vl).slice():[...l(this,xe).keys()]:null}getGroups(){return l(this,xe).size>0?Bv(l(this,xe)):null}getGroup(e){return l(this,xe).get(e)||null}getHash(){if(l(this,wr)!==null)return l(this,wr);const e=new yS;for(const[t,s]of l(this,xe))e.update(`${t}:${s.visible}`);return y(this,wr,e.hexdigest())}}wr=new WeakMap,xe=new WeakMap,Hl=new WeakMap,Vl=new WeakMap,Fd=new WeakSet,ey=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let a;if(Array.isArray(r))a=_(this,Fd,ey).call(this,r);else if(l(this,xe).has(r))a=l(this,xe).get(r).visible;else return ne(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class Wj{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Je(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});Je(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Je(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new qj(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Gj(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class qj{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=Hv(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Gj{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Xj(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=c(h),h=u(h),r(h)}if(t=a(n),t){const h=u(t);return r(h)}if(t=s("filename","i").exec(n),t){t=t[1];let h=o(t);return h=u(h),r(h)}function s(h,f){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function i(h,f){if(h){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(h,{fatal:!0}),m=Am(f);f=p.decode(m),e=!1}catch{}}return f}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=i("utf-8",h),e&&(h=i("iso-8859-1",h))),h}function a(h){const f=[];let p;const m=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=m.exec(h))!==null;){let[,b,E,x]=p;if(b=parseInt(b,10),b in f){if(b===0)break;continue}f[b]=[E,x]}const g=[];for(let b=0;b<f.length&&b in f;++b){let[E,x]=f[b];x=o(x),E&&(x=unescape(x),b===0&&(x=c(x))),g.push(x)}return g.join("")}function o(h){if(h.startsWith('"')){const f=h.slice(1).split('\\"');for(let p=0;p<f.length;++p){const m=f[p].indexOf('"');m!==-1&&(f[p]=f[p].slice(0,m),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}h=f.join('"')}return h}function c(h){const f=h.indexOf("'");if(f===-1)return h;const p=h.slice(0,f),g=h.slice(f+1).replace(/^[^']*'/,"");return i(p,g)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,m,g){if(m==="q"||m==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,E){return String.fromCharCode(parseInt(E,16))}),i(p,g);try{g=atob(g)}catch{}return i(p,g)})}return""}function PS(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function Nm(n){try{return new URL(n).origin}catch{}return null}function RS({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function IS(n){const e=n.get("Content-Disposition");if(e){let t=Xj(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Hv(t))return t}return null}function Cm(n,e){return n===404||n===0&&e.startsWith("file:")?new td('Missing PDF "'+e+'".'):new Np(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function LS(n){return n===200||n===206}function MS(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function DS(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ne(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class Gb{constructor(e){K(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=PS(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Je(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Kj(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Yj(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class Kj{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,MS(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Nm(r.url),!LS(r.status))throw Cm(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:c}=RS({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=c||this._contentLength,this._filename=IS(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Jr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:DS(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class Yj{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const a=i.url;fetch(a,MS(r,this._withCredentials,this._abortController)).then(o=>{const c=Nm(o.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!LS(o.status))throw Cm(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:DS(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const gg=200,yg=206;function Qj(n){const e=n.response;return typeof e!="string"?e:Am(e).buffer}class Jj{constructor({url:e,httpHeaders:t,withCredentials:s}){K(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=PS(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=yg):i.expectedStatus=gg,t.responseType="arraybuffer",Je(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||gg;if(!(r===gg&&s.expectedStatus===yg)&&r!==s.expectedStatus){s.onError(i.status);return}const o=Qj(i);if(r===yg){const c=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:o}):(ne('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class Zj{constructor(e){this._source=e,this._manager=new Jj(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Je(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new e2(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new t2(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class e2{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Nm(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[c,...u]=o.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=RS({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=IS(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Cm(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class t2{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Nm((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Cm(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const s2=/^[a-z][a-z0-9\-+.]+:/i;function n2(n){if(s2.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class i2{constructor(e){this.source=e,this.url=n2(e.url),Je(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Je(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new r2(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new a2(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class r2{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new td(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Jr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class a2{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const o2=1e5,ts=30,l2=.8;var Qb,_r,rs,$d,Bd,Wa,Ai,Ud,zd,qa,Wl,ql,Sr,Gl,Hd,Xl,Ga,Vd,Wd,Xa,Ka,qd,Ar,Kl,Qi,OS,FS,ty,Ds,Df,sy,$S,BS;const nt=class nt{constructor({textContentSource:e,container:t,viewport:s}){w(this,Qi);w(this,_r,Promise.withResolvers());w(this,rs,null);w(this,$d,!1);w(this,Bd,!!((Qb=globalThis.FontInspector)!=null&&Qb.enabled));w(this,Wa,null);w(this,Ai,null);w(this,Ud,0);w(this,zd,0);w(this,qa,null);w(this,Wl,null);w(this,ql,0);w(this,Sr,0);w(this,Gl,Object.create(null));w(this,Hd,[]);w(this,Xl,null);w(this,Ga,[]);w(this,Vd,new WeakMap);w(this,Wd,null);var c;if(e instanceof ReadableStream)y(this,Xl,e);else if(typeof e=="object")y(this,Xl,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');y(this,rs,y(this,Wl,t)),y(this,Sr,s.scale*(globalThis.devicePixelRatio||1)),y(this,ql,s.rotation),y(this,Ai,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:a,pageY:o}=s.rawDims;y(this,Wd,[1,0,0,-1,-a,o+r]),y(this,zd,i),y(this,Ud,r),_(c=nt,Ds,$S).call(c),Lo(t,s),l(this,_r).promise.finally(()=>{l(nt,Kl).delete(this),y(this,Ai,null),y(this,Gl,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Yt.platform;return ae(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{l(this,qa).read().then(({value:t,done:s})=>{if(s){l(this,_r).resolve();return}l(this,Wa)??y(this,Wa,t.lang),Object.assign(l(this,Gl),t.styles),_(this,Qi,OS).call(this,t.items),e()},l(this,_r).reject)};return y(this,qa,l(this,Xl).getReader()),l(nt,Kl).add(this),e(),l(this,_r).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==l(this,ql)&&(t==null||t(),y(this,ql,i),Lo(l(this,Wl),{rotation:i})),s!==l(this,Sr)){t==null||t(),y(this,Sr,s);const a={div:null,properties:null,ctx:_(r=nt,Ds,Df).call(r,l(this,Wa))};for(const o of l(this,Ga))a.properties=l(this,Vd).get(o),a.div=o,_(this,Qi,ty).call(this,a)}}cancel(){var t;const e=new Jr("TextLayer task cancelled.");(t=l(this,qa))==null||t.cancel(e).catch(()=>{}),y(this,qa,null),l(this,_r).reject(e)}get textDivs(){return l(this,Ga)}get textContentItemsStr(){return l(this,Hd)}static cleanup(){if(!(l(this,Kl).size>0)){l(this,Xa).clear();for(const{canvas:e}of l(this,Ka).values())e.remove();l(this,Ka).clear()}}};_r=new WeakMap,rs=new WeakMap,$d=new WeakMap,Bd=new WeakMap,Wa=new WeakMap,Ai=new WeakMap,Ud=new WeakMap,zd=new WeakMap,qa=new WeakMap,Wl=new WeakMap,ql=new WeakMap,Sr=new WeakMap,Gl=new WeakMap,Hd=new WeakMap,Xl=new WeakMap,Ga=new WeakMap,Vd=new WeakMap,Wd=new WeakMap,Xa=new WeakMap,Ka=new WeakMap,qd=new WeakMap,Ar=new WeakMap,Kl=new WeakMap,Qi=new WeakSet,OS=function(e){var i,r;if(l(this,$d))return;(r=l(this,Ai)).ctx??(r.ctx=_(i=nt,Ds,Df).call(i,l(this,Wa)));const t=l(this,Ga),s=l(this,Hd);for(const a of e){if(t.length>o2){ne("Ignoring additional textDivs for performance reasons."),y(this,$d,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=l(this,rs);y(this,rs,document.createElement("span")),l(this,rs).classList.add("markedContent"),a.id!==null&&l(this,rs).setAttribute("id",`${a.id}`),o.append(l(this,rs))}else a.type==="endMarkedContent"&&y(this,rs,l(this,rs).parentNode);continue}s.push(a.str),_(this,Qi,FS).call(this,a)}},FS=function(e){var b;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};l(this,Ga).push(t);const i=W.transform(l(this,Wd),e.transform);let r=Math.atan2(i[1],i[0]);const a=l(this,Gl)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=l(this,Bd)&&a.fontSubstitution||a.fontFamily;o=nt.fontFamilyMap.get(o)||o;const c=Math.hypot(i[2],i[3]),u=c*_(b=nt,Ds,BS).call(b,o,l(this,Wa));let h,f;r===0?(h=i[4],f=i[5]-u):(h=i[4]+u*Math.sin(r),f=i[5]-u*Math.cos(r));const p="calc(var(--scale-factor)*",m=t.style;l(this,rs)===l(this,Wl)?(m.left=`${(100*h/l(this,zd)).toFixed(2)}%`,m.top=`${(100*f/l(this,Ud)).toFixed(2)}%`):(m.left=`${p}${h.toFixed(2)}px)`,m.top=`${p}${f.toFixed(2)}px)`),m.fontSize=`${p}${(l(nt,Ar)*c).toFixed(2)}px)`,m.fontFamily=o,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,l(this,Bd)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const E=Math.abs(e.transform[0]),x=Math.abs(e.transform[3]);E!==x&&Math.max(E,x)/Math.min(E,x)>1.5&&(g=!0)}if(g&&(s.canvasWidth=a.vertical?e.height:e.width),l(this,Vd).set(t,s),l(this,Ai).div=t,l(this,Ai).properties=s,_(this,Qi,ty).call(this,l(this,Ai)),s.hasText&&l(this,rs).append(t),s.hasEOL){const E=document.createElement("br");E.setAttribute("role","presentation"),l(this,rs).append(E)}},ty=function(e){var o;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let a="";if(l(nt,Ar)>1&&(a=`scale(${1/l(nt,Ar)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:h}=s;_(o=nt,Ds,sy).call(o,i,h*l(this,Sr),c);const{width:f}=i.measureText(t.textContent);f>0&&(a=`scaleX(${u*l(this,Sr)/f}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)},Ds=new WeakSet,Df=function(e=null){let t=l(this,Ka).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,Ka).set(e,t),l(this,qd).set(t,{size:0,family:""})}return t},sy=function(e,t,s){const i=l(this,qd).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},$S=function(){if(l(this,Ar)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),y(this,Ar,e.getBoundingClientRect().height),e.remove()},BS=function(e,t){const s=l(this,Xa).get(e);if(s)return s;const i=_(this,Ds,Df).call(this,t);i.canvas.width=i.canvas.height=ts,_(this,Ds,sy).call(this,i,ts,e);const r=i.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const h=a/(a+o);return l(this,Xa).set(e,h),i.canvas.width=i.canvas.height=0,h}i.strokeStyle="red",i.clearRect(0,0,ts,ts),i.strokeText("g",0,0);let c=i.getImageData(0,0,ts,ts).data;o=0;for(let h=c.length-1-3;h>=0;h-=4)if(c[h]>0){o=Math.ceil(h/4/ts);break}i.clearRect(0,0,ts,ts),i.strokeText("A",0,ts),c=i.getImageData(0,0,ts,ts).data,a=0;for(let h=0,f=c.length;h<f;h+=4)if(c[h]>0){a=ts-Math.floor(h/4/ts);break}i.canvas.width=i.canvas.height=0;const u=a?a/(a+o):l2;return l(this,Xa).set(e,u),u},w(nt,Ds),w(nt,Xa,new Map),w(nt,Ka,new Map),w(nt,qd,new WeakMap),w(nt,Ar,null),w(nt,Kl,new Set);let sd=nt;class nd{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var c;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(nd.shouldBuildText(o))(c=r==null?void 0:r.attributes)!=null&&c.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const c2=65536,u2=100,d2=5e3,h2=$t?kj:Sj,f2=$t?Nj:ES,p2=$t?Ej:Aj,m2=$t?Cj:TS;function g2(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new ny,{docId:t}=e,s=n.url?y2(n.url):null,i=n.data?v2(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,c=n.range instanceof US?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:c2;let h=n.worker instanceof Al?n.worker:null;const f=n.verbosity,p=typeof n.docBaseUrl=="string"&&!km(n.docBaseUrl)?n.docBaseUrl:null,m=typeof n.cMapUrl=="string"?n.cMapUrl:null,g=n.cMapPacked!==!1,b=n.CMapReaderFactory||f2,E=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,x=n.StandardFontDataFactory||m2,v=n.stopAtErrors!==!0,S=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,A=n.isEvalSupported!==!1,C=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!$t,N=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!$t&&(Yt.platform.isFirefox||!globalThis.chrome),k=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,j=typeof n.disableFontFace=="boolean"?n.disableFontFace:$t,I=n.fontExtraProperties===!0,R=n.enableXfa===!0,U=n.ownerDocument||globalThis.document,H=n.disableRange===!0,J=n.disableStream===!0,de=n.disableAutoFetch===!0,et=n.pdfBug===!0,O=n.CanvasFactory||h2,q=n.FilterFactory||p2,M=n.enableHWA===!0,G=c?c.length:n.length??NaN,X=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!$t&&!j,ue=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:b===ES&&x===TS&&m&&E&&ou(m,document.baseURI)&&ou(E,document.baseURI),oe=null;tj(f);const Ae={canvasFactory:new O({ownerDocument:U,enableHWA:M}),filterFactory:new q({docId:t,ownerDocument:U}),cMapReaderFactory:ue?null:new b({baseUrl:m,isCompressed:g}),standardFontDataFactory:ue?null:new x({baseUrl:E})};if(!h){const Pe={verbosity:f,port:Bi.workerPort};h=Pe.port?Al.fromPort(Pe):new Al(Pe),e._worker=h}const Nt={docId:t,apiVersion:"4.10.38",data:i,password:o,disableAutoFetch:de,rangeChunkSize:u,length:G,docBaseUrl:p,enableXfa:R,evaluatorOptions:{maxImageSize:S,disableFontFace:j,ignoreErrors:v,isEvalSupported:A,isOffscreenCanvasSupported:C,isImageDecoderSupported:N,canvasMaxAreaInBytes:k,fontExtraProperties:I,useSystemFonts:X,cMapUrl:ue?m:null,standardFontDataUrl:ue?E:null}},rn={disableFontFace:j,fontExtraProperties:I,ownerDocument:U,pdfBug:et,styleElement:oe,loadingParams:{disableAutoFetch:de,enableXfa:R}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Pe=h.messageHandler.sendWithPromise("GetDocRequest",Nt,i?[i.buffer]:null);let me;if(c)me=new Wj(c,{disableRange:H,disableStream:J});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");let ps;if($t)if(ou(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");ps=Gb}else ps=i2;else ps=ou(s)?Gb:Zj;me=new ps({url:s,length:G,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:H,disableStream:J})}return Pe.then(ps=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Bh=new du(t,ps,h.port),T=new _2(Bh,e,me,rn,Ae);e._transport=T,Bh.send("Ready",null)})}).catch(e._capability.reject),e}function y2(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if($t&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function v2(n){if($t&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Am(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Xb(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var Hp;const Vp=class Vp{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ut(Vp,Hp)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};Hp=new WeakMap,w(Vp,Hp,0);let ny=Vp;class US{constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Se("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class x2{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ae(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Er,Ei,Ys,el,Of;class b2{constructor(e,t,s,i=!1){w(this,Ys);w(this,Er,null);w(this,Ei,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new Lb:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new zS,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new Oh({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ae(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=lr.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:f=!1}){var A,C;(A=this._stats)==null||A.time("Overall");const p=this._transport.getRenderingIntent(s,i,h,f),{renderingIntent:m,cacheKey:g}=p;y(this,Ei,!1),_(this,Ys,Of).call(this),o||(o=this._transport.getOptionalContentConfig(m));let b=this._intentStates.get(g);b||(b=Object.create(null),this._intentStates.set(g,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const E=!!(m&Ts.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(p));const x=N=>{var k;b.renderTasks.delete(v),(this._maybeCleanupAfterRender||E)&&y(this,Ei,!0),_(this,Ys,el).call(this,!E),N?(v.capability.reject(N),this._abortOperatorList({intentState:b,reason:N instanceof Error?N:new Error(N)})):v.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(k=globalThis.Stats)!=null&&k.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},v=new ry({callback:x,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:u});(b.renderTasks||(b.renderTasks=new Set)).add(v);const S=v.task;return Promise.all([b.displayReadyCapability.promise,o]).then(([N,k])=>{var j;if(this.destroyed){x();return}if((j=this._stats)==null||j.time("Rendering"),!(k.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");v.initializeGraphics({transparency:N,optionalContentConfig:k}),v.operatorListChanged()}).catch(x),S}getOperatorList({intent:e="display",annotationMode:t=lr.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(e,t,s,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let c;return o.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(c),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>nd.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){a.read().then(function({value:c,done:u}){if(u){s(o);return}o.lang??(o.lang=c.lang),Object.assign(o.styles,c.styles),o.items.push(...c.items),r()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),y(this,Ei,!1),_(this,Ys,Of).call(this),Promise.all(e)}cleanup(e=!1){y(this,Ei,!0);const t=_(this,Ys,el).call(this,!1);return e&&t&&this._stats&&(this._stats=new Lb),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&_(this,Ys,el).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:a}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),u=this._intentStates.get(t);u.streamReader=c;const h=()=>{c.read().then(({value:f,done:p})=>{if(p){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,u),h())},f=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const p of u.renderTasks)p.operatorListChanged();_(this,Ys,el).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(f);else if(u.opListReadCapability)u.opListReadCapability.reject(f);else throw f}})};h()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof zv){let i=u2;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Jr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Er=new WeakMap,Ei=new WeakMap,Ys=new WeakSet,el=function(e=!1){if(_(this,Ys,Of).call(this),!l(this,Ei)||this.destroyed)return!1;if(e)return y(this,Er,setTimeout(()=>{y(this,Er,null),_(this,Ys,el).call(this,!1)},d2)),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),y(this,Ei,!1),!0},Of=function(){l(this,Er)&&(clearTimeout(l(this,Er)),y(this,Er,null))};var ki,Wp;class w2{constructor(){w(this,ki,new Map);w(this,Wp,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};l(this,Wp).then(()=>{for(const[i]of l(this,ki))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){ne("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}l(this,ki).set(t,i)}removeEventListener(e,t){const s=l(this,ki).get(t);s==null||s(),l(this,ki).delete(t)}terminate(){for(const[,e]of l(this,ki))e==null||e();l(this,ki).clear()}}ki=new WeakMap,Wp=new WeakMap;var qp,Ya,Qa,Yl,Ff,Ql,$f;const Re=class Re{constructor({name:e=null,port:t=null,verbosity:s=sj()}={}){w(this,Yl);var i;if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=l(Re,Qa))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(l(Re,Qa)||y(Re,Qa,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new du("main","worker",e),this._messageHandler.on("ready",function(){}),_(this,Yl,Ff).call(this)}_initialize(){if(l(Re,Ya)||l(Re,Ql,$f)){this._setupFakeWorker();return}let{workerSrc:e}=Re;try{Re._isSameOrigin(window.location.href,e)||(e=Re._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new du("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:r.signal}),s.on("test",o=>{if(r.abort(),this.destroyed||!o){i();return}this._messageHandler=s,this._port=t,this._webWorker=t,_(this,Yl,Ff).call(this)}),s.on("ready",o=>{if(r.abort(),this.destroyed){i();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{Sm("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){l(Re,Ya)||(ne("Setting up fake worker."),y(Re,Ya,!0)),Re._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new w2;this._port=t;const s=`fake${Ut(Re,qp)._++}`,i=new du(s+"_worker",s,t);e.setup(i,t),this._messageHandler=new du(s,s+"_worker",t),_(this,Yl,Ff).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,s;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=l(Re,Qa))==null||t.delete(this._port),this._port=null,(s=this._messageHandler)==null||s.destroy(),this._messageHandler=null}static fromPort(e){var s;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(s=l(this,Qa))==null?void 0:s.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Re(e)}static get workerSrc(){if(Bi.workerSrc)return Bi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ae(this,"_setupFakeWorkerGlobal",(async()=>l(this,Ql,$f)?l(this,Ql,$f):(await import(this.workerSrc)).WorkerMessageHandler)())}};qp=new WeakMap,Ya=new WeakMap,Qa=new WeakMap,Yl=new WeakSet,Ff=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Ql=new WeakSet,$f=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},w(Re,Ql),w(Re,qp,0),w(Re,Ya,!1),w(Re,Qa),$t&&(y(Re,Ya,!0),Bi.workerSrc||(Bi.workerSrc="./pdf.worker.mjs")),Re._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const i=new URL(t,s);return s.origin===i.origin},Re._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let Al=Re;var Ni,Xn,Jl,Zl,Ci,Ja,gu;class _2{constructor(e,t,s,i,r){w(this,Ja);w(this,Ni,new Map);w(this,Xn,new Map);w(this,Jl,new Map);w(this,Zl,new Map);w(this,Ci,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new zS,this.fontLoader=new wj({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ae(this,"annotationStorage",new qv)}getRenderingIntent(e,t=lr.ENABLE,s=null,i=!1,r=!1){let a=Ts.DISPLAY,o=q0;switch(e){case"any":a=Ts.ANY;break;case"display":break;case"print":a=Ts.PRINT;break;default:ne(`getRenderingIntent - invalid intent: ${e}`)}const c=a&Ts.PRINT&&s instanceof xS?s:this.annotationStorage;switch(t){case lr.DISABLE:a+=Ts.ANNOTATIONS_DISABLE;break;case lr.ENABLE:break;case lr.ENABLE_FORMS:a+=Ts.ANNOTATIONS_FORMS;break;case lr.ENABLE_STORAGE:a+=Ts.ANNOTATIONS_STORAGE,o=c.serializable;break;default:ne(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=Ts.IS_EDITING),r&&(a+=Ts.OPLIST);const{ids:u,hash:h}=c.modifiedIds,f=[a,o.hash,h];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,Ci))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of l(this,Xn).values())e.push(i._destroy());l(this,Xn).clear(),l(this,Jl).clear(),l(this,Zl).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,Ni).clear(),this.filterFactory.destroy(),sd.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Jr("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Je(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){i.close();return}Je(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,i)=>{Je(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){i.close();return}Je(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{r.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new x2(s,this))}),e.on("DocException",s=>{t._capability.reject(ss(s))}),e.on("PasswordRequest",s=>{y(this,Ci,Promise.withResolvers());try{if(!t.onPassword)throw ss(s);const i=r=>{r instanceof Error?l(this,Ci).reject(r):l(this,Ci).resolve({password:r})};t.onPassword(i,s.code)}catch(i){l(this,Ci).reject(i)}return l(this,Ci).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,Xn).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":const{disableFontFace:o,fontExtraProperties:c,pdfBug:u}=this._params;if("error"in r){const m=r.error;ne(`Error during font loading: ${m}`),this.commonObjs.resolve(s,m);break}const h=u&&((a=globalThis.FontInspector)!=null&&a.enabled)?(m,g)=>globalThis.FontInspector.fontAdded(m,g):null,f=new _j(r,{disableFontFace:o,fontExtraProperties:c,inspectFont:h});this.fontLoader.bind(f).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c&&f.data&&(f.data=null),this.commonObjs.resolve(s,f)});break;case"CopyLocalImage":const{imageRef:p}=r;Je(p,"The imageRef must be defined.");for(const m of l(this,Xn).values())for(const[,g]of m.objs)if((g==null?void 0:g.ref)===p)return g.dataLen?(this.commonObjs.resolve(s,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,a])=>{var c;if(this.destroyed)return;const o=l(this,Xn).get(i);if(!o.objs.has(s)){if(o._intentStates.size===0){(c=a==null?void 0:a.bitmap)==null||c.close();return}switch(r){case"Image":o.objs.resolve(s,a),(a==null?void 0:a.dataLen)>QT&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=l(this,Jl).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,Zl).set(r.refStr,e);const a=new b2(t,r,this,this._params.pdfBug);return l(this,Xn).set(t,a),a});return l(this,Jl).set(t,i),i}getPageIndex(e){return Xb(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return _(this,Ja,gu).call(this,"GetFieldObjects")}hasJSActions(){return _(this,Ja,gu).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return _(this,Ja,gu).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return _(this,Ja,gu).call(this,"GetOptionalContentConfig").then(t=>new Vj(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=l(this,Ni).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,a;return{info:i[0],metadata:i[1]?new zj(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return l(this,Ni).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of l(this,Xn).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),l(this,Ni).clear(),this.filterFactory.destroy(!0),sd.cleanup()}}cachedPageNumber(e){if(!Xb(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return l(this,Zl).get(t)??null}}Ni=new WeakMap,Xn=new WeakMap,Jl=new WeakMap,Zl=new WeakMap,Ci=new WeakMap,Ja=new WeakSet,gu=function(e,t=null){const s=l(this,Ni).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return l(this,Ni).set(e,i),i};const eu=Symbol("INITIAL_DATA");var bs,Gd,iy;class zS{constructor(){w(this,Gd);w(this,bs,Object.create(null))}get(e,t=null){if(t){const i=_(this,Gd,iy).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=l(this,bs)[e];if(!s||s.data===eu)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=l(this,bs)[e];return!!t&&t.data!==eu}delete(e){const t=l(this,bs)[e];return!t||t.data===eu?!1:(delete l(this,bs)[e],!0)}resolve(e,t=null){const s=_(this,Gd,iy).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in l(this,bs)){const{data:s}=l(this,bs)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}y(this,bs,Object.create(null))}*[Symbol.iterator](){for(const e in l(this,bs)){const{data:t}=l(this,bs)[e];t!==eu&&(yield[e,t])}}}bs=new WeakMap,Gd=new WeakSet,iy=function(e){var t;return(t=l(this,bs))[e]||(t[e]={...Promise.withResolvers(),data:eu})};var kr;class S2{constructor(e){w(this,kr,null);y(this,kr,e),this.onContinue=null}get promise(){return l(this,kr).capability.promise}cancel(e=0){l(this,kr).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=l(this,kr).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=l(this,kr);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}kr=new WeakMap;var Nr,Za;const ga=class ga{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:f=!1,pageColors:p=null}){w(this,Nr,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new S2(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,c;if(this.cancelled)return;if(this._canvas){if(l(ga,Za).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(ga,Za).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:a}=this.params;this.gfx=new Sl(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,Nr)&&(window.cancelAnimationFrame(l(this,Nr)),y(this,Nr,null)),l(ga,Za).delete(this._canvas),this.callback(e||new zv(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?y(this,Nr,window.requestAnimationFrame(()=>{y(this,Nr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(ga,Za).delete(this._canvas),this.callback())))}};Nr=new WeakMap,Za=new WeakMap,w(ga,Za,new WeakSet);let ry=ga;const A2="4.10.38",E2="f9bea397f";function Kb(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function tu(n){return Math.max(0,Math.min(255,255*n))}class Yb{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=tu(e),[e,e,e]}static G_HTML([e]){const t=Kb(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(tu)}static RGB_HTML(e){return`#${e.map(Kb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[tu(1-Math.min(1,e+i)),tu(1-Math.min(1,s+i)),tu(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,a=1-s,o=Math.min(i,r,a);return["CMYK",i,r,a,o]}}class k2{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Se("Abstract method `_createSVG` called.")}}class Xv extends k2{_createSVG(e){return document.createElementNS(oi,e)}}class HS{static setupStorage(e,t,s,i,r){const a=i.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const c=o.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[c,u]of Object.entries(a))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}o&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var f,p;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:s});const o=r!=="richText",c=e.div;if(c.append(a),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=m}o&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const m=document.createTextNode(i.value);a.append(m),o&&nd.shouldBuildText(i.name)&&u.push(m)}return{textDivs:u}}const h=[[i,-1,a]];for(;h.length>0;){const[m,g,b]=h.at(-1);if(g+1===m.children.length){h.pop();continue}const E=m.children[++h.at(-1)[1]];if(E===null)continue;const{name:x}=E;if(x==="#text"){const S=document.createTextNode(E.value);u.push(S),b.append(S);continue}const v=(f=E==null?void 0:E.attributes)!=null&&f.xmlns?document.createElementNS(E.attributes.xmlns,x):document.createElement(x);if(b.append(v),E.attributes&&this.setAttributes({html:v,element:E,storage:t,intent:r,linkService:s}),((p=E.children)==null?void 0:p.length)>0)h.push([E,-1,v]);else if(E.value){const S=document.createTextNode(E.value);o&&nd.shouldBuildText(x)&&u.push(S),v.append(S)}}for(const m of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const $h=1e3,N2=9,Do=new WeakSet;function Kr(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class C2{static create(e){switch(e.data.annotationType){case tt.LINK:return new VS(e);case tt.TEXT:return new T2(e);case tt.WIDGET:switch(e.data.fieldType){case"Tx":return new j2(e);case"Btn":return e.data.radioButton?new GS(e):e.data.checkBox?new R2(e):new I2(e);case"Ch":return new L2(e);case"Sig":return new P2(e)}return new Uo(e);case tt.POPUP:return new oy(e);case tt.FREETEXT:return new JS(e);case tt.LINE:return new D2(e);case tt.SQUARE:return new O2(e);case tt.CIRCLE:return new F2(e);case tt.POLYLINE:return new ZS(e);case tt.CARET:return new B2(e);case tt.INK:return new Kv(e);case tt.POLYGON:return new $2(e);case tt.HIGHLIGHT:return new eA(e);case tt.UNDERLINE:return new U2(e);case tt.SQUIGGLY:return new z2(e);case tt.STRIKEOUT:return new H2(e);case tt.STAMP:return new tA(e);case tt.FILEATTACHMENT:return new V2(e);default:return new Ke(e)}}}var eo,ec,tc,Xd,ay;const Zv=class Zv{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){w(this,Xd);w(this,eo,null);w(this,ec,!1);w(this,tc,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Zv._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;l(this,eo)||y(this,eo,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&_(this,Xd,ay).call(this,t),(s=l(this,tc))==null||s.popup.updateEdited(e)}resetEdited(){var e;l(this,eo)&&(_(this,Xd,ay).call(this,l(this,eo).rect),(e=l(this,tc))==null||e.popup.resetEdited(),y(this,eo,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Uo||(r.tabIndex=$h);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof oy){const{rotation:b}=t;return!t.hasOwnCanvas&&b!==0&&this.setRotation(b,r),r}const{width:o,height:c}=Kr(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const b=t.borderStyle.horizontalCornerRadius,E=t.borderStyle.verticalCornerRadius;if(b>0||E>0){const v=`calc(${b}px * var(--scale-factor)) / calc(${E}px * var(--scale-factor))`;a.borderRadius=v}else if(this instanceof GS){const v=`calc(${o}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;a.borderRadius=v}switch(t.borderStyle.style){case Jc.SOLID:a.borderStyle="solid";break;case Jc.DASHED:a.borderStyle="dashed";break;case Jc.BEVELED:ne("Unimplemented border style: beveled");break;case Jc.INSET:ne("Unimplemented border style: inset");break;case Jc.UNDERLINE:a.borderBottomStyle="solid";break}const x=t.borderColor||null;x?(y(this,ec,!0),a.borderColor=W.makeHexColor(x[0]|0,x[1]|0,x[2]|0)):a.borderWidth=0}const u=W.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:f,pageX:p,pageY:m}=i.rawDims;a.left=`${100*(u[0]-p)/h}%`,a.top=`${100*(u[1]-m)/f}%`;const{rotation:g}=t;return t.hasOwnCanvas||g===0?(a.width=`${100*o/h}%`,a.height=`${100*c/f}%`):this.setRotation(g,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims,{width:r,height:a}=Kr(this.data.rect);let o,c;e%180===0?(o=100*r/s,c=100*a/i):(o=100*a/s,c=100*r/i),t.style.width=`${o}%`,t.style.height=`${c}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],a=r[0],o=r.slice(1);i.target.style[s]=Yb[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:Yb[`${a}_rgb`](o)})};return ae(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const a=s[i];if(a){const o={detail:{[i]:r},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(b=>Math.fround(b));if(e.length===8){const[b,E,x,v]=e.subarray(2,6);if(i===b&&r===E&&t===x&&s===v)return}const{style:a}=this.container;let o;if(l(this,ec)){const{borderColor:b,borderWidth:E}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const c=i-t,u=r-s,{svgFactory:h}=this,f=h.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const p=h.createElement("defs");f.append(p);const m=h.createElement("clipPath"),g=`clippath_${this.data.id}`;m.setAttribute("id",g),m.setAttribute("clipPathUnits","objectBoundingBox"),p.append(m);for(let b=2,E=e.length;b<E;b+=8){const x=e[b],v=e[b+1],S=e[b+2],A=e[b+3],C=h.createElement("rect"),N=(S-t)/c,k=(r-v)/u,j=(x-S)/c,I=(v-A)/u;C.setAttribute("x",N),C.setAttribute("y",k),C.setAttribute("width",j),C.setAttribute("height",I),m.append(C),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${k}" width="${j}" height="${I}"/>`)}l(this,ec)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:e}=this,t=y(this,tc,new oy({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Se("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:a,exportValues:o}of i){if(r===-1||a===t)continue;const c=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!Do.has(u)){ne(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:c,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,a=i.getAttribute("data-element-id");a!==t&&Do.has(i)&&s.push({id:a,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};eo=new WeakMap,ec=new WeakMap,tc=new WeakMap,Xd=new WeakSet,ay=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}}}=this;s==null||s.splice(0,4,...e);const{width:u,height:h}=Kr(e);t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+c)/a}%`,i===0?(t.width=`${100*u/r}%`,t.height=`${100*h/a}%`):this.setRotation(i)};let Ke=Zv;var Ps,da,WS,qS;class VS extends Ke{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});w(this,Ps);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(_(this,Ps,WS).call(this,i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(_(this,Ps,qS).call(this,i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&_(this,Ps,da).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),_(this,Ps,da).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=i.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),_(this,Ps,da).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),_(this,Ps,da).call(this),!this._fieldObjects){ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var f;i==null||i();const{fields:r,refs:a,include:o}=s,c=[];if(r.length!==0||a.length!==0){const p=new Set(a);for(const m of r){const g=this._fieldObjects[m]||[];for(const{id:b}of g)p.add(b)}for(const m of Object.values(this._fieldObjects))for(const g of m)p.has(g.id)===o&&c.push(g)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const u=this.annotationStorage,h=[];for(const p of c){const{id:m}=p;switch(h.push(m),p.type){case"text":{const b=p.defaultValue||"";u.setValue(m,{value:b});break}case"checkbox":case"radiobutton":{const b=p.defaultValue===p.exportValues;u.setValue(m,{value:b});break}case"combobox":case"listbox":{const b=p.defaultValue||"";u.setValue(m,{value:b});break}default:continue}const g=document.querySelector(`[data-element-id="${m}"]`);if(g){if(!Do.has(g)){ne(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Ps=new WeakSet,da=function(){this.container.setAttribute("data-internal-link","")},WS=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},_(this,Ps,da).call(this)},qS=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),_(this,Ps,da).call(this)};class T2 extends Ke{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Uo extends Ke{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Yt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var o;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a)}}))})}_setEventListeners(e,t,s,i){var r,a,o;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,i),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":W.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||N2,r=e.style;let a;const o=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(u/(dg*i))||1,f=u/h;a=Math.min(i,c(f/dg))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,c(u/dg))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=W.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class j2 extends Uo{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let u=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Do.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=$h,this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",p=>{e.setValue(t,{value:p.target.value}),this.setPropertyOnSiblings(s,"value",p.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue??"";s.value=h.userValue=m,h.formattedValue=null});let f=p=>{const{formattedValue:m}=h;m!=null&&(p.target.value=m),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",m=>{var b;if(h.focused)return;const{target:g}=m;h.userValue&&(g.value=h.userValue),h.lastCommittedValue=g.value,h.commitKey=1,(b=this.data.actions)!=null&&b.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);const g={value(b){h.userValue=b.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),b.target.value=h.userValue},formattedValue(b){const{formattedValue:E}=b.detail;h.formattedValue=E,E!=null&&b.target!==document.activeElement&&(b.target.value=E),e.setValue(t,{formattedValue:E})},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var S;const{charLimit:E}=b.detail,{target:x}=b;if(E===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",E);let v=h.userValue;!v||v.length<=E||(v=v.slice(0,E),x.value=h.userValue=v,e.setValue(t,{value:v}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(g,m)}),s.addEventListener("keydown",m=>{var E;h.commitKey=1;let g=-1;if(m.key==="Escape"?g=0:m.key==="Enter"&&!this.data.multiLine?g=2:m.key==="Tab"&&(h.commitKey=3),g===-1)return;const{value:b}=m.target;h.lastCommittedValue!==b&&(h.lastCommittedValue=b,h.userValue=b,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:g,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});const p=f;f=null,s.addEventListener("blur",m=>{var b,E;if(!h.focused||!m.relatedTarget)return;(b=this.data.actions)!=null&&b.Blur||(h.focused=!1);const{value:g}=m.target;h.userValue=g,h.lastCommittedValue!==g&&((E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,willCommit:!0,commitKey:h.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}})),p(m)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",m=>{var C;h.lastCommittedValue=null;const{data:g,target:b}=m,{value:E,selectionStart:x,selectionEnd:v}=b;let S=x,A=v;switch(m.inputType){case"deleteWordBackward":{const N=E.substring(0,x).match(/\w*[^\w]*$/);N&&(S-=N[0].length);break}case"deleteWordForward":{const N=E.substring(x).match(/^[^\w]*\w*/);N&&(A+=N[0].length);break}case"deleteContentBackward":x===v&&(S-=1);break;case"deleteContentForward":x===v&&(A+=1);break}m.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,change:g||"",willCommit:!1,selStart:S,selEnd:A}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(f&&s.addEventListener("blur",f),this.data.comb){const m=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${m}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class P2 extends Uo{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class R2 extends Uo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Do.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=$h,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const u of this._getElementsByName(o,s)){const h=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class GS extends Uo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(Do.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=$h,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const u of this._getElementsByName(o,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const c={value:u=>{const h=a===u.detail.value;for(const f of this._getElementsByName(u.target.name)){const p=h&&f.id===s;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class I2 extends VS{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class L2 extends Uo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Do.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=$h;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",h=>{const f=this.data.defaultFieldValue;for(const p of i.options)p.selected=p.value===f});for(const h of this.data.options){const f=document.createElement("option");f.textContent=h.displayValue,f.value=h.exportValue,s.value.includes(h.exportValue)&&(f.setAttribute("selected",!0),r=!1),i.append(f)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),i.prepend(h),a=()=>{h.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=h=>{const f=h?"value":"textContent",{options:p,multiple:m}=i;return m?Array.prototype.filter.call(p,g=>g.selected).map(g=>g[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let c=o(!1);const u=h=>{const f=h.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",h=>{const f={value(p){a==null||a();const m=p.detail.value,g=new Set(Array.isArray(m)?m:[m]);for(const b of i.options)b.selected=g.has(b.value);e.setValue(t,{value:o(!0)}),c=o(!1)},multipleSelection(p){i.multiple=!0},remove(p){const m=i.options,g=p.detail.remove;m[g].selected=!1,i.remove(g),m.length>0&&Array.prototype.findIndex.call(m,E=>E.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:o(!0),items:u(p)}),c=o(!1)},clear(p){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=o(!1)},insert(p){const{index:m,displayValue:g,exportValue:b}=p.detail.insert,E=i.children[m],x=document.createElement("option");x.textContent=g,x.value=b,E?E.before(x):i.append(x),e.setValue(t,{value:o(!0),items:u(p)}),c=o(!1)},items(p){const{items:m}=p.detail;for(;i.length!==0;)i.remove(0);for(const g of m){const{displayValue:b,exportValue:E}=g,x=document.createElement("option");x.textContent=b,x.value=E,i.append(x)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(p)}),c=o(!1)},indices(p){const m=new Set(p.detail.indices);for(const g of p.target.options)g.selected=m.has(g.index);e.setValue(t,{value:o(!0)}),c=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,h)}),i.addEventListener("input",h=>{var m;const f=o(!0),p=o(!1);e.setValue(t,{value:f}),h.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):i.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class oy extends Ke{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Ke._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new M2({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${Uv}${s}`).join(",")),this.container}}var sc,Gp,Xp,nc,to,Ve,Ti,ic,Kd,Yd,rc,ji,mn,Pi,Qd,Ri,Jd,so,no,_e,Bf,ly,XS,KS,YS,QS,Uf,zf,cy;class M2{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:a,richText:o,parent:c,rect:u,parentRect:h,open:f}){w(this,_e);w(this,sc,_(this,_e,YS).bind(this));w(this,Gp,_(this,_e,cy).bind(this));w(this,Xp,_(this,_e,zf).bind(this));w(this,nc,_(this,_e,Uf).bind(this));w(this,to,null);w(this,Ve,null);w(this,Ti,null);w(this,ic,null);w(this,Kd,null);w(this,Yd,null);w(this,rc,null);w(this,ji,!1);w(this,mn,null);w(this,Pi,null);w(this,Qd,null);w(this,Ri,null);w(this,Jd,null);w(this,so,null);w(this,no,!1);var p;y(this,Ve,e),y(this,Jd,i),y(this,Ti,a),y(this,Ri,o),y(this,Yd,c),y(this,to,t),y(this,Qd,u),y(this,rc,h),y(this,Kd,s),y(this,ic,Vv.toDateObject(r)),this.trigger=s.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",l(this,nc)),m.addEventListener("mouseenter",l(this,Xp)),m.addEventListener("mouseleave",l(this,Gp)),m.classList.add("popupTriggerArea");for(const m of s)(p=m.container)==null||p.addEventListener("keydown",l(this,sc));l(this,Ve).hidden=!0,f&&_(this,_e,Uf).call(this)}render(){if(l(this,mn))return;const e=y(this,mn,document.createElement("div"));if(e.className="popup",l(this,to)){const r=e.style.outlineColor=W.makeHexColor(...l(this,to));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=W.makeHexColor(...l(this,to).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=l(this,Jd),e.append(t),l(this,ic)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,ic).valueOf()})),t.append(r)}const i=l(this,_e,Bf);if(i)HS.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,Ti));e.append(r)}l(this,Ve).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,a=i.length;r<a;++r){const o=i[r];s.append(document.createTextNode(o)),r<a-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;l(this,so)||y(this,so,{contentsObj:l(this,Ti),richText:l(this,Ri)}),e&&y(this,Pi,null),t&&(y(this,Ri,_(this,_e,KS).call(this,t)),y(this,Ti,null)),(s=l(this,mn))==null||s.remove(),y(this,mn,null)}resetEdited(){var e;l(this,so)&&({contentsObj:Ut(this,Ti)._,richText:Ut(this,Ri)._}=l(this,so),y(this,so,null),(e=l(this,mn))==null||e.remove(),y(this,mn,null),y(this,Pi,null))}forceHide(){y(this,no,this.isVisible),l(this,no)&&(l(this,Ve).hidden=!0)}maybeShow(){l(this,no)&&(l(this,mn)||_(this,_e,zf).call(this),y(this,no,!1),l(this,Ve).hidden=!1)}get isVisible(){return l(this,Ve).hidden===!1}}sc=new WeakMap,Gp=new WeakMap,Xp=new WeakMap,nc=new WeakMap,to=new WeakMap,Ve=new WeakMap,Ti=new WeakMap,ic=new WeakMap,Kd=new WeakMap,Yd=new WeakMap,rc=new WeakMap,ji=new WeakMap,mn=new WeakMap,Pi=new WeakMap,Qd=new WeakMap,Ri=new WeakMap,Jd=new WeakMap,so=new WeakMap,no=new WeakMap,_e=new WeakSet,Bf=function(){const e=l(this,Ri),t=l(this,Ti);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&l(this,Ri).html||null},ly=function(){var e,t,s;return((s=(t=(e=l(this,_e,Bf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},XS=function(){var e,t,s;return((s=(t=(e=l(this,_e,Bf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},KS=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:l(this,_e,XS),fontSize:l(this,_e,ly)?`calc(${l(this,_e,ly)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},YS=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&l(this,ji))&&_(this,_e,Uf).call(this)},QS=function(){if(l(this,Pi)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=l(this,Yd);let a=!!l(this,rc),o=a?l(this,rc):l(this,Qd);for(const g of l(this,Kd))if(!o||W.intersect(g.data.rect,o)!==null){o=g.data.rect,a=!0;break}const c=W.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,f=c[0]+h,p=c[1];y(this,Pi,[100*(f-i)/t,100*(p-r)/s]);const{style:m}=l(this,Ve);m.left=`${l(this,Pi)[0]}%`,m.top=`${l(this,Pi)[1]}%`},Uf=function(){y(this,ji,!l(this,ji)),l(this,ji)?(_(this,_e,zf).call(this),l(this,Ve).addEventListener("click",l(this,nc)),l(this,Ve).addEventListener("keydown",l(this,sc))):(_(this,_e,cy).call(this),l(this,Ve).removeEventListener("click",l(this,nc)),l(this,Ve).removeEventListener("keydown",l(this,sc)))},zf=function(){l(this,mn)||this.render(),this.isVisible?l(this,ji)&&l(this,Ve).classList.add("focused"):(_(this,_e,QS).call(this),l(this,Ve).hidden=!1,l(this,Ve).style.zIndex=parseInt(l(this,Ve).style.zIndex)+1e3)},cy=function(){l(this,Ve).classList.remove("focused"),!(l(this,ji)||!this.isVisible)&&(l(this,Ve).hidden=!0,l(this,Ve).style.zIndex=parseInt(l(this,Ve).style.zIndex)-1e3)};class JS extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=se.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Zd;class D2 extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});w(this,Zd,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:i}=Kr(t.rect),r=this.svgFactory.create(s,i,!0),a=y(this,Zd,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Zd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zd=new WeakMap;var eh;class O2 extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});w(this,eh,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:i}=Kr(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=y(this,eh,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",s-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,eh)}addHighlightArea(){this.container.classList.add("highlightArea")}}eh=new WeakMap;var th;class F2 extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});w(this,th,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:i}=Kr(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=y(this,th,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",i/2),o.setAttribute("rx",s/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,th)}addHighlightArea(){this.container.classList.add("highlightArea")}}th=new WeakMap;var sh;class ZS extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});w(this,sh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r}}=this;if(!s)return this.container;const{width:a,height:o}=Kr(t),c=this.svgFactory.create(a,o,!0);let u=[];for(let f=0,p=s.length;f<p;f+=2){const m=s[f]-t[0],g=t[3]-s[f+1];u.push(`${m},${g}`)}u=u.join(" ");const h=y(this,sh,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",i.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,sh)}addHighlightArea(){this.container.classList.add("highlightArea")}}sh=new WeakMap;class $2 extends ZS{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class B2 extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var nh,io,ih,uy;class Kv extends Ke{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});w(this,ih);w(this,nh,null);w(this,io,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?se.HIGHLIGHT:se.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:o,width:c,height:u}=_(this,ih,uy).call(this,s,t),h=this.svgFactory.create(c,u,!0),f=y(this,nh,this.svgFactory.createElement("svg:g"));h.append(f),f.setAttribute("stroke-width",r.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let p=0,m=i.length;p<m;p++){const g=this.svgFactory.createElement(this.svgElementName);l(this,io).push(g),g.setAttribute("points",i[p].join(",")),f.append(g)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,a=l(this,nh);if(s>=0&&a.setAttribute("stroke-width",s||1),i)for(let o=0,c=l(this,io).length;o<c;o++)l(this,io)[o].setAttribute("points",i[o].join(","));if(r){const{transform:o,width:c,height:u}=_(this,ih,uy).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return l(this,io)}addHighlightArea(){this.container.classList.add("highlightArea")}}nh=new WeakMap,io=new WeakMap,ih=new WeakSet,uy=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class eA extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=se.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class U2 extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class z2 extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class H2 extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class tA extends Ke{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=se.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var rh,ah,dy;class V2 extends Ke{constructor(t){var i;super(t,{isRenderable:!0});w(this,ah);w(this,rh,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",_(this,ah,dy).bind(this)),y(this,rh,i);const{isMac:r}=Yt.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&_(this,ah,dy).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return l(this,rh)}addHighlightArea(){this.container.classList.add("highlightArea")}}rh=new WeakMap,ah=new WeakSet,dy=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var oh,ro,ao,lh,Oo,sA,hy;class W2{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:o}){w(this,Oo);w(this,oh,null);w(this,ro,null);w(this,ao,new Map);w(this,lh,null);this.div=e,y(this,oh,t),y(this,ro,s),y(this,lh,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return l(this,ao).size>0}async render(e){var a;const{annotations:t}=e,s=this.div;Lo(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Xv,annotationStorage:e.annotationStorage||new qv,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const c=o.annotationType===tt.POPUP;if(c){const f=i.get(o.id);if(!f)continue;r.elements=f}else{const{width:f,height:p}=Kr(o.rect);if(f<=0||p<=0)continue}r.data=o;const u=C2.create(r);if(!u.isRenderable)continue;if(!c&&o.popupRef){const f=i.get(o.popupRef);f?f.push(u):i.set(o.popupRef,[u])}const h=u.render();o.hidden&&(h.style.visibility="hidden"),await _(this,Oo,sA).call(this,h,o.id),u._isEditable&&(l(this,ao).set(u.data.id,u),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(u))}_(this,Oo,hy).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Lo(t,{rotation:e.rotation}),_(this,Oo,hy).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(l(this,ao).values())}getEditableAnnotation(e){return l(this,ao).get(e)}}oh=new WeakMap,ro=new WeakMap,ao=new WeakMap,lh=new WeakMap,Oo=new WeakSet,sA=async function(e,t){var a,o;const s=e.firstChild||e,i=s.id=`${Uv}${t}`,r=await((a=l(this,lh))==null?void 0:a.getAriaAttributes(i));if(r)for(const[c,u]of r)s.setAttribute(c,u);this.div.append(e),(o=l(this,oh))==null||o.moveElementInDOM(this.div,e,s,!1)},hy=function(){if(!l(this,ro))return;const e=this.div;for(const[t,s]of l(this,ro)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:r}=i;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):i.append(s)}l(this,ro).clear()};const hf=/\r\n?|\n/g;var gn,ws,ch,oo,_s,Ze,nA,iA,rA,Hf,Wi,Vf,Wf,aA,py,oA;const ke=class ke extends Ue{constructor(t){super({...t,name:"freeTextEditor"});w(this,Ze);w(this,gn);w(this,ws,"");w(this,ch,`${this.id}-editor`);w(this,oo,null);w(this,_s);y(this,gn,t.color||ke._defaultColor||Ue._defaultLineColor),y(this,_s,t.fontSize||ke._defaultFontSize)}static get _keyboardManager(){const t=ke.prototype,s=a=>a.isEmpty(),i=Mo.TRANSLATE_SMALL,r=Mo.TRANSLATE_BIG;return ae(this,"_keyboardManager",new Fh([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){Ue.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case he.FREETEXT_SIZE:ke._defaultFontSize=s;break;case he.FREETEXT_COLOR:ke._defaultColor=s;break}}updateParams(t,s){switch(t){case he.FREETEXT_SIZE:_(this,Ze,nA).call(this,s);break;case he.FREETEXT_COLOR:_(this,Ze,iA).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[he.FREETEXT_SIZE,ke._defaultFontSize],[he.FREETEXT_COLOR,ke._defaultColor||Ue._defaultLineColor]]}get propertiesToUpdate(){return[[he.FREETEXT_SIZE,l(this,_s)],[he.FREETEXT_COLOR,l(this,gn)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-ke._internalPadding*t,-(ke._internalPadding+l(this,_s))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(se.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),y(this,oo,new AbortController);const t=this._uiManager.combinedSignal(l(this,oo));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,ch)),this._isDraggable=!0,(t=l(this,oo))==null||t.abort(),y(this,oo,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=l(this,ws),s=y(this,ws,_(this,Ze,rA).call(this).trimEnd());if(t===s)return;const i=r=>{if(y(this,ws,r),!r){this.remove();return}_(this,Ze,Wf).call(this),this._uiManager.rebuild(this),_(this,Ze,Hf).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),_(this,Ze,Hf).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){ke._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,ch)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${l(this,_s)}px * var(--scale-factor))`,i.color=l(this,gn),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Cp(this,this.div,["dblclick","keydown"]),this.width){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[h,f]=this.pageDimensions,[p,m]=this.pageTranslation;let g,b;switch(this.rotation){case 0:g=t+(o[0]-p)/h,b=s+this.height-(o[1]-m)/f;break;case 90:g=t+(o[0]-p)/h,b=s-(o[1]-m)/f,[c,u]=[u,-c];break;case 180:g=t-this.width+(o[0]-p)/h,b=s-(o[1]-m)/f,[c,u]=[-c,-u];break;case 270:g=t+(o[0]-p-this.height*f)/h,b=s+(o[1]-m-this.width*h)/f,[c,u]=[-u,c];break}this.setAt(g*r,b*a,c,u)}else this.setAt(t*r,s*a,this.width*r,this.height*a);_(this,Ze,Wf).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var g,b,E;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=_(g=ke,Wi,py).call(g,s.getData("text")||"").replaceAll(hf,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:u}=o,h=[],f=[];if(c.nodeType===Node.TEXT_NODE){const x=c.parentElement;if(f.push(c.nodeValue.slice(u).replaceAll(hf,"")),x!==this.editorDiv){let v=h;for(const S of this.editorDiv.childNodes){if(S===x){v=f;continue}v.push(_(b=ke,Wi,Vf).call(b,S))}}h.push(c.nodeValue.slice(0,u).replaceAll(hf,""))}else if(c===this.editorDiv){let x=h,v=0;for(const S of this.editorDiv.childNodes)v++===u&&(x=f),x.push(_(E=ke,Wi,Vf).call(E,S))}y(this,ws,`${h.join(`
`)}${r}${f.join(`
`)}`),_(this,Ze,Wf).call(this);const p=new Range;let m=h.reduce((x,v)=>x+v.length,0);for(const{firstChild:x}of this.editorDiv.childNodes)if(x.nodeType===Node.TEXT_NODE){const v=x.nodeValue.length;if(m<=v){p.setStart(x,m),p.setEnd(x,m);break}m-=v}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var o;let r=null;if(t instanceof JS){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:f,id:p,popupRef:m},textContent:g,textPosition:b,parent:{page:{pageNumber:E}}}=t;if(!g||g.length===0)return null;r=t={annotationType:se.FREETEXT,color:Array.from(u),fontSize:c,value:g.join(`
`),position:b,pageIndex:E-1,rect:h.slice(0),rotation:f,id:p,deleted:!1,popupRef:m}}const a=await super.deserialize(t,s,i);return y(a,_s,t.fontSize),y(a,gn,W.makeHexColor(...t.color)),y(a,ws,_(o=ke,Wi,py).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=r,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=ke._internalPadding*this.parentScale,i=this.getRect(s,s),r=Ue._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,gn)),a={annotationType:se.FREETEXT,color:r,fontSize:l(this,_s),value:_(this,Ze,aA).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!_(this,Ze,oA).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${l(this,_s)}px * var(--scale-factor))`,i.color=l(this,gn),s.replaceChildren();for(const a of l(this,ws).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),s.append(o)}const r=ke._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:l(this,ws)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};gn=new WeakMap,ws=new WeakMap,ch=new WeakMap,oo=new WeakMap,_s=new WeakMap,Ze=new WeakSet,nA=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-l(this,_s))*this.parentScale),y(this,_s,r),_(this,Ze,Hf).call(this)},i=l(this,_s);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:he.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},iA=function(t){const s=r=>{y(this,gn,this.editorDiv.style.color=r)},i=l(this,gn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:he.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},rA=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(_(i=ke,Wi,Vf).call(i,r)),s=r);return t.join(`
`)},Hf=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},Wi=new WeakSet,Vf=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(hf,"")},Wf=function(){if(this.editorDiv.replaceChildren(),!!l(this,ws))for(const t of l(this,ws).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},aA=function(){return l(this,ws).replaceAll(""," ")},py=function(t){return t.replaceAll(" ","")},oA=function(t){const{value:s,fontSize:i,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((o,c)=>o!==r[c])||t.pageIndex!==a},w(ke,Wi),K(ke,"_freeTextDefaultContent",""),K(ke,"_internalPadding",0),K(ke,"_defaultColor",null),K(ke,"_defaultFontSize",10),K(ke,"_type","freetext"),K(ke,"_editorType",se.FREETEXT);let fy=ke;class ${toSVGPath(){Se("Abstract method `toSVGPath` must be implemented.")}get box(){Se("Abstract getter `box` must be implemented.")}serialize(e,t){Se("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o]*i,a[o+1]=s+e[o+1]*r;return a}static _rescaleAndSwap(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o+1]*i,a[o+1]=s+e[o]*r;return a}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,a){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+a)/6,(s+r)/2,(i+a)/2]}}K($,"PRECISION",1e-4);var Ss,yn,ac,oc,Kn,re,lo,co,uh,dh,lc,cc,Cr,hh,Kp,Yp,ct,yu,lA,cA,uA,dA,hA,fA;const fi=class fi{constructor({x:e,y:t},s,i,r,a,o=0){w(this,ct);w(this,Ss);w(this,yn,[]);w(this,ac);w(this,oc);w(this,Kn,[]);w(this,re,new Float32Array(18));w(this,lo);w(this,co);w(this,uh);w(this,dh);w(this,lc);w(this,cc);w(this,Cr,[]);y(this,Ss,s),y(this,cc,r*i),y(this,oc,a),l(this,re).set([NaN,NaN,NaN,NaN,e,t],6),y(this,ac,o),y(this,dh,l(fi,hh)*i),y(this,uh,l(fi,Yp)*i),y(this,lc,i),l(this,Cr).push(e,t)}isEmpty(){return isNaN(l(this,re)[8])}add({x:e,y:t}){var I;y(this,lo,e),y(this,co,t);const[s,i,r,a]=l(this,Ss);let[o,c,u,h]=l(this,re).subarray(8,12);const f=e-u,p=t-h,m=Math.hypot(f,p);if(m<l(this,uh))return!1;const g=m-l(this,dh),b=g/m,E=b*f,x=b*p;let v=o,S=c;o=u,c=h,u+=E,h+=x,(I=l(this,Cr))==null||I.push(e,t);const A=-x/g,C=E/g,N=A*l(this,cc),k=C*l(this,cc);return l(this,re).set(l(this,re).subarray(2,8),0),l(this,re).set([u+N,h+k],4),l(this,re).set(l(this,re).subarray(14,18),12),l(this,re).set([u-N,h-k],16),isNaN(l(this,re)[6])?(l(this,Kn).length===0&&(l(this,re).set([o+N,c+k],2),l(this,Kn).push(NaN,NaN,NaN,NaN,(o+N-s)/r,(c+k-i)/a),l(this,re).set([o-N,c-k],14),l(this,yn).push(NaN,NaN,NaN,NaN,(o-N-s)/r,(c-k-i)/a)),l(this,re).set([v,S,o,c,u,h],6),!this.isEmpty()):(l(this,re).set([v,S,o,c,u,h],6),Math.abs(Math.atan2(S-c,v-o)-Math.atan2(x,E))<Math.PI/2?([o,c,u,h]=l(this,re).subarray(2,6),l(this,Kn).push(NaN,NaN,NaN,NaN,((o+u)/2-s)/r,((c+h)/2-i)/a),[o,c,v,S]=l(this,re).subarray(14,18),l(this,yn).push(NaN,NaN,NaN,NaN,((v+o)/2-s)/r,((S+c)/2-i)/a),!0):([v,S,o,c,u,h]=l(this,re).subarray(0,6),l(this,Kn).push(((v+5*o)/6-s)/r,((S+5*c)/6-i)/a,((5*o+u)/6-s)/r,((5*c+h)/6-i)/a,((o+u)/2-s)/r,((c+h)/2-i)/a),[u,h,o,c,v,S]=l(this,re).subarray(12,18),l(this,yn).push(((v+5*o)/6-s)/r,((S+5*c)/6-i)/a,((5*o+u)/6-s)/r,((5*c+h)/6-i)/a,((o+u)/2-s)/r,((c+h)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=l(this,Kn),t=l(this,yn);if(isNaN(l(this,re)[6])&&!this.isEmpty())return _(this,ct,lA).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);_(this,ct,uA).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return _(this,ct,cA).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,a){return new pA(e,t,s,i,r,a)}getOutlines(){var f;const e=l(this,Kn),t=l(this,yn),s=l(this,re),[i,r,a,o]=l(this,Ss),c=new Float32Array((((f=l(this,Cr))==null?void 0:f.length)??0)+2);for(let p=0,m=c.length-2;p<m;p+=2)c[p]=(l(this,Cr)[p]-i)/a,c[p+1]=(l(this,Cr)[p+1]-r)/o;if(c[c.length-2]=(l(this,lo)-i)/a,c[c.length-1]=(l(this,co)-r)/o,isNaN(s[6])&&!this.isEmpty())return _(this,ct,dA).call(this,c);const u=new Float32Array(l(this,Kn).length+24+l(this,yn).length);let h=e.length;for(let p=0;p<h;p+=2){if(isNaN(e[p])){u[p]=u[p+1]=NaN;continue}u[p]=e[p],u[p+1]=e[p+1]}h=_(this,ct,fA).call(this,u,h);for(let p=t.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(t[p+m])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[p+m],u[h+1]=t[p+m+1],h+=2}return _(this,ct,hA).call(this,u,h),this.newFreeDrawOutline(u,c,l(this,Ss),l(this,lc),l(this,ac),l(this,oc))}};Ss=new WeakMap,yn=new WeakMap,ac=new WeakMap,oc=new WeakMap,Kn=new WeakMap,re=new WeakMap,lo=new WeakMap,co=new WeakMap,uh=new WeakMap,dh=new WeakMap,lc=new WeakMap,cc=new WeakMap,Cr=new WeakMap,hh=new WeakMap,Kp=new WeakMap,Yp=new WeakMap,ct=new WeakSet,yu=function(){const e=l(this,re).subarray(4,6),t=l(this,re).subarray(16,18),[s,i,r,a]=l(this,Ss);return[(l(this,lo)+(e[0]-t[0])/2-s)/r,(l(this,co)+(e[1]-t[1])/2-i)/a,(l(this,lo)+(t[0]-e[0])/2-s)/r,(l(this,co)+(t[1]-e[1])/2-i)/a]},lA=function(){const[e,t,s,i]=l(this,Ss),[r,a,o,c]=_(this,ct,yu).call(this);return`M${(l(this,re)[2]-e)/s} ${(l(this,re)[3]-t)/i} L${(l(this,re)[4]-e)/s} ${(l(this,re)[5]-t)/i} L${r} ${a} L${o} ${c} L${(l(this,re)[16]-e)/s} ${(l(this,re)[17]-t)/i} L${(l(this,re)[14]-e)/s} ${(l(this,re)[15]-t)/i} Z`},cA=function(e){const t=l(this,yn);e.push(`L${t[4]} ${t[5]} Z`)},uA=function(e){const[t,s,i,r]=l(this,Ss),a=l(this,re).subarray(4,6),o=l(this,re).subarray(16,18),[c,u,h,f]=_(this,ct,yu).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-s)/r} L${c} ${u} L${h} ${f} L${(o[0]-t)/i} ${(o[1]-s)/r}`)},dA=function(e){const t=l(this,re),[s,i,r,a]=l(this,Ss),[o,c,u,h]=_(this,ct,yu).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(f,e,l(this,Ss),l(this,lc),l(this,ac),l(this,oc))},hA=function(e,t){const s=l(this,yn);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},fA=function(e,t){const s=l(this,re).subarray(4,6),i=l(this,re).subarray(16,18),[r,a,o,c]=l(this,Ss),[u,h,f,p]=_(this,ct,yu).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/c],t),t+=24},w(fi,hh,8),w(fi,Kp,2),w(fi,Yp,l(fi,hh)+l(fi,Kp));let Pp=fi;var uc,uo,Ii,fh,As,ph,Ge,Qp,mA;class pA extends ${constructor(t,s,i,r,a,o){super();w(this,Qp);w(this,uc);w(this,uo,new Float32Array(4));w(this,Ii);w(this,fh);w(this,As);w(this,ph);w(this,Ge);y(this,Ge,t),y(this,As,s),y(this,uc,i),y(this,ph,r),y(this,Ii,a),y(this,fh,o),this.lastPoint=[NaN,NaN],_(this,Qp,mA).call(this,o);const[c,u,h,f]=l(this,uo);for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-c)/h,t[p+1]=(t[p+1]-u)/f;for(let p=0,m=s.length;p<m;p+=2)s[p]=(s[p]-c)/h,s[p+1]=(s[p+1]-u)/f}toSVGPath(){const t=[`M${l(this,Ge)[4]} ${l(this,Ge)[5]}`];for(let s=6,i=l(this,Ge).length;s<i;s+=6){if(isNaN(l(this,Ge)[s])){t.push(`L${l(this,Ge)[s+4]} ${l(this,Ge)[s+5]}`);continue}t.push(`C${l(this,Ge)[s]} ${l(this,Ge)[s+1]} ${l(this,Ge)[s+2]} ${l(this,Ge)[s+3]} ${l(this,Ge)[s+4]} ${l(this,Ge)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],a){const o=i-t,c=r-s;let u,h;switch(a){case 0:u=$._rescale(l(this,Ge),t,r,o,-c),h=$._rescale(l(this,As),t,r,o,-c);break;case 90:u=$._rescaleAndSwap(l(this,Ge),t,s,o,c),h=$._rescaleAndSwap(l(this,As),t,s,o,c);break;case 180:u=$._rescale(l(this,Ge),i,s,-o,c),h=$._rescale(l(this,As),i,s,-o,c);break;case 270:u=$._rescaleAndSwap(l(this,Ge),i,r,-o,-c),h=$._rescaleAndSwap(l(this,As),i,r,-o,-c);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return l(this,uo)}newOutliner(t,s,i,r,a,o=0){return new Pp(t,s,i,r,a,o)}getNewOutline(t,s){const[i,r,a,o]=l(this,uo),[c,u,h,f]=l(this,uc),p=a*h,m=o*f,g=i*h+c,b=r*f+u,E=this.newOutliner({x:l(this,As)[0]*p+g,y:l(this,As)[1]*m+b},l(this,uc),l(this,ph),t,l(this,fh),s??l(this,Ii));for(let x=2;x<l(this,As).length;x+=2)E.add({x:l(this,As)[x]*p+g,y:l(this,As)[x+1]*m+b});return E.getOutlines()}}uc=new WeakMap,uo=new WeakMap,Ii=new WeakMap,fh=new WeakMap,As=new WeakMap,ph=new WeakMap,Ge=new WeakMap,Qp=new WeakSet,mA=function(t){const s=l(this,Ge);let i=s[4],r=s[5],a=i,o=r,c=i,u=r,h=i,f=r;const p=t?Math.max:Math.min;for(let g=6,b=s.length;g<b;g+=6){if(isNaN(s[g]))a=Math.min(a,s[g+4]),o=Math.min(o,s[g+5]),c=Math.max(c,s[g+4]),u=Math.max(u,s[g+5]),f<s[g+5]?(h=s[g+4],f=s[g+5]):f===s[g+5]&&(h=p(h,s[g+4]));else{const E=W.bezierBoundingBox(i,r,...s.slice(g,g+6));a=Math.min(a,E[0]),o=Math.min(o,E[1]),c=Math.max(c,E[2]),u=Math.max(u,E[3]),f<E[3]?(h=E[2],f=E[3]):f===E[3]&&(h=p(h,E[2]))}i=s[g+4],r=s[g+5]}const m=l(this,uo);m[0]=a-l(this,Ii),m[1]=o-l(this,Ii),m[2]=c-a+2*l(this,Ii),m[3]=u-o+2*l(this,Ii),this.lastPoint=[h,f]};var mh,gh,Tr,vn,Jt,gA,qf,yA,vA,gy;class my{constructor(e,t=0,s=0,i=!0){w(this,Jt);w(this,mh);w(this,gh);w(this,Tr,[]);w(this,vn,[]);let r=1/0,a=-1/0,o=1/0,c=-1/0;const h=10**-4;for(const{x,y:v,width:S,height:A}of e){const C=Math.floor((x-t)/h)*h,N=Math.ceil((x+S+t)/h)*h,k=Math.floor((v-t)/h)*h,j=Math.ceil((v+A+t)/h)*h,I=[C,k,j,!0],R=[N,k,j,!1];l(this,Tr).push(I,R),r=Math.min(r,C),a=Math.max(a,N),o=Math.min(o,k),c=Math.max(c,j)}const f=a-r+2*s,p=c-o+2*s,m=r-s,g=o-s,b=l(this,Tr).at(i?-1:-2),E=[b[0],b[2]];for(const x of l(this,Tr)){const[v,S,A]=x;x[0]=(v-m)/f,x[1]=(S-g)/p,x[2]=(A-g)/p}y(this,mh,new Float32Array([m,g,f,p])),y(this,gh,E)}getOutlines(){l(this,Tr).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of l(this,Tr))t[3]?(e.push(..._(this,Jt,gy).call(this,t)),_(this,Jt,yA).call(this,t)):(_(this,Jt,vA).call(this,t),e.push(..._(this,Jt,gy).call(this,t)));return _(this,Jt,gA).call(this,e)}}mh=new WeakMap,gh=new WeakMap,Tr=new WeakMap,vn=new WeakMap,Jt=new WeakSet,gA=function(e){const t=[],s=new Set;for(const a of e){const[o,c,u]=a;t.push([o,c,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const c=t[a][2],u=t[a+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const i=[];let r;for(;s.size>0;){const a=s.values().next().value;let[o,c,u,h,f]=a;s.delete(a);let p=o,m=c;for(r=[o,u],i.push(r);;){let g;if(s.has(h))g=h;else if(s.has(f))g=f;else break;s.delete(g),[o,c,u,h,f]=g,p!==o&&(r.push(p,m,o,m===c?c:u),p=o),m=m===c?u:c}r.push(p,m)}return new q2(i,l(this,mh),l(this,gh))},qf=function(e){const t=l(this,vn);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:i=r-1}return i+1},yA=function([,e,t]){const s=_(this,Jt,qf).call(this,e);l(this,vn).splice(s,0,[e,t])},vA=function([,e,t]){const s=_(this,Jt,qf).call(this,e);for(let i=s;i<l(this,vn).length;i++){const[r,a]=l(this,vn)[i];if(r!==e)break;if(r===e&&a===t){l(this,vn).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,a]=l(this,vn)[i];if(r!==e)break;if(r===e&&a===t){l(this,vn).splice(i,1);return}}},gy=function(e){const[t,s,i]=e,r=[[t,s,i]],a=_(this,Jt,qf).call(this,i);for(let o=0;o<a;o++){const[c,u]=l(this,vn)[o];for(let h=0,f=r.length;h<f;h++){const[,p,m]=r[h];if(!(u<=p||m<=c)){if(p>=c){if(m>u)r[h][1]=u;else{if(f===1)return[];r.splice(h,1),h--,f--}continue}r[h][2]=c,m>u&&r.push([t,u,m])}}}return r};var yh,dc;class q2 extends ${constructor(t,s,i){super();w(this,yh);w(this,dc);y(this,dc,t),y(this,yh,s),this.lastPoint=i}toSVGPath(){const t=[];for(const s of l(this,dc)){let[i,r]=s;t.push(`M${i} ${r}`);for(let a=2;a<s.length;a+=2){const o=s[a],c=s[a+1];o===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],a){const o=[],c=i-t,u=r-s;for(const h of l(this,dc)){const f=new Array(h.length);for(let p=0;p<h.length;p+=2)f[p]=t+h[p]*c,f[p+1]=r-h[p+1]*u;o.push(f)}return o}get box(){return l(this,yh)}get classNamesForOutlining(){return["highlightOutline"]}}yh=new WeakMap,dc=new WeakMap;class yy extends Pp{newFreeDrawOutline(e,t,s,i,r,a){return new G2(e,t,s,i,r,a)}}class G2 extends pA{newOutliner(e,t,s,i,r,a=0){return new yy(e,t,s,i,r,a)}}var xn,ho,hc,rt,vh,fc,xh,bh,jr,bn,pc,wh,we,vy,xy,by,ha,xA,sr;const ns=class ns{constructor({editor:e=null,uiManager:t=null}){w(this,we);w(this,xn,null);w(this,ho,null);w(this,hc);w(this,rt,null);w(this,vh,!1);w(this,fc,!1);w(this,xh,null);w(this,bh);w(this,jr,null);w(this,bn,null);w(this,pc);var s;e?(y(this,fc,!1),y(this,pc,he.HIGHLIGHT_COLOR),y(this,xh,e)):(y(this,fc,!0),y(this,pc,he.HIGHLIGHT_DEFAULT_COLOR)),y(this,bn,(e==null?void 0:e._uiManager)||t),y(this,bh,l(this,bn)._eventBus),y(this,hc,(e==null?void 0:e.color)||((s=l(this,bn))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),l(ns,wh)||y(ns,wh,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ae(this,"_keyboardManager",new Fh([[["Escape","mac+Escape"],ns.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ns.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ns.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ns.prototype._moveToPrevious],[["Home","mac+Home"],ns.prototype._moveToBeginning],[["End","mac+End"],ns.prototype._moveToEnd]]))}renderButton(){const e=y(this,xn,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=l(this,bn)._signal;e.addEventListener("click",_(this,we,ha).bind(this),{signal:t}),e.addEventListener("keydown",_(this,we,by).bind(this),{signal:t});const s=y(this,ho,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=l(this,hc),e.append(s),e}renderMainDropdown(){const e=y(this,rt,_(this,we,vy).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===l(this,xn)){_(this,we,ha).call(this,e);return}const t=e.target.getAttribute("data-color");t&&_(this,we,xy).call(this,t,e)}_moveToNext(e){var t,s;if(!l(this,we,sr)){_(this,we,ha).call(this,e);return}if(e.target===l(this,xn)){(t=l(this,rt).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=l(this,rt))==null?void 0:t.firstChild)||e.target===l(this,xn)){l(this,we,sr)&&this._hideDropdownFromKeyboard();return}l(this,we,sr)||_(this,we,ha).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!l(this,we,sr)){_(this,we,ha).call(this,e);return}(t=l(this,rt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!l(this,we,sr)){_(this,we,ha).call(this,e);return}(t=l(this,rt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=l(this,rt))==null||e.classList.add("hidden"),(t=l(this,jr))==null||t.abort(),y(this,jr,null)}_hideDropdownFromKeyboard(){var e;if(!l(this,fc)){if(!l(this,we,sr)){(e=l(this,xh))==null||e.unselect();return}this.hideDropdown(),l(this,xn).focus({preventScroll:!0,focusVisible:l(this,vh)})}}updateColor(e){if(l(this,ho)&&(l(this,ho).style.backgroundColor=e),!l(this,rt))return;const t=l(this,bn).highlightColors.values();for(const s of l(this,rt).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=l(this,xn))==null||e.remove(),y(this,xn,null),y(this,ho,null),(t=l(this,rt))==null||t.remove(),y(this,rt,null)}};xn=new WeakMap,ho=new WeakMap,hc=new WeakMap,rt=new WeakMap,vh=new WeakMap,fc=new WeakMap,xh=new WeakMap,bh=new WeakMap,jr=new WeakMap,bn=new WeakMap,pc=new WeakMap,wh=new WeakMap,we=new WeakSet,vy=function(){const e=document.createElement("div"),t=l(this,bn)._signal;e.addEventListener("contextmenu",jn,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of l(this,bn).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",l(ns,wh)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.setAttribute("aria-selected",i===l(this,hc)),r.addEventListener("click",_(this,we,xy).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",_(this,we,by).bind(this),{signal:t}),e},xy=function(e,t){t.stopPropagation(),l(this,bh).dispatch("switchannotationeditorparams",{source:this,type:l(this,pc),value:e})},by=function(e){ns._keyboardManager.exec(this,e)},ha=function(e){if(l(this,we,sr)){this.hideDropdown();return}if(y(this,vh,e.detail===0),l(this,jr)||(y(this,jr,new AbortController),window.addEventListener("pointerdown",_(this,we,xA).bind(this),{signal:l(this,bn).combinedSignal(l(this,jr))})),l(this,rt)){l(this,rt).classList.remove("hidden");return}const t=y(this,rt,_(this,we,vy).call(this));l(this,xn).append(t)},xA=function(e){var t;(t=l(this,rt))!=null&&t.contains(e.target)||this.hideDropdown()},sr=function(){return l(this,rt)&&!l(this,rt).classList.contains("hidden")},w(ns,wh,null);let Rp=ns;var mc,_h,Li,fo,gc,as,Sh,Ah,po,Vs,Es,bt,yc,Mi,Mt,vc,Ws,Eh,te,wy,Gf,bA,wA,_A,_y,fa,Qs,tl,SA,Xf,vu,AA,EA,kA,NA,CA;const ye=class ye extends Ue{constructor(t){super({...t,name:"highlightEditor"});w(this,te);w(this,mc,null);w(this,_h,0);w(this,Li);w(this,fo,null);w(this,gc,null);w(this,as,null);w(this,Sh,null);w(this,Ah,0);w(this,po,null);w(this,Vs,null);w(this,Es,null);w(this,bt,!1);w(this,yc,null);w(this,Mi);w(this,Mt,null);w(this,vc,"");w(this,Ws);w(this,Eh,"");this.color=t.color||ye._defaultColor,y(this,Ws,t.thickness||ye._defaultThickness),y(this,Mi,t.opacity||ye._defaultOpacity),y(this,Li,t.boxes||null),y(this,Eh,t.methodOfCreation||""),y(this,vc,t.text||""),this._isDraggable=!1,t.highlightId>-1?(y(this,bt,!0),_(this,te,Gf).call(this,t),_(this,te,fa).call(this)):l(this,Li)&&(y(this,mc,t.anchorNode),y(this,_h,t.anchorOffset),y(this,Sh,t.focusNode),y(this,Ah,t.focusOffset),_(this,te,wy).call(this),_(this,te,fa).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=ye.prototype;return ae(this,"_keyboardManager",new Fh([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,bt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,Ws),methodOfCreation:l(this,Eh)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;Ue.initialize(t,s),ye._defaultColor||(ye._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case he.HIGHLIGHT_DEFAULT_COLOR:ye._defaultColor=s;break;case he.HIGHLIGHT_THICKNESS:ye._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return l(this,yc)}updateParams(t,s){switch(t){case he.HIGHLIGHT_COLOR:_(this,te,bA).call(this,s);break;case he.HIGHLIGHT_THICKNESS:_(this,te,wA).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[he.HIGHLIGHT_DEFAULT_COLOR,ye._defaultColor],[he.HIGHLIGHT_THICKNESS,ye._defaultThickness]]}get propertiesToUpdate(){return[[he.HIGHLIGHT_COLOR,this.color||ye._defaultColor],[he.HIGHLIGHT_THICKNESS,l(this,Ws)||ye._defaultThickness],[he.HIGHLIGHT_FREE,l(this,bt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(y(this,gc,new Rp({editor:this})),t.addColorPicker(l(this,gc))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(_(this,te,vu).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,_(this,te,vu).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){_(this,te,_y).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(_(this,te,fa).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?_(this,te,_y).call(this):t&&(_(this,te,fa).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,a,o;const{drawLayer:s}=this.parent;let i;l(this,bt)?(t=(t-this.rotation+360)%360,i=_(r=ye,Qs,tl).call(r,l(this,Vs).box,t)):i=_(a=ye,Qs,tl).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(l(this,Es),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(l(this,Mt),{bbox:_(o=ye,Qs,tl).call(o,l(this,as).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();l(this,vc)&&(t.setAttribute("aria-label",l(this,vc)),t.setAttribute("role","mark")),l(this,bt)?t.classList.add("free"):this.div.addEventListener("keydown",_(this,te,SA).bind(this),{signal:this._uiManager._signal});const s=y(this,po,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,fo);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),Cp(this,l(this,po),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:_(this,te,Xf).call(this,!0);break;case 1:case 3:_(this,te,Xf).call(this,!1);break}}select(){var t;super.select(),l(this,Mt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),l(this,Mt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{selected:!1}}),l(this,bt)||_(this,te,Xf).call(this,!1))}get _mustFixPosition(){return!l(this,bt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(l(this,Es),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(l(this,Mt),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:a}){const{x:o,y:c,width:u,height:h}=i.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),m=g=>{f.abort(),_(this,Qs,NA).call(this,t,g)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",Is,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",jn,{signal:p}),i.addEventListener("pointermove",_(this,Qs,kA).bind(this,t),{signal:p}),this._freeHighlight=new yy({x:r,y:a},[o,c,u,h],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var b,E,x,v;let r=null;if(t instanceof eA){const{data:{quadPoints:S,rect:A,rotation:C,id:N,color:k,opacity:j,popupRef:I},parent:{page:{pageNumber:R}}}=t;r=t={annotationType:se.HIGHLIGHT,color:Array.from(k),opacity:j,quadPoints:S,boxes:null,pageIndex:R-1,rect:A.slice(0),rotation:C,id:N,deleted:!1,popupRef:I}}else if(t instanceof Kv){const{data:{inkLists:S,rect:A,rotation:C,id:N,color:k,borderStyle:{rawWidth:j},popupRef:I},parent:{page:{pageNumber:R}}}=t;r=t={annotationType:se.HIGHLIGHT,color:Array.from(k),thickness:j,inkLists:S,boxes:null,pageIndex:R-1,rect:A.slice(0),rotation:C,id:N,deleted:!1,popupRef:I}}const{color:a,quadPoints:o,inkLists:c,opacity:u}=t,h=await super.deserialize(t,s,i);h.color=W.makeHexColor(...a),y(h,Mi,u||1),c&&y(h,Ws,t.thickness),h.annotationElementId=t.id||null,h._initialData=r;const[f,p]=h.pageDimensions,[m,g]=h.pageTranslation;if(o){const S=y(h,Li,[]);for(let A=0;A<o.length;A+=8)S.push({x:(o[A]-m)/f,y:1-(o[A+1]-g)/p,width:(o[A+2]-o[A])/f,height:(o[A+1]-o[A+5])/p});_(b=h,te,wy).call(b),_(E=h,te,fa).call(E),h.rotate(h.rotation)}else if(c){y(h,bt,!0);const S=c[0],A={x:S[0]-m,y:p-(S[1]-g)},C=new yy(A,[0,0,f,p],1,l(h,Ws)/2,!0,.001);for(let j=0,I=S.length;j<I;j+=2)A.x=S[j]-m,A.y=p-(S[j+1]-g),C.add(A);const{id:N,clipPathId:k}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);_(x=h,te,Gf).call(x,{highlightOutlines:C.getOutlines(),highlightId:N,clipPathId:k}),_(v=h,te,fa).call(v)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=Ue._colorManager.convert(this.color),r={annotationType:se.HIGHLIGHT,color:i,opacity:l(this,Mi),thickness:l(this,Ws),quadPoints:_(this,te,AA).call(this),outlines:_(this,te,EA).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:_(this,te,vu).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!_(this,te,CA).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};mc=new WeakMap,_h=new WeakMap,Li=new WeakMap,fo=new WeakMap,gc=new WeakMap,as=new WeakMap,Sh=new WeakMap,Ah=new WeakMap,po=new WeakMap,Vs=new WeakMap,Es=new WeakMap,bt=new WeakMap,yc=new WeakMap,Mi=new WeakMap,Mt=new WeakMap,vc=new WeakMap,Ws=new WeakMap,Eh=new WeakMap,te=new WeakSet,wy=function(){const t=new my(l(this,Li),.001);y(this,Vs,t.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,Vs).box;const s=new my(l(this,Li),.0025,.001,this._uiManager.direction==="ltr");y(this,as,s.getOutlines());const{lastPoint:i}=l(this,as);y(this,yc,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Gf=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var f,p;if(y(this,Vs,t),y(this,as,t.getNewOutline(l(this,Ws)/2+1.5,.0025)),s>=0)y(this,Es,s),y(this,fo,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),y(this,Mt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,as).box,path:{d:l(this,as).toSVGPath()}},!0));else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,Es),{bbox:_(f=ye,Qs,tl).call(f,l(this,Vs).box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Mt),{bbox:_(p=ye,Qs,tl).call(p,l(this,as).box,m),path:{d:l(this,as).toSVGPath()}})}const[a,o,c,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=c,this.height=u;break;case 90:{const[m,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=c*g/m,this.height=u*m/g;break}case 180:this.x=1-a,this.y=1-o,this.width=c,this.height=u;break;case 270:{const[m,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=c*g/m,this.height=u*m/g;break}}const{lastPoint:h}=l(this,as);y(this,yc,[(h[0]-a)/c,(h[1]-o)/u])},bA=function(t){const s=(a,o)=>{var c,u;this.color=a,y(this,Mi,o),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,Es),{root:{fill:a,"fill-opacity":o}}),(u=l(this,gc))==null||u.updateColor(a)},i=this.color,r=l(this,Mi);this.addCommands({cmd:s.bind(this,t,ye._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:he.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},wA=function(t){const s=l(this,Ws),i=r=>{y(this,Ws,r),_(this,te,_A).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:he.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},_A=function(t){if(!l(this,bt))return;_(this,te,Gf).call(this,{highlightOutlines:l(this,Vs).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},_y=function(){l(this,Es)===null||!this.parent||(this.parent.drawLayer.remove(l(this,Es)),y(this,Es,null),this.parent.drawLayer.remove(l(this,Mt)),y(this,Mt,null))},fa=function(t=this.parent){l(this,Es)===null&&({id:Ut(this,Es)._,clipPathId:Ut(this,fo)._}=t.drawLayer.draw({bbox:l(this,Vs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,Mi)},rootClass:{highlight:!0,free:l(this,bt)},path:{d:l(this,Vs).toSVGPath()}},!1,!0),y(this,Mt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,bt)},bbox:l(this,as).box,path:{d:l(this,as).toSVGPath()}},l(this,bt))),l(this,po)&&(l(this,po).style.clipPath=l(this,fo)))},Qs=new WeakSet,tl=function([t,s,i,r],a){switch(a){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},SA=function(t){ye._keyboardManager.exec(this,t)},Xf=function(t){if(!l(this,mc))return;const s=window.getSelection();t?s.setPosition(l(this,mc),l(this,_h)):s.setPosition(l(this,Sh),l(this,Ah))},vu=function(){return l(this,bt)?this.rotation:0},AA=function(){if(l(this,bt))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,a=l(this,Li),o=new Float32Array(a.length*8);let c=0;for(const{x:u,y:h,width:f,height:p}of a){const m=u*t+i,g=(1-h)*s+r;o[c]=o[c+4]=m,o[c+1]=o[c+3]=g,o[c+2]=o[c+6]=m+f*t,o[c+5]=o[c+7]=g-p*s,c+=8}return o},EA=function(t){return l(this,Vs).serialize(t,_(this,te,vu).call(this))},kA=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},NA=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},CA=function(t){const{color:s}=this._initialData;return t.color.some((i,r)=>i!==s[r])},w(ye,Qs),K(ye,"_defaultColor",null),K(ye,"_defaultOpacity",1),K(ye,"_defaultThickness",12),K(ye,"_type","highlight"),K(ye,"_editorType",se.HIGHLIGHT),K(ye,"_freeHighlightId",-1),K(ye,"_freeHighlight",null),K(ye,"_freeHighlightClipId","");let Ip=ye;var mo;class X2{constructor(){w(this,mo,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){l(this,mo)[e]=t}toSVGProperties(){const e=l(this,mo);return y(this,mo,Object.create(null)),{root:e}}reset(){y(this,mo,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Se("Not implemented")}}mo=new WeakMap;var ks,xc,ft,go,yo,Pr,Rr,Ir,vo,pe,Ay,Ey,ky,xu,TA,Kf,bu,sl;const z=class z extends Ue{constructor(t){super(t);w(this,pe);w(this,ks,null);w(this,xc);K(this,"_drawId",null);y(this,xc,t.mustBeCommitted||!1),t.drawOutlines&&(_(this,pe,Ay).call(this,t),_(this,pe,xu).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(s))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){Se("Not implemented")}static get typesMap(){Se("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(l(z,ft).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,a=r[s],o=c=>{var h;r.updateProperty(s,c);const u=l(this,ks).updateProperty(s,c);u&&_(this,pe,bu).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties(l(this,ks).getPathResizingSVGProperties(_(this,pe,Kf).call(this)),{bbox:_(this,pe,sl).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties(l(this,ks).getPathResizedSVGProperties(_(this,pe,Kf).call(this)),{bbox:_(this,pe,sl).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:_(this,pe,sl).call(this,t,s)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties(l(this,ks).getPathTranslatedSVGProperties(_(this,pe,Kf).call(this),this.parentDimensions),{bbox:_(this,pe,sl).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,xc)&&(y(this,xc,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){_(this,pe,ky).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(_(this,pe,xu).call(this),_(this,pe,bu).call(this,l(this,ks).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),_(this,pe,ky).call(this)):t&&(this._uiManager.addShouldRescale(this),_(this,pe,xu).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties({bbox:_(this,pe,sl).call(this)},l(this,ks).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&_(this,pe,bu).call(this,l(this,ks).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const s=document.createElement("div");t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,s,i,r,a){Se("Not implemented")}static startDrawing(t,s,i,r){var E;const{target:a,offsetX:o,offsetY:c,pointerId:u,pointerType:h}=r;if(l(z,Rr)&&l(z,Rr)!==h)return;const{viewport:{rotation:f}}=t,{width:p,height:m}=a.getBoundingClientRect(),g=y(z,go,new AbortController),b=t.combinedSignal(g);if(l(z,Pr)||y(z,Pr,u),l(z,Rr)??y(z,Rr,h),window.addEventListener("pointerup",x=>{var v;l(z,Pr)===x.pointerId?this._endDraw(x):(v=l(z,Ir))==null||v.delete(x.pointerId)},{signal:b}),window.addEventListener("pointercancel",x=>{var v;l(z,Pr)===x.pointerId?this._currentParent.endDrawingSession():(v=l(z,Ir))==null||v.delete(x.pointerId)},{signal:b}),window.addEventListener("pointerdown",x=>{l(z,Rr)===x.pointerType&&((l(z,Ir)||y(z,Ir,new Set)).add(x.pointerId),l(z,ft).isCancellable()&&(l(z,ft).removeLastElement(),l(z,ft).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",jn,{signal:b}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),a.addEventListener("touchmove",x=>{x.timeStamp===l(z,vo)&&Is(x)},{signal:b}),t.toggleDrawing(),(E=s._editorUndoBar)==null||E.hide(),l(z,ft)){t.drawLayer.updateProperties(this._currentDrawId,l(z,ft).startNew(o,c,p,m,f));return}s.updateUIForDefaultProperties(this),y(z,ft,this.createDrawerInstance(o,c,p,m,f)),y(z,yo,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(l(z,yo).toSVGProperties(),l(z,ft).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(y(z,vo,-1),!l(z,ft))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(l(z,Pr)===r){if(((a=l(z,Ir))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(z,ft).add(s,i)),y(z,vo,t.timeStamp),Is(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,y(z,ft,null),y(z,yo,null),y(z,Rr,null),y(z,vo,NaN)),l(z,go)&&(l(z,go).abort(),y(z,go,null),y(z,Pr,NaN),y(z,Ir,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),t&&s.drawLayer.updateProperties(this._currentDrawId,l(z,ft).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=l(z,ft),r=this._currentDrawId,a=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:he.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(he.DRAW_STEP),!l(z,ft).isEmpty()){const{pageDimensions:[i,r],scale:a}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(z,ft).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:l(z,yo),mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,a,o){Se("Not implemented")}static async deserialize(t,s,i){var f,p;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}=s.viewport,u=this.deserializeDraw(o,c,r,a,this._INNER_MARGIN,t),h=await super.deserialize(t,s,i);return h.createDrawingOptions(t),_(f=h,pe,Ay).call(f,{drawOutlines:u}),_(p=h,pe,xu).call(p),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[s,i]=this.pageTranslation,[r,a]=this.pageDimensions;return l(this,ks).serialize([s,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ks=new WeakMap,xc=new WeakMap,ft=new WeakMap,go=new WeakMap,yo=new WeakMap,Pr=new WeakMap,Rr=new WeakMap,Ir=new WeakMap,vo=new WeakMap,pe=new WeakSet,Ay=function({drawOutlines:t,drawId:s,drawingOptions:i}){y(this,ks,t),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=_(this,pe,Ey).call(this,t,this.parent),_(this,pe,bu).call(this,t.box)},Ey=function(t,s){const{id:i}=s.drawLayer.draw(z._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},ky=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},xu=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=_(this,pe,Ey).call(this,l(this,ks),t)}},TA=function([t,s,i,r]){const{parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[s,1-t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},Kf=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[1-s,t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},bu=function(t){if([this.x,this.y,this.width,this.height]=_(this,pe,TA).call(this,t),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},sl=function(){const{x:t,y:s,width:i,height:r,rotation:a,parentRotation:o,parentDimensions:[c,u]}=this;switch((a*4+o)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(c/u),r*(u/c),i*(c/u)];case 5:return[1-s,t,i*(c/u),r*(u/c)];case 6:return[1-t-r*(u/c),1-s,r*(u/c),i*(c/u)];case 7:return[s-i*(c/u),1-t-r*(u/c),i*(c/u),r*(u/c)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/c),s,r*(u/c),i*(c/u)];case 13:return[1-s-i*(c/u),t-r*(u/c),i*(c/u),r*(u/c)];case 14:return[1-t,1-s-i*(c/u),r*(u/c),i*(c/u)];case 15:return[s,1-t,i*(c/u),r*(u/c)];default:return[t,s,i,r]}},K(z,"_currentDrawId",-1),K(z,"_currentParent",null),w(z,ft,null),w(z,go,null),w(z,yo,null),w(z,Pr,NaN),w(z,Rr,null),w(z,Ir,null),w(z,vo,NaN),K(z,"_INNER_MARGIN",3);let Sy=z;var Yn,pt,mt,xo,bc,Wt,wt,qs,bo,wo,_o,wc,Yf;class K2{constructor(e,t,s,i,r,a){w(this,wc);w(this,Yn,new Float64Array(6));w(this,pt);w(this,mt);w(this,xo);w(this,bc);w(this,Wt);w(this,wt,"");w(this,qs,0);w(this,bo,new Lp);w(this,wo);w(this,_o);y(this,wo,s),y(this,_o,i),y(this,xo,r),y(this,bc,a),[e,t]=_(this,wc,Yf).call(this,e,t);const o=y(this,pt,[NaN,NaN,NaN,NaN,e,t]);y(this,Wt,[e,t]),y(this,mt,[{line:o,points:l(this,Wt)}]),l(this,Yn).set(o,0)}updateProperty(e,t){e==="stroke-width"&&y(this,bc,t)}isEmpty(){return!l(this,mt)||l(this,mt).length===0}isCancellable(){return l(this,Wt).length<=10}add(e,t){[e,t]=_(this,wc,Yf).call(this,e,t);const[s,i,r,a]=l(this,Yn).subarray(2,6),o=e-r,c=t-a;return Math.hypot(l(this,wo)*o,l(this,_o)*c)<=2?null:(l(this,Wt).push(e,t),isNaN(s)?(l(this,Yn).set([r,a,e,t],2),l(this,pt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(l(this,Yn)[0])&&l(this,pt).splice(6,6),l(this,Yn).set([s,i,r,a,e,t],0),l(this,pt).push(...$.createBezierPoints(s,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(l(this,Wt).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){y(this,wo,s),y(this,_o,i),y(this,xo,r),[e,t]=_(this,wc,Yf).call(this,e,t);const a=y(this,pt,[NaN,NaN,NaN,NaN,e,t]);y(this,Wt,[e,t]);const o=l(this,mt).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),l(this,mt).push({line:a,points:l(this,Wt)}),l(this,Yn).set(a,0),y(this,qs,0),this.toSVGPath(),null}getLastElement(){return l(this,mt).at(-1)}setLastElement(e){return l(this,mt)?(l(this,mt).push(e),y(this,pt,e.line),y(this,Wt,e.points),y(this,qs,0),{path:{d:this.toSVGPath()}}):l(this,bo).setLastElement(e)}removeLastElement(){if(!l(this,mt))return l(this,bo).removeLastElement();l(this,mt).pop(),y(this,wt,"");for(let e=0,t=l(this,mt).length;e<t;e++){const{line:s,points:i}=l(this,mt)[e];y(this,pt,s),y(this,Wt,i),y(this,qs,0),this.toSVGPath()}return{path:{d:l(this,wt)}}}toSVGPath(){const e=$.svgRound(l(this,pt)[4]),t=$.svgRound(l(this,pt)[5]);if(l(this,Wt).length===2)return y(this,wt,`${l(this,wt)} M ${e} ${t} Z`),l(this,wt);if(l(this,Wt).length<=6){const i=l(this,wt).lastIndexOf("M");y(this,wt,`${l(this,wt).slice(0,i)} M ${e} ${t}`),y(this,qs,6)}if(l(this,Wt).length===4){const i=$.svgRound(l(this,pt)[10]),r=$.svgRound(l(this,pt)[11]);return y(this,wt,`${l(this,wt)} L ${i} ${r}`),y(this,qs,12),l(this,wt)}const s=[];l(this,qs)===0&&(s.push(`M ${e} ${t}`),y(this,qs,6));for(let i=l(this,qs),r=l(this,pt).length;i<r;i+=6){const[a,o,c,u,h,f]=l(this,pt).slice(i,i+6).map($.svgRound);s.push(`C${a} ${o} ${c} ${u} ${h} ${f}`)}return y(this,wt,l(this,wt)+s.join(" ")),y(this,qs,l(this,pt).length),l(this,wt)}getOutlines(e,t,s,i){const r=l(this,mt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,bo).build(l(this,mt),e,t,s,l(this,xo),l(this,bc),i),y(this,Yn,null),y(this,pt,null),y(this,mt,null),y(this,wt,null),l(this,bo)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Yn=new WeakMap,pt=new WeakMap,mt=new WeakMap,xo=new WeakMap,bc=new WeakMap,Wt=new WeakMap,wt=new WeakMap,qs=new WeakMap,bo=new WeakMap,wo=new WeakMap,_o=new WeakMap,wc=new WeakSet,Yf=function(e,t){return $._normalizePoint(e,t,l(this,wo),l(this,_o),l(this,xo))};var qt,kh,Nh,Ns,Qn,Jn,_c,Sc,Ac,At,ci,jA,PA,RA;const ex=class ex extends ${constructor(){super(...arguments);w(this,At);w(this,qt);w(this,kh,0);w(this,Nh);w(this,Ns);w(this,Qn);w(this,Jn);w(this,_c);w(this,Sc);w(this,Ac)}build(t,s,i,r,a,o,c){y(this,Qn,s),y(this,Jn,i),y(this,_c,r),y(this,Sc,a),y(this,Ac,o),y(this,Nh,c??0),y(this,Ns,t),_(this,At,PA).call(this)}setLastElement(t){return l(this,Ns).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,Ns).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of l(this,Ns)){if(t.push(`M${$.svgRound(s[4])} ${$.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12){t.push(`L${$.svgRound(s[10])} ${$.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[a,o,c,u,h,f]=s.subarray(i,i+6).map($.svgRound);t.push(`C${a} ${o} ${c} ${u} ${h} ${f}`)}}return t.join("")}serialize([t,s,i,r],a){const o=[],c=[],[u,h,f,p]=_(this,At,jA).call(this);let m,g,b,E,x,v,S,A,C;switch(l(this,Sc)){case 0:C=$._rescale,m=t,g=s+r,b=i,E=-r,x=t+u*i,v=s+(1-h-p)*r,S=t+(u+f)*i,A=s+(1-h)*r;break;case 90:C=$._rescaleAndSwap,m=t,g=s,b=i,E=r,x=t+h*i,v=s+u*r,S=t+(h+p)*i,A=s+(u+f)*r;break;case 180:C=$._rescale,m=t+i,g=s,b=-i,E=r,x=t+(1-u-f)*i,v=s+h*r,S=t+(1-u)*i,A=s+(h+p)*r;break;case 270:C=$._rescaleAndSwap,m=t+i,g=s+r,b=-i,E=-r,x=t+(1-h-p)*i,v=s+(1-u-f)*r,S=t+(1-h)*i,A=s+(1-u)*r;break}for(const{line:N,points:k}of l(this,Ns))o.push(C(N,m,g,b,E,a?new Array(N.length):null)),c.push(C(k,m,g,b,E,a?new Array(k.length):null));return{lines:o,points:c,rect:[x,v,S,A]}}static deserialize(t,s,i,r,a,{paths:{lines:o,points:c},rotation:u,thickness:h}){const f=[];let p,m,g,b,E;switch(u){case 0:E=$._rescale,p=-t/i,m=s/r+1,g=1/i,b=-1/r;break;case 90:E=$._rescaleAndSwap,p=-s/r,m=-t/i,g=1/r,b=1/i;break;case 180:E=$._rescale,p=t/i+1,m=-s/r,g=-1/i,b=1/r;break;case 270:E=$._rescaleAndSwap,p=s/r+1,m=t/i+1,g=-1/r,b=-1/i;break}if(!o){o=[];for(const v of c){const S=v.length;if(S===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1]]));continue}if(S===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1],NaN,NaN,NaN,NaN,v[2],v[3]]));continue}const A=new Float32Array(3*(S-2));o.push(A);let[C,N,k,j]=v.subarray(0,4);A.set([NaN,NaN,NaN,NaN,C,N],0);for(let I=4;I<S;I+=2){const R=v[I],U=v[I+1];A.set($.createBezierPoints(C,N,k,j,R,U),(I-2)*3),[C,N,k,j]=[k,j,R,U]}}}for(let v=0,S=o.length;v<S;v++)f.push({line:E(o[v].map(A=>A??NaN),p,m,g,b),points:E(c[v].map(A=>A??NaN),p,m,g,b)});const x=new ex;return x.build(f,i,r,1,u,h,a),x}get box(){return l(this,qt)}updateProperty(t,s){return t==="stroke-width"?_(this,At,RA).call(this,s):null}updateParentDimensions([t,s],i){const[r,a]=_(this,At,ci).call(this);y(this,Qn,t),y(this,Jn,s),y(this,_c,i);const[o,c]=_(this,At,ci).call(this),u=o-r,h=c-a,f=l(this,qt);return f[0]-=u,f[1]-=h,f[2]+=2*u,f[3]+=2*h,f}updateRotation(t){return y(this,kh,t),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,qt).map($.svgRound).join(" ")}get defaultProperties(){const[t,s]=l(this,qt);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${$.svgRound(t)} ${$.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=l(this,qt);let i=0,r=0,a=0,o=0,c=0,u=0;switch(l(this,kh)){case 90:r=s/t,a=-t/s,c=t;break;case 180:i=-1,o=-1,c=t,u=s;break;case 270:r=-s/t,a=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${a} ${o} ${$.svgRound(c)} ${$.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[a,o]=_(this,At,ci).call(this),[c,u,h,f]=l(this,qt);if(Math.abs(h-a)<=$.PRECISION||Math.abs(f-o)<=$.PRECISION){const E=t+i/2-(c+h/2),x=s+r/2-(u+f/2);return{path:{"transform-origin":`${$.svgRound(t)} ${$.svgRound(s)}`,transform:`${this.rotationTransform} translate(${E} ${x})`}}}const p=(i-2*a)/(h-2*a),m=(r-2*o)/(f-2*o),g=h/i,b=f/r;return{path:{"transform-origin":`${$.svgRound(c)} ${$.svgRound(u)}`,transform:`${this.rotationTransform} scale(${g} ${b}) translate(${$.svgRound(a)} ${$.svgRound(o)}) scale(${p} ${m}) translate(${$.svgRound(-a)} ${$.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[a,o]=_(this,At,ci).call(this),c=l(this,qt),[u,h,f,p]=c;if(c[0]=t,c[1]=s,c[2]=i,c[3]=r,Math.abs(f-a)<=$.PRECISION||Math.abs(p-o)<=$.PRECISION){const x=t+i/2-(u+f/2),v=s+r/2-(h+p/2);for(const{line:S,points:A}of l(this,Ns))$._translate(S,x,v,S),$._translate(A,x,v,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${$.svgRound(t)} ${$.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*a)/(f-2*a),g=(r-2*o)/(p-2*o),b=-m*(u+a)+t+a,E=-g*(h+o)+s+o;if(m!==1||g!==1||b!==0||E!==0)for(const{line:x,points:v}of l(this,Ns))$._rescale(x,b,E,m,g,x),$._rescale(v,b,E,m,g,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${$.svgRound(t)} ${$.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,a]=i,o=l(this,qt),c=t-o[0],u=s-o[1];if(l(this,Qn)===r&&l(this,Jn)===a)for(const{line:h,points:f}of l(this,Ns))$._translate(h,c,u,h),$._translate(f,c,u,f);else{const h=l(this,Qn)/r,f=l(this,Jn)/a;y(this,Qn,r),y(this,Jn,a);for(const{line:p,points:m}of l(this,Ns))$._rescale(p,c,u,h,f,p),$._rescale(m,c,u,h,f,m);o[2]*=h,o[3]*=f}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${$.svgRound(t)} ${$.svgRound(s)}`}}}get defaultSVGProperties(){const t=l(this,qt);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${$.svgRound(t[0])} ${$.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};qt=new WeakMap,kh=new WeakMap,Nh=new WeakMap,Ns=new WeakMap,Qn=new WeakMap,Jn=new WeakMap,_c=new WeakMap,Sc=new WeakMap,Ac=new WeakMap,At=new WeakSet,ci=function(t=l(this,Ac)){const s=l(this,Nh)+t/2*l(this,_c);return l(this,Sc)%180===0?[s/l(this,Qn),s/l(this,Jn)]:[s/l(this,Jn),s/l(this,Qn)]},jA=function(){const[t,s,i,r]=l(this,qt),[a,o]=_(this,At,ci).call(this,0);return[t+a,s+o,i-2*a,r-2*o]},PA=function(){const t=y(this,qt,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,Ns)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6){const[h,f]=r.subarray(c,c+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],f),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],f)}continue}let a=r[4],o=r[5];for(let c=6,u=r.length;c<u;c+=6){const[h,f,p,m,g,b]=r.subarray(c,c+6);W.bezierBoundingBox(a,o,h,f,p,m,g,b,t),a=g,o=b}}const[s,i]=_(this,At,ci).call(this);t[0]=Math.min(1,Math.max(0,t[0]-s)),t[1]=Math.min(1,Math.max(0,t[1]-i)),t[2]=Math.min(1,Math.max(0,t[2]+s)),t[3]=Math.min(1,Math.max(0,t[3]+i)),t[2]-=t[0],t[3]-=t[1]},RA=function(t){const[s,i]=_(this,At,ci).call(this);y(this,Ac,t);const[r,a]=_(this,At,ci).call(this),[o,c]=[r-s,a-i],u=l(this,qt);return u[0]-=o,u[1]-=c,u[2]+=2*o,u[3]+=2*c,u};let Lp=ex;var Ec;const tx=class tx extends X2{constructor(t){super();w(this,Ec);y(this,Ec,t),super.updateProperties({fill:"none",stroke:Ue._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,s){t==="stroke-width"&&(s??(s=this["stroke-width"]),s*=l(this,Ec).realScale),super.updateSVGProperty(t,s)}clone(){const t=new tx(l(this,Ec));return t.updateAll(this),t}};Ec=new WeakMap;let Ny=tx;var Jp,IA;const gl=class gl extends Sy{constructor(t){super({...t,name:"inkEditor"});w(this,Jp);this._willKeepAspectRatio=!0}static initialize(t,s){Ue.initialize(t,s),this._defaultDrawingOptions=new Ny(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return ae(this,"typesMap",new Map([[he.INK_THICKNESS,"stroke-width"],[he.INK_COLOR,"stroke"],[he.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,a){return new K2(t,s,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,a,o){return Lp.deserialize(t,s,i,r,a,o)}static async deserialize(t,s,i){let r=null;if(t instanceof Kv){const{data:{inkLists:o,rect:c,rotation:u,id:h,color:f,opacity:p,borderStyle:{rawWidth:m},popupRef:g},parent:{page:{pageNumber:b}}}=t;r=t={annotationType:se.INK,color:Array.from(f),thickness:m,opacity:p,paths:{points:o},boxes:null,pageIndex:b-1,rect:c.slice(0),rotation:u,id:h,deleted:!1,popupRef:g}}const a=await super.deserialize(t,s,i);return a.annotationElementId=t.id||null,a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=gl.getDefaultDrawingOptions({stroke:W.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":c}}=this,u={annotationType:se.INK,color:Ue._colorManager.convert(a),opacity:o,thickness:c,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?u:this.annotationElementId&&!_(this,Jp,IA).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};Jp=new WeakSet,IA=function(t){const{color:s,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,c)=>o!==s[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a},K(gl,"_type","ink"),K(gl,"_editorType",se.INK),K(gl,"_defaultDrawingOptions",null);let Cy=gl;var $e,_t,Lr,Di,Mr,kc,Zn,ei,Cs,Nc,ge,wu,_u,Qf,jy,Jf,Py,Zf,LA;const Du=class Du extends Ue{constructor(t){super({...t,name:"stampEditor"});w(this,ge);w(this,$e,null);w(this,_t,null);w(this,Lr,null);w(this,Di,null);w(this,Mr,null);w(this,kc,"");w(this,Zn,null);w(this,ei,null);w(this,Cs,!1);w(this,Nc,!1);y(this,Di,t.bitmapUrl),y(this,Mr,t.bitmapFile)}static initialize(t,s){Ue.initialize(t,s)}static get supportedTypes(){return ae(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return ae(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(se.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;l(this,_t)&&(y(this,$e,null),this._uiManager.imageManager.deleteId(l(this,_t)),(t=l(this,Zn))==null||t.remove(),y(this,Zn,null),l(this,ei)&&(clearTimeout(l(this,ei)),y(this,ei,null))),super.remove()}rebuild(){if(!this.parent){l(this,_t)&&_(this,ge,Qf).call(this);return}super.rebuild(),this.div!==null&&(l(this,_t)&&l(this,Zn)===null&&_(this,ge,Qf).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(l(this,Lr)||l(this,$e)||l(this,Di)||l(this,Mr)||l(this,_t))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),l(this,$e)?_(this,ge,jy).call(this):_(this,ge,Qf).call(this),this.width&&!this.annotationElementId){const[i,r]=this.parentDimensions;this.setAt(t*i,s*r,this.width*i,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,ei)!==null&&clearTimeout(l(this,ei)),y(this,ei,setTimeout(()=>{y(this,ei,null),_(this,ge,Py).call(this)},200))}copyCanvas(t,s,i=!1){var m;t||(t=224);const{width:r,height:a}=l(this,$e),o=new N0;let c=l(this,$e),u=r,h=a,f=null;if(s){if(r>s||a>s){const j=Math.min(s/r,s/a);u=Math.floor(r*j),h=Math.floor(a*j)}f=document.createElement("canvas");const g=f.width=Math.ceil(u*o.sx),b=f.height=Math.ceil(h*o.sy);l(this,Cs)||(c=_(this,ge,Jf).call(this,g,b));const E=f.getContext("2d");E.filter=this._uiManager.hcmFilter;let x="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":(m=window.matchMedia)!=null&&m.call(window,"(prefers-color-scheme: dark)").matches&&(x="#8f8f9d",v="#42414d");const S=15,A=S*o.sx,C=S*o.sy,N=new OffscreenCanvas(A*2,C*2),k=N.getContext("2d");k.fillStyle=x,k.fillRect(0,0,A*2,C*2),k.fillStyle=v,k.fillRect(0,0,A,C),k.fillRect(A,C,A,C),E.fillStyle=E.createPattern(N,"repeat"),E.fillRect(0,0,g,b),E.drawImage(c,0,0,c.width,c.height,0,0,g,b)}let p=null;if(i){let g,b;if(o.symmetric&&c.width<t&&c.height<t)g=c.width,b=c.height;else if(c=l(this,$e),r>t||a>t){const v=Math.min(t/r,t/a);g=Math.floor(r*v),b=Math.floor(a*v),l(this,Cs)||(c=_(this,ge,Jf).call(this,g,b))}const x=new OffscreenCanvas(g,b).getContext("2d",{willReadFrequently:!0});x.drawImage(c,0,0,c.width,c.height,0,0,g,b),p={width:g,height:b,data:x.getImageData(0,0,g,b).data}}return{canvas:f,width:u,height:h,imageData:p}}getImageForAltText(){return l(this,Zn)}static async deserialize(t,s,i){var b;let r=null;if(t instanceof tA){const{data:{rect:E,rotation:x,id:v,structParent:S,popupRef:A},container:C,parent:{page:{pageNumber:N}}}=t,k=C.querySelector("canvas"),j=i.imageManager.getFromCanvas(C.id,k);k.remove();const I=((b=await s._structTree.getAriaAttributes(`${Uv}${v}`))==null?void 0:b.get("aria-label"))||"";r=t={annotationType:se.STAMP,bitmapId:j.id,bitmap:j.bitmap,pageIndex:N-1,rect:E.slice(0),rotation:x,id:v,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:S,popupRef:A}}const a=await super.deserialize(t,s,i),{rect:o,bitmap:c,bitmapUrl:u,bitmapId:h,isSvg:f,accessibilityData:p}=t;h&&i.imageManager.isValidId(h)?(y(a,_t,h),c&&y(a,$e,c)):y(a,Di,u),y(a,Cs,f);const[m,g]=a.pageDimensions;return a.width=(o[2]-o[0])/m,a.height=(o[3]-o[1])/g,a.annotationElementId=t.id||null,p&&(a.altTextData=p),a._initialData=r,y(a,Nc,!!r),a}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:se.STAMP,bitmapId:l(this,_t),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,Cs),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=_(this,ge,Zf).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=_(this,ge,LA).call(this,i);if(c.isSame)return null;c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const o=l(this,Cs)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(l(this,_t)))s.stamps.set(l(this,_t),{area:o,serialized:i}),i.bitmap=_(this,ge,Zf).call(this,!1);else if(l(this,Cs)){const c=s.stamps.get(l(this,_t));o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=_(this,ge,Zf).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};$e=new WeakMap,_t=new WeakMap,Lr=new WeakMap,Di=new WeakMap,Mr=new WeakMap,kc=new WeakMap,Zn=new WeakMap,ei=new WeakMap,Cs=new WeakMap,Nc=new WeakMap,ge=new WeakSet,wu=function(t,s=!1){if(!t){this.remove();return}y(this,$e,t.bitmap),s||(y(this,_t,t.id),y(this,Cs,t.isSvg)),t.file&&y(this,kc,t.file.name),_(this,ge,jy).call(this)},_u=function(){if(y(this,Lr,null),this._uiManager.enableWaiting(!1),!!l(this,Zn)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,$e)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,$e)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Qf=function(){if(l(this,_t)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,_t)).then(i=>_(this,ge,wu).call(this,i,!0)).finally(()=>_(this,ge,_u).call(this));return}if(l(this,Di)){const i=l(this,Di);y(this,Di,null),this._uiManager.enableWaiting(!0),y(this,Lr,this._uiManager.imageManager.getFromUrl(i).then(r=>_(this,ge,wu).call(this,r)).finally(()=>_(this,ge,_u).call(this)));return}if(l(this,Mr)){const i=l(this,Mr);y(this,Mr,null),this._uiManager.enableWaiting(!0),y(this,Lr,this._uiManager.imageManager.getFromFile(i).then(r=>_(this,ge,wu).call(this,r)).finally(()=>_(this,ge,_u).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Du.supportedTypesStr;const s=this._uiManager._signal;y(this,Lr,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),_(this,ge,wu).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>_(this,ge,_u).call(this))),t.click()},jy=function(){var f;const{div:t}=this;let{width:s,height:i}=l(this,$e);const[r,a]=this.pageDimensions,o=.75;if(this.width)s=this.width*r,i=this.height*a;else if(s>o*r||i>o*a){const p=Math.min(o*r/s,o*a/i);s*=p,i*=p}const[c,u]=this.parentDimensions;this.setDims(s*c/r,i*u/a),this._uiManager.enableWaiting(!1);const h=y(this,Zn,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=s/r,this.height=i/a,(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),_(this,ge,Py).call(this),l(this,Nc)||(this.parent.addUndoableEditor(this),y(this,Nc,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,kc)&&h.setAttribute("aria-label",l(this,kc))},Jf=function(t,s){const{width:i,height:r}=l(this,$e);let a=i,o=r,c=l(this,$e);for(;a>2*t||o>2*s;){const u=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(c,0,0,u,h,0,0,a,o),c=f.transferToImageBitmap()}return c},Py=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,a=new N0,o=Math.ceil(i*t*a.sx),c=Math.ceil(r*s*a.sy),u=l(this,Zn);if(!u||u.width===o&&u.height===c)return;u.width=o,u.height=c;const h=l(this,Cs)?l(this,$e):_(this,ge,Jf).call(this,o,c),f=u.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(h,0,0,h.width,h.height,0,0,o,c)},Zf=function(t){if(t){if(l(this,Cs)){const r=this._uiManager.imageManager.getSvgUrl(l(this,_t));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,$e),s.getContext("2d").drawImage(l(this,$e),0,0),s.toDataURL()}if(l(this,Cs)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*Zr.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*Zr.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(l(this,$e),0,0,l(this,$e).width,l(this,$e).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(l(this,$e))},LA=function(t){var o;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},K(Du,"_type","stamp"),K(Du,"_editorType",se.STAMP);let Ty=Du;var So,Cc,ti,Dr,Oi,Gs,Or,Tc,Ao,wn,Fi,Dt,$i,V,Fr,Le,MA,Dn,Iy,Ly,ep;const ln=class ln{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:c,viewport:u,l10n:h}){w(this,Le);w(this,So);w(this,Cc,!1);w(this,ti,null);w(this,Dr,null);w(this,Oi,null);w(this,Gs,new Map);w(this,Or,!1);w(this,Tc,!1);w(this,Ao,!1);w(this,wn,null);w(this,Fi,null);w(this,Dt,null);w(this,$i,null);w(this,V);const f=[...l(ln,Fr).values()];if(!ln._initialized){ln._initialized=!0;for(const p of f)p.initialize(h,e)}e.registerEditorTypes(f),y(this,V,e),this.pageIndex=t,this.div=s,y(this,So,r),y(this,ti,a),this.viewport=u,y(this,Dt,c),this.drawLayer=o,this._structTree=i,l(this,V).addLayer(this)}get isEmpty(){return l(this,Gs).size===0}get isInvisible(){return this.isEmpty&&l(this,V).getMode()===se.NONE}updateToolbar(e){l(this,V).updateToolbar(e)}updateMode(e=l(this,V).getMode()){switch(_(this,Le,ep).call(this),e){case se.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case se.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case se.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of l(ln,Fr).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=l(this,Dt))==null?void 0:t.div)}setEditingState(e){l(this,V).setEditingState(e)}addCommands(e){l(this,V).addCommands(e)}cleanUndoStack(e){l(this,V).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=l(this,ti))==null||t.div.classList.toggle("disabled",!e)}async enable(){y(this,Ao,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of l(this,Gs).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(l(this,V).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!l(this,ti)){y(this,Ao,!1);return}const t=l(this,ti).getEditableAnnotations();for(const s of t){if(s.hide(),l(this,V).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}y(this,Ao,!1)}disable(){var i;y(this,Tc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of l(this,Gs).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(l(this,ti)){const r=l(this,ti).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(l(this,V).isDeletedAnnotationElement(o))continue;let c=t.get(o);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=e.get(o),c&&(l(this,V).addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}_(this,Le,ep).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of l(ln,Fr).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),y(this,Tc,!1)}getEditableAnnotation(e){var t;return((t=l(this,ti))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){l(this,V).getActive()!==e&&l(this,V).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=l(this,Dt))!=null&&e.div&&!l(this,$i)){y(this,$i,new AbortController);const t=l(this,V).combinedSignal(l(this,$i));l(this,Dt).div.addEventListener("pointerdown",_(this,Le,MA).bind(this),{signal:t}),l(this,Dt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=l(this,Dt))!=null&&e.div&&l(this,$i)&&(l(this,$i).abort(),y(this,$i,null),l(this,Dt).div.classList.remove("highlighting"))}enableClick(){if(l(this,Dr))return;y(this,Dr,new AbortController);const e=l(this,V).combinedSignal(l(this,Dr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=l(this,Dr))==null||e.abort(),y(this,Dr,null)}attach(e){l(this,Gs).set(e.id,e);const{annotationElementId:t}=e;t&&l(this,V).isDeletedAnnotationElement(t)&&l(this,V).removeDeletedAnnotationElement(e)}detach(e){var t;l(this,Gs).delete(e.id),(t=l(this,So))==null||t.removePointerInTextLayer(e.contentDiv),!l(this,Tc)&&e.annotationElementId&&l(this,V).addDeletedAnnotationElement(e)}remove(e){this.detach(e),l(this,V).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(l(this,V).addDeletedAnnotationElement(e.annotationElementId),Ue.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),l(this,V).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!l(this,Ao)),l(this,V).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!l(this,Oi)&&(e._focusEventsAllowed=!1,y(this,Oi,setTimeout(()=>{y(this,Oi,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:l(this,V)._signal}),t.focus())},0))),e._structTreeParentId=(s=l(this,So))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return l(this,V).getId()}combinedSignal(e){return l(this,V).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=l(this,Le,Dn))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){l(this,V).updateToolbar(e),l(this,V).updateMode(e);const{offsetX:s,offsetY:i}=_(this,Le,Ly).call(this),r=this.getNextId(),a=_(this,Le,Iy).call(this,{parent:this,id:r,x:s,y:i,uiManager:l(this,V),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=l(ln,Fr).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,l(this,V)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=_(this,Le,Iy).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:l(this,V),isCentered:t,...s});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(_(this,Le,Ly).call(this),!0)}setSelected(e){l(this,V).setSelected(e)}toggleSelected(e){l(this,V).toggleSelected(e)}unselect(e){l(this,V).unselect(e)}pointerup(e){var s;const{isMac:t}=Yt.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&l(this,Or)&&(y(this,Or,!1),!((s=l(this,Le,Dn))!=null&&s.isDrawer&&l(this,Le,Dn).supportMultipleDrawings))){if(!l(this,Cc)){y(this,Cc,!0);return}if(l(this,V).getMode()===se.STAMP){l(this,V).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var i;if(l(this,V).getMode()===se.HIGHLIGHT&&this.enableTextSelection(),l(this,Or)){y(this,Or,!1);return}const{isMac:t}=Yt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(y(this,Or,!0),(i=l(this,Le,Dn))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=l(this,V).getActive();y(this,Cc,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus(),l(this,wn)){l(this,Le,Dn).startDrawing(this,l(this,V),!1,e);return}l(this,V).setCurrentDrawingSession(this),y(this,wn,new AbortController);const t=l(this,V).combinedSignal(l(this,wn));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(y(this,Fi,null),this.commitOrRemove())},{signal:t}),l(this,Le,Dn).startDrawing(this,l(this,V),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&y(this,Fi,t);return}l(this,Fi)&&setTimeout(()=>{var t;(t=l(this,Fi))==null||t.focus(),y(this,Fi,null)},0)}endDrawingSession(e=!1){return l(this,wn)?(l(this,V).setCurrentDrawingSession(null),l(this,wn).abort(),y(this,wn,null),y(this,Fi,null),l(this,Le,Dn).endDrawing(e)):null}findNewParent(e,t,s){const i=l(this,V).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return l(this,wn)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,wn)&&l(this,Le,Dn).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=l(this,V).getActive())==null?void 0:e.parent)===this&&(l(this,V).commitOrRemove(),l(this,V).setActiveEditor(null)),l(this,Oi)&&(clearTimeout(l(this,Oi)),y(this,Oi,null));for(const s of l(this,Gs).values())(t=l(this,So))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,Gs).clear(),l(this,V).removeLayer(this)}render({viewport:e}){this.viewport=e,Lo(this.div,e);for(const t of l(this,V).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){l(this,V).commitOrRemove(),_(this,Le,ep).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Lo(this.div,{rotation:s}),t!==s)for(const i of l(this,Gs).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return l(this,V).viewParameters.realScale}};So=new WeakMap,Cc=new WeakMap,ti=new WeakMap,Dr=new WeakMap,Oi=new WeakMap,Gs=new WeakMap,Or=new WeakMap,Tc=new WeakMap,Ao=new WeakMap,wn=new WeakMap,Fi=new WeakMap,Dt=new WeakMap,$i=new WeakMap,V=new WeakMap,Fr=new WeakMap,Le=new WeakSet,MA=function(e){l(this,V).unselectAll();const{target:t}=e;if(t===l(this,Dt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&l(this,Dt).div.contains(t)){const{isMac:s}=Yt.platform;if(e.button!==0||e.ctrlKey&&s)return;l(this,V).showAllEditors("highlight",!0,!0),l(this,Dt).div.classList.add("free"),this.toggleDrawing(),Ip.startHighlighting(this,l(this,V).direction==="ltr",{target:l(this,Dt).div,x:e.x,y:e.y}),l(this,Dt).div.addEventListener("pointerup",()=>{l(this,Dt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,V)._signal}),e.preventDefault()}},Dn=function(){return l(ln,Fr).get(l(this,V).getMode())},Iy=function(e){const t=l(this,Le,Dn);return t?new t.prototype.constructor(e):null},Ly=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+i),u=(r+o)/2-e,h=(a+c)/2-t,[f,p]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:f,offsetY:p}},ep=function(){for(const e of l(this,Gs).values())e.isEmpty()&&e.remove()},K(ln,"_initialized",!1),w(ln,Fr,new Map([fy,Cy,Ty,Ip].map(e=>[e._editorType,e])));let Ry=ln;var _n,Ch,Gt,Eo,Zp,DA,ri,Dy,OA,Oy;const Rt=class Rt{constructor({pageIndex:e}){w(this,ri);w(this,_n,null);w(this,Ch,0);w(this,Gt,new Map);w(this,Eo,new Map);this.pageIndex=e}setParent(e){if(!l(this,_n)){y(this,_n,e);return}if(l(this,_n)!==e){if(l(this,Gt).size>0)for(const t of l(this,Gt).values())t.remove(),e.append(t);y(this,_n,e)}}static get _svgFactory(){return ae(this,"_svgFactory",new Xv)}draw(e,t=!1,s=!1){const i=Ut(this,Ch)._++,r=_(this,ri,Dy).call(this),a=Rt._svgFactory.createElement("defs");r.append(a);const o=Rt._svgFactory.createElement("path");a.append(o);const c=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke"),t&&l(this,Eo).set(i,o);const u=s?_(this,ri,OA).call(this,a,c):null,h=Rt._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(r,e),l(this,Gt).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=Ut(this,Ch)._++,i=_(this,ri,Dy).call(this),r=Rt._svgFactory.createElement("defs");i.append(r);const a=Rt._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const f=Rt._svgFactory.createElement("mask");r.append(f),c=`mask_p${this.pageIndex}_${s}`,f.setAttribute("id",c),f.setAttribute("maskUnits","objectBoundingBox");const p=Rt._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const m=Rt._svgFactory.createElement("use");f.append(m),m.setAttribute("href",`#${o}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const u=Rt._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${o}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return i.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(i,e),l(this,Gt).set(s,i),s}finalizeDraw(e,t){l(this,Eo).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:i,rootClass:r,path:a}=t,o=typeof e=="number"?l(this,Gt).get(e):e;if(o){if(s&&_(this,ri,Oy).call(this,o,s),i&&_(c=Rt,Zp,DA).call(c,o,i),r){const{classList:u}=o;for(const[h,f]of Object.entries(r))u.toggle(h,f)}if(a){const h=o.firstChild.firstChild;_(this,ri,Oy).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const s=l(this,Gt).get(e);s&&(l(t,_n).append(s),l(this,Gt).delete(e),l(t,Gt).set(e,s))}remove(e){l(this,Eo).delete(e),l(this,_n)!==null&&(l(this,Gt).get(e).remove(),l(this,Gt).delete(e))}destroy(){y(this,_n,null);for(const e of l(this,Gt).values())e.remove();l(this,Gt).clear(),l(this,Eo).clear()}};_n=new WeakMap,Ch=new WeakMap,Gt=new WeakMap,Eo=new WeakMap,Zp=new WeakSet,DA=function(e,[t,s,i,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*r}%`},ri=new WeakSet,Dy=function(){const e=Rt._svgFactory.create(1,1,!0);return l(this,_n).append(e),e.setAttribute("aria-hidden",!0),e},OA=function(e,t){const s=Rt._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=Rt._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},Oy=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},w(Rt,Zp);let My=Rt;globalThis.pdfjsTestingUtils={HighlightOutliner:my};Z.AbortException;Z.AnnotationEditorLayer;Z.AnnotationEditorParamsType;Z.AnnotationEditorType;Z.AnnotationEditorUIManager;Z.AnnotationLayer;Z.AnnotationMode;Z.ColorPicker;Z.DOMSVGFactory;Z.DrawLayer;Z.FeatureTest;var Y2=Z.GlobalWorkerOptions;Z.ImageKind;Z.InvalidPDFException;Z.MissingPDFException;Z.OPS;Z.OutputScale;Z.PDFDataRangeTransport;Z.PDFDateString;Z.PDFWorker;Z.PasswordResponses;Z.PermissionFlag;Z.PixelsPerInch;Z.RenderingCancelledException;Z.TextLayer;Z.TouchManager;Z.UnexpectedResponseException;Z.Util;Z.VerbosityLevel;Z.XfaLayer;Z.build;Z.createValidAbsoluteUrl;Z.fetchData;var Q2=Z.getDocument;Z.getFilenameFromUrl;Z.getPdfFilenameFromUrl;Z.getXfaPageViewport;Z.isDataScheme;Z.isPdfFile;Z.noContextMenu;Z.normalizeUnicode;Z.setLayerDimensions;Z.shadow;Z.stopEvent;Z.version;const J2="/assets/pdf.worker.min-yatZIOMy.mjs";Y2.workerSrc=J2;const Z2=async n=>{try{const e=await n.arrayBuffer(),t=await Q2({data:e}).promise;let s="";for(let r=1;r<=t.numPages;r++){const c=(await(await t.getPage(r)).getTextContent()).items.map(u=>u.str).join(" ");s+=c+" "}return eP(s)}catch(e){throw console.error("PDF extraction error:",e),new Error("Failed to extract data from PDF")}},eP=n=>{const e=n.replace(/\s+/g," ").trim(),t={businessName:[/business\s+dba\s+name[:\s]+([^\n\r]+)/i,/(?:business\s+name|company\s+name|legal\s+name)[:\s]+([^\n\r]+)/i,/(?:dba|doing\s+business\s+as)[:\s]+([^\n\r]+)/i],ownerName:[/(?:^|\s)name[:\s]+([^\n\r]+)/i,/(?:owner\s+name|principal\s+name|applicant\s+name)[:\s]+([^\n\r]+)/i,/(?:first\s+name\s+last\s+name|full\s+name)[:\s]+([^\n\r]+)/i],email:[/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g,/(?:email|e-mail)[:\s]+([^\s\n\r]+)/i],phone:[/(?:phone|telephone|cell|mobile)[:\s]*(\(?[0-9]{3}\)?[-.\s]?[0-9]{3}[-.\s]?[0-9]{4})/i,/(\(?[0-9]{3}\)?[-.\s]?[0-9]{3}[-.\s]?[0-9]{4})/g],address:[/address\s+cty\s+state\s+zip[:\s]+([^\n\r]+(?:\s+[^\n\r]+)*)/i,/(?:business\s+address|address)[:\s]+([^\n\r]+(?:\s+[^\n\r]+)*)/i,/(?:street|address\s+line)[:\s]+([^\n\r]+)/i],ein:[/federal\s+tax\s+id\s*#[:\s]*(\d{2}-?\d{7})/i,/(?:federal\s+tax\s+id|tax\s+id\s*#)[:\s]*(\d{2}-?\d{7})/i,/(?:ein|tax\s+id|federal\s+id)[:\s]*(\d{2}-?\d{7})/i,/(\d{2}-\d{7})/g],businessType:[/(?:business\s+type|entity\s+type|legal\s+structure)[:\s]+([^,\n]+)/i,/(?:llc|corporation|partnership|sole\s+proprietorship|s-corp|c-corp)/i],industry:[/(?:industry|business\s+type|nature\s+of\s+business)[:\s]+([^,\n]+)/i,/(?:retail|restaurant|healthcare|construction|professional\s+services|transportation|manufacturing|technology|real\s+estate)/i],yearsInBusiness:[/(?:years\s+in\s+business|time\s+in\s+business)[:\s]*(\d+(?:\.\d+)?)/i,/(?:established|started)[:\s]*(\d{4})/i],numberOfEmployees:[/(?:number\s+of\s+employees|employees|staff\s+size)[:\s]*(\d+)/i,/(\d+)\s+employees/i],annualRevenue:[/(?:annual\s+revenue|yearly\s+revenue|annual\s+sales)[:\s]*\$?([0-9,]+)/i,/(?:gross\s+revenue)[:\s]*\$?([0-9,]+)/i],averageMonthlyRevenue:[/(?:monthly\s+revenue|average\s+monthly\s+sales)[:\s]*\$?([0-9,]+)/i,/(?:monthly\s+gross)[:\s]*\$?([0-9,]+)/i],averageMonthlyDeposits:[/(?:monthly\s+deposits|average\s+monthly\s+deposits)[:\s]*\$?([0-9,]+)/i,/(?:bank\s+deposits)[:\s]*\$?([0-9,]+)/i],existingDebt:[/(?:existing\s+debt|current\s+debt|outstanding\s+debt)[:\s]*\$?([0-9,]+)/i,/(?:debt\s+balance)[:\s]*\$?([0-9,]+)/i],creditScore:[/(?:credit\s+score|fico\s+score|personal\s+credit)[:\s]*(\d{3})/i,/(?:score)[:\s]*(\d{3})/i],requestedAmount:[/amount\s+requested[:\s]*\$?([0-9,]+)/i,/(?:requested\s+amount|loan\s+amount|funding\s+amount)[:\s]*\$?([0-9,]+)/i,/(?:amount\s+needed|capital\s+needed)[:\s]*\$?([0-9,]+)/i]},s={businessName:"",ownerName:"",email:"",phone:"",address:"",ein:"",businessType:"",industry:"",yearsInBusiness:"",numberOfEmployees:"",annualRevenue:"",averageMonthlyRevenue:"",averageMonthlyDeposits:"",existingDebt:"",creditScore:"",requestedAmount:""};if(Object.keys(t).forEach(i=>{const r=t[i];for(const a of r){const o=e.match(a);if(o&&o[1]){let c=o[1].trim().replace(/\s+/g," ");(i.includes("Revenue")||i.includes("Amount")||i.includes("Debt")||i.includes("Deposits"))&&(c=c.replace(/[,$]/g,"")),i==="phone"&&(c=c.replace(/[^\d]/g,""),c.length===10&&(c=`(${c.slice(0,3)}) ${c.slice(3,6)}-${c.slice(6)}`)),i==="ein"&&c.length===9&&(c=`${c.slice(0,2)}-${c.slice(2)}`),i==="address"&&(c=c.replace(/\s+/g," ").trim()),s[i]=c;break}}}),console.log("PDF Extraction Results:",s),!s.businessType&&e.toLowerCase().includes("llc")&&(s.businessType="LLC"),!s.yearsInBusiness&&s.businessName){const i=new Date().getFullYear(),r=e.match(/(?:established|started|founded)[:\s]*(\d{4})/i);r&&(s.yearsInBusiness=(i-parseInt(r[1])).toString())}if(!s.averageMonthlyRevenue&&s.annualRevenue){const i=parseInt(s.annualRevenue.replace(/[,$]/g,""));isNaN(i)||(s.averageMonthlyRevenue=Math.round(i/12).toString())}return s},tP=({onSubmit:n})=>{const[e,t]=Q.useState("upload"),[s,i]=Q.useState(!1),[r,a]=Q.useState(null),[o,c]=Q.useState({businessName:"",ownerName:"",email:"",phone:"",address:"",ein:"",businessType:"",industry:"",yearsInBusiness:"",numberOfEmployees:"",annualRevenue:"",averageMonthlyRevenue:"",averageMonthlyDeposits:"",existingDebt:"",creditScore:"",requestedAmount:"",documents:[]}),[u,h]=Q.useState([]),[f,p]=Q.useState({}),[m,g]=Q.useState(null),b=["Retail","Restaurant","Healthcare","Construction","Professional Services","Transportation","Manufacturing","Technology","Real Estate","Other"],E=["Sole Proprietorship","Partnership","LLC","Corporation","S-Corporation"],x=async k=>{i(!0);try{const j=await Z2(k);a(j),c(I=>({...I,...j})),t("form")}catch(j){console.error("Error extracting data from PDF:",j),alert("Error extracting data from PDF. Please fill the form manually."),t("form")}finally{i(!1)}},v=async k=>{var I;const j=(I=k.target.files)==null?void 0:I[0];j&&(g(j),await x(j))},S=()=>{const k={};return o.businessName||(k.businessName="Business name is required"),o.ownerName||(k.ownerName="Owner name is required"),o.email||(k.email="Email is required"),o.phone||(k.phone="Phone is required"),(!o.requestedAmount||Number(o.requestedAmount)<1e4)&&(k.requestedAmount="Requested amount must be at least $10,000"),(!o.averageMonthlyRevenue||Number(o.averageMonthlyRevenue)<1e4)&&(k.averageMonthlyRevenue="Monthly revenue must be at least $10,000"),(!o.creditScore||Number(o.creditScore)<300||Number(o.creditScore)>850)&&(k.creditScore="Credit score must be between 300-850"),p(k),Object.keys(k).length===0},A=k=>{if(k.preventDefault(),!S())return;(async()=>{try{const I={business_name:o.businessName,owner_name:o.ownerName,email:o.email,phone:o.phone,address:o.address,ein:o.ein,business_type:o.businessType,industry:o.industry,years_in_business:Number(o.yearsInBusiness),number_of_employees:Number(o.numberOfEmployees),annual_revenue:Number(o.annualRevenue),monthly_revenue:Number(o.averageMonthlyRevenue),monthly_deposits:Number(o.averageMonthlyDeposits),existing_debt:Number(o.existingDebt),credit_score:Number(o.creditScore),requested_amount:Number(o.requestedAmount),status:"submitted",documents:u},R=await HT(I),U={id:R.id,businessName:R.business_name,monthlyRevenue:R.monthly_revenue,timeInBusiness:R.years_in_business,creditScore:R.credit_score,industry:R.industry,requestedAmount:R.requested_amount,status:R.status,contactInfo:{ownerName:R.owner_name,email:R.email,phone:R.phone||"",address:R.address||""},businessInfo:{ein:R.ein||"",businessType:R.business_type||"",yearsInBusiness:R.years_in_business,numberOfEmployees:R.number_of_employees},financialInfo:{annualRevenue:R.annual_revenue,averageMonthlyRevenue:R.monthly_revenue,averageMonthlyDeposits:R.monthly_deposits,existingDebt:R.existing_debt},documents:R.documents};n(U)}catch(I){console.error("Error saving application:",I),alert("Error saving application. Please try again.")}})()},C=k=>{const j=k.target.files;if(j){const I=Array.from(j).map(R=>R.name);h(R=>[...R,...I])}},N=k=>{h(j=>j.filter(I=>I!==k))};return e==="upload"?d.jsxs("div",{className:"bg-white rounded-xl shadow-lg",children:[d.jsxs("div",{className:"px-8 py-6 border-b border-gray-200",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Upload Application Document"}),d.jsx("p",{className:"text-gray-600 mt-1",children:"Upload your completed MCA application form to auto-populate the submission"})]}),d.jsxs("div",{className:"p-8",children:[s?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(f1,{className:"w-12 h-12 text-blue-600 mx-auto mb-4 animate-spin"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Processing Your Document"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"We're extracting information from your application document..."}),d.jsxs("div",{className:"max-w-md mx-auto",children:[d.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:d.jsx("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse",style:{width:"60%"}})}),d.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This usually takes 30-60 seconds"})]})]}):d.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-12",children:d.jsxs("div",{className:"text-center",children:[d.jsx(ba,{className:"w-16 h-16 text-gray-400 mx-auto mb-6"}),d.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Your Application Document"}),d.jsx("p",{className:"text-gray-600 mb-6",children:"Supported formats: PDF, DOC, DOCX. We'll automatically extract your business information."}),d.jsxs("div",{className:"text-sm text-gray-600",children:[d.jsxs("label",{htmlFor:"document-upload",className:"relative cursor-pointer bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500 transition-colors",children:[d.jsx("span",{children:"Choose Application File"}),d.jsx("input",{id:"document-upload",name:"document-upload",type:"file",className:"sr-only",accept:".pdf,.doc,.docx",onChange:v})]}),d.jsx("p",{className:"mt-4 text-xs text-gray-500",children:"Maximum file size: 10MB"})]})]})}),d.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:d.jsx("button",{onClick:()=>t("form"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Skip and fill form manually "})})]})]}):d.jsxs("div",{className:"bg-white rounded-xl shadow-lg",children:[d.jsxs("div",{className:"px-8 py-6 border-b border-gray-200",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Merchant Cash Advance Application"}),d.jsx("p",{className:"text-gray-600 mt-1",children:r?"Review and confirm the extracted information":"Please fill out all required information to get matched with qualified lenders"})]}),r&&d.jsxs("div",{className:"flex items-center text-green-600",children:[d.jsx(wN,{className:"w-5 h-5 mr-2"}),d.jsx("span",{className:"text-sm font-medium",children:"Data extracted from document"})]})]}),m&&d.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(ba,{className:"w-4 h-4 text-blue-600 mr-2"}),d.jsxs("span",{className:"text-sm text-blue-800 font-medium",children:["Source Document: ",m.name]}),d.jsx("button",{onClick:()=>{t("upload"),g(null),a(null),c({businessName:"",ownerName:"",email:"",phone:"",address:"",ein:"",businessType:"",industry:"",yearsInBusiness:"",numberOfEmployees:"",annualRevenue:"",averageMonthlyRevenue:"",averageMonthlyDeposits:"",existingDebt:"",creditScore:"",requestedAmount:"",documents:[]})},className:"ml-auto text-blue-600 hover:text-blue-800 text-sm",children:"Upload Different Document"})]})})]}),d.jsxs("form",{onSubmit:A,className:"p-8 space-y-8",children:[r&&d.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(Rs,{className:"w-5 h-5 text-green-600 mr-2"}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-green-800",children:"Information Successfully Extracted"}),d.jsx("p",{className:"text-sm text-green-700 mt-1",children:"We've automatically filled in your application details. Please review and make any necessary corrections below."})]})]})}),d.jsxs("div",{children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[d.jsx(Co,{className:"w-5 h-5 mr-2 text-blue-600"}),"Business Information"]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Name *"}),d.jsx("input",{type:"text",value:o.businessName,onChange:k=>c(j=>({...j,businessName:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.businessName?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"Enter your business name"}),f.businessName&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.businessName})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EIN"}),d.jsx("input",{type:"text",value:o.ein,onChange:k=>c(j=>({...j,ein:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"XX-XXXXXXX"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Type"}),d.jsxs("select",{value:o.businessType,onChange:k=>c(j=>({...j,businessType:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,children:[d.jsx("option",{value:"",children:"Select business type"}),E.map(k=>d.jsx("option",{value:k,children:k},k))]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Industry"}),d.jsxs("select",{value:o.industry,onChange:k=>c(j=>({...j,industry:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,children:[d.jsx("option",{value:"",children:"Select industry"}),b.map(k=>d.jsx("option",{value:k,children:k},k))]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Years in Business"}),d.jsx("input",{type:"number",value:o.yearsInBusiness,onChange:k=>c(j=>({...j,yearsInBusiness:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Employees"}),d.jsx("input",{type:"number",value:o.numberOfEmployees,onChange:k=>c(j=>({...j,numberOfEmployees:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"})]})]})]}),d.jsxs("div",{children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[d.jsx(EN,{className:"w-5 h-5 mr-2 text-blue-600"}),"Contact Information"]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Owner Name *"}),d.jsx("input",{type:"text",value:o.ownerName,onChange:k=>c(j=>({...j,ownerName:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.ownerName?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"Enter owner's full name"}),f.ownerName&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.ownerName})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),d.jsx("input",{type:"email",value:o.email,onChange:k=>c(j=>({...j,email:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.email?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"Enter email address"}),f.email&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.email})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),d.jsx("input",{type:"tel",value:o.phone,onChange:k=>c(j=>({...j,phone:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.phone?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"(555) 123-4567"}),f.phone&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.phone})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Address"}),d.jsx("input",{type:"text",value:o.address,onChange:k=>c(j=>({...j,address:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"Enter business address"})]})]})]}),d.jsxs("div",{children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[d.jsx(d1,{className:"w-5 h-5 mr-2 text-blue-600"}),"Financial Information"]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Annual Revenue"}),d.jsx("input",{type:"number",value:o.annualRevenue,onChange:k=>c(j=>({...j,annualRevenue:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Average Monthly Revenue *"}),d.jsx("input",{type:"number",value:o.averageMonthlyRevenue,onChange:k=>c(j=>({...j,averageMonthlyRevenue:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.averageMonthlyRevenue?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"}),f.averageMonthlyRevenue&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.averageMonthlyRevenue})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Average Monthly Deposits"}),d.jsx("input",{type:"number",value:o.averageMonthlyDeposits,onChange:k=>c(j=>({...j,averageMonthlyDeposits:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Existing Debt"}),d.jsx("input",{type:"number",value:o.existingDebt,onChange:k=>c(j=>({...j,existingDebt:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"0",min:"0"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Credit Score *"}),d.jsx("input",{type:"number",value:o.creditScore,onChange:k=>c(j=>({...j,creditScore:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.creditScore?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"300-850",min:"300",max:"850"}),f.creditScore&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.creditScore})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Requested Amount *"}),d.jsx("input",{type:"number",value:o.requestedAmount,onChange:k=>c(j=>({...j,requestedAmount:k.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f.requestedAmount?"border-red-300":r?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"10000",min:"10000"}),f.requestedAmount&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.requestedAmount})]})]})]}),d.jsxs("div",{children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[d.jsx(fb,{className:"w-5 h-5 mr-2 text-blue-600"}),"Additional Documents"]}),d.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx(fb,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),d.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Upload additional supporting documents (bank statements, tax returns, etc.)"}),d.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500 transition-colors",children:[d.jsx("span",{children:"Choose Files"}),d.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",multiple:!0,onChange:C})]})]}),u.length>0&&d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Uploaded Files:"}),d.jsx("div",{className:"space-y-2",children:u.map((k,j)=>d.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(ba,{className:"w-4 h-4 text-gray-500 mr-2"}),d.jsx("span",{className:"text-sm text-gray-700",children:k})]}),d.jsx("button",{type:"button",onClick:()=>N(k),className:"text-red-500 hover:text-red-700 text-sm",children:"Remove"})]},j))})]})]})]}),d.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:d.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-8 py-3 rounded-lg font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Submit Application"})})]})]})},sP=({application:n,onLenderSelect:e,onBack:t})=>{const[s,i]=Q.useState([]),[r,a]=Q.useState([]),[o,c]=Q.useState(!0);Q.useEffect(()=>{(async()=>{if(n)try{c(!0);const m=await $v()||[],b=["draft","submitted","under-review","approved","funded","declined"].includes(n.status)?n.status:"draft",E={id:"",business_name:n.businessName||"",owner_name:n.ownerName||"",email:n.email||"",phone:n.phone||"",address:n.address||"",ein:n.ein||"",business_type:n.businessType||"",industry:n.industry||"",years_in_business:n.yearsInBusiness||0,number_of_employees:n.numberOfEmployees||0,annual_revenue:n.annualRevenue||0,monthly_revenue:n.monthlyRevenue||0,monthly_deposits:n.monthlyDeposits||0,existing_debt:n.existingDebt||0,credit_score:n.creditScore||0,requested_amount:n.requestedAmount||0,status:b,documents:n.documents||[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()},x=await YT(m,E);i(x)}catch(p){console.error("Error loading lenders:",p)}finally{c(!1)}})()},[n]);const u=f=>{a(p=>p.includes(f)?p.filter(m=>m!==f):[...p,f])},h=()=>{e(r)};return o?d.jsx("div",{className:"flex items-center justify-center py-12",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"Finding qualified lenders..."})]})}):n?d.jsxs("div",{className:"space-y-8",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Qualified Lenders"}),d.jsxs("p",{className:"text-gray-600 mb-6",children:["We found ",s.length," lenders that match your business profile"]}),d.jsx("div",{className:"bg-blue-50 rounded-xl p-6 mb-8",children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[d.jsxs("div",{className:"text-center",children:[d.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:["$",(n.requestedAmount||0).toLocaleString()]}),d.jsx("div",{className:"text-sm text-blue-600",children:"Requested Amount"})]}),d.jsxs("div",{className:"text-center",children:[d.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:["$",(n.monthlyRevenue||0).toLocaleString()]}),d.jsx("div",{className:"text-sm text-blue-600",children:"Monthly Revenue"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-2xl font-bold text-blue-900",children:n.creditScore||0}),d.jsx("div",{className:"text-sm text-blue-600",children:"Credit Score"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-2xl font-bold text-blue-900",children:n.industry||"N/A"}),d.jsx("div",{className:"text-sm text-blue-600",children:"Industry"})]})]})})]}),d.jsx("div",{className:"grid gap-6",children:s.map(f=>d.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-6 border-2 transition-all cursor-pointer ${r.includes(f.id)?"border-emerald-500 bg-emerald-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>u(f.id),children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-lg flex items-center justify-center mr-4",children:d.jsx(Co,{className:"w-8 h-8 text-emerald-600"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold text-gray-900",children:f.name}),d.jsxs("div",{className:"flex items-center mt-1",children:[d.jsx(Iv,{className:"w-4 h-4 text-yellow-400 fill-current mr-1"}),d.jsx("span",{className:"text-sm font-medium",children:f.rating}),d.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:[f.approval_rate,"% approval rate"]})]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"text-right",children:[d.jsx("div",{className:"text-lg font-bold text-emerald-600",children:"95% Match"}),d.jsx("div",{className:"text-sm text-gray-500",children:"Qualification Score"})]}),d.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${r.includes(f.id)?"bg-emerald-500 border-emerald-500":"border-gray-300"}`,children:r.includes(f.id)&&d.jsx(Rs,{className:"w-4 h-4 text-white"})})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[d.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Amount Range"}),d.jsxs("div",{className:"text-sm font-bold text-blue-900",children:["$",f.min_amount.toLocaleString()," - $",f.max_amount.toLocaleString()]})]}),d.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[d.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Factor Rate"}),d.jsx("div",{className:"text-sm font-bold text-green-900",children:f.factor_rate})]}),d.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[d.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Payback Term"}),d.jsx("div",{className:"text-sm font-bold text-purple-900",children:f.payback_term})]}),d.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[d.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Approval Time"}),d.jsx("div",{className:"text-sm font-bold text-orange-900",children:f.approval_time})]})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Key Features"}),d.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.features.slice(0,4).map((p,m)=>d.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm",children:p},m)),f.features.length>4&&d.jsxs("span",{className:"text-sm text-gray-500",children:["+",f.features.length-4," more"]})]})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Rs,{className:"w-4 h-4 text-green-500 mr-2"}),d.jsx("span",{className:"text-gray-600",children:"Amount: "})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(Rs,{className:"w-4 h-4 text-green-500 mr-2"}),d.jsx("span",{className:"text-gray-600",children:"Credit: "})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(Rs,{className:"w-4 h-4 text-green-500 mr-2"}),d.jsx("span",{className:"text-gray-600",children:"Revenue: "})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(Rs,{className:"w-4 h-4 text-green-500 mr-2"}),d.jsx("span",{className:"text-gray-600",children:"Industry: "})]})]})]},f.id))}),d.jsxs("div",{className:"flex justify-between pt-8 border-t border-gray-200",children:[d.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Back to Application"}),d.jsxs("button",{onClick:h,disabled:r.length===0,className:`flex items-center px-8 py-3 rounded-lg font-medium transition-colors ${r.length>0?"bg-emerald-600 text-white hover:bg-emerald-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:["Continue with ",r.length," Lender",r.length!==1?"s":"",d.jsx(xN,{className:"w-5 h-5 ml-2"})]})]})]}):d.jsx("div",{className:"text-center py-12",children:d.jsx("p",{className:"text-gray-500",children:"No application data available"})})},nP=({application:n,selectedLenderIds:e,onBack:t,onSubmit:s})=>{const[i,r]=Q.useState(!1),[a,o]=Q.useState(()=>{var j,I;const N=localStorage.getItem("mcaPortalSmtpSettings"),k={smtpHost:"",smtpPort:"",smtpUser:"",smtpPassword:"",fromEmail:((j=n==null?void 0:n.contactInfo)==null?void 0:j.email)||""};if(N)try{const R=JSON.parse(N);return{...R,fromEmail:((I=n==null?void 0:n.contactInfo)==null?void 0:I.email)||R.fromEmail}}catch(R){return console.error("Error parsing saved SMTP settings:",R),k}return k}),[c,u]=Q.useState(!1),[h,f]=Q.useState(!1),[p,m]=Q.useState(!1),[g,b]=Q.useState(null),[E,x]=Q.useState([]);zy.useEffect(()=>{(async()=>{try{const k=await $v();x(k)}catch(k){console.error("Error loading lenders:",k)}})()},[]);const v=E.filter(N=>e.includes(N.id)),S=N=>n?(localStorage.getItem("mcaPortalEmailTemplate")||`Subject: Merchant Cash Advance Application - {{businessName}}

Dear {{lenderName}} Team,

I hope this email finds you well. I am writing to submit a merchant cash advance application for your review and consideration.

BUSINESS INFORMATION:
 Business Name: {{businessName}}
 Owner: {{ownerName}}
 Industry: {{industry}}
 Years in Business: {{yearsInBusiness}}
 Business Type: {{businessType}}
 EIN: {{ein}}

FINANCIAL DETAILS:
 Requested Amount: \${{requestedAmount}}
 Monthly Revenue: \${{monthlyRevenue}}
 Annual Revenue: \${{annualRevenue}}
 Credit Score: {{creditScore}}
 Existing Debt: \${{existingDebt}}

CONTACT INFORMATION:
 Email: {{email}}
 Phone: {{phone}}
 Address: {{address}}

I have attached the following documents for your review:
 Business bank statements (last 6 months)
 Tax returns
 Completed application form
 Voided business check

Based on your underwriting guidelines, I believe this application aligns well with your lending criteria:
 Amount Range: \${{lenderMinAmount}} - \${{lenderMaxAmount}}
 Factor Rate: {{lenderFactorRate}}
 Payback Term: {{lenderPaybackTerm}}
 Approval Time: {{lenderApprovalTime}}

I would appreciate the opportunity to discuss this application further and answer any questions you may have. Please let me know if you need any additional information or documentation.

Thank you for your time and consideration. I look forward to hearing from you soon.

Best regards,
{{ownerName}}
{{businessName}}
{{email}}
{{phone}}

---
This application was submitted through MCAPortal Pro
Application ID: {{applicationId}}`).replace(/\{\{businessName\}\}/g,n.businessName).replace(/\{\{ownerName\}\}/g,n.contactInfo.ownerName).replace(/\{\{industry\}\}/g,n.industry).replace(/\{\{yearsInBusiness\}\}/g,n.timeInBusiness.toString()).replace(/\{\{businessType\}\}/g,n.businessInfo.businessType).replace(/\{\{ein\}\}/g,n.businessInfo.ein).replace(/\{\{requestedAmount\}\}/g,n.requestedAmount.toLocaleString()).replace(/\{\{monthlyRevenue\}\}/g,n.monthlyRevenue.toLocaleString()).replace(/\{\{annualRevenue\}\}/g,n.financialInfo.annualRevenue.toLocaleString()).replace(/\{\{creditScore\}\}/g,n.creditScore.toString()).replace(/\{\{existingDebt\}\}/g,n.financialInfo.existingDebt.toLocaleString()).replace(/\{\{email\}\}/g,n.contactInfo.email).replace(/\{\{phone\}\}/g,n.contactInfo.phone).replace(/\{\{address\}\}/g,n.contactInfo.address).replace(/\{\{lenderName\}\}/g,N.name).replace(/\{\{lenderMinAmount\}\}/g,N.min_amount.toLocaleString()).replace(/\{\{lenderMaxAmount\}\}/g,N.max_amount.toLocaleString()).replace(/\{\{lenderFactorRate\}\}/g,N.factor_rate).replace(/\{\{lenderPaybackTerm\}\}/g,N.payback_term).replace(/\{\{lenderApprovalTime\}\}/g,N.approval_time).replace(/\{\{applicationId\}\}/g,n.id):"",A=N=>{try{const k={smtpHost:N.smtpHost,smtpPort:N.smtpPort,smtpUser:N.smtpUser,smtpPassword:"",fromEmail:N.fromEmail};localStorage.setItem("mcaPortalSmtpSettings",JSON.stringify(k))}catch(k){console.error("Error saving SMTP settings:",k)}},C=async()=>{var N;f(!0),A(a);try{n&&await $1(n.id,e),console.log(`Sending application from: ${(N=n==null?void 0:n.contactInfo)==null?void 0:N.email}`),console.log(`Selected lenders: ${v.length}`),console.log(`SMTP Settings configured: ${a.smtpHost?"Yes":"No"}`),await new Promise(k=>setTimeout(k,3e3)),m(!0),s()}catch(k){console.error("Error submitting application:",k),alert("Error submitting application. Please try again.")}finally{f(!1)}};return n?p?d.jsx("div",{className:"bg-white rounded-xl shadow-lg p-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx(Rs,{className:"w-16 h-16 text-green-600 mx-auto mb-6"}),d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Application Submitted Successfully!"}),d.jsxs("p",{className:"text-gray-600 mb-6",children:["Your application and business bank statements have been sent to ",v.length," selected lender",v.length>1?"s":"",". You should receive responses within 24-48 hours at ",n.contactInfo.email,"."]}),d.jsxs("div",{className:"bg-green-50 rounded-lg p-6 mb-6",children:[d.jsx("h3",{className:"text-lg font-medium text-green-800 mb-3",children:"Submitted to:"}),d.jsx("div",{className:"space-y-2",children:v.map(N=>d.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("img",{src:"https://images.pexels.com/photos/259027/pexels-photo-259027.jpeg?auto=compress&cs=tinysrgb&w=100&h=100",alt:N.name,className:"w-12 h-12 rounded-lg mr-4"}),d.jsx("span",{className:"font-medium text-green-900",children:N.name})]}),d.jsx("span",{className:"text-sm text-green-600",children:" Sent"})]},N.id))})]}),d.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Submit Another Application"})]})}):d.jsxs("div",{className:"space-y-8",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("button",{onClick:t,className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[d.jsx(vN,{className:"w-5 h-5 mr-2"}),"Back to Lender Selection"]}),d.jsxs("div",{className:"text-sm text-gray-500",children:["Application ID: ",n.id]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Submission Summary"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[d.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[d.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Business"}),d.jsx("div",{className:"text-lg font-bold text-blue-900",children:n.businessName}),d.jsx("div",{className:"text-sm text-blue-700",children:n.industry})]}),d.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[d.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Requested Amount"}),d.jsxs("div",{className:"text-lg font-bold text-green-900",children:["$",n.requestedAmount.toLocaleString()]})]}),d.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[d.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Monthly Revenue"}),d.jsxs("div",{className:"text-lg font-bold text-purple-900",children:["$",n.monthlyRevenue.toLocaleString()]})]}),d.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[d.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Credit Score"}),d.jsx("div",{className:"text-lg font-bold text-orange-900",children:n.creditScore})]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Selected Lenders (",v.length,")"]}),d.jsx("div",{className:"space-y-3",children:v.map(N=>d.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("img",{src:"https://images.pexels.com/photos/259027/pexels-photo-259027.jpeg?auto=compress&cs=tinysrgb&w=100&h=100",alt:N.name,className:"w-12 h-12 rounded-lg mr-4"}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-medium text-gray-900",children:N.name}),d.jsxs("p",{className:"text-sm text-gray-600",children:[N.factor_rate,"  ",N.payback_term,"  ",N.approval_time]})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-sm font-medium text-green-600",children:"95% Match"}),d.jsx("button",{onClick:()=>{b(N),r(!0)},className:"text-blue-600 hover:text-blue-800 text-sm flex items-center",children:"Preview Email"})]})]},N.id))})]}),d.jsx("div",{className:"bg-blue-50 rounded-lg p-4 mb-6",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-medium text-blue-900",children:"Email Configuration"}),d.jsxs("p",{className:"text-sm text-blue-700",children:["Emails will be sent from: ",d.jsx("span",{className:"font-medium",children:n.contactInfo.email})]}),d.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["SMTP Status: ",a.smtpHost?"Configured ":"Not configured - using default settings",a.smtpHost&&d.jsx("span",{className:"block text-xs text-blue-500 mt-1",children:"Settings saved for future submissions"})]})]}),d.jsxs("button",{onClick:()=>u(!0),className:"flex items-center text-blue-600 hover:text-blue-800 text-sm",children:[d.jsx(p1,{className:"w-4 h-4 mr-1"}),"Configure SMTP"]})]})}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Documents to be Included:"}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[d.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[d.jsx(ba,{className:"w-4 h-4 mr-2 text-blue-600"}),"Application Form"]}),d.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[d.jsx(ba,{className:"w-4 h-4 mr-2 text-green-600"}),"Bank Statements (6 months)"]}),d.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[d.jsx(ba,{className:"w-4 h-4 mr-2 text-purple-600"}),"Tax Returns"]}),d.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[d.jsx(ba,{className:"w-4 h-4 mr-2 text-orange-600"}),"Voided Check"]})]})]}),d.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:d.jsx("button",{onClick:C,disabled:h,className:`flex items-center px-8 py-3 rounded-lg font-medium transition-colors ${h?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:h?d.jsxs(d.Fragment,{children:[d.jsx(f1,{className:"w-5 h-5 mr-2 animate-spin"}),"Sending Applications..."]}):d.jsxs(d.Fragment,{children:[d.jsx(AN,{className:"w-5 h-5 mr-2"}),"Send to ",v.length," Lender",v.length>1?"s":""]})})})]}),c&&d.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[d.jsxs("div",{className:"p-6 border-b border-gray-200",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Email Settings"}),d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure your SMTP settings for sending applications"})]}),d.jsxs("div",{className:"p-6 space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Host"}),d.jsx("input",{type:"text",value:a.smtpHost,onChange:N=>o(k=>({...k,smtpHost:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"smtp.gmail.com"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Port"}),d.jsx("input",{type:"text",value:a.smtpPort,onChange:N=>o(k=>({...k,smtpPort:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"587"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),d.jsx("input",{type:"text",value:a.smtpUser,onChange:N=>o(k=>({...k,smtpUser:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"your-email@gmail.com"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),d.jsx("input",{type:"password",value:a.smtpPassword,onChange:N=>o(k=>({...k,smtpPassword:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"your-app-password"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Email"}),d.jsx("input",{type:"email",value:n.contactInfo.email,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",disabled:!0}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Using your application email address"})]})]}),d.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{onClick:()=>{A(a),u(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save Settings"})]})]})}),i&&g&&d.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Email Preview - ",g.name]}),d.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[d.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[d.jsx("strong",{children:"From:"})," ",n.contactInfo.email]}),d.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[d.jsx("strong",{children:"To:"})," ",g.name," (contact email would be used)"]})]}),d.jsx("div",{className:"bg-white border rounded-lg p-6",children:d.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-800 font-mono",children:S(g)})})]}),d.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end",children:d.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Close Preview"})})]})})]}):d.jsx("div",{className:"text-center py-12",children:d.jsx("p",{className:"text-gray-500",children:"No application data available"})})},iP=()=>{const[n,e]=Q.useState("application"),[t,s]=Q.useState(null),[i,r]=Q.useState([]),a=h=>{const f={id:h.id,businessName:h.businessName,monthlyRevenue:h.monthlyRevenue,timeInBusiness:h.timeInBusiness,creditScore:h.creditScore,industry:h.industry,requestedAmount:h.requestedAmount,status:h.status,ownerName:h.contactInfo.ownerName,email:h.contactInfo.email,phone:h.contactInfo.phone,address:h.contactInfo.address,ein:h.businessInfo.ein,businessType:h.businessInfo.businessType,yearsInBusiness:h.businessInfo.yearsInBusiness,numberOfEmployees:h.businessInfo.numberOfEmployees,annualRevenue:h.financialInfo.annualRevenue,monthlyDeposits:h.financialInfo.averageMonthlyDeposits,existingDebt:h.financialInfo.existingDebt,documents:h.documents,contactInfo:h.contactInfo,businessInfo:h.businessInfo,financialInfo:h.financialInfo};s(f),e("matches")},o=h=>{r(h),e("recap")},c=()=>{e("matches")},u=()=>{console.log("Final submission completed")};return d.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Submissions Portal"}),d.jsx("p",{className:"text-gray-600",children:"Submit your merchant cash advance application and get matched with qualified lenders"})]}),d.jsx("div",{className:"mb-8",children:d.jsxs("div",{className:"flex items-center",children:[d.jsxs("div",{className:`flex items-center ${n==="application"?"text-blue-600":t?"text-green-600":"text-gray-400"}`,children:[d.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${t?"bg-green-100 text-green-600":n==="application"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:t?d.jsx(Rs,{className:"w-5 h-5"}):"1"}),d.jsx("span",{className:"ml-2 text-sm font-medium",children:"Document Upload & Application"})]}),d.jsx("div",{className:`flex-1 h-1 mx-4 ${t?"bg-green-200":"bg-gray-200"}`}),d.jsxs("div",{className:`flex items-center ${n==="matches"?"text-blue-600":i.length>0?"text-green-600":"text-gray-400"}`,children:[d.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${i.length>0?"bg-green-100 text-green-600":n==="matches"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:i.length>0?d.jsx(Rs,{className:"w-5 h-5"}):"2"}),d.jsx("span",{className:"ml-2 text-sm font-medium",children:"Lender Matches"})]}),d.jsx("div",{className:`flex-1 h-1 mx-4 ${i.length>0?"bg-green-200":"bg-gray-200"}`}),d.jsxs("div",{className:`flex items-center ${n==="recap"?"text-blue-600":"text-gray-400"}`,children:[d.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${n==="recap"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:"3"}),d.jsx("span",{className:"ml-2 text-sm font-medium",children:"Submission Recap"})]})]})}),n==="application"?d.jsx(tP,{onSubmit:a}):n==="matches"?d.jsx(sP,{application:t,onBack:()=>e("application"),onLenderSelect:o}):d.jsx(nP,{application:t?{...t,status:["draft","submitted","under-review","matched"].includes(String(t.status))?t.status:"submitted"}:null,selectedLenderIds:i,onBack:c,onSubmit:u})]})},rP=()=>{const[n,e]=Q.useState("applications"),[t,s]=Q.useState(!1),[i,r]=Q.useState(null),[a,o]=Q.useState(!1),[c,u]=Q.useState(!1),[h,f]=Q.useState(()=>localStorage.getItem("mcaPortalEmailTemplate")||`Subject: Merchant Cash Advance Application - {{businessName}}

Dear {{lenderName}} Team,

I hope this email finds you well. I am writing to submit a merchant cash advance application for your review and consideration.

BUSINESS INFORMATION:
 Business Name: {{businessName}}
 Owner: {{ownerName}}
 Industry: {{industry}}
 Years in Business: {{yearsInBusiness}}
 Business Type: {{businessType}}
 EIN: {{ein}}

FINANCIAL DETAILS:
 Requested Amount: \${{requestedAmount}}
 Monthly Revenue: \${{monthlyRevenue}}
 Annual Revenue: \${{annualRevenue}}
 Credit Score: {{creditScore}}
 Existing Debt: \${{existingDebt}}

CONTACT INFORMATION:
 Email: {{email}}
 Phone: {{phone}}
 Address: {{address}}

I have attached the following documents for your review:
 Business bank statements (last 6 months)
 Tax returns
 Completed application form
 Voided business check

Based on your underwriting guidelines, I believe this application aligns well with your lending criteria:
 Amount Range: \${{lenderMinAmount}} - \${{lenderMaxAmount}}
 Factor Rate: {{lenderFactorRate}}
 Payback Term: {{lenderPaybackTerm}}
 Approval Time: {{lenderApprovalTime}}

I would appreciate the opportunity to discuss this application further and answer any questions you may have. Please let me know if you need any additional information or documentation.

Thank you for your time and consideration. I look forward to hearing from you soon.

Best regards,
{{ownerName}}
{{businessName}}
{{email}}
{{phone}}

---
This application was submitted through MCAPortal Pro
Application ID: {{applicationId}}`),[p,m]=Q.useState(null),[g,b]=Q.useState([]),[E,x]=Q.useState([]),[v,S]=Q.useState(!0),[A,C]=Q.useState(null),[N,k]=Q.useState(!1),[j,I]=Q.useState([]),[R,U]=Q.useState(!1),[H,J]=Q.useState({name:"",contactEmail:"",phone:"",status:"active",rating:4,minAmount:1e4,maxAmount:5e5,minCreditScore:550,maxCreditScore:850,minTimeInBusiness:1,minMonthlyRevenue:15e3,industries:[],factorRate:"1.1 - 1.4",paybackTerm:"3-18 months",approvalTime:"24 hours",features:[]}),de=["All Industries","Retail","Restaurant","Healthcare","Professional Services","Technology","Construction","Transportation","Manufacturing","Real Estate","Automotive","Education","Entertainment","Agriculture","Finance"],et=["No collateral required","Same day funding","Flexible payments","Competitive rates","Larger amounts","Industry expertise","Instant approval","Bad credit OK","Fast funding","Best rates","Large amounts","Premium service","Merchant-focused","Flexible terms"];zy.useEffect(()=>{(async()=>{try{S(!0);const[P,Oe]=await Promise.all([$v(),F1()]),ms=await Promise.all(Oe.map(async gs=>{const FA=await S0(gs.id);return{...gs,matchedLenders:FA.length}}));b(P),x(ms)}catch(P){console.error("Error loading data:",P)}finally{S(!1)}})()},[]);const O=async T=>{try{const P=await S0(T);I(P)}catch(P){console.error("Error loading submissions:",P)}},q=T=>{m(T),o(!0),O(T.id)},M=T=>{C(T),k(!0),O(T.id)},G=async T=>{if(T.preventDefault(),!!A)try{const P={business_name:A.business_name,owner_name:A.owner_name,email:A.email,phone:A.phone,address:A.address,ein:A.ein,business_type:A.business_type,industry:A.industry,years_in_business:A.years_in_business,number_of_employees:A.number_of_employees,annual_revenue:A.annual_revenue,monthly_revenue:A.monthly_revenue,monthly_deposits:A.monthly_deposits,existing_debt:A.existing_debt,credit_score:A.credit_score,requested_amount:A.requested_amount,status:A.status,documents:A.documents,user_id:A.user_id},Oe=await VT(A.id,P);x(ms=>ms.map(gs=>gs.id===A.id?{...Oe,matchedLenders:A.matchedLenders||gs.matchedLenders}:gs)),k(!1),C(null)}catch(P){console.error("Error updating application:",P),alert("Error updating application")}};if(v)return d.jsx("div",{className:"flex items-center justify-center py-12",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"Loading admin data..."})]})});const X=T=>{switch(T){case"active":case"matched":case"funded":return"bg-green-100 text-green-800";case"inactive":case"declined":return"bg-red-100 text-red-800";case"pending":case"under-review":return"bg-yellow-100 text-yellow-800";case"submitted":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},ue=T=>{(async()=>{try{await XT(T),b(Oe=>Oe.filter(ms=>ms.id!==T))}catch(Oe){console.error("Error deleting lender:",Oe),alert("Error deleting lender. Please try again.")}})()},oe=T=>{J({name:T.name,contactEmail:T.contact_email,phone:T.phone||"",status:T.status,rating:T.rating,minAmount:T.min_amount,maxAmount:T.max_amount,minCreditScore:T.min_credit_score,maxCreditScore:T.max_credit_score,minTimeInBusiness:T.min_time_in_business,minMonthlyRevenue:T.min_monthly_revenue,industries:T.industries,factorRate:T.factor_rate,paybackTerm:T.payback_term,approvalTime:T.approval_time,features:T.features}),r(T),s(!0)},Ae=()=>{J({name:"",contactEmail:"",phone:"",status:"active",rating:4,minAmount:1e4,maxAmount:5e5,minCreditScore:550,maxCreditScore:850,minTimeInBusiness:1,minMonthlyRevenue:15e3,industries:[],factorRate:"1.1 - 1.4",paybackTerm:"3-18 months",approvalTime:"24 hours",features:[]}),r(null),s(!0)},Nt=T=>{J(P=>({...P,industries:P.industries.includes(T)?P.industries.filter(Oe=>Oe!==T):[...P.industries,T]}))},rn=T=>{J(P=>({...P,features:P.features.includes(T)?P.features.filter(Oe=>Oe!==T):[...P.features,T]}))},Pe=()=>{(async()=>{try{const P={name:H.name,contact_email:H.contactEmail,phone:H.phone,status:H.status,rating:H.rating,total_applications:0,approval_rate:0,min_amount:H.minAmount,max_amount:H.maxAmount,min_credit_score:H.minCreditScore,max_credit_score:H.maxCreditScore,min_time_in_business:H.minTimeInBusiness,min_monthly_revenue:H.minMonthlyRevenue,industries:H.industries,factor_rate:H.factorRate,payback_term:H.paybackTerm,approval_time:H.approvalTime,features:H.features};if(i){const Oe=await GT(i.id,P);b(ms=>ms.map(gs=>gs.id===i.id?Oe:gs))}else{const Oe=await qT(P);b(ms=>[...ms,Oe])}s(!1),r(null)}catch(P){console.error("Error saving lender:",P),alert("Error saving lender. Please try again.")}})()},me=T=>{confirm("Are you sure you want to delete this application? This action cannot be undone.")&&(async()=>{try{await WT(T),x(Oe=>Oe.filter(ms=>ms.id!==T))}catch(Oe){console.error("Error deleting application:",Oe),alert("Error deleting application. Please try again.")}})()},ps=async(T,P)=>{try{const Oe=await KT(T.id,P);I(ms=>ms.map(gs=>gs.id===T.id?{...gs,...Oe}:gs))}catch(Oe){console.error("Error updating submission:",Oe),alert("Error updating submission")}},Bh=async T=>{if(A)try{await $1(A.id,[T]),O(A.id),U(!1)}catch(P){console.error("Error adding lender submission:",P),alert("Error adding lender submission")}};return d.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Portal"}),d.jsx("p",{className:"text-gray-600",children:"Manage applications, lenders, and underwriting guidelines"})]}),d.jsx("div",{className:"border-b border-gray-200 mb-8",children:d.jsxs("nav",{className:"flex space-x-8",children:[d.jsxs("button",{onClick:()=>e("applications"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="applications"?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[d.jsx(kN,{className:"w-5 h-5 inline mr-2"}),"Applications"]}),d.jsxs("button",{onClick:()=>e("lenders"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="lenders"?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[d.jsx(Co,{className:"w-5 h-5 inline mr-2"}),"Lenders"]}),d.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center",children:[d.jsx(_N,{className:"w-4 h-4 mr-2"}),"Email Template"]}),d.jsxs("button",{onClick:()=>e("settings"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="settings"?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[d.jsx(p1,{className:"w-5 h-5 inline mr-2"}),"Settings"]})]})}),n==="applications"&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Applications"}),d.jsx("div",{className:"flex space-x-2",children:d.jsxs("select",{className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",children:[d.jsx("option",{children:"All Statuses"}),d.jsx("option",{children:"Submitted"}),d.jsx("option",{children:"Under Review"}),d.jsx("option",{children:"Matched"}),d.jsx("option",{children:"Funded"}),d.jsx("option",{children:"Declined"})]})})]}),d.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Application"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue/Credit"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Matches"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(T=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.business_name}),d.jsx("div",{className:"text-sm text-gray-500",children:T.owner_name}),d.jsx("div",{className:"text-xs text-gray-400",children:T.id})]})}),d.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[d.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["$",T.requested_amount.toLocaleString()]}),d.jsx("div",{className:"text-sm text-gray-500",children:T.industry})]}),d.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[d.jsxs("div",{className:"text-sm text-gray-900",children:["$",T.monthly_revenue.toLocaleString(),"/mo"]}),d.jsxs("div",{className:"text-sm text-gray-500",children:["Credit: ",T.credit_score]})]}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${X(T.status)}`,children:T.status})}),d.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[T.matchedLenders," lenders"]}),d.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[d.jsx("button",{onClick:()=>q(T),className:"text-emerald-600 hover:text-emerald-900 mr-3",children:d.jsx(h1,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>M(T),className:"text-blue-600 hover:text-blue-900 mr-3",children:d.jsx(u0,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>me(T.id),className:"text-red-600 hover:text-red-900",children:d.jsx(hb,{className:"w-4 h-4"})})]})]},T.id))})]})})]}),n==="lenders"&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Lender Management"}),d.jsxs("button",{onClick:()=>{Ae()},className:"bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition-colors flex items-center",children:[d.jsx(ng,{className:"w-4 h-4 mr-2"}),"Add Lender"]})]}),d.jsx("div",{className:"grid gap-6",children:g.map(T=>d.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-lg flex items-center justify-center mr-4",children:d.jsx(Co,{className:"w-6 h-6 text-emerald-600"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold text-gray-900",children:T.name}),d.jsx("p",{className:"text-gray-600",children:T.contact_email}),d.jsx("p",{className:"text-gray-500 text-sm",children:T.phone})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${X(T.status)}`,children:T.status}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(Iv,{className:"w-4 h-4 text-yellow-400 fill-current mr-1"}),d.jsx("span",{className:"text-sm font-medium",children:T.rating})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[d.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Applications"}),d.jsx("div",{className:"text-lg font-bold text-blue-900",children:T.total_applications})]}),d.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[d.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Approval Rate"}),d.jsxs("div",{className:"text-lg font-bold text-green-900",children:[T.approval_rate,"%"]})]}),d.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[d.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Amount Range"}),d.jsxs("div",{className:"text-sm font-bold text-purple-900",children:["$",T.min_amount.toLocaleString()," - $",T.max_amount.toLocaleString()]})]}),d.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[d.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Factor Rate"}),d.jsx("div",{className:"text-sm font-bold text-orange-900",children:T.factor_rate})]})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Underwriting Guidelines"}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Min Credit Score:"}),d.jsx("span",{className:"ml-1 font-medium",children:T.min_credit_score})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Min Time in Business:"}),d.jsxs("span",{className:"ml-1 font-medium",children:[T.min_time_in_business," years"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Min Monthly Revenue:"}),d.jsxs("span",{className:"ml-1 font-medium",children:["$",T.min_monthly_revenue.toLocaleString()]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Approval Time:"}),d.jsx("span",{className:"ml-1 font-medium",children:T.approval_time})]})]})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("span",{className:"text-sm text-gray-500",children:"Industries: "}),d.jsx("span",{className:"text-sm font-medium",children:T.industries.join(", ")})]}),d.jsxs("div",{className:"flex justify-end space-x-3",children:[d.jsxs("button",{onClick:()=>oe(T),className:"px-4 py-2 text-blue-600 border border-blue-300 rounded-lg hover:bg-blue-50 transition-colors flex items-center",children:[d.jsx(u0,{className:"w-4 h-4 mr-1"}),"Edit"]}),d.jsxs("button",{onClick:()=>ue(T.id),className:"px-4 py-2 text-red-600 border border-red-300 rounded-lg hover:bg-red-50 transition-colors flex items-center",children:[d.jsx(hb,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]},T.id))})]}),n==="settings"&&d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"System Settings"}),d.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"General Settings"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Application Amount"}),d.jsx("input",{type:"number",defaultValue:"10000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Application Amount"}),d.jsx("input",{type:"number",defaultValue:"2000000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Notification Settings"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",defaultChecked:!0,className:"mr-3"}),d.jsx("label",{className:"text-sm text-gray-700",children:"Email notifications for new applications"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",defaultChecked:!0,className:"mr-3"}),d.jsx("label",{className:"text-sm text-gray-700",children:"Email notifications for lender matches"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",className:"mr-3"}),d.jsx("label",{className:"text-sm text-gray-700",children:"SMS notifications for urgent matters"})]})]})]})]}),d.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:d.jsx("button",{className:"bg-emerald-600 text-white px-6 py-2 rounded-lg hover:bg-emerald-700 transition-colors",children:"Save Settings"})})]})]}),t&&d.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:i?"Edit Lender":"Add New Lender"})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lender Name *"}),d.jsx("input",{type:"text",value:H.name,onChange:T=>J(P=>({...P,name:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"Enter lender name"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email *"}),d.jsx("input",{type:"email",value:H.contactEmail,onChange:T=>J(P=>({...P,contactEmail:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"contact@lender.com"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),d.jsx("input",{type:"tel",value:H.phone,onChange:T=>J(P=>({...P,phone:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"(555) 123-4567"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),d.jsxs("select",{value:H.status,onChange:T=>J(P=>({...P,status:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",children:[d.jsx("option",{value:"active",children:"Active"}),d.jsx("option",{value:"inactive",children:"Inactive"}),d.jsx("option",{value:"pending",children:"Pending"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),d.jsx("input",{type:"number",min:"1",max:"5",step:"0.1",value:H.rating,onChange:T=>J(P=>({...P,rating:parseFloat(T.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Underwriting Guidelines"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Funding Range"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Amount ($)"}),d.jsx("input",{type:"number",value:H.minAmount,onChange:T=>J(P=>({...P,minAmount:parseInt(T.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Amount ($)"}),d.jsx("input",{type:"number",value:H.maxAmount,onChange:T=>J(P=>({...P,maxAmount:parseInt(T.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Credit Score Requirements"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Credit Score"}),d.jsx("input",{type:"number",min:"300",max:"850",value:H.minCreditScore,onChange:T=>J(P=>({...P,minCreditScore:parseInt(T.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Credit Score"}),d.jsx("input",{type:"number",min:"300",max:"850",value:H.maxCreditScore,onChange:T=>J(P=>({...P,maxCreditScore:parseInt(T.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Business Requirements"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Time in Business (years)"}),d.jsx("input",{type:"number",min:"0",step:"0.5",value:H.minTimeInBusiness,onChange:T=>J(P=>({...P,minTimeInBusiness:parseFloat(T.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Monthly Revenue ($)"}),d.jsx("input",{type:"number",value:H.minMonthlyRevenue,onChange:T=>J(P=>({...P,minMonthlyRevenue:parseInt(T.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Terms & Processing"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Factor Rate"}),d.jsx("input",{type:"text",value:H.factorRate,onChange:T=>J(P=>({...P,factorRate:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"1.1 - 1.4"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payback Term"}),d.jsx("input",{type:"text",value:H.paybackTerm,onChange:T=>J(P=>({...P,paybackTerm:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"3-18 months"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Approval Time"}),d.jsx("input",{type:"text",value:H.approvalTime,onChange:T=>J(P=>({...P,approvalTime:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"24 hours"})]})]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Accepted Industries"}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:de.map(T=>d.jsxs("label",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",checked:H.industries.includes(T),onChange:()=>Nt(T),className:"mr-2 text-emerald-600 focus:ring-emerald-500"}),d.jsx("span",{className:"text-sm text-gray-700",children:T})]},T))})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Key Features"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:et.map(T=>d.jsxs("label",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",checked:H.features.includes(T),onChange:()=>rn(T),className:"mr-2 text-emerald-600 focus:ring-emerald-500"}),d.jsx("span",{className:"text-sm text-gray-700",children:T})]},T))})]})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{onClick:Pe,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700",children:i?"Update Lender":"Add Lender"})]})]})]})}),a&&p&&d.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:p.business_name}),d.jsxs("div",{className:"flex items-center mt-1",children:[d.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${X(p.status)}`,children:p.status}),d.jsxs("span",{className:"ml-4 text-sm text-gray-500",children:["Application ID: ",p.id]})]})]}),d.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Business Information"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Business Name"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.business_name})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Industry"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.industry})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Business Type"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.business_type||"N/A"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"EIN"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.ein||"N/A"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Years in Business"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.years_in_business})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Number of Employees"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.number_of_employees})]})]})]}),d.jsxs("div",{className:"mb-8",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact Information"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Owner Name"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.owner_name})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.email})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.phone||"N/A"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.address||"N/A"})]})]})]}),d.jsxs("div",{className:"mb-8",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Financial Information"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Requested Amount"}),d.jsxs("p",{className:"mt-1 text-sm text-gray-900 font-semibold",children:["$",p.requested_amount.toLocaleString()]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Monthly Revenue"}),d.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:["$",p.monthly_revenue.toLocaleString()]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Annual Revenue"}),d.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:["$",p.annual_revenue.toLocaleString()]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Monthly Deposits"}),d.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:["$",p.monthly_deposits.toLocaleString()]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Existing Debt"}),d.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:["$",p.existing_debt.toLocaleString()]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Credit Score"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.credit_score})]})]})]}),d.jsxs("div",{className:"mb-8",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Application Status"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Status"}),d.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-sm font-medium ${X(p.status)}`,children:p.status})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Matched Lenders"}),d.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[p.matchedLenders," lenders"]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(p.created_at).toLocaleDateString()})]})]})]}),p.documents&&p.documents.length>0&&d.jsxs("div",{className:"mb-8",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Documents"}),d.jsx("div",{className:"space-y-2",children:p.documents.map((T,P)=>d.jsxs("div",{className:"flex items-center bg-gray-50 p-3 rounded",children:[d.jsx(Rs,{className:"w-4 h-4 text-green-500 mr-2"}),d.jsx("span",{className:"text-sm text-gray-700",children:T})]},P))})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[d.jsx("button",{onClick:()=>o(!1),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"}),d.jsx("button",{onClick:()=>me(p.id),className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete Application"})]})]})]})}),N&&A&&d.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full mx-4 max-h-[95vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("h3",{className:"text-xl font-medium text-gray-900",children:["Edit Application - ",A.business_name]}),d.jsx("button",{onClick:()=>{k(!1),C(null)},className:"text-gray-400 hover:text-gray-600",children:d.jsx(d0,{className:"w-6 h-6"})})]})}),d.jsx("div",{className:"p-6",children:d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Application Details"}),d.jsxs("form",{onSubmit:G,className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Name"}),d.jsx("input",{type:"text",value:A.business_name,onChange:T=>C(P=>P?{...P,business_name:T.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Name"}),d.jsx("input",{type:"text",value:A.owner_name,onChange:T=>C(P=>P?{...P,owner_name:T.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),d.jsx("input",{type:"email",value:A.email,onChange:T=>C(P=>P?{...P,email:T.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),d.jsx("input",{type:"tel",value:A.phone||"",onChange:T=>C(P=>P?{...P,phone:T.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Industry"}),d.jsxs("select",{value:A.industry||"",onChange:T=>C(P=>P?{...P,industry:T.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"",children:"Select Industry"}),d.jsx("option",{value:"Retail",children:"Retail"}),d.jsx("option",{value:"Restaurant",children:"Restaurant"}),d.jsx("option",{value:"Healthcare",children:"Healthcare"}),d.jsx("option",{value:"Construction",children:"Construction"}),d.jsx("option",{value:"Professional Services",children:"Professional Services"}),d.jsx("option",{value:"Transportation",children:"Transportation"}),d.jsx("option",{value:"Manufacturing",children:"Manufacturing"}),d.jsx("option",{value:"Technology",children:"Technology"}),d.jsx("option",{value:"Real Estate",children:"Real Estate"}),d.jsx("option",{value:"Other",children:"Other"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),d.jsxs("select",{value:A.status,onChange:T=>C(P=>P&&{...P,status:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"draft",children:"Draft"}),d.jsx("option",{value:"submitted",children:"Submitted"}),d.jsx("option",{value:"under-review",children:"Under Review"}),d.jsx("option",{value:"approved",children:"Approved"}),d.jsx("option",{value:"funded",children:"Funded"}),d.jsx("option",{value:"declined",children:"Declined"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Requested Amount"}),d.jsx("input",{type:"number",value:A.requested_amount,onChange:T=>C(P=>P&&{...P,requested_amount:Number(T.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monthly Revenue"}),d.jsx("input",{type:"number",value:A.monthly_revenue,onChange:T=>C(P=>P&&{...P,monthly_revenue:Number(T.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit Score"}),d.jsx("input",{type:"number",value:A.credit_score,onChange:T=>C(P=>P&&{...P,credit_score:Number(T.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"300",max:"850"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Years in Business"}),d.jsx("input",{type:"number",value:A.years_in_business,onChange:T=>C(P=>P&&{...P,years_in_business:Number(T.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"})]})]}),d.jsx("div",{className:"flex justify-end pt-4",children:d.jsxs("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 flex items-center",children:[d.jsx(Rs,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Lender Submissions"}),d.jsxs("button",{onClick:()=>U(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center text-sm",children:[d.jsx(ng,{className:"w-4 h-4 mr-1"}),"Add Lender"]})]}),d.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[j.map(T=>d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[d.jsxs("div",{className:"flex items-start justify-between mb-3",children:[d.jsxs("div",{children:[d.jsx("h5",{className:"font-medium text-gray-900",children:T.lender.name}),d.jsxs("p",{className:"text-sm text-gray-500",children:["Created: ",new Date(T.created_at).toLocaleDateString()]})]}),d.jsxs("select",{value:T.status,onChange:P=>ps(T,{status:P.target.value}),className:`px-3 py-1 rounded-full text-xs font-medium border-0 ${T.status==="approved"?"bg-green-100 text-green-800":T.status==="declined"?"bg-red-100 text-red-800":T.status==="funded"?"bg-blue-100 text-blue-800":T.status==="counter-offer"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:[d.jsx("option",{value:"pending",children:"Pending"}),d.jsx("option",{value:"approved",children:"Approved"}),d.jsx("option",{value:"declined",children:"Declined"}),d.jsx("option",{value:"counter-offer",children:"Counter Offer"}),d.jsx("option",{value:"funded",children:"Funded"})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Offered Amount"}),d.jsx("input",{type:"number",value:T.offered_amount||"",onChange:P=>ps(T,{offered_amount:P.target.value===""?void 0:Number(P.target.value)}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Amount"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Factor Rate"}),d.jsx("input",{type:"text",value:T.factor_rate||"",onChange:P=>ps(T,{factor_rate:P.target.value===""?void 0:P.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"1.2"})]})]}),d.jsxs("div",{className:"mb-3",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Terms"}),d.jsx("input",{type:"text",value:T.terms||"",onChange:P=>ps(T,{terms:P.target.value===""?void 0:P.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"12 months"})]}),d.jsxs("div",{className:"mb-3",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Response"}),d.jsx("textarea",{value:T.response||"",onChange:P=>ps(T,{response:P.target.value===""?void 0:P.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",rows:2,placeholder:"Lender response..."})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),d.jsx("textarea",{value:T.notes||"",onChange:P=>ps(T,{notes:P.target.value===""?void 0:P.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",rows:2,placeholder:"Internal notes..."})]})]},T.id)),j.length===0&&d.jsxs("div",{className:"text-center py-8 text-gray-500",children:[d.jsx(Co,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),d.jsx("p",{children:"No lender submissions yet"}),d.jsx("p",{className:"text-sm",children:'Click "Add Lender" to create submissions'})]})]})]})]})})]})}),R&&d.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[d.jsx("div",{className:"p-6 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add Lender Submission"}),d.jsx("button",{onClick:()=>U(!1),className:"text-gray-400 hover:text-gray-600",children:d.jsx(d0,{className:"w-5 h-5"})})]})}),d.jsxs("div",{className:"p-6",children:[d.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:g.filter(T=>!j.some(P=>P.lender_id===T.id)).map(T=>d.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>Bh(T.id),children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-medium text-gray-900",children:T.name}),d.jsxs("p",{className:"text-sm text-gray-500",children:["$",T.min_amount.toLocaleString()," - $",T.max_amount.toLocaleString()]})]}),d.jsx(ng,{className:"w-5 h-5 text-green-600"})]},T.id))}),g.filter(T=>!j.some(P=>P.lender_id===T.id)).length===0&&d.jsx("div",{className:"text-center py-8 text-gray-500",children:d.jsx("p",{children:"All available lenders have been added"})})]})]})}),c&&d.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Email Template Settings"}),d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Customize the email template sent to lenders"})]}),d.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"mb-6",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Available Variables"}),d.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-sm",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"font-medium text-gray-700",children:"Business Info:"}),d.jsx("p",{className:"text-gray-600",children:"{{businessName}}"}),d.jsx("p",{className:"text-gray-600",children:"{{ownerName}}"}),d.jsx("p",{className:"text-gray-600",children:"{{industry}}"}),d.jsx("p",{className:"text-gray-600",children:"{{businessType}}"}),d.jsx("p",{className:"text-gray-600",children:"{{ein}}"}),d.jsx("p",{className:"text-gray-600",children:"{{yearsInBusiness}}"})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"font-medium text-gray-700",children:"Financial Info:"}),d.jsx("p",{className:"text-gray-600",children:"{{requestedAmount}}"}),d.jsx("p",{className:"text-gray-600",children:"{{monthlyRevenue}}"}),d.jsx("p",{className:"text-gray-600",children:"{{annualRevenue}}"}),d.jsx("p",{className:"text-gray-600",children:"{{creditScore}}"}),d.jsx("p",{className:"text-gray-600",children:"{{existingDebt}}"})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"font-medium text-gray-700",children:"Contact & Lender:"}),d.jsx("p",{className:"text-gray-600",children:"{{email}}"}),d.jsx("p",{className:"text-gray-600",children:"{{phone}}"}),d.jsx("p",{className:"text-gray-600",children:"{{address}}"}),d.jsx("p",{className:"text-gray-600",children:"{{lenderName}}"}),d.jsx("p",{className:"text-gray-600",children:"{{lenderMinAmount}}"}),d.jsx("p",{className:"text-gray-600",children:"{{lenderMaxAmount}}"}),d.jsx("p",{className:"text-gray-600",children:"{{lenderFactorRate}}"}),d.jsx("p",{className:"text-gray-600",children:"{{lenderPaybackTerm}}"}),d.jsx("p",{className:"text-gray-600",children:"{{lenderApprovalTime}}"}),d.jsx("p",{className:"text-gray-600",children:"{{applicationId}}"})]})]})})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Template"}),d.jsx("textarea",{value:h,onChange:T=>f(T.target.value),className:"w-full h-96 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono text-sm",placeholder:"Enter your email template..."}),d.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Use the variables above to dynamically insert application and lender data"})]}),d.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6",children:[d.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Preview"}),d.jsx("div",{className:"bg-white border rounded p-3 max-h-40 overflow-y-auto",children:d.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap",children:h.replace(/\{\{businessName\}\}/g,"Sample Business LLC").replace(/\{\{ownerName\}\}/g,"John Smith").replace(/\{\{industry\}\}/g,"Technology").replace(/\{\{businessType\}\}/g,"LLC").replace(/\{\{ein\}\}/g,"12-3456789").replace(/\{\{yearsInBusiness\}\}/g,"3").replace(/\{\{requestedAmount\}\}/g,"150,000").replace(/\{\{monthlyRevenue\}\}/g,"50,000").replace(/\{\{annualRevenue\}\}/g,"600,000").replace(/\{\{creditScore\}\}/g,"720").replace(/\{\{existingDebt\}\}/g,"25,000").replace(/\{\{email\}\}/g,"john@samplebusiness.com").replace(/\{\{phone\}\}/g,"(555) 123-4567").replace(/\{\{address\}\}/g,"123 Business St, City, ST 12345").replace(/\{\{lenderName\}\}/g,"Sample Lender").replace(/\{\{lenderMinAmount\}\}/g,"50,000").replace(/\{\{lenderMaxAmount\}\}/g,"500,000").replace(/\{\{lenderFactorRate\}\}/g,"1.2 - 1.4").replace(/\{\{lenderPaybackTerm\}\}/g,"6-18 months").replace(/\{\{lenderApprovalTime\}\}/g,"24 hours").replace(/\{\{applicationId\}\}/g,"APP-12345")})})]})]}),d.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[d.jsx("button",{onClick:()=>{f(`Subject: Merchant Cash Advance Application - {{businessName}}

Dear {{lenderName}} Team,

I hope this email finds you well. I am writing to submit a merchant cash advance application for your review and consideration.

BUSINESS INFORMATION:
 Business Name: {{businessName}}
 Owner: {{ownerName}}
 Industry: {{industry}}
 Years in Business: {{yearsInBusiness}}
 Business Type: {{businessType}}
 EIN: {{ein}}

FINANCIAL DETAILS:
 Requested Amount: \${{requestedAmount}}
 Monthly Revenue: \${{monthlyRevenue}}
 Annual Revenue: \${{annualRevenue}}
 Credit Score: {{creditScore}}
 Existing Debt: \${{existingDebt}}

CONTACT INFORMATION:
 Email: {{email}}
 Phone: {{phone}}
 Address: {{address}}

I have attached the following documents for your review:
 Business bank statements (last 6 months)
 Tax returns
 Completed application form
 Voided business check

Based on your underwriting guidelines, I believe this application aligns well with your lending criteria:
 Amount Range: \${{lenderMinAmount}} - \${{lenderMaxAmount}}
 Factor Rate: {{lenderFactorRate}}
 Payback Term: {{lenderPaybackTerm}}
 Approval Time: {{lenderApprovalTime}}

I would appreciate the opportunity to discuss this application further and answer any questions you may have. Please let me know if you need any additional information or documentation.

Thank you for your time and consideration. I look forward to hearing from you soon.

Best regards,
{{ownerName}}
{{businessName}}
{{email}}
{{phone}}

---
This application was submitted through MCAPortal Pro
Application ID: {{applicationId}}`)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Reset to Default"}),d.jsxs("div",{className:"flex space-x-3",children:[d.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),d.jsx("button",{onClick:()=>{localStorage.setItem("mcaPortalEmailTemplate",h),u(!1),alert("Email template saved successfully!")},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Save Template"})]})]})]})})]})},aP=()=>{const[n,e]=Q.useState(""),[t,s]=Q.useState("all"),[i,r]=Q.useState(null),[a,o]=Q.useState(!1),[c,u]=Q.useState([]),[h,f]=Q.useState(!0);zy.useEffect(()=>{(async()=>{try{f(!0);const S=await F1(),A=await Promise.all(S.map(async C=>{const N=await S0(C.id);return{...C,matchedLenders:N.length,lenderSubmissions:N}}));u(A)}catch(S){console.error("Error loading applications:",S)}finally{f(!1)}})()},[]);const p=v=>{switch(v){case"funded":return"bg-green-100 text-green-800";case"approved":return"bg-blue-100 text-blue-800";case"counter-offer":return"bg-yellow-100 text-yellow-800";case"pending":return"bg-gray-100 text-gray-800";case"declined":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},m=v=>{switch(v){case"funded":return"bg-blue-100 text-blue-800";case"approved":return"bg-green-100 text-green-800";case"submitted":return"bg-yellow-100 text-yellow-800";case"under-review":return"bg-purple-100 text-purple-800";case"declined":return"bg-red-100 text-red-800";case"draft":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},g=v=>{switch(v){case"funded":return d.jsx(Iv,{className:"w-4 h-4"});case"approved":return d.jsx(Rs,{className:"w-4 h-4"});case"submitted":return d.jsx(sg,{className:"w-4 h-4"});case"under-review":return d.jsx(yN,{className:"w-4 h-4"});case"declined":return d.jsx(d0,{className:"w-4 h-4"});default:return d.jsx(sg,{className:"w-4 h-4"})}},b=c.filter(v=>{const S=v.business_name.toLowerCase().includes(n.toLowerCase())||v.owner_name.toLowerCase().includes(n.toLowerCase())||v.id.toLowerCase().includes(n.toLowerCase()),A=t==="all"||v.status===t;return S&&A}),E={all:c.length,submitted:c.filter(v=>v.status==="submitted").length,approved:c.filter(v=>v.status==="approved").length,declined:c.filter(v=>v.status==="declined").length},x=v=>{r(v),o(!0)};return d.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[h&&d.jsx("div",{className:"flex items-center justify-center py-12",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"Loading applications..."})]})}),d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"All Deals"}),d.jsx("p",{className:"text-gray-600",children:"View and manage all merchant cash advance submissions"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[d.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:d.jsx(Co,{className:"w-6 h-6 text-blue-600"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Deals"}),d.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.length})]})]})}),d.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:d.jsx(Rs,{className:"w-6 h-6 text-green-600"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Approved"}),d.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.approved})]})]})}),d.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:d.jsx(sg,{className:"w-6 h-6 text-yellow-600"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Submitted"}),d.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.submitted})]})]})}),d.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:d.jsx(d1,{className:"w-6 h-6 text-purple-600"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Volume"}),d.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",c.reduce((v,S)=>v+S.requested_amount,0).toLocaleString()]})]})]})})]}),d.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsxs("div",{className:"relative",children:[d.jsx(SN,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),d.jsx("input",{type:"text",placeholder:"Search deals...",value:n,onChange:v=>e(v.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),d.jsxs("select",{value:t,onChange:v=>s(v.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[d.jsxs("option",{value:"all",children:["All Status (",E.all,")"]}),d.jsxs("option",{value:"submitted",children:["Submitted (",E.submitted,")"]}),d.jsxs("option",{value:"approved",children:["Approved (",E.approved,")"]}),d.jsxs("option",{value:"approved",children:["Approved (",E.approved,")"]}),d.jsxs("option",{value:"declined",children:["Declined (",E.declined,")"]})]})]}),d.jsx("div",{className:"flex items-center space-x-2",children:d.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center",children:[d.jsx(bN,{className:"w-4 h-4 mr-2"}),"Export"]})})]})}),d.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deal Info"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Financial"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activity"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(v=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.business_name}),d.jsx("div",{className:"text-sm text-gray-500",children:v.id}),d.jsxs("div",{className:"flex items-center mt-1",children:[d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${m(v.status)}`,children:v.status}),d.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"website"})]})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.owner_name}),d.jsx("div",{className:"text-sm text-gray-500",children:v.email}),d.jsx("div",{className:"text-sm text-gray-500",children:v.phone||"N/A"})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{children:[d.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["$",v.requested_amount.toLocaleString()]}),d.jsxs("div",{className:"text-sm text-gray-500",children:["$",v.monthly_revenue.toLocaleString(),"/mo"]}),d.jsxs("div",{className:"text-sm text-gray-500",children:["Credit: ",v.credit_score," | ",v.years_in_business,"y"]})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"flex flex-col space-y-2",children:[d.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m(v.status)}`,children:[g(v.status),d.jsx("span",{className:"ml-1",children:v.status.replace("-"," ")})]}),v.lenderSubmissions.length>0&&d.jsxs("span",{className:"text-xs text-gray-500",children:[v.lenderSubmissions.length," lender",v.lenderSubmissions.length>1?"s":""]})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{children:[d.jsxs("div",{className:"text-sm text-gray-900",children:["Submitted: ",new Date(v.created_at).toLocaleDateString()]}),d.jsxs("div",{className:"text-sm text-gray-500",children:["Last: ",new Date(v.updated_at).toLocaleDateString()]})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:d.jsxs("div",{className:"flex space-x-2",children:[d.jsx("button",{onClick:()=>x(v),className:"text-purple-600 hover:text-purple-900",children:d.jsx(h1,{className:"w-4 h-4"})}),d.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:d.jsx(u0,{className:"w-4 h-4"})})]})})]},v.id))})]})})}),a&&i&&d.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Deal Details - ",i.business_name]}),d.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Business Information"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Business Name:"})," ",d.jsx("span",{className:"font-medium",children:i.business_name})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Industry:"})," ",d.jsx("span",{className:"font-medium",children:i.industry})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Time in Business:"})," ",d.jsxs("span",{className:"font-medium",children:[i.years_in_business," years"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Monthly Revenue:"})," ",d.jsxs("span",{className:"font-medium",children:["$",i.monthly_revenue.toLocaleString()]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Credit Score:"})," ",d.jsx("span",{className:"font-medium",children:i.credit_score})]})]})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Contact Information"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Owner:"})," ",d.jsx("span",{className:"font-medium",children:i.owner_name})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Email:"})," ",d.jsx("span",{className:"font-medium",children:i.email})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Phone:"})," ",d.jsx("span",{className:"font-medium",children:i.phone||"N/A"})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Source:"})," ",d.jsx("span",{className:"font-medium",children:"website"})]})]})]})]}),d.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[d.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:["Lender Submissions (",i.lenderSubmissions.length,")"]}),d.jsx("div",{className:"space-y-4",children:i.lenderSubmissions.map((v,S)=>d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[d.jsxs("div",{className:"flex items-start justify-between mb-3",children:[d.jsxs("div",{children:[d.jsx("h5",{className:"font-medium text-gray-900",children:v.lender.name}),d.jsxs("p",{className:"text-sm text-gray-500",children:["Submitted: ",new Date(v.created_at).toLocaleDateString(),v.response_date&&d.jsxs("span",{children:["  Responded: ",new Date(v.response_date).toLocaleDateString()]})]})]}),d.jsx("span",{className:`inline-flex px-2.5 py-0.5 rounded-full text-xs font-medium ${p(v.status)}`,children:v.status})]}),v.response&&d.jsx("div",{className:"mb-3",children:d.jsxs("p",{className:"text-sm text-gray-700",children:[d.jsx("span",{className:"font-medium",children:"Response:"})," ",v.response]})}),(v.offered_amount||v.factor_rate||v.terms)&&d.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[v.offered_amount&&d.jsxs("div",{children:[d.jsx("span",{className:"text-xs text-gray-500",children:"Offered Amount"}),d.jsxs("p",{className:"font-medium text-sm",children:["$",v.offered_amount.toLocaleString()]})]}),v.factor_rate&&d.jsxs("div",{children:[d.jsx("span",{className:"text-xs text-gray-500",children:"Factor Rate"}),d.jsx("p",{className:"font-medium text-sm",children:v.factor_rate})]}),v.terms&&d.jsxs("div",{children:[d.jsx("span",{className:"text-xs text-gray-500",children:"Terms"}),d.jsx("p",{className:"font-medium text-sm",children:v.terms})]})]}),v.notes&&d.jsxs("div",{className:"text-xs text-gray-600 bg-white p-2 rounded border",children:[d.jsx("span",{className:"font-medium",children:"Notes:"})," ",v.notes]})]},S))})]}),d.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:d.jsxs("div",{className:"flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"}),d.jsx("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Edit Deal"})]})})]})]})})]})};function oP(){const[n,e]=Q.useState("submissions");return d.jsxs("div",{className:"min-h-screen bg-gray-50",children:[d.jsx("div",{className:"bg-white shadow-sm border-b",children:d.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:d.jsxs("div",{className:"flex justify-between items-center py-4",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(Co,{className:"h-8 w-8 text-blue-600"}),d.jsx("span",{className:"text-2xl font-bold text-gray-900",children:"MCAPortal Pro"})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsx("button",{onClick:()=>e("submissions"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="submissions"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Submissions Portal"}),d.jsx("button",{onClick:()=>e("deals"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="deals"?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Deals"}),d.jsx("button",{onClick:()=>e("admin"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="admin"?"bg-emerald-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Admin Portal"})]})]})})}),n==="submissions"&&d.jsx(iP,{}),n==="deals"&&d.jsx(aP,{}),n==="admin"&&d.jsx(rP,{})]})}u1(document.getElementById("root")).render(d.jsx(Q.StrictMode,{children:d.jsx(oP,{})}));
